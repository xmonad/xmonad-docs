<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  XMonad.Hooks.FadeWindows</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Description :  A more flexible and general compositing interface than FadeInactive.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  Brandon S Allbery KF8NH &lt;allbery.b@gmail.com&gt;</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  BSD</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  Brandon S Allbery KF8NH</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- A more flexible and general compositing interface than FadeInactive.</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Windows can be selected and opacity specified by means of FadeHooks,</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- which are very similar to ManageHooks and use the same machinery.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Hooks.FadeWindows</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-20"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- * The 'logHook' for window fading</span></span><span>
</span><span id="line-23"></span><span>                                 </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsLogHook"><span class="hs-identifier">fadeWindowsLogHook</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- * The 'FadeHook'</span></span><span>
</span><span id="line-26"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier">FadeHook</span></a></span><span>
</span><span id="line-27"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier">Opacity</span></a></span><span>
</span><span id="line-28"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#idFadeHook"><span class="hs-identifier">idFadeHook</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>                                 </span><span class="annot"><span class="hs-comment">-- * Predefined 'FadeHook's</span></span><span>
</span><span id="line-31"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#opaque"><span class="hs-identifier">opaque</span></a></span><span>
</span><span id="line-32"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#solid"><span class="hs-identifier">solid</span></a></span><span>
</span><span id="line-33"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#transparent"><span class="hs-identifier">transparent</span></a></span><span>
</span><span id="line-34"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#invisible"><span class="hs-identifier">invisible</span></a></span><span>
</span><span id="line-35"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#transparency"><span class="hs-identifier">transparency</span></a></span><span>
</span><span id="line-36"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#translucence"><span class="hs-identifier">translucence</span></a></span><span>
</span><span id="line-37"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeBy"><span class="hs-identifier">fadeBy</span></a></span><span>
</span><span id="line-38"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#opacity"><span class="hs-identifier">opacity</span></a></span><span>
</span><span id="line-39"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeTo"><span class="hs-identifier">fadeTo</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>                                </span><span class="annot"><span class="hs-comment">-- * 'handleEventHook' for mapped/unmapped windows</span></span><span>
</span><span id="line-42"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsEventHook"><span class="hs-identifier">fadeWindowsEventHook</span></a></span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>                                </span><span class="annot"><span class="hs-comment">-- * 'doF' for simple hooks</span></span><span>
</span><span id="line-45"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier">doS</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>                                </span><span class="annot"><span class="hs-comment">-- * Useful 'Query's for 'FadeHook's</span></span><span>
</span><span id="line-48"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#isFloating"><span class="hs-identifier">isFloating</span></a></span><span>
</span><span id="line-49"></span><span>                                </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeInactive.html#isUnfocused"><span class="hs-identifier">isUnfocused</span></a></span><span>
</span><span id="line-50"></span><span>                                </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">XMonad.Core</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">XMonad.ManageHook</span></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftX</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Hooks.FadeInactive.html"><span class="hs-identifier">XMonad.Hooks.FadeInactive</span></a></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.FadeInactive.html#setOpacity"><span class="hs-identifier">setOpacity</span></a></span><span>
</span><span id="line-58"></span><span>                                                         </span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.FadeInactive.html#isUnfocused"><span class="hs-identifier">isUnfocused</span></a></span><span>
</span><span id="line-59"></span><span>                                                         </span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span>
</span><span id="line-62"></span><span>                                                         </span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Graphics.X11.Xlib.Extras</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Event</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- To use this module, make sure your @xmonad@ core supports generalized</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- 'ManageHook's (check the type of 'idHook'; if it's @ManageHook@ then</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- your @xmonad@ is too old) and then add @fadeWindowsLogHook@ to your</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- 'logHook' and @fadeWindowsEventHook@ to your 'handleEventHook':</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;     , logHook = fadeWindowsLogHook myFadeHook</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- &gt;     , handleEventHook = fadeWindowsEventHook</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- &gt;     {- ... -}</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &gt; myFadeHook = composeAll [                 opaque</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &gt;                         , isUnfocused --&gt; transparency 0.2</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- &gt;                         ]</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- The above is like FadeInactive with a fade value of 0.2.</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- 'FadeHook's do not accumulate; instead, they compose from right to</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- left like 'ManageHook's, so in the above example @myFadeHook@ will</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- render unfocused windows at 4/5 opacity and the focused window as</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- opaque.  This means that, in particular, the order in the above</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- example is important.</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- The 'opaque' hook above is optional, by the way, as any unmatched</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- window will be opaque by default.  If you want to make all windows a</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- bit transparent by default, you can replace 'opaque' with something</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- like</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt; transparency 0.93</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- at the top of @myFadeHook@.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- This module is best used with &quot;XMonad.Hooks.MoreManageHelpers&quot;, which</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- exports a number of Queries that can be used in either @ManageHook@</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- or @FadeHook@.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Note that you need a compositing manager such as @xcompmgr@,</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- @dcompmgr@, or @cairo-compmgr@ for window fading to work.  If you</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- aren't running a compositing manager, the opacity will be recorded</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- but won't take effect until a compositing manager is started.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- For more detailed instructions on editing the 'logHook' see:</span><span>
</span><span id="line-109"></span><span class="hs-comment">--</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#The_log_hook_and_external_status_bars&quot;</span><span>
</span><span id="line-111"></span><span class="hs-comment">--</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- For more detailed instructions on editing the 'handleEventHook',</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- see:</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#Editing_the_event_hook&quot;</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- (which sadly doesnt exist at the time of writing...)</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- /WARNING:/  This module is very good at triggering bugs in</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- compositing managers.  Symptoms range from windows not being</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- repainted until the compositing manager is restarted or the</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- window is unmapped and remapped, to the machine becoming sluggish</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- until the compositing manager is restarted (at which point a</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- popup/dialog will suddenly appear; apparently it's getting into</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- a tight loop trying to fade the popup in).  I find it useful to</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- have a key binding to restart the compositing manager; for example,</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- main = xmonad $ def {</span><span>
</span><span id="line-128"></span><span class="hs-comment">--                   {- ... -}</span><span>
</span><span id="line-129"></span><span class="hs-comment">--                 }</span><span>
</span><span id="line-130"></span><span class="hs-comment">--                 `additionalKeysP`</span><span>
</span><span id="line-131"></span><span class="hs-comment">--                 [(&quot;M-S-4&quot;,spawn &quot;killall xcompmgr; sleep 1; xcompmgr -cCfF &amp;&quot;)]</span><span>
</span><span id="line-132"></span><span class="hs-comment">--                 {- ... -}</span><span>
</span><span id="line-133"></span><span class="hs-comment">--                 ]</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- (See &quot;XMonad.Util.EZConfig&quot; for 'additionalKeysP'.)</span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- a window opacity to be carried in a Query.  OEmpty is sort of a hack</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- to make it obay the monoid laws</span><span>
</span><span id="line-139"></span><span class="hs-keyword">data</span><span> </span><span id="Opacity"><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Opacity"><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="OEmpty"><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#OEmpty"><span class="hs-identifier hs-var">OEmpty</span></a></span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679378174"><span id="local-6989586621679378176"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-type">Opacity</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679378172"><span class="annot"><span class="annottext">Opacity
</span><a href="#local-6989586621679378172"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679378171"><span class="annot"><span class="annottext">&lt;&gt; :: Opacity -&gt; Opacity -&gt; Opacity
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><span class="annottext">Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#OEmpty"><span class="hs-identifier hs-var">OEmpty</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Opacity
</span><a href="#local-6989586621679378172"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">Opacity
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span id="local-6989586621679378170"><span class="annot"><span class="annottext">Opacity
</span><a href="#local-6989586621679378170"><span class="hs-identifier hs-var">r</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Opacity
</span><a href="#local-6989586621679378170"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679378163"><span id="local-6989586621679378165"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-type">Opacity</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="local-6989586621679378161"><span class="annot"><span class="annottext">mempty :: Opacity
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#OEmpty"><span class="hs-identifier hs-var">OEmpty</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | A FadeHook is similar to a ManageHook, but records window opacity.</span><span>
</span><span id="line-149"></span><span class="hs-keyword">type</span><span> </span><span id="FadeHook"><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-var">FadeHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-type">Opacity</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Render a window fully opaque.</span><span>
</span><span id="line-152"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#opaque"><span class="hs-identifier hs-type">opaque</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-153"></span><span id="opaque"><span class="annot"><span class="annottext">opaque :: FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#opaque"><span class="hs-identifier hs-var hs-var">opaque</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Opacity -&gt; FadeHook
forall m. Monoid m =&gt; m -&gt; Query m
</span><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier hs-var">doS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Render a window fully transparent.</span><span>
</span><span id="line-156"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#transparent"><span class="hs-identifier hs-type">transparent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-157"></span><span id="transparent"><span class="annot"><span class="annottext">transparent :: FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#transparent"><span class="hs-identifier hs-var hs-var">transparent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Opacity -&gt; FadeHook
forall m. Monoid m =&gt; m -&gt; Query m
</span><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier hs-var">doS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Specify a window's transparency.</span><span>
</span><span id="line-160"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#transparency"><span class="hs-identifier hs-type">transparency</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-comment">-- ^ The window's transparency as a fraction.</span><span>
</span><span id="line-161"></span><span>                         </span><span class="hs-comment">--   @transparency 1@ is the same as 'transparent',</span><span>
</span><span id="line-162"></span><span>                         </span><span class="hs-comment">--   whereas @transparency 0@ is the same as 'opaque'.</span><span>
</span><span id="line-163"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-164"></span><span id="transparency"><span class="annot"><span class="annottext">transparency :: Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#transparency"><span class="hs-identifier hs-var hs-var">transparency</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Opacity -&gt; FadeHook
forall m. Monoid m =&gt; m -&gt; Query m
</span><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier hs-var">doS</span></a></span><span> </span><span class="annot"><span class="annottext">(Opacity -&gt; FadeHook)
-&gt; (Rational -&gt; Opacity) -&gt; Rational -&gt; FadeHook
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Opacity)
-&gt; (Rational -&gt; Rational) -&gt; Rational -&gt; Opacity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Rational)
-&gt; (Rational -&gt; Rational) -&gt; Rational -&gt; Rational
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational
</span><a href="XMonad.Hooks.FadeWindows.html#clampRatio"><span class="hs-identifier hs-var">clampRatio</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Specify a window's opacity; this is the inverse of 'transparency'.</span><span>
</span><span id="line-167"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#opacity"><span class="hs-identifier hs-type">opacity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-comment">-- ^ The opacity of a window as a fraction.</span><span>
</span><span id="line-168"></span><span>                    </span><span class="hs-comment">--   @opacity 1@ is the same as 'opaque',</span><span>
</span><span id="line-169"></span><span>                    </span><span class="hs-comment">--   whereas @opacity 0@ is the same as 'transparent'.</span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-171"></span><span id="opacity"><span class="annot"><span class="annottext">opacity :: Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#opacity"><span class="hs-identifier hs-var hs-var">opacity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Opacity -&gt; FadeHook
forall m. Monoid m =&gt; m -&gt; Query m
</span><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier hs-var">doS</span></a></span><span> </span><span class="annot"><span class="annottext">(Opacity -&gt; FadeHook)
-&gt; (Rational -&gt; Opacity) -&gt; Rational -&gt; FadeHook
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Opacity)
-&gt; (Rational -&gt; Rational) -&gt; Rational -&gt; Opacity
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational
</span><a href="XMonad.Hooks.FadeWindows.html#clampRatio"><span class="hs-identifier hs-var">clampRatio</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeTo"><span class="hs-identifier hs-type">fadeTo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#translucence"><span class="hs-identifier hs-type">translucence</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeBy"><span class="hs-identifier hs-type">fadeBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | An alias for 'transparency'.</span><span>
</span><span id="line-175"></span><span id="fadeTo"><span class="annot"><span class="annottext">fadeTo :: Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#fadeTo"><span class="hs-identifier hs-var hs-var">fadeTo</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#transparency"><span class="hs-identifier hs-var">transparency</span></a></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | An alias for 'transparency'.</span><span>
</span><span id="line-177"></span><span id="translucence"><span class="annot"><span class="annottext">translucence :: Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#translucence"><span class="hs-identifier hs-var hs-var">translucence</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#transparency"><span class="hs-identifier hs-var">transparency</span></a></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | An alias for 'opacity'.</span><span>
</span><span id="line-179"></span><span id="fadeBy"><span class="annot"><span class="annottext">fadeBy :: Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#fadeBy"><span class="hs-identifier hs-var hs-var">fadeBy</span></a></span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#opacity"><span class="hs-identifier hs-var">opacity</span></a></span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#invisible"><span class="hs-identifier hs-type">invisible</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#solid"><span class="hs-identifier hs-type">solid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | An alias for 'transparent'.</span><span>
</span><span id="line-183"></span><span id="invisible"><span class="annot"><span class="annottext">invisible :: FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#invisible"><span class="hs-identifier hs-var hs-var">invisible</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#transparent"><span class="hs-identifier hs-var">transparent</span></a></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | An alias for 'opaque'.</span><span>
</span><span id="line-185"></span><span id="solid"><span class="annot"><span class="annottext">solid :: FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#solid"><span class="hs-identifier hs-var hs-var">solid</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#opaque"><span class="hs-identifier hs-var">opaque</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Like 'doF', but usable with 'ManageHook'-like hooks that</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- aren't 'Query' wrapped around transforming functions ('Endo').</span><span>
</span><span id="line-189"></span><span id="local-6989586621679378325"><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier hs-type">doS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679378325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679378325"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><a href="#local-6989586621679378325"><span class="hs-identifier hs-type">m</span></a></span></span><span>
</span><span id="line-190"></span><span id="doS"><span class="annot"><span class="annottext">doS :: forall m. Monoid m =&gt; m -&gt; Query m
</span><a href="XMonad.Hooks.FadeWindows.html#doS"><span class="hs-identifier hs-var hs-var">doS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">m -&gt; Query m
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | The identity 'FadeHook', which renders windows 'opaque'.</span><span>
</span><span id="line-193"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#idFadeHook"><span class="hs-identifier hs-type">idFadeHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span>
</span><span id="line-194"></span><span id="idFadeHook"><span class="annot"><span class="annottext">idFadeHook :: FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#idFadeHook"><span class="hs-identifier hs-var hs-var">idFadeHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">FadeHook
</span><a href="XMonad.Hooks.FadeWindows.html#opaque"><span class="hs-identifier hs-var">opaque</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | A Query to determine if a window is floating.</span><span>
</span><span id="line-197"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#isFloating"><span class="hs-identifier hs-type">isFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-198"></span><span id="isFloating"><span class="annot"><span class="annottext">isFloating :: Query Bool
</span><a href="XMonad.Hooks.FadeWindows.html#isFloating"><span class="hs-identifier hs-var hs-var">isFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window -&gt; (Window -&gt; Query Bool) -&gt; Query Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679378156"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679378156"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; Query Bool
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X Bool -&gt; Query Bool)
-&gt; ((XState -&gt; Bool) -&gt; X Bool) -&gt; (XState -&gt; Bool) -&gt; Query Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Bool) -&gt; X Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XState -&gt; Bool) -&gt; Query Bool) -&gt; (XState -&gt; Bool) -&gt; Query Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Map Window RationalRect -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">M.member</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679378156"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Window RationalRect -&gt; Bool)
-&gt; (XState -&gt; Map Window RationalRect) -&gt; XState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Map Window RationalRect
forall i l a sid sd. StackSet i l a sid sd -&gt; Map a RationalRect
</span><span class="hs-identifier hs-var hs-var">W.floating</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
 -&gt; Map Window RationalRect)
-&gt; (XState
    -&gt; StackSet
         WorkspaceId (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; Map Window RationalRect
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- boring windows can't be seen outside of a layout, so we watch messages with</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- a dummy LayoutModifier and stow them in a persistent bucket.  this is not</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- entirely reliable given that boringAuto still isn't observable; we just hope</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- those aren't visible and won;t be affected anyway</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- @@@ punted for now, will be a separate module.  it's still slimy, though</span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-comment">-- | A 'logHook' to fade windows under control of a 'FadeHook', which is</span><span>
</span><span id="line-207"></span><span class="hs-comment">--   similar to but not identical to 'ManageHook'.</span><span>
</span><span id="line-208"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsLogHook"><span class="hs-identifier hs-type">fadeWindowsLogHook</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#FadeHook"><span class="hs-identifier hs-type">FadeHook</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span id="fadeWindowsLogHook"><span class="annot"><span class="annottext">fadeWindowsLogHook :: FadeHook -&gt; X ()
</span><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsLogHook"><span class="hs-identifier hs-var hs-var">fadeWindowsLogHook</span></a></span></span><span> </span><span id="local-6989586621679378152"><span class="annot"><span class="annottext">FadeHook
</span><a href="#local-6989586621679378152"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
 -&gt; X ())
-&gt; X ()
forall a.
(StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
 -&gt; X a)
-&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
  -&gt; X ())
 -&gt; X ())
-&gt; (StackSet
      WorkspaceId (Layout Window) Window ScreenId ScreenDetail
    -&gt; X ())
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679378150"><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679378150"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679378148"><span class="annot"><span class="annottext">visibleWins :: [Window]
</span><a href="#local-6989586621679378148"><span class="hs-identifier hs-var hs-var">visibleWins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; [Window]
forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack Window) -&gt; [Window])
-&gt; (StackSet
      WorkspaceId (Layout Window) Window ScreenId ScreenDetail
    -&gt; Maybe (Stack Window))
-&gt; StackSet
     WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; [Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
-&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceId (Layout Window) Window
 -&gt; Maybe (Stack Window))
-&gt; (StackSet
      WorkspaceId (Layout Window) Window ScreenId ScreenDetail
    -&gt; Workspace WorkspaceId (Layout Window) Window)
-&gt; StackSet
     WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace WorkspaceId (Layout Window) Window
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
 -&gt; Workspace WorkspaceId (Layout Window) Window)
-&gt; (StackSet
      WorkspaceId (Layout Window) Window ScreenId ScreenDetail
    -&gt; Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail)
-&gt; StackSet
     WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace WorkspaceId (Layout Window) Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
 -&gt; [Window])
-&gt; StackSet
     WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; [Window]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679378150"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [Window] -&gt; [Window]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-211"></span><span>                    </span><span class="annot"><span class="annottext">(Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
 -&gt; [Window])
-&gt; [Screen
      WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
-&gt; [Window]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; [Window]
forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack Window) -&gt; [Window])
-&gt; (Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
    -&gt; Maybe (Stack Window))
-&gt; Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; [Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
-&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceId (Layout Window) Window
 -&gt; Maybe (Stack Window))
-&gt; (Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
    -&gt; Workspace WorkspaceId (Layout Window) Window)
-&gt; Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace WorkspaceId (Layout Window) Window
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
-&gt; [Screen
      WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var hs-var">W.visible</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679378150"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">[Window] -&gt; (Window -&gt; X ()) -&gt; X ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679378148"><span class="hs-identifier hs-var">visibleWins</span></a></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; X ()) -&gt; X ()) -&gt; (Window -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679378140"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679378140"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679378139"><span class="annot"><span class="annottext">Opacity
</span><a href="#local-6989586621679378139"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Opacity -&gt; X Opacity -&gt; X Opacity
forall a. a -&gt; X a -&gt; X a
</span><span class="hs-identifier hs-var">userCodeDef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-var">Opacity</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FadeHook -&gt; Window -&gt; X Opacity
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">FadeHook
</span><a href="#local-6989586621679378152"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679378140"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; Rational -&gt; X ()
</span><a href="XMonad.Hooks.FadeInactive.html#setOpacity"><span class="hs-identifier hs-var">setOpacity</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679378140"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; X ()) -&gt; Rational -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Opacity
</span><a href="#local-6989586621679378139"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-215"></span><span>                     </span><span class="annot"><span class="annottext">Opacity
</span><a href="XMonad.Hooks.FadeWindows.html#OEmpty"><span class="hs-identifier hs-var">OEmpty</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-216"></span><span>                     </span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#Opacity"><span class="hs-identifier hs-type">Opacity</span></a></span><span> </span><span id="local-6989586621679378136"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378136"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378136"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | A 'handleEventHook' to handle fading and unfading of newly mapped</span><span>
</span><span id="line-219"></span><span class="hs-comment">--   or unmapped windows; this avoids problems with layouts such as</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   &quot;XMonad.Layout.Full&quot; or &quot;XMonad.Layout.Tabbed&quot;.  This hook may</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   also be useful with &quot;XMonad.Hooks.FadeInactive&quot;.</span><span>
</span><span id="line-222"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsEventHook"><span class="hs-identifier hs-type">fadeWindowsEventHook</span></a></span><span>                     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span>
</span><span id="line-223"></span><span id="fadeWindowsEventHook"><span class="annot"><span class="annottext">fadeWindowsEventHook :: Event -&gt; X All
</span><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsEventHook"><span class="hs-identifier hs-var hs-var">fadeWindowsEventHook</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">MapNotifyEvent</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-comment">-- we need to run the fadeWindowsLogHook.  only one way...</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">(XConf -&gt; XConfig Layout) -&gt; X (XConfig Layout)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var hs-var">config</span></span><span> </span><span class="annot"><span class="annottext">X (XConfig Layout) -&gt; (XConfig Layout -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">XConfig Layout -&gt; X ()
forall (l :: * -&gt; *). XConfig l -&gt; X ()
</span><span class="hs-identifier hs-var hs-var">logHook</span></span><span> </span><span class="annot"><span class="annottext">X () -&gt; X All -&gt; X All
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">All -&gt; X All
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#fadeWindowsEventHook"><span class="hs-identifier hs-var">fadeWindowsEventHook</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span>                   </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">All -&gt; X All
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- A utility to clamp opacity fractions to the range (0,1)</span><span>
</span><span id="line-229"></span><span class="annot"><a href="XMonad.Hooks.FadeWindows.html#clampRatio"><span class="hs-identifier hs-type">clampRatio</span></a></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-230"></span><span id="clampRatio"><span class="annot"><span class="annottext">clampRatio :: Rational -&gt; Rational
</span><a href="XMonad.Hooks.FadeWindows.html#clampRatio"><span class="hs-identifier hs-var hs-var">clampRatio</span></a></span></span><span> </span><span id="local-6989586621679378131"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378131"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378131"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378131"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378131"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-231"></span><span>             </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679378131"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>            </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-232"></span><span>             </span><span class="hs-glyph">|</span><span>  </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>        </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-233"></span></pre></body></html>