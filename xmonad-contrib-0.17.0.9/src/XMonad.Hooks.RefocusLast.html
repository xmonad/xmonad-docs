<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, MultiWayIf #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  XMonad.Hooks.RefocusLast</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Description :  Hooks and actions to refocus the previous window.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (c) 2018  L. S. Leary</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  :  L. S. Leary</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Provides hooks and actions that keep track of recently focused windows on a</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- per workspace basis and automatically refocus the last window on loss of the</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- current (if appropriate as determined by user specified criteria).</span><span>
</span><span id="line-17"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">-- --&lt; Imports &amp; Exports &gt;-- {{{</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Hooks.RefocusLast</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-comment">-- $Usage</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-comment">-- * Hooks</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusLastLogHook"><span class="hs-identifier">refocusLastLogHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusLastLayoutHook"><span class="hs-identifier">refocusLastLayoutHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusLastWhen"><span class="hs-identifier">refocusLastWhen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Predicates</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- $Predicates</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusingIsActive"><span class="hs-identifier">refocusingIsActive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#isFloat"><span class="hs-identifier">isFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Actions</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#toggleRefocusing"><span class="hs-identifier">toggleRefocusing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#toggleFocus"><span class="hs-identifier">toggleFocus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#swapWithLast"><span class="hs-identifier">swapWithLast</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusWhen"><span class="hs-identifier">refocusWhen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#shiftRLWhen"><span class="hs-identifier">shiftRLWhen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#updateRecentsOn"><span class="hs-identifier">updateRecentsOn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><span class="hs-comment">-- $Types</span></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentWins"><span class="hs-identifier">RecentWins</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier">RecentsMap</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastLayoutHook"><span class="hs-identifier">RefocusLastLayoutHook</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastToggle"><span class="hs-identifier">RefocusLastToggle</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Library functions</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier">withRecentsIn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">All</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asum</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html"><span class="hs-identifier">XMonad.Util.Stack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Stack.html#findS"><span class="hs-identifier">findS</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapZ_"><span class="hs-identifier">mapZ_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html"><span class="hs-identifier">XMonad.Layout.LayoutModifier</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- --&lt; Usage &gt;-- {{{</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- $Usage</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- To use this module, you must either include 'refocusLastLogHook' in your log</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- hook __or__ 'refocusLastLayoutHook' in your layout hook; don't use both.</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- This suffices to make use of both 'toggleFocus' and 'shiftRLWhen' but will</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- not refocus automatically upon loss of the current window; for that you must</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- include in your event hook @'refocusLastWhen' pred@ for some valid @pred@.</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- The event hooks that trigger refocusing only fire when a window is lost</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- completely, not when it's simply e.g. moved to another workspace. Hence you</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- will need to use @'shiftRLWhen' pred@ or @'refocusWhen' pred@ as appropriate</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- if you want the same behaviour in such cases.</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Example configuration:</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- &gt; import XMonad</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.RefocusLast</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &gt; import qualified Data.Map.Strict as M</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- &gt; main = xmonad def</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- &gt;     { handleEventHook = refocusLastWhen myPred &lt;&gt; handleEventHook def</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- &gt;     , logHook         = refocusLastLogHook     &lt;&gt; logHook         def</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- &gt; --  , layoutHook      = refocusLastLayoutHook   $  layoutHook      def</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- &gt;     , keys            = refocusLastKeys        &lt;&gt; keys            def</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt;     } where</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt;         myPred = refocusingIsActive &lt;||&gt; isFloat</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt;         refocusLastKeys cnf</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt;           = M.fromList</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt;           $ ((modMask cnf              , xK_a), toggleFocus)</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt;           : ((modMask cnf .|. shiftMask, xK_a), swapWithLast)</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt;           : ((modMask cnf              , xK_b), toggleRefocusing)</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;           : [ ( (modMask cnf .|. shiftMask, n)</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;               , windows =&lt;&lt; shiftRLWhen myPred wksp</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt;               )</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &gt;             | (n, wksp) &lt;- zip [xK_1..xK_9] (workspaces cnf)</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt;             ]</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- --&lt; Types &gt;-- {{{</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- $Types</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- The types and constructors used in this module are exported principally to</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- aid extensibility; typical users will have nothing to gain from this section.</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Data type holding onto the previous and current @Window@.</span><span>
</span><span id="line-109"></span><span class="hs-keyword">data</span><span> </span><span id="RecentWins"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentWins"><span class="hs-identifier hs-var">RecentWins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Recent"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#Recent"><span class="hs-identifier hs-var">Recent</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="previous"><span class="annot"><span class="annottext">RecentWins -&gt; Window
</span><a href="XMonad.Hooks.RefocusLast.html#previous"><span class="hs-identifier hs-var hs-var">previous</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span id="current"><span class="annot"><span class="annottext">RecentWins -&gt; Window
</span><a href="XMonad.Hooks.RefocusLast.html#current"><span class="hs-identifier hs-var hs-var">current</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401802"><span id="local-6989586621679401804"><span id="local-6989586621679401811"><span class="annot"><span class="annottext">Int -&gt; RecentWins -&gt; ShowS
[RecentWins] -&gt; ShowS
RecentWins -&gt; WorkspaceId
(Int -&gt; RecentWins -&gt; ShowS)
-&gt; (RecentWins -&gt; WorkspaceId)
-&gt; ([RecentWins] -&gt; ShowS)
-&gt; Show RecentWins
forall a.
(Int -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceId) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RecentWins] -&gt; ShowS
$cshowList :: [RecentWins] -&gt; ShowS
show :: RecentWins -&gt; WorkspaceId
$cshow :: RecentWins -&gt; WorkspaceId
showsPrec :: Int -&gt; RecentWins -&gt; ShowS
$cshowsPrec :: Int -&gt; RecentWins -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401781"><span id="local-6989586621679401794"><span id="local-6989586621679401797"><span id="local-6989586621679401799"><span class="annot"><span class="annottext">ReadPrec [RecentWins]
ReadPrec RecentWins
Int -&gt; ReadS RecentWins
ReadS [RecentWins]
(Int -&gt; ReadS RecentWins)
-&gt; ReadS [RecentWins]
-&gt; ReadPrec RecentWins
-&gt; ReadPrec [RecentWins]
-&gt; Read RecentWins
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [RecentWins]
$creadListPrec :: ReadPrec [RecentWins]
readPrec :: ReadPrec RecentWins
$creadPrec :: ReadPrec RecentWins
readList :: ReadS [RecentWins]
$creadList :: ReadS [RecentWins]
readsPrec :: Int -&gt; ReadS RecentWins
$creadsPrec :: Int -&gt; ReadS RecentWins
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401773"><span id="local-6989586621679401777"><span class="annot"><span class="annottext">RecentWins -&gt; RecentWins -&gt; Bool
(RecentWins -&gt; RecentWins -&gt; Bool)
-&gt; (RecentWins -&gt; RecentWins -&gt; Bool) -&gt; Eq RecentWins
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RecentWins -&gt; RecentWins -&gt; Bool
$c/= :: RecentWins -&gt; RecentWins -&gt; Bool
== :: RecentWins -&gt; RecentWins -&gt; Bool
$c== :: RecentWins -&gt; RecentWins -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Newtype wrapper for a @Map@ holding the @RecentWins@ for each workspace.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--   Is an instance of @ExtensionClass@ with persistence of state.</span><span>
</span><span id="line-114"></span><span class="hs-keyword">newtype</span><span> </span><span id="RecentsMap"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier hs-var">RecentsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RecentsMap"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier hs-var">RecentsMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentWins"><span class="hs-identifier hs-type">RecentWins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401760"><span id="local-6989586621679401762"><span id="local-6989586621679401769"><span class="annot"><span class="annottext">Int -&gt; RecentsMap -&gt; ShowS
[RecentsMap] -&gt; ShowS
RecentsMap -&gt; WorkspaceId
(Int -&gt; RecentsMap -&gt; ShowS)
-&gt; (RecentsMap -&gt; WorkspaceId)
-&gt; ([RecentsMap] -&gt; ShowS)
-&gt; Show RecentsMap
forall a.
(Int -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceId) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RecentsMap] -&gt; ShowS
$cshowList :: [RecentsMap] -&gt; ShowS
show :: RecentsMap -&gt; WorkspaceId
$cshow :: RecentsMap -&gt; WorkspaceId
showsPrec :: Int -&gt; RecentsMap -&gt; ShowS
$cshowsPrec :: Int -&gt; RecentsMap -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401741"><span id="local-6989586621679401750"><span id="local-6989586621679401753"><span id="local-6989586621679401755"><span class="annot"><span class="annottext">ReadPrec [RecentsMap]
ReadPrec RecentsMap
Int -&gt; ReadS RecentsMap
ReadS [RecentsMap]
(Int -&gt; ReadS RecentsMap)
-&gt; ReadS [RecentsMap]
-&gt; ReadPrec RecentsMap
-&gt; ReadPrec [RecentsMap]
-&gt; Read RecentsMap
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [RecentsMap]
$creadListPrec :: ReadPrec [RecentsMap]
readPrec :: ReadPrec RecentsMap
$creadPrec :: ReadPrec RecentsMap
readList :: ReadS [RecentsMap]
$creadList :: ReadS [RecentsMap]
readsPrec :: Int -&gt; ReadS RecentsMap
$creadsPrec :: Int -&gt; ReadS RecentsMap
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401729"><span id="local-6989586621679401735"><span class="annot"><span class="annottext">RecentsMap -&gt; RecentsMap -&gt; Bool
(RecentsMap -&gt; RecentsMap -&gt; Bool)
-&gt; (RecentsMap -&gt; RecentsMap -&gt; Bool) -&gt; Eq RecentsMap
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RecentsMap -&gt; RecentsMap -&gt; Bool
$c/= :: RecentsMap -&gt; RecentsMap -&gt; Bool
== :: RecentsMap -&gt; RecentsMap -&gt; Bool
$c== :: RecentsMap -&gt; RecentsMap -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier hs-type">RecentsMap</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679401719"><span class="annot"><span class="annottext">initialValue :: RecentsMap
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins -&gt; RecentsMap
</span><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier hs-var">RecentsMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-119"></span><span>  </span><span id="local-6989586621679401713"><span class="annot"><span class="annottext">extensionType :: RecentsMap -&gt; StateExtension
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">extensionType</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecentsMap -&gt; StateExtension
forall a. (Read a, Show a, ExtensionClass a) =&gt; a -&gt; StateExtension
</span><span class="hs-identifier hs-var">PersistentExtension</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | A 'LayoutModifier' that updates the 'RecentWins' for a workspace upon</span><span>
</span><span id="line-122"></span><span class="hs-comment">--   relayout.</span><span>
</span><span id="line-123"></span><span class="hs-keyword">data</span><span> </span><span id="RefocusLastLayoutHook"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastLayoutHook"><span class="hs-identifier hs-var">RefocusLastLayoutHook</span></a></span></span><span> </span><span id="local-6989586621679402078"><span class="annot"><a href="#local-6989586621679402078"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RefocusLastLayoutHook"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastLayoutHook"><span class="hs-identifier hs-var">RefocusLastLayoutHook</span></a></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401704"><span id="local-6989586621679401706"><span id="local-6989586621679401708"><span class="annot"><span class="annottext">Int -&gt; RefocusLastLayoutHook a -&gt; ShowS
[RefocusLastLayoutHook a] -&gt; ShowS
RefocusLastLayoutHook a -&gt; WorkspaceId
(Int -&gt; RefocusLastLayoutHook a -&gt; ShowS)
-&gt; (RefocusLastLayoutHook a -&gt; WorkspaceId)
-&gt; ([RefocusLastLayoutHook a] -&gt; ShowS)
-&gt; Show (RefocusLastLayoutHook a)
forall a. Int -&gt; RefocusLastLayoutHook a -&gt; ShowS
forall a. [RefocusLastLayoutHook a] -&gt; ShowS
forall a. RefocusLastLayoutHook a -&gt; WorkspaceId
forall a.
(Int -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceId) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RefocusLastLayoutHook a] -&gt; ShowS
$cshowList :: forall a. [RefocusLastLayoutHook a] -&gt; ShowS
show :: RefocusLastLayoutHook a -&gt; WorkspaceId
$cshow :: forall a. RefocusLastLayoutHook a -&gt; WorkspaceId
showsPrec :: Int -&gt; RefocusLastLayoutHook a -&gt; ShowS
$cshowsPrec :: forall a. Int -&gt; RefocusLastLayoutHook a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401693"><span id="local-6989586621679401697"><span id="local-6989586621679401700"><span id="local-6989586621679401702"><span class="annot"><span class="annottext">ReadPrec [RefocusLastLayoutHook a]
ReadPrec (RefocusLastLayoutHook a)
Int -&gt; ReadS (RefocusLastLayoutHook a)
ReadS [RefocusLastLayoutHook a]
(Int -&gt; ReadS (RefocusLastLayoutHook a))
-&gt; ReadS [RefocusLastLayoutHook a]
-&gt; ReadPrec (RefocusLastLayoutHook a)
-&gt; ReadPrec [RefocusLastLayoutHook a]
-&gt; Read (RefocusLastLayoutHook a)
forall a. ReadPrec [RefocusLastLayoutHook a]
forall a. ReadPrec (RefocusLastLayoutHook a)
forall a. Int -&gt; ReadS (RefocusLastLayoutHook a)
forall a. ReadS [RefocusLastLayoutHook a]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [RefocusLastLayoutHook a]
$creadListPrec :: forall a. ReadPrec [RefocusLastLayoutHook a]
readPrec :: ReadPrec (RefocusLastLayoutHook a)
$creadPrec :: forall a. ReadPrec (RefocusLastLayoutHook a)
readList :: ReadS [RefocusLastLayoutHook a]
$creadList :: forall a. ReadS [RefocusLastLayoutHook a]
readsPrec :: Int -&gt; ReadS (RefocusLastLayoutHook a)
$creadsPrec :: forall a. Int -&gt; ReadS (RefocusLastLayoutHook a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679402068"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679401667"><span id="local-6989586621679401669"><span id="local-6989586621679401671"><span id="local-6989586621679401673"><span id="local-6989586621679401675"><span id="local-6989586621679401677"><span id="local-6989586621679401679"><span id="local-6989586621679401681"><span id="local-6989586621679401683"><span id="local-6989586621679401685"><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#LayoutModifier"><span class="hs-identifier hs-type">LayoutModifier</span></a></span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastLayoutHook"><span class="hs-identifier hs-type">RefocusLastLayoutHook</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402068"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679401662"><span class="annot"><span class="annottext">modifyLayout :: forall (l :: * -&gt; *).
LayoutClass l a =&gt;
RefocusLastLayoutHook a
-&gt; Workspace WorkspaceId (l a) a
-&gt; Rectangle
-&gt; X ([(a, Rectangle)], Maybe (l a))
</span><a href="XMonad.Layout.LayoutModifier.html#modifyLayout"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifyLayout</span></a></span></span><span> </span><span class="annot"><span class="annottext">RefocusLastLayoutHook a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401660"><span class="annot"><span class="annottext">w :: Workspace WorkspaceId (l a) a
</span><a href="#local-6989586621679401660"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Workspace</span></span><span> </span><span id="local-6989586621679401658"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401658"><span class="hs-identifier hs-var">tg</span></a></span></span><span> </span><span class="annot"><span class="annottext">l a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679401657"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679401657"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Hooks.RefocusLast.html#updateRecentsOn"><span class="hs-identifier hs-var">updateRecentsOn</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401658"><span class="hs-identifier hs-var">tg</span></a></span><span> </span><span class="annot"><span class="annottext">X ()
-&gt; X ([(a, Rectangle)], Maybe (l a))
-&gt; X ([(a, Rectangle)], Maybe (l a))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (l a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (l a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace WorkspaceId (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (l a) a
</span><a href="#local-6989586621679401660"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679401657"><span class="hs-identifier hs-var">r</span></a></span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | A newtype on @Bool@ to act as a universal toggle for refocusing.</span><span>
</span><span id="line-130"></span><span class="hs-keyword">newtype</span><span> </span><span id="RefocusLastToggle"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastToggle"><span class="hs-identifier hs-var">RefocusLastToggle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RefocusLastToggle"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastToggle"><span class="hs-identifier hs-var">RefocusLastToggle</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="refocusing"><span class="annot"><span class="annottext">RefocusLastToggle -&gt; Bool
</span><a href="XMonad.Hooks.RefocusLast.html#refocusing"><span class="hs-identifier hs-var hs-var">refocusing</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679401645"><span id="local-6989586621679401647"><span id="local-6989586621679401652"><span class="annot"><span class="annottext">Int -&gt; RefocusLastToggle -&gt; ShowS
[RefocusLastToggle] -&gt; ShowS
RefocusLastToggle -&gt; WorkspaceId
(Int -&gt; RefocusLastToggle -&gt; ShowS)
-&gt; (RefocusLastToggle -&gt; WorkspaceId)
-&gt; ([RefocusLastToggle] -&gt; ShowS)
-&gt; Show RefocusLastToggle
forall a.
(Int -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceId) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RefocusLastToggle] -&gt; ShowS
$cshowList :: [RefocusLastToggle] -&gt; ShowS
show :: RefocusLastToggle -&gt; WorkspaceId
$cshow :: RefocusLastToggle -&gt; WorkspaceId
showsPrec :: Int -&gt; RefocusLastToggle -&gt; ShowS
$cshowsPrec :: Int -&gt; RefocusLastToggle -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401629"><span id="local-6989586621679401638"><span id="local-6989586621679401641"><span id="local-6989586621679401643"><span class="annot"><span class="annottext">ReadPrec [RefocusLastToggle]
ReadPrec RefocusLastToggle
Int -&gt; ReadS RefocusLastToggle
ReadS [RefocusLastToggle]
(Int -&gt; ReadS RefocusLastToggle)
-&gt; ReadS [RefocusLastToggle]
-&gt; ReadPrec RefocusLastToggle
-&gt; ReadPrec [RefocusLastToggle]
-&gt; Read RefocusLastToggle
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [RefocusLastToggle]
$creadListPrec :: ReadPrec [RefocusLastToggle]
readPrec :: ReadPrec RefocusLastToggle
$creadPrec :: ReadPrec RefocusLastToggle
readList :: ReadS [RefocusLastToggle]
$creadList :: ReadS [RefocusLastToggle]
readsPrec :: Int -&gt; ReadS RefocusLastToggle
$creadsPrec :: Int -&gt; ReadS RefocusLastToggle
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679401621"><span id="local-6989586621679401626"><span class="annot"><span class="annottext">RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool
(RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool)
-&gt; (RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool)
-&gt; Eq RefocusLastToggle
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool
$c/= :: RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool
== :: RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool
$c== :: RefocusLastToggle -&gt; RefocusLastToggle -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastToggle"><span class="hs-identifier hs-type">RefocusLastToggle</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679401613"><span class="annot"><span class="annottext">initialValue :: RefocusLastToggle
</span><a href="#local-6989586621679401613"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RefocusLastToggle :: Bool -&gt; RefocusLastToggle
</span><a href="XMonad.Hooks.RefocusLast.html#RefocusLastToggle"><span class="hs-identifier hs-type">RefocusLastToggle</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">refocusing :: Bool
</span><a href="XMonad.Hooks.RefocusLast.html#refocusing"><span class="hs-identifier hs-var">refocusing</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>  </span><span id="local-6989586621679401609"><span class="annot"><span class="annottext">extensionType :: RefocusLastToggle -&gt; StateExtension
</span><a href="#local-6989586621679401609"><span class="hs-identifier hs-var hs-var hs-var hs-var">extensionType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RefocusLastToggle -&gt; StateExtension
forall a. (Read a, Show a, ExtensionClass a) =&gt; a -&gt; StateExtension
</span><span class="hs-identifier hs-var">PersistentExtension</span></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- --&lt; Public Hooks &gt;-- {{{</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | A log hook recording the current workspace's most recently focused windows</span><span>
</span><span id="line-142"></span><span class="hs-comment">--   into extensible state.</span><span>
</span><span id="line-143"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusLastLogHook"><span class="hs-identifier hs-type">refocusLastLogHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span id="refocusLastLogHook"><span class="annot"><span class="annottext">refocusLastLogHook :: X ()
</span><a href="XMonad.Hooks.RefocusLast.html#refocusLastLogHook"><span class="hs-identifier hs-var hs-var">refocusLastLogHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Hooks.RefocusLast.html#updateRecentsOn"><span class="hs-identifier hs-var">updateRecentsOn</span></a></span><span> </span><span class="annot"><span class="annottext">(WorkspaceId -&gt; X ())
-&gt; (WindowSet -&gt; WorkspaceId) -&gt; WindowSet -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; WorkspaceId
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Records a workspace's recently focused windows into extensible state upon</span><span>
</span><span id="line-147"></span><span class="hs-comment">--   relayout. Potentially a less wasteful alternative to @refocusLastLogHook@,</span><span>
</span><span id="line-148"></span><span class="hs-comment">--   as it does not run on @WM_NAME@ @propertyNotify@ events.</span><span>
</span><span id="line-149"></span><span id="local-6989586621679402049"><span id="local-6989586621679402050"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusLastLayoutHook"><span class="hs-identifier hs-type">refocusLastLayoutHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679402050"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-type">ModifiedLayout</span></a></span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RefocusLastLayoutHook"><span class="hs-identifier hs-type">RefocusLastLayoutHook</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402050"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679402049"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-150"></span><span id="refocusLastLayoutHook"><span class="annot"><span class="annottext">refocusLastLayoutHook :: forall (l :: * -&gt; *) a.
l a -&gt; ModifiedLayout RefocusLastLayoutHook l a
</span><a href="XMonad.Hooks.RefocusLast.html#refocusLastLayoutHook"><span class="hs-identifier hs-var hs-var">refocusLastLayoutHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RefocusLastLayoutHook a
-&gt; l a -&gt; ModifiedLayout RefocusLastLayoutHook l a
forall (m :: * -&gt; *) (l :: * -&gt; *) a.
m a -&gt; l a -&gt; ModifiedLayout m l a
</span><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-var">ModifiedLayout</span></a></span><span> </span><span class="annot"><span class="annottext">RefocusLastLayoutHook a
forall a. RefocusLastLayoutHook a
</span><a href="XMonad.Hooks.RefocusLast.html#RefocusLastLayoutHook"><span class="hs-identifier hs-var">RefocusLastLayoutHook</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-comment">-- | Given a predicate on the event window determining whether or not to act,</span><span>
</span><span id="line-153"></span><span class="hs-comment">--   construct an event hook that runs iff the core xmonad event handler will</span><span>
</span><span id="line-154"></span><span class="hs-comment">--   unmanage the window, and which shifts focus to the last focused window on</span><span>
</span><span id="line-155"></span><span class="hs-comment">--   the appropriate workspace if desired.</span><span>
</span><span id="line-156"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusLastWhen"><span class="hs-identifier hs-type">refocusLastWhen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span>
</span><span id="line-157"></span><span id="refocusLastWhen"><span class="annot"><span class="annottext">refocusLastWhen :: Query Bool -&gt; Event -&gt; X All
</span><a href="XMonad.Hooks.RefocusLast.html#refocusLastWhen"><span class="hs-identifier hs-var hs-var">refocusLastWhen</span></a></span></span><span> </span><span id="local-6989586621679401604"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679401604"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679401603"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679401603"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">All -&gt; X () -&gt; X All
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679401603"><span class="hs-identifier hs-var">event</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UnmapEvent</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ev_send_event :: Event -&gt; Bool
</span><span class="hs-identifier hs-var">ev_send_event</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679401598"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679401598"><span class="hs-identifier hs-var">synth</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_window :: Event -&gt; Window
</span><span class="hs-identifier hs-var">ev_window</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679401596"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401596"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679401595"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679401595"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Int) -&gt; X Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; (XState -&gt; Maybe Int) -&gt; XState -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Map Window Int -&gt; Maybe Int
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401596"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Window Int -&gt; Maybe Int)
-&gt; (XState -&gt; Map Window Int) -&gt; XState -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; Map Window Int
</span><span class="hs-identifier hs-var hs-var">waitingUnmap</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679401598"><span class="hs-identifier hs-var">synth</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679401595"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679401590"><span class="hs-identifier hs-var">refocusLast</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401596"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">DestroyWindowEvent</span></span><span> </span><span class="hs-special">{</span><span>                </span><span class="annot"><span class="annottext">ev_window :: Event -&gt; Window
</span><span class="hs-identifier hs-var">ev_window</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679401588"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401588"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679401590"><span class="hs-identifier hs-var">refocusLast</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401588"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span>                                                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>    </span><span id="local-6989586621679401590"><span class="annot"><span class="annottext">refocusLast :: Window -&gt; X ()
</span><a href="#local-6989586621679401590"><span class="hs-identifier hs-var hs-var">refocusLast</span></a></span></span><span> </span><span id="local-6989586621679401582"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401582"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query Bool -&gt; Window -&gt; X Bool
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679401604"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401582"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ())
-&gt; ((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401579"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401579"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">Maybe WorkspaceId -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; WindowSet -&gt; Maybe WorkspaceId
forall a i l s sd. Eq a =&gt; a -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">W.findTag</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401582"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401579"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((WorkspaceId -&gt; X ()) -&gt; X ()) -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401576"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401576"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="annottext">WorkspaceId -&gt; () -&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a. WorkspaceId -&gt; a -&gt; (Window -&gt; Window -&gt; X a) -&gt; X a
</span><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-var">withRecentsIn</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401576"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; Window -&gt; X ()) -&gt; X ())
-&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401575"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401575"><span class="hs-identifier hs-var">lw</span></a></span></span><span> </span><span id="local-6989586621679401574"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401574"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401582"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401574"><span class="hs-identifier hs-var">cw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ())
-&gt; ((XState -&gt; XState) -&gt; X ()) -&gt; (XState -&gt; XState) -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(XState -&gt; XState) -&gt; X ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XState -&gt; XState) -&gt; X ()) -&gt; (XState -&gt; XState) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401572"><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679401572"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>            </span><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679401572"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">windowset :: WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [Window] -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Hooks.RefocusLast.html#tryFocusIn"><span class="hs-identifier hs-var">tryFocusIn</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401576"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401575"><span class="hs-identifier hs-var">lw</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401579"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-comment">-- --&lt; Predicates &gt;-- {{{</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- $Predicates</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- Impure @Query Bool@ predicates on event windows for use as arguments to</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- 'refocusLastWhen', 'shiftRLWhen' and 'refocusWhen'. Can be combined with</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- '&lt;||&gt;' or '&lt;&amp;&amp;&gt;'. Use like e.g.</span><span>
</span><span id="line-178"></span><span class="hs-comment">--</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- &gt; , handleEventHook = refocusLastWhen refocusingIsActive</span><span>
</span><span id="line-180"></span><span class="hs-comment">--</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- or in a keybinding:</span><span>
</span><span id="line-182"></span><span class="hs-comment">--</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt; windows =&lt;&lt; shiftRLWhen (refocusingIsActive &lt;&amp;&amp;&gt; isFloat) &quot;3&quot;</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- It's also valid to use a property lookup like @className =? &quot;someProgram&quot;@ as</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- a predicate, and it should function as expected with e.g. @shiftRLWhen@.</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- In the event hook on the other hand, the window in question has already been</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- unmapped or destroyed, so external lookups to X properties don't work:</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- only the information fossilised in xmonad's state is available.</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Holds iff refocusing is toggled active.</span><span>
</span><span id="line-192"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusingIsActive"><span class="hs-identifier hs-type">refocusingIsActive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-193"></span><span id="refocusingIsActive"><span class="annot"><span class="annottext">refocusingIsActive :: Query Bool
</span><a href="XMonad.Hooks.RefocusLast.html#refocusingIsActive"><span class="hs-identifier hs-var hs-var">refocusingIsActive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Bool -&gt; Query Bool
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X Bool -&gt; Query Bool)
-&gt; ((RefocusLastToggle -&gt; Bool) -&gt; X Bool)
-&gt; (RefocusLastToggle -&gt; Bool)
-&gt; Query Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(RefocusLastToggle -&gt; Bool) -&gt; X Bool
forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RefocusLastToggle -&gt; Bool
</span><a href="XMonad.Hooks.RefocusLast.html#refocusing"><span class="hs-identifier hs-var hs-var">refocusing</span></a></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | Holds iff the event window is a float.</span><span>
</span><span id="line-196"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#isFloat"><span class="hs-identifier hs-type">isFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-197"></span><span id="isFloat"><span class="annot"><span class="annottext">isFloat :: Query Bool
</span><a href="XMonad.Hooks.RefocusLast.html#isFloat"><span class="hs-identifier hs-var hs-var">isFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window -&gt; (Window -&gt; Query Bool) -&gt; Query Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401566"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401566"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Bool -&gt; Query Bool
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X Bool -&gt; Query Bool)
-&gt; ((XState -&gt; Bool) -&gt; X Bool) -&gt; (XState -&gt; Bool) -&gt; Query Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Bool) -&gt; X Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; Map Window RationalRect -&gt; Bool
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Bool
</span><span class="hs-identifier hs-var">M.member</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401566"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Window RationalRect -&gt; Bool)
-&gt; (XState -&gt; Map Window RationalRect) -&gt; XState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; Map Window RationalRect
forall i l a sid sd. StackSet i l a sid sd -&gt; Map a RationalRect
</span><span class="hs-identifier hs-var hs-var">W.floating</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; Map Window RationalRect)
-&gt; (XState -&gt; WindowSet) -&gt; XState -&gt; Map Window RationalRect
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- --&lt; Public Actions &gt;-- {{{</span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Toggle automatic refocusing at runtime. Has no effect unless the</span><span>
</span><span id="line-204"></span><span class="hs-comment">--   @refocusingIsActive@ predicate has been used.</span><span>
</span><span id="line-205"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#toggleRefocusing"><span class="hs-identifier hs-type">toggleRefocusing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span id="toggleRefocusing"><span class="annot"><span class="annottext">toggleRefocusing :: X ()
</span><a href="XMonad.Hooks.RefocusLast.html#toggleRefocusing"><span class="hs-identifier hs-var hs-var">toggleRefocusing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RefocusLastToggle -&gt; RefocusLastToggle) -&gt; X ()
forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; RefocusLastToggle
</span><a href="XMonad.Hooks.RefocusLast.html#RefocusLastToggle"><span class="hs-identifier hs-var">RefocusLastToggle</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; RefocusLastToggle)
-&gt; (RefocusLastToggle -&gt; Bool)
-&gt; RefocusLastToggle
-&gt; RefocusLastToggle
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; (RefocusLastToggle -&gt; Bool) -&gt; RefocusLastToggle -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RefocusLastToggle -&gt; Bool
</span><a href="XMonad.Hooks.RefocusLast.html#refocusing"><span class="hs-identifier hs-var hs-var">refocusing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Refocuses the previously focused window; acts as a toggle.</span><span>
</span><span id="line-209"></span><span class="hs-comment">--   Is not affected by @toggleRefocusing@.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#toggleFocus"><span class="hs-identifier hs-type">toggleFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span id="toggleFocus"><span class="annot"><span class="annottext">toggleFocus :: X ()
</span><a href="XMonad.Hooks.RefocusLast.html#toggleFocus"><span class="hs-identifier hs-var hs-var">toggleFocus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Hooks.RefocusLast.html#withRecents"><span class="hs-identifier hs-var">withRecents</span></a></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; Window -&gt; X ()) -&gt; X ())
-&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401560"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401560"><span class="hs-identifier hs-var">lw</span></a></span></span><span> </span><span id="local-6989586621679401559"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401559"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401559"><span class="hs-identifier hs-var">cw</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401560"><span class="hs-identifier hs-var">lw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ())
-&gt; ((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (WindowSet -&gt; WindowSet)
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (WindowSet -&gt; WindowSet) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Hooks.RefocusLast.html#tryFocus"><span class="hs-identifier hs-var">tryFocus</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401560"><span class="hs-identifier hs-var">lw</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Swaps the current and previous windows of the current workspace.</span><span>
</span><span id="line-215"></span><span class="hs-comment">--   Is not affected by @toggleRefocusing@.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#swapWithLast"><span class="hs-identifier hs-type">swapWithLast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="swapWithLast"><span class="annot"><span class="annottext">swapWithLast :: X ()
</span><a href="XMonad.Hooks.RefocusLast.html#swapWithLast"><span class="hs-identifier hs-var hs-var">swapWithLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Hooks.RefocusLast.html#withRecents"><span class="hs-identifier hs-var">withRecents</span></a></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; Window -&gt; X ()) -&gt; X ())
-&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401555"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">lw</span></a></span></span><span> </span><span id="local-6989586621679401554"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401554"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401554"><span class="hs-identifier hs-var">cw</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">lw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ())
-&gt; ((Window -&gt; Window) -&gt; X ()) -&gt; (Window -&gt; Window) -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; ((Window -&gt; Window) -&gt; WindowSet -&gt; WindowSet)
-&gt; (Window -&gt; Window)
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack Window) -&gt; Maybe (Stack Window))
-&gt; WindowSet -&gt; WindowSet
forall {a} {i} {l} {s} {sd}.
(Maybe (Stack a) -&gt; Maybe (Stack a))
-&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><a href="#local-6989586621679401553"><span class="hs-identifier hs-var">modify''</span></a></span><span class="annot"><span class="annottext">((Maybe (Stack Window) -&gt; Maybe (Stack Window))
 -&gt; WindowSet -&gt; WindowSet)
-&gt; ((Window -&gt; Window)
    -&gt; Maybe (Stack Window) -&gt; Maybe (Stack Window))
-&gt; (Window -&gt; Window)
-&gt; WindowSet
-&gt; WindowSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window) -&gt; Maybe (Stack Window) -&gt; Maybe (Stack Window)
forall a b. (a -&gt; b) -&gt; Zipper a -&gt; Zipper b
</span><a href="XMonad.Util.Stack.html#mapZ_"><span class="hs-identifier hs-var">mapZ_</span></a></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; Window) -&gt; X ()) -&gt; (Window -&gt; Window) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401552"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401552"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401552"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">lw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401554"><span class="hs-identifier hs-var">cw</span></a></span><span>
</span><span id="line-220"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401552"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401554"><span class="hs-identifier hs-var">cw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401555"><span class="hs-identifier hs-var">lw</span></a></span><span>
</span><span id="line-221"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401552"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679401553"><span class="annot"><span class="annottext">modify'' :: (Maybe (Stack a) -&gt; Maybe (Stack a))
-&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><a href="#local-6989586621679401553"><span class="hs-identifier hs-var hs-var">modify''</span></a></span></span><span> </span><span id="local-6989586621679401551"><span class="annot"><span class="annottext">Maybe (Stack a) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679401551"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
-&gt; (Stack a -&gt; Maybe (Stack a))
-&gt; StackSet i l a s sd
-&gt; StackSet i l a s sd
forall a i l s sd.
Maybe (Stack a)
-&gt; (Stack a -&gt; Maybe (Stack a))
-&gt; StackSet i l a s sd
-&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack a) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679401551"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack a) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679401551"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack a) -&gt; Maybe (Stack a))
-&gt; (Stack a -&gt; Maybe (Stack a)) -&gt; Stack a -&gt; Maybe (Stack a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Given a target workspace and a predicate on its current window, produce a</span><span>
</span><span id="line-225"></span><span class="hs-comment">--   'windows' suitable function that will refocus that workspace appropriately.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--   Allows you to hook refocusing into any action you can run through</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   @windows@. See the implementation of @shiftRLWhen@ for a straight-forward</span><span>
</span><span id="line-228"></span><span class="hs-comment">--   usage example.</span><span>
</span><span id="line-229"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#refocusWhen"><span class="hs-identifier hs-type">refocusWhen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span id="refocusWhen"><span class="annot"><span class="annottext">refocusWhen :: Query Bool -&gt; WorkspaceId -&gt; X (WindowSet -&gt; WindowSet)
</span><a href="XMonad.Hooks.RefocusLast.html#refocusWhen"><span class="hs-identifier hs-var hs-var">refocusWhen</span></a></span></span><span> </span><span id="local-6989586621679401549"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679401549"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679401548"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401548"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
-&gt; (WindowSet -&gt; WindowSet)
-&gt; (Window -&gt; Window -&gt; X (WindowSet -&gt; WindowSet))
-&gt; X (WindowSet -&gt; WindowSet)
forall a. WorkspaceId -&gt; a -&gt; (Window -&gt; Window -&gt; X a) -&gt; X a
</span><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-var">withRecentsIn</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401548"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; Window -&gt; X (WindowSet -&gt; WindowSet))
 -&gt; X (WindowSet -&gt; WindowSet))
-&gt; (Window -&gt; Window -&gt; X (WindowSet -&gt; WindowSet))
-&gt; X (WindowSet -&gt; WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401546"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401546"><span class="hs-identifier hs-var">lw</span></a></span></span><span> </span><span id="local-6989586621679401545"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401545"><span class="hs-identifier hs-var">cw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679401544"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679401544"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query Bool -&gt; Window -&gt; X Bool
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679401549"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401545"><span class="hs-identifier hs-var">cw</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X (WindowSet -&gt; WindowSet)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679401544"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [Window] -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Hooks.RefocusLast.html#tryFocusIn"><span class="hs-identifier hs-var">tryFocusIn</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401548"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401545"><span class="hs-identifier hs-var">cw</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401546"><span class="hs-identifier hs-var">lw</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Sends the focused window to the specified workspace, refocusing the last</span><span>
</span><span id="line-235"></span><span class="hs-comment">--   focused window if the predicate holds on the current window. Note that the</span><span>
</span><span id="line-236"></span><span class="hs-comment">--   native version of this, @windows . W.shift@, has a nice property that this</span><span>
</span><span id="line-237"></span><span class="hs-comment">--   does not: shifting a window to another workspace then shifting it back</span><span>
</span><span id="line-238"></span><span class="hs-comment">--   preserves its place in the stack. Can be used in a keybinding like e.g.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- &gt; windows =&lt;&lt; shiftRLWhen refocusingIsActive &quot;3&quot;</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">--   or</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- &gt; (windows &lt;=&lt; shiftRLWhen refocusingIsActive) &quot;3&quot;</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">--   where '&lt;=&lt;' is imported from &quot;Control.Monad&quot;.</span><span>
</span><span id="line-247"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#shiftRLWhen"><span class="hs-identifier hs-type">shiftRLWhen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span id="shiftRLWhen"><span class="annot"><span class="annottext">shiftRLWhen :: Query Bool -&gt; WorkspaceId -&gt; X (WindowSet -&gt; WindowSet)
</span><a href="XMonad.Hooks.RefocusLast.html#shiftRLWhen"><span class="hs-identifier hs-var hs-var">shiftRLWhen</span></a></span></span><span> </span><span id="local-6989586621679401543"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679401543"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679401542"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401542"><span class="hs-identifier hs-var">to</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X (WindowSet -&gt; WindowSet))
-&gt; X (WindowSet -&gt; WindowSet)
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X (WindowSet -&gt; WindowSet))
 -&gt; X (WindowSet -&gt; WindowSet))
-&gt; (WindowSet -&gt; X (WindowSet -&gt; WindowSet))
-&gt; X (WindowSet -&gt; WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401541"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401541"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679401540"><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679401540"><span class="hs-identifier hs-var">refocus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query Bool -&gt; WorkspaceId -&gt; X (WindowSet -&gt; WindowSet)
</span><a href="XMonad.Hooks.RefocusLast.html#refocusWhen"><span class="hs-identifier hs-var">refocusWhen</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679401543"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; WorkspaceId
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401541"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679401535"><span class="annot"><span class="annottext">shift :: StackSet WorkspaceId l Window ScreenId sd
-&gt; StackSet WorkspaceId l Window ScreenId sd
</span><a href="#local-6989586621679401535"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId l Window ScreenId sd
 -&gt; StackSet WorkspaceId l Window ScreenId sd)
-&gt; (Window
    -&gt; StackSet WorkspaceId l Window ScreenId sd
    -&gt; StackSet WorkspaceId l Window ScreenId sd)
-&gt; Maybe Window
-&gt; StackSet WorkspaceId l Window ScreenId sd
-&gt; StackSet WorkspaceId l Window ScreenId sd
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceId l Window ScreenId sd
-&gt; StackSet WorkspaceId l Window ScreenId sd
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
-&gt; Window
-&gt; StackSet WorkspaceId l Window ScreenId sd
-&gt; StackSet WorkspaceId l Window ScreenId sd
forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401542"><span class="hs-identifier hs-var">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; Maybe Window
forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">W.peek</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401541"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X (WindowSet -&gt; WindowSet)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679401540"><span class="hs-identifier hs-var">refocus</span></a></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; (WindowSet -&gt; WindowSet) -&gt; WindowSet -&gt; WindowSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
forall {l} {sd}.
StackSet WorkspaceId l Window ScreenId sd
-&gt; StackSet WorkspaceId l Window ScreenId sd
</span><a href="#local-6989586621679401535"><span class="hs-identifier hs-var">shift</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Perform an update to the 'RecentWins' for the specified workspace.</span><span>
</span><span id="line-254"></span><span class="hs-comment">--   The RefocusLast log and layout hooks are both implemented trivially in</span><span>
</span><span id="line-255"></span><span class="hs-comment">--   terms of this function. Only exported to aid extensibility.</span><span>
</span><span id="line-256"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#updateRecentsOn"><span class="hs-identifier hs-type">updateRecentsOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span id="updateRecentsOn"><span class="annot"><span class="annottext">updateRecentsOn :: WorkspaceId -&gt; X ()
</span><a href="XMonad.Hooks.RefocusLast.html#updateRecentsOn"><span class="hs-identifier hs-var hs-var">updateRecentsOn</span></a></span></span><span> </span><span id="local-6989586621679401531"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401531"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401530"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401530"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="annottext">Maybe Window -&gt; (Window -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; Maybe Window
forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">W.peek</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; Maybe Window) -&gt; WindowSet -&gt; Maybe Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401531"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401530"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; X ()) -&gt; X ()) -&gt; (Window -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401528"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401528"><span class="hs-identifier hs-var">fw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-259"></span><span>    </span><span id="local-6989586621679401527"><span class="annot"><span class="annottext">Map WorkspaceId RecentWins
</span><a href="#local-6989586621679401527"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (Map WorkspaceId RecentWins)
</span><a href="XMonad.Hooks.RefocusLast.html#getRecentsMap"><span class="hs-identifier hs-var">getRecentsMap</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679401520"><span class="annot"><span class="annottext">insertRecent :: Window -&gt; Window -&gt; m ()
</span><a href="#local-6989586621679401520"><span class="hs-identifier hs-var hs-var">insertRecent</span></a></span></span><span> </span><span id="local-6989586621679401519"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401519"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679401518"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401518"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RecentsMap -&gt; m ()
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">(RecentsMap -&gt; m ())
-&gt; (Map WorkspaceId RecentWins -&gt; RecentsMap)
-&gt; Map WorkspaceId RecentWins
-&gt; m ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins -&gt; RecentsMap
</span><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier hs-var">RecentsMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map WorkspaceId RecentWins -&gt; m ())
-&gt; Map WorkspaceId RecentWins -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
-&gt; RecentWins
-&gt; Map WorkspaceId RecentWins
-&gt; Map WorkspaceId RecentWins
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401531"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; RecentWins
</span><a href="XMonad.Hooks.RefocusLast.html#Recent"><span class="hs-identifier hs-var">Recent</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401519"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401518"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins
</span><a href="#local-6989586621679401527"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; Map WorkspaceId RecentWins -&gt; Maybe RecentWins
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401531"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins
</span><a href="#local-6989586621679401527"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#Recent"><span class="hs-identifier hs-type">Recent</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679401515"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401515"><span class="hs-identifier hs-var">cw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401515"><span class="hs-identifier hs-var">cw</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401528"><span class="hs-identifier hs-var">fw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X ()
forall {m :: * -&gt; *}. XLike m =&gt; Window -&gt; Window -&gt; m ()
</span><a href="#local-6989586621679401520"><span class="hs-identifier hs-var">insertRecent</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401515"><span class="hs-identifier hs-var">cw</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401528"><span class="hs-identifier hs-var">fw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">Maybe RecentWins
</span><span class="hs-identifier hs-var">Nothing</span></span><span>            </span><span class="hs-glyph">-&gt;</span><span>                  </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X ()
forall {m :: * -&gt; *}. XLike m =&gt; Window -&gt; Window -&gt; m ()
</span><a href="#local-6989586621679401520"><span class="hs-identifier hs-var">insertRecent</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401528"><span class="hs-identifier hs-var">fw</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401528"><span class="hs-identifier hs-var">fw</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span class="hs-comment">-- --&lt; Utilities &gt;-- {{{</span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Focuses the first window in the list it can find on the current workspace.</span><span>
</span><span id="line-270"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#tryFocus"><span class="hs-identifier hs-type">tryFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-271"></span><span id="tryFocus"><span class="annot"><span class="annottext">tryFocus :: [Window] -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Hooks.RefocusLast.html#tryFocus"><span class="hs-identifier hs-var hs-var">tryFocus</span></a></span></span><span> </span><span id="local-6989586621679401514"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679401514"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet)
-&gt; (Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401512"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679401512"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">Stack Window -&gt; Maybe (Stack Window) -&gt; Stack Window
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679401512"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack Window) -&gt; Stack Window)
-&gt; ([Maybe (Stack Window)] -&gt; Maybe (Stack Window))
-&gt; [Maybe (Stack Window)]
-&gt; Stack Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Maybe (Stack Window)] -&gt; Maybe (Stack Window)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable t, Alternative f) =&gt;
t (f a) -&gt; f a
</span><span class="hs-identifier hs-var">asum</span></span><span> </span><span class="annot"><span class="annottext">([Maybe (Stack Window)] -&gt; Stack Window)
-&gt; [Maybe (Stack Window)] -&gt; Stack Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679401511"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401511"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Bool) -&gt; Stack Window -&gt; Maybe (Stack Window)
forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><a href="XMonad.Util.Stack.html#findS"><span class="hs-identifier hs-var">findS</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401511"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679401512"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Maybe (Stack Window))
-&gt; [Window] -&gt; [Maybe (Stack Window)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679401514"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | Operate the above on a specified workspace.</span><span>
</span><span id="line-275"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#tryFocusIn"><span class="hs-identifier hs-type">tryFocusIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-276"></span><span id="tryFocusIn"><span class="annot"><span class="annottext">tryFocusIn :: WorkspaceId -&gt; [Window] -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Hooks.RefocusLast.html#tryFocusIn"><span class="hs-identifier hs-var hs-var">tryFocusIn</span></a></span></span><span> </span><span id="local-6989586621679401509"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401509"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679401508"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679401508"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span id="local-6989586621679401507"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401507"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; WorkspaceId
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401507"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; (WindowSet -&gt; WindowSet) -&gt; WindowSet -&gt; WindowSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Hooks.RefocusLast.html#tryFocus"><span class="hs-identifier hs-var">tryFocus</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679401508"><span class="hs-identifier hs-var">wins</span></a></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; (WindowSet -&gt; WindowSet) -&gt; WindowSet -&gt; WindowSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401509"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; WindowSet -&gt; WindowSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401507"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Get the RecentsMap out of extensible state and remove its newtype wrapper.</span><span>
</span><span id="line-280"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#getRecentsMap"><span class="hs-identifier hs-type">getRecentsMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentWins"><span class="hs-identifier hs-type">RecentWins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span id="getRecentsMap"><span class="annot"><span class="annottext">getRecentsMap :: X (Map WorkspaceId RecentWins)
</span><a href="XMonad.Hooks.RefocusLast.html#getRecentsMap"><span class="hs-identifier hs-var hs-var">getRecentsMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X RecentsMap
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span> </span><span class="annot"><span class="annottext">X RecentsMap
-&gt; (RecentsMap -&gt; X (Map WorkspaceId RecentWins))
-&gt; X (Map WorkspaceId RecentWins)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#RecentsMap"><span class="hs-identifier hs-type">RecentsMap</span></a></span><span> </span><span id="local-6989586621679401505"><span class="annot"><span class="annottext">Map WorkspaceId RecentWins
</span><a href="#local-6989586621679401505"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins -&gt; X (Map WorkspaceId RecentWins)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId RecentWins
</span><a href="#local-6989586621679401505"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Perform an X action dependent on successful lookup of the RecentWins for</span><span>
</span><span id="line-284"></span><span class="hs-comment">--   the specified workspace, or return a default value.</span><span>
</span><span id="line-285"></span><span id="local-6989586621679402018"><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-type">withRecentsIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679402018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679402018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679402018"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-286"></span><span id="withRecentsIn"><span class="annot"><span class="annottext">withRecentsIn :: forall a. WorkspaceId -&gt; a -&gt; (Window -&gt; Window -&gt; X a) -&gt; X a
</span><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-var hs-var">withRecentsIn</span></a></span></span><span> </span><span id="local-6989586621679401501"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401501"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span id="local-6989586621679401500"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401500"><span class="hs-identifier hs-var">dflt</span></a></span></span><span> </span><span id="local-6989586621679401499"><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X a
</span><a href="#local-6989586621679401499"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X a -&gt; (RecentWins -&gt; X a) -&gt; Maybe RecentWins -&gt; X a
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; X a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679401500"><span class="hs-identifier hs-var">dflt</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#Recent"><span class="hs-identifier hs-type">Recent</span></a></span><span> </span><span id="local-6989586621679401498"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401498"><span class="hs-identifier hs-var">lw</span></a></span></span><span> </span><span id="local-6989586621679401497"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401497"><span class="hs-identifier hs-var">cw</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X a
</span><a href="#local-6989586621679401499"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401498"><span class="hs-identifier hs-var">lw</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679401497"><span class="hs-identifier hs-var">cw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>                         </span><span class="annot"><span class="annottext">(Maybe RecentWins -&gt; X a)
-&gt; (Map WorkspaceId RecentWins -&gt; Maybe RecentWins)
-&gt; Map WorkspaceId RecentWins
-&gt; X a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; Map WorkspaceId RecentWins -&gt; Maybe RecentWins
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679401501"><span class="hs-identifier hs-var">tag</span></a></span><span>
</span><span id="line-288"></span><span>                       </span><span class="annot"><span class="annottext">(Map WorkspaceId RecentWins -&gt; X a)
-&gt; X (Map WorkspaceId RecentWins) -&gt; X a
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X (Map WorkspaceId RecentWins)
</span><a href="XMonad.Hooks.RefocusLast.html#getRecentsMap"><span class="hs-identifier hs-var">getRecentsMap</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | The above specialised to the current workspace and unit.</span><span>
</span><span id="line-291"></span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#withRecents"><span class="hs-identifier hs-type">withRecents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="withRecents"><span class="annot"><span class="annottext">withRecents :: (Window -&gt; Window -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Hooks.RefocusLast.html#withRecents"><span class="hs-identifier hs-var hs-var">withRecents</span></a></span></span><span> </span><span id="local-6989586621679401495"><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X ()
</span><a href="#local-6989586621679401495"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679401494"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401494"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; () -&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a. WorkspaceId -&gt; a -&gt; (Window -&gt; Window -&gt; X a) -&gt; X a
</span><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-var">withRecentsIn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; WorkspaceId
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679401494"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X ()
</span><a href="#local-6989586621679401495"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-295"></span></pre></body></html>