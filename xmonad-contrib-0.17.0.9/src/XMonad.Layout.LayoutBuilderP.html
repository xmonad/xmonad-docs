<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts, FlexibleInstances, MultiParamTypeClasses, UndecidableInstances, PatternGuards, ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  XMonad.Layout.LayoutBuilderP</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Description :  (DEPRECATED) An old version of &quot;XMonad.Layout.LayoutBuilderP&quot;.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (c) 2009 Anders Engstrom &lt;ankaan@gmail.com&gt;, 2011 Ilya Portnov &lt;portnov84@rambler.ru&gt;</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  Ilya Portnov &lt;portnov84@rambler.ru&gt;</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- DEPRECATED.  Use 'XMonad.Layout.LayoutBuilder' instead.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Layout.LayoutBuilderP</span><span> </span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Layout.LayoutBuilder instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier">LayoutP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#layoutP"><span class="hs-identifier">layoutP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#layoutAll"><span class="hs-identifier">layoutAll</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#relBox"><span class="hs-identifier">B.relBox</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#absBox"><span class="hs-identifier">B.absBox</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Overloading ways to select windows</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- $selectWin</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier">Predicate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Proxy"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Const</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.WindowProperties.html"><span class="hs-identifier">XMonad.Util.WindowProperties</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html"><span class="hs-identifier">XMonad.Layout.LayoutBuilder</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">-- $selectWin</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- 'Predicate' exists because layouts are required to be serializable, and</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- &quot;XMonad.Util.WindowProperties&quot; is not sufficient (for example it does not</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- allow using regular expressions).</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- compare &quot;XMonad.Util.Invisible&quot;</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Type class for predicates. This enables us to manage not only Windows,</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- but any objects, for which instance Predicate is defined.</span><span>
</span><span id="line-43"></span><span class="hs-comment">--</span><span>
</span><span id="line-44"></span><span class="hs-comment">-- Another instance exists in XMonad.Util.WindowPropertiesRE in xmonad-extras</span><span>
</span><span id="line-45"></span><span class="hs-keyword">class</span><span> </span><span id="Predicate"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-var">Predicate</span></a></span></span><span> </span><span id="local-6989586621679417043"><span class="annot"><a href="#local-6989586621679417043"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679417042"><span class="annot"><a href="#local-6989586621679417042"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span id="alwaysTrue"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#alwaysTrue"><span class="hs-identifier hs-type">alwaysTrue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417042"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417043"><span class="hs-identifier hs-type">p</span></a></span><span>         </span><span class="hs-comment">-- ^ A predicate that is always True.</span><span>
</span><span id="line-47"></span><span>  </span><span id="checkPredicate"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#checkPredicate"><span class="hs-identifier hs-type">checkPredicate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679417043"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417042"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ Check if given object (window or smth else) matches that predicate</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Contains no actual data, but is needed to help select the correct instance</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- of 'Predicate'</span><span>
</span><span id="line-51"></span><span class="hs-keyword">data</span><span> </span><span id="Proxy"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span></span><span> </span><span id="local-6989586621679417041"><span class="annot"><a href="#local-6989586621679417041"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Proxy"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Data type for our layout.</span><span>
</span><span id="line-54"></span><span class="hs-keyword">data</span><span> </span><span id="LayoutP"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span></span><span> </span><span id="local-6989586621679417069"><span class="annot"><a href="#local-6989586621679417069"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679417068"><span class="annot"><a href="#local-6989586621679417068"><span class="hs-identifier hs-type">l1</span></a></span></span><span> </span><span id="local-6989586621679417067"><span class="annot"><a href="#local-6989586621679417067"><span class="hs-identifier hs-type">l2</span></a></span></span><span> </span><span id="local-6989586621679417070"><span class="annot"><a href="#local-6989586621679417070"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-55"></span><span>    </span><span id="LayoutP"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679417070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679417070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679417069"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679417068"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679417067"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417070"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679416853"><span id="local-6989586621679416855"><span id="local-6989586621679416868"><span class="annot"><span class="annottext">Int -&gt; LayoutP p l1 l2 a -&gt; ShowS
[LayoutP p l1 l2 a] -&gt; ShowS
LayoutP p l1 l2 a -&gt; String
(Int -&gt; LayoutP p l1 l2 a -&gt; ShowS)
-&gt; (LayoutP p l1 l2 a -&gt; String)
-&gt; ([LayoutP p l1 l2 a] -&gt; ShowS)
-&gt; Show (LayoutP p l1 l2 a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show p, Show (l1 a), Show (l2 a)) =&gt;
Int -&gt; LayoutP p l1 l2 a -&gt; ShowS
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show p, Show (l1 a), Show (l2 a)) =&gt;
[LayoutP p l1 l2 a] -&gt; ShowS
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show p, Show (l1 a), Show (l2 a)) =&gt;
LayoutP p l1 l2 a -&gt; String
showList :: [LayoutP p l1 l2 a] -&gt; ShowS
$cshowList :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show p, Show (l1 a), Show (l2 a)) =&gt;
[LayoutP p l1 l2 a] -&gt; ShowS
show :: LayoutP p l1 l2 a -&gt; String
$cshow :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show p, Show (l1 a), Show (l2 a)) =&gt;
LayoutP p l1 l2 a -&gt; String
showsPrec :: Int -&gt; LayoutP p l1 l2 a -&gt; ShowS
$cshowsPrec :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show p, Show (l1 a), Show (l2 a)) =&gt;
Int -&gt; LayoutP p l1 l2 a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679416824"><span id="local-6989586621679416845"><span id="local-6989586621679416848"><span id="local-6989586621679416850"><span class="annot"><span class="annottext">ReadPrec [LayoutP p l1 l2 a]
ReadPrec (LayoutP p l1 l2 a)
Int -&gt; ReadS (LayoutP p l1 l2 a)
ReadS [LayoutP p l1 l2 a]
(Int -&gt; ReadS (LayoutP p l1 l2 a))
-&gt; ReadS [LayoutP p l1 l2 a]
-&gt; ReadPrec (LayoutP p l1 l2 a)
-&gt; ReadPrec [LayoutP p l1 l2 a]
-&gt; Read (LayoutP p l1 l2 a)
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec [LayoutP p l1 l2 a]
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec (LayoutP p l1 l2 a)
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
Int -&gt; ReadS (LayoutP p l1 l2 a)
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
ReadS [LayoutP p l1 l2 a]
readListPrec :: ReadPrec [LayoutP p l1 l2 a]
$creadListPrec :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec [LayoutP p l1 l2 a]
readPrec :: ReadPrec (LayoutP p l1 l2 a)
$creadPrec :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec (LayoutP p l1 l2 a)
readList :: ReadS [LayoutP p l1 l2 a]
$creadList :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
ReadS [LayoutP p l1 l2 a]
readsPrec :: Int -&gt; ReadS (LayoutP p l1 l2 a)
$creadsPrec :: forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read p, Read (l1 a), Read (l2 a)) =&gt;
Int -&gt; ReadS (LayoutP p l1 l2 a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | Use the specified layout in the described area windows that match given predicate and send the rest of the windows to the next layout in the chain.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--   It is possible to supply an alternative area that will then be used instead, if there are no windows to send to the next layout.</span><span>
</span><span id="line-60"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">layoutP</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Layout.LayoutBuilder.layoutP instead.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-61"></span><span id="local-6989586621679417058"><span id="local-6989586621679417059"><span id="local-6989586621679417060"><span id="local-6989586621679417061"><span id="local-6989586621679417062"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#layoutP"><span class="hs-identifier hs-type">layoutP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417061"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417060"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417059"><span class="hs-identifier hs-type">l3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417058"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-62"></span><span>       </span><span class="annot"><a href="#local-6989586621679417058"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span>                       </span><span class="hs-comment">-- ^ The box to place the windows in</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span>                 </span><span class="hs-comment">-- ^ Possibly an alternative box that is used when this layout handles all windows that are left</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417061"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span>                         </span><span class="hs-comment">-- ^ The layout to use in the specified area</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417058"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417060"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417059"><span class="hs-identifier hs-type">l3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="hs-comment">-- ^ Where to send the remaining windows</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417058"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417061"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417058"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417060"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417059"><span class="hs-identifier hs-type">l3</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679417062"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span> </span><span class="hs-comment">-- ^ The resulting layout</span><span>
</span><span id="line-68"></span><span id="layoutP"><span class="annot"><span class="annottext">layoutP :: forall a (l1 :: * -&gt; *) (l2 :: * -&gt; *) (l3 :: * -&gt; *) p.
(Read a, Eq a, LayoutClass l1 a, LayoutClass l2 a,
 LayoutClass l3 a, Predicate p a) =&gt;
p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; LayoutP p l2 l3 a
-&gt; LayoutP p l1 (LayoutP p l2 l3) a
</span><a href="XMonad.Layout.LayoutBuilderP.html#layoutP"><span class="hs-identifier hs-var hs-var">layoutP</span></a></span></span><span> </span><span id="local-6989586621679416815"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416815"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621679416814"><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416814"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679416813"><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416813"><span class="hs-identifier hs-var">mbox</span></a></span></span><span> </span><span id="local-6989586621679416812"><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416812"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679416811"><span class="annot"><span class="annottext">LayoutP p l2 l3 a
</span><a href="#local-6989586621679416811"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (LayoutP p l2 l3 a)
-&gt; LayoutP p l1 (LayoutP p l2 l3) a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
</span><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416815"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416814"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416813"><span class="hs-identifier hs-var">mbox</span></a></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416812"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LayoutP p l2 l3 a -&gt; Maybe (LayoutP p l2 l3 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">LayoutP p l2 l3 a
</span><a href="#local-6989586621679416811"><span class="hs-identifier hs-var">next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Use the specified layout in the described area for all remaining windows.</span><span>
</span><span id="line-71"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">layoutAll</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Layout.LayoutBuilder.layoutAll instead.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-72"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#layoutAll"><span class="hs-identifier hs-type">layoutAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679417050"><span class="annot"><a href="#local-6989586621679417050"><span class="hs-identifier hs-type">l1</span></a></span></span><span> </span><span id="local-6989586621679417049"><span class="annot"><a href="#local-6989586621679417049"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679417051"><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417050"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417049"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-73"></span><span>       </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span>             </span><span class="hs-comment">-- ^ The box to place the windows in</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417050"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span>               </span><span class="hs-comment">-- ^ The layout to use in the specified area</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417049"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417050"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Full</span></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ The resulting layout</span><span>
</span><span id="line-76"></span><span id="layoutAll"><span class="annot"><span class="annottext">layoutAll :: forall (l1 :: * -&gt; *) p a.
(Read a, Eq a, LayoutClass l1 a, Predicate p a) =&gt;
SubBox -&gt; l1 a -&gt; LayoutP p l1 Full a
</span><a href="XMonad.Layout.LayoutBuilderP.html#layoutAll"><span class="hs-identifier hs-var hs-var">layoutAll</span></a></span></span><span> </span><span id="local-6989586621679416806"><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416806"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679416805"><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416805"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679416803"><span class="annot"><span class="annottext">a :: p
</span><a href="#local-6989586621679416803"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Proxy a -&gt; p
forall p w. Predicate p w =&gt; Proxy w -&gt; p
</span><a href="XMonad.Layout.LayoutBuilderP.html#alwaysTrue"><span class="hs-identifier hs-var">alwaysTrue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy a
forall a. Proxy a
</span><a href="XMonad.Layout.LayoutBuilderP.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (Full a)
-&gt; LayoutP p l1 Full a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
</span><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416803"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416806"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416805"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Full a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span id="local-6989586621679417030"><span id="local-6989586621679417031"><span id="local-6989586621679417032"><span id="local-6989586621679417033"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679416788"><span id="local-6989586621679416791"><span id="local-6989586621679416793"><span id="local-6989586621679416795"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417033"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417031"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417030"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679417030"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679417030"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417030"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417033"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417031"><span class="hs-identifier hs-type">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679417032"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-comment">-- | Update window locations.</span><span>
</span><span id="line-84"></span><span>        </span><span id="local-6989586621679416771"><span class="annot"><span class="annottext">runLayout :: Workspace String (LayoutP p l1 l2 w) w
-&gt; Rectangle -&gt; X ([(w, Rectangle)], Maybe (LayoutP p l1 l2 w))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">runLayout</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span id="local-6989586621679416768"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416768"><span class="hs-identifier hs-var">subf</span></a></span></span><span> </span><span id="local-6989586621679416767"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416767"><span class="hs-identifier hs-var">nextf</span></a></span></span><span> </span><span id="local-6989586621679416766"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416766"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621679416765"><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416765"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679416764"><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416764"><span class="hs-identifier hs-var">mbox</span></a></span></span><span> </span><span id="local-6989586621679416763"><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416763"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679416762"><span class="annot"><span class="annottext">Maybe (l2 w)
</span><a href="#local-6989586621679416762"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416761"><span class="annot"><span class="annottext">Maybe (Stack w)
</span><a href="#local-6989586621679416761"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416760"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416760"><span class="hs-identifier hs-var">rect</span></a></span></span><span>
</span><span id="line-85"></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679416759"><span class="annot"><span class="annottext">Maybe (Stack w)
</span><a href="#local-6989586621679416759"><span class="hs-identifier hs-var">subs</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416758"><span class="annot"><span class="annottext">Maybe (Stack w)
</span><a href="#local-6989586621679416758"><span class="hs-identifier hs-var">nexts</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416757"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416757"><span class="hs-identifier hs-var">subf'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416756"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416756"><span class="hs-identifier hs-var">nextf'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack w)
-&gt; p
-&gt; Maybe w
-&gt; Maybe w
-&gt; X (Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
forall p w.
(Predicate p w, Eq w) =&gt;
Maybe (Stack w)
-&gt; p
-&gt; Maybe w
-&gt; Maybe w
-&gt; X (Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
</span><a href="XMonad.Layout.LayoutBuilderP.html#splitStack"><span class="hs-identifier hs-var">splitStack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack w)
</span><a href="#local-6989586621679416761"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416766"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416768"><span class="hs-identifier hs-var">subf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416767"><span class="hs-identifier hs-var">nextf</span></a></span><span>
</span><span id="line-86"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679416754"><span class="annot"><span class="annottext">selBox :: SubBox
</span><a href="#local-6989586621679416754"><span class="hs-identifier hs-var hs-var">selBox</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe w -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416756"><span class="hs-identifier hs-var">nextf'</span></a></span><span>
</span><span id="line-87"></span><span>                                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416765"><span class="hs-identifier hs-var">box</span></a></span><span>
</span><span id="line-88"></span><span>                                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">SubBox -&gt; Maybe SubBox -&gt; SubBox
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416765"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416764"><span class="hs-identifier hs-var">mbox</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621679416751"><span class="annot"><span class="annottext">[(w, Rectangle)]
</span><a href="#local-6989586621679416751"><span class="hs-identifier hs-var">sublist</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416750"><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416750"><span class="hs-identifier hs-var">sub'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 w -&gt; Maybe (Stack w) -&gt; Rectangle -&gt; X ([(w, Rectangle)], l1 w)
forall {layout :: * -&gt; *} {a}.
LayoutClass layout a =&gt;
layout a
-&gt; Maybe (Stack a) -&gt; Rectangle -&gt; X ([(a, Rectangle)], layout a)
</span><a href="#local-6989586621679416749"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416763"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack w)
</span><a href="#local-6989586621679416759"><span class="hs-identifier hs-var">subs</span></a></span><span> </span><span class="annot"><span class="annottext">(Rectangle -&gt; X ([(w, Rectangle)], l1 w))
-&gt; Rectangle -&gt; X ([(w, Rectangle)], l1 w)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SubBox -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Layout.LayoutBuilderP.html#calcArea"><span class="hs-identifier hs-var">calcArea</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416754"><span class="hs-identifier hs-var">selBox</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416760"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span>                 </span><span class="hs-special">(</span><span id="local-6989586621679416747"><span class="annot"><span class="annottext">[(w, Rectangle)]
</span><a href="#local-6989586621679416747"><span class="hs-identifier hs-var">nextlist</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416746"><span class="annot"><span class="annottext">Maybe (l2 w)
</span><a href="#local-6989586621679416746"><span class="hs-identifier hs-var">next'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (l2 w)
</span><a href="#local-6989586621679416762"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (l2 w)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">([(w, Rectangle)], Maybe (l2 w))
-&gt; X ([(w, Rectangle)], Maybe (l2 w))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (l2 w)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>                                                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416745"><span class="annot"><span class="annottext">l2 w
</span><a href="#local-6989586621679416745"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679416744"><span class="annot"><span class="annottext">[(w, Rectangle)]
</span><a href="#local-6989586621679416744"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416743"><span class="annot"><span class="annottext">l2 w
</span><a href="#local-6989586621679416743"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 w -&gt; Maybe (Stack w) -&gt; Rectangle -&gt; X ([(w, Rectangle)], l2 w)
forall {layout :: * -&gt; *} {a}.
LayoutClass layout a =&gt;
layout a
-&gt; Maybe (Stack a) -&gt; Rectangle -&gt; X ([(a, Rectangle)], layout a)
</span><a href="#local-6989586621679416749"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">l2 w
</span><a href="#local-6989586621679416745"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack w)
</span><a href="#local-6989586621679416758"><span class="hs-identifier hs-var">nexts</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416760"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-94"></span><span>                                                               </span><span class="annot"><span class="annottext">([(w, Rectangle)], Maybe (l2 w))
-&gt; X ([(w, Rectangle)], Maybe (l2 w))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(w, Rectangle)]
</span><a href="#local-6989586621679416744"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">l2 w -&gt; Maybe (l2 w)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">l2 w
</span><a href="#local-6989586621679416743"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span>                 </span><span class="annot"><span class="annottext">([(w, Rectangle)], Maybe (LayoutP p l1 l2 w))
-&gt; X ([(w, Rectangle)], Maybe (LayoutP p l1 l2 w))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(w, Rectangle)]
</span><a href="#local-6989586621679416751"><span class="hs-identifier hs-var">sublist</span></a></span><span class="annot"><span class="annottext">[(w, Rectangle)] -&gt; [(w, Rectangle)] -&gt; [(w, Rectangle)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(w, Rectangle)]
</span><a href="#local-6989586621679416747"><span class="hs-identifier hs-var">nextlist</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w -&gt; Maybe (LayoutP p l1 l2 w)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LayoutP p l1 l2 w -&gt; Maybe (LayoutP p l1 l2 w))
-&gt; LayoutP p l1 l2 w -&gt; Maybe (LayoutP p l1 l2 w)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe w
-&gt; Maybe w
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 w
-&gt; Maybe (l2 w)
-&gt; LayoutP p l1 l2 w
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
</span><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416757"><span class="hs-identifier hs-var">subf'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416756"><span class="hs-identifier hs-var">nextf'</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416766"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416765"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416764"><span class="hs-identifier hs-var">mbox</span></a></span><span> </span><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416750"><span class="hs-identifier hs-var">sub'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 w)
</span><a href="#local-6989586621679416746"><span class="hs-identifier hs-var">next'</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>                  </span><span id="local-6989586621679416749"><span class="annot"><span class="annottext">handle :: layout a
-&gt; Maybe (Stack a) -&gt; Rectangle -&gt; X ([(a, Rectangle)], layout a)
</span><a href="#local-6989586621679416749"><span class="hs-identifier hs-var hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679416738"><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679416738"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679416737"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679416737"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span id="local-6989586621679416736"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416736"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679416735"><span class="annot"><span class="annottext">[(a, Rectangle)]
</span><a href="#local-6989586621679416735"><span class="hs-identifier hs-var">res</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679416734"><span class="annot"><span class="annottext">Maybe (layout a)
</span><a href="#local-6989586621679416734"><span class="hs-identifier hs-var">ml</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; layout a -&gt; Maybe (Stack a) -&gt; Workspace String (layout a) a
forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679416738"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679416737"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416736"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-99"></span><span>                                     </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679416733"><span class="annot"><span class="annottext">l' :: layout a
</span><a href="#local-6989586621679416733"><span class="hs-identifier hs-var hs-var">l'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">layout a -&gt; Maybe (layout a) -&gt; layout a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679416738"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (layout a)
</span><a href="#local-6989586621679416734"><span class="hs-identifier hs-var">ml</span></a></span><span>
</span><span id="line-100"></span><span>                                     </span><span class="annot"><span class="annottext">([(a, Rectangle)], layout a) -&gt; X ([(a, Rectangle)], layout a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Rectangle)]
</span><a href="#local-6989586621679416735"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679416733"><span class="hs-identifier hs-var">l'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span>        </span><span class="hs-comment">-- |  Propagate messages.</span><span>
</span><span id="line-103"></span><span>        </span><span id="local-6989586621679416699"><span class="annot"><span class="annottext">handleMessage :: LayoutP p l1 l2 w -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 w))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">handleMessage</span></span></span><span> </span><span id="local-6989586621679416697"><span class="annot"><span class="annottext">LayoutP p l1 l2 w
</span><a href="#local-6989586621679416697"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679416696"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-104"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IncMasterN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe IncMasterN
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 w))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendFocus"><span class="hs-identifier hs-var">sendFocus</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w
</span><a href="#local-6989586621679416697"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-105"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Resize
</span><span class="hs-identifier hs-var">Shrink</span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Resize
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 w))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendFocus"><span class="hs-identifier hs-var">sendFocus</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w
</span><a href="#local-6989586621679416697"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-106"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Resize
</span><span class="hs-identifier hs-var">Expand</span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Resize
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 w))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendFocus"><span class="hs-identifier hs-var">sendFocus</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w
</span><a href="#local-6989586621679416697"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-107"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 w))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendBoth"><span class="hs-identifier hs-var">sendBoth</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 w
</span><a href="#local-6989586621679416697"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416696"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-comment">-- |  Descriptive name for layout.</span><span>
</span><span id="line-110"></span><span>        </span><span id="local-6989586621679416686"><span class="annot"><span class="annottext">description :: LayoutP p l1 l2 w -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">description</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679416684"><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416684"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416683"><span class="annot"><span class="annottext">l2 w
</span><a href="#local-6989586621679416683"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;layoutP &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">l1 w -&gt; String
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; String
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416684"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">l2 w -&gt; String
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; String
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">l2 w
</span><a href="#local-6989586621679416683"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="annot"><span class="hs-identifier hs-var">description</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679416682"><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416682"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 w)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;layoutP &quot;</span></span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">l1 w -&gt; String
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; String
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">l1 w
</span><a href="#local-6989586621679416682"><span class="hs-identifier hs-var">sub</span></a></span></span></span></span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span id="local-6989586621679416678"><span id="local-6989586621679416679"><span id="local-6989586621679416680"><span id="local-6989586621679416681"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#sendSub"><span class="hs-identifier hs-type">sendSub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679416681"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679416679"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416678"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416678"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416681"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416679"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416678"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416681"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416679"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416680"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-116"></span><span id="sendSub"><span class="annot"><span class="annottext">sendSub :: forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendSub"><span class="hs-identifier hs-var hs-var">sendSub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span id="local-6989586621679416666"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416666"><span class="hs-identifier hs-var">subf</span></a></span></span><span> </span><span id="local-6989586621679416665"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416665"><span class="hs-identifier hs-var">nextf</span></a></span></span><span> </span><span id="local-6989586621679416664"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416664"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621679416663"><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416663"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679416662"><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416662"><span class="hs-identifier hs-var">mbox</span></a></span></span><span> </span><span id="local-6989586621679416661"><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416661"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span id="local-6989586621679416660"><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416660"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416659"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416659"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679416658"><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679416658"><span class="hs-identifier hs-var">sub'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 a -&gt; SomeMessage -&gt; X (Maybe (l1 a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416661"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416659"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-118"></span><span>       </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a)))
-&gt; Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679416658"><span class="hs-identifier hs-var">sub'</span></a></span><span>
</span><span id="line-119"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a))
-&gt; LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
</span><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416666"><span class="hs-identifier hs-var">subf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416665"><span class="hs-identifier hs-var">nextf</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416664"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416663"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416662"><span class="hs-identifier hs-var">mbox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l1 a -&gt; Maybe (l1 a) -&gt; l1 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416661"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679416658"><span class="hs-identifier hs-var">sub'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416660"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-120"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span id="local-6989586621679416654"><span id="local-6989586621679416655"><span id="local-6989586621679416656"><span id="local-6989586621679416657"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#sendBoth"><span class="hs-identifier hs-type">sendBoth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679416657"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679416655"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416654"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416654"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416657"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416655"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416654"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416657"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416655"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416656"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-124"></span><span id="sendBoth"><span class="annot"><span class="annottext">sendBoth :: forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendBoth"><span class="hs-identifier hs-var hs-var">sendBoth</span></a></span></span><span> </span><span id="local-6989586621679416634"><span class="annot"><span class="annottext">l :: LayoutP p l1 l2 a
</span><a href="#local-6989586621679416634"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416633"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416633"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendSub"><span class="hs-identifier hs-var">sendSub</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a
</span><a href="#local-6989586621679416634"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416633"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-125"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#sendBoth"><span class="hs-identifier hs-var">sendBoth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span id="local-6989586621679416632"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416632"><span class="hs-identifier hs-var">subf</span></a></span></span><span> </span><span id="local-6989586621679416631"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416631"><span class="hs-identifier hs-var">nextf</span></a></span></span><span> </span><span id="local-6989586621679416630"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416630"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621679416629"><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416629"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679416628"><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416628"><span class="hs-identifier hs-var">mbox</span></a></span></span><span> </span><span id="local-6989586621679416627"><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416627"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416626"><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679416626"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416625"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416625"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679416624"><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679416624"><span class="hs-identifier hs-var">sub'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 a -&gt; SomeMessage -&gt; X (Maybe (l1 a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416627"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416625"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-127"></span><span>       </span><span id="local-6989586621679416623"><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416623"><span class="hs-identifier hs-var">next'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 a -&gt; SomeMessage -&gt; X (Maybe (l2 a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679416626"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416625"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-128"></span><span>       </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a)))
-&gt; Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679416624"><span class="hs-identifier hs-var">sub'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416623"><span class="hs-identifier hs-var">next'</span></a></span><span>
</span><span id="line-129"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a))
-&gt; LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
</span><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416632"><span class="hs-identifier hs-var">subf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416631"><span class="hs-identifier hs-var">nextf</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416630"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416629"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416628"><span class="hs-identifier hs-var">mbox</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l1 a -&gt; Maybe (l1 a) -&gt; l1 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416627"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679416624"><span class="hs-identifier hs-var">sub'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l2 a -&gt; Maybe (l2 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(l2 a -&gt; Maybe (l2 a)) -&gt; l2 a -&gt; Maybe (l2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">l2 a -&gt; Maybe (l2 a) -&gt; l2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679416626"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416623"><span class="hs-identifier hs-var">next'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span id="local-6989586621679416618"><span id="local-6989586621679416619"><span id="local-6989586621679416620"><span id="local-6989586621679416621"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#sendNext"><span class="hs-identifier hs-type">sendNext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679416621"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679416619"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416618"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416618"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416621"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416619"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416618"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416621"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416619"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416620"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-134"></span><span id="sendNext"><span class="annot"><span class="annottext">sendNext :: forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendNext"><span class="hs-identifier hs-var hs-var">sendNext</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-135"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#sendNext"><span class="hs-identifier hs-var">sendNext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span id="local-6989586621679416605"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416605"><span class="hs-identifier hs-var">subf</span></a></span></span><span> </span><span id="local-6989586621679416604"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416604"><span class="hs-identifier hs-var">nextf</span></a></span></span><span> </span><span id="local-6989586621679416603"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416603"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621679416602"><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416602"><span class="hs-identifier hs-var">box</span></a></span></span><span> </span><span id="local-6989586621679416601"><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416601"><span class="hs-identifier hs-var">mbox</span></a></span></span><span> </span><span id="local-6989586621679416600"><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416600"><span class="hs-identifier hs-var">sub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416599"><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679416599"><span class="hs-identifier hs-var">next</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416598"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416598"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679416597"><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416597"><span class="hs-identifier hs-var">next'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 a -&gt; SomeMessage -&gt; X (Maybe (l2 a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679416599"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416598"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-137"></span><span>       </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a)))
-&gt; Maybe (LayoutP p l1 l2 a) -&gt; X (Maybe (LayoutP p l1 l2 a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416597"><span class="hs-identifier hs-var">next'</span></a></span><span>
</span><span id="line-138"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a))
-&gt; LayoutP p l1 l2 a -&gt; Maybe (LayoutP p l1 l2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
forall p (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
Maybe a
-&gt; Maybe a
-&gt; p
-&gt; SubBox
-&gt; Maybe SubBox
-&gt; l1 a
-&gt; Maybe (l2 a)
-&gt; LayoutP p l1 l2 a
</span><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-var">LayoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416605"><span class="hs-identifier hs-var">subf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416604"><span class="hs-identifier hs-var">nextf</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416603"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><a href="#local-6989586621679416602"><span class="hs-identifier hs-var">box</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><a href="#local-6989586621679416601"><span class="hs-identifier hs-var">mbox</span></a></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679416600"><span class="hs-identifier hs-var">sub</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679416597"><span class="hs-identifier hs-var">next'</span></a></span><span>
</span><span id="line-139"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (LayoutP p l1 l2 a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span id="local-6989586621679417007"><span id="local-6989586621679417008"><span id="local-6989586621679417009"><span id="local-6989586621679417010"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#sendFocus"><span class="hs-identifier hs-type">sendFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417010"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679417008"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417007"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417007"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417010"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417008"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417007"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417010"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417008"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417009"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-143"></span><span id="sendFocus"><span class="annot"><span class="annottext">sendFocus :: forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendFocus"><span class="hs-identifier hs-var hs-var">sendFocus</span></a></span></span><span> </span><span id="local-6989586621679416573"><span class="annot"><span class="annottext">l :: LayoutP p l1 l2 a
</span><a href="#local-6989586621679416573"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#LayoutP"><span class="hs-identifier hs-type">LayoutP</span></a></span><span> </span><span id="local-6989586621679416572"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416572"><span class="hs-identifier hs-var">subf</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe SubBox
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416571"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416571"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679416570"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679416570"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; X Bool
forall a. Show a =&gt; Maybe a -&gt; X Bool
</span><a href="XMonad.Layout.LayoutBuilderP.html#isFocus"><span class="hs-identifier hs-var">isFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679416572"><span class="hs-identifier hs-var">subf</span></a></span><span>
</span><span id="line-144"></span><span>                                              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679416570"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendSub"><span class="hs-identifier hs-var">sendSub</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a
</span><a href="#local-6989586621679416573"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416571"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-145"></span><span>                                                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *) p.
(LayoutClass l1 a, LayoutClass l2 a, Read a, Show a, Eq a,
 Typeable a, Predicate p a) =&gt;
LayoutP p l1 l2 a -&gt; SomeMessage -&gt; X (Maybe (LayoutP p l1 l2 a))
</span><a href="XMonad.Layout.LayoutBuilderP.html#sendNext"><span class="hs-identifier hs-var">sendNext</span></a></span><span> </span><span class="annot"><span class="annottext">LayoutP p l1 l2 a
</span><a href="#local-6989586621679416573"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679416571"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span id="local-6989586621679416990"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#isFocus"><span class="hs-identifier hs-type">isFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679416990"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679416990"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-148"></span><span id="isFocus"><span class="annot"><span class="annottext">isFocus :: forall a. Show a =&gt; Maybe a -&gt; X Bool
</span><a href="XMonad.Layout.LayoutBuilderP.html#isFocus"><span class="hs-identifier hs-var hs-var">isFocus</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; X Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-149"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#isFocus"><span class="hs-identifier hs-var">isFocus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416553"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416553"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679416552"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679416552"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Workspace String (Layout Window) Window -&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace String (Layout Window) Window -&gt; Maybe (Stack Window))
-&gt; (StackSet String (Layout Window) Window ScreenId ScreenDetail
    -&gt; Workspace String (Layout Window) Window)
-&gt; StackSet String (Layout Window) Window ScreenId ScreenDetail
-&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen String (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace String (Layout Window) Window
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen String (Layout Window) Window ScreenId ScreenDetail
 -&gt; Workspace String (Layout Window) Window)
-&gt; (StackSet String (Layout Window) Window ScreenId ScreenDetail
    -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; StackSet String (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace String (Layout Window) Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet String (Layout Window) Window ScreenId ScreenDetail
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(StackSet String (Layout Window) Window ScreenId ScreenDetail
 -&gt; Maybe (Stack Window))
-&gt; X (StackSet String (Layout Window) Window ScreenId ScreenDetail)
-&gt; X (Maybe (Stack Window))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(XState
 -&gt; StackSet String (Layout Window) Window ScreenId ScreenDetail)
-&gt; X (StackSet String (Layout Window) Window ScreenId ScreenDetail)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet String (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-150"></span><span>                      </span><span class="annot"><span class="annottext">Bool -&gt; X Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; X Bool) -&gt; Bool -&gt; X Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (Stack Window -&gt; Bool) -&gt; Maybe (Stack Window) -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679416543"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679416543"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416553"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack Window -&gt; Window
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679416543"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679416552"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Split given list of objects (i.e. windows) using predicate.</span><span>
</span><span id="line-154"></span><span id="local-6989586621679416952"><span id="local-6989586621679416953"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#splitBy"><span class="hs-identifier hs-type">splitBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416953"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679416952"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679416953"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679416952"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679416952"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679416952"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-155"></span><span id="splitBy"><span class="annot"><span class="annottext">splitBy :: forall p w. Predicate p w =&gt; p -&gt; [w] -&gt; X ([w], [w])
</span><a href="XMonad.Layout.LayoutBuilderP.html#splitBy"><span class="hs-identifier hs-var hs-var">splitBy</span></a></span></span><span> </span><span id="local-6989586621679416534"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416534"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([w], [w]) -&gt; w -&gt; X ([w], [w]))
-&gt; ([w], [w]) -&gt; [w] -&gt; X ([w], [w])
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">([w], [w]) -&gt; w -&gt; X ([w], [w])
forall {a}. Predicate p a =&gt; ([a], [a]) -&gt; a -&gt; X ([a], [a])
</span><a href="#local-6989586621679416532"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>    </span><span id="local-6989586621679416532"><span class="annot"><span class="annottext">step :: ([a], [a]) -&gt; a -&gt; X ([a], [a])
</span><a href="#local-6989586621679416532"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679416527"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679416527"><span class="hs-identifier hs-var">good</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679416526"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679416526"><span class="hs-identifier hs-var">bad</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416525"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416525"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-158"></span><span>      </span><span id="local-6989586621679416524"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679416524"><span class="hs-identifier hs-var">ok</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">p -&gt; a -&gt; X Bool
forall p w. Predicate p w =&gt; p -&gt; w -&gt; X Bool
</span><a href="XMonad.Layout.LayoutBuilderP.html#checkPredicate"><span class="hs-identifier hs-var">checkPredicate</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416534"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416525"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">([a], [a]) -&gt; X ([a], [a])
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(([a], [a]) -&gt; X ([a], [a])) -&gt; ([a], [a]) -&gt; X ([a], [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679416524"><span class="hs-identifier hs-var">ok</span></a></span><span>
</span><span id="line-160"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416525"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679416527"><span class="hs-identifier hs-var">good</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679416526"><span class="hs-identifier hs-var">bad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679416527"><span class="hs-identifier hs-var">good</span></a></span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416525"><span class="hs-identifier hs-var">w</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679416526"><span class="hs-identifier hs-var">bad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span id="local-6989586621679417028"><span id="local-6989586621679417029"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#splitStack"><span class="hs-identifier hs-type">splitStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417029"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679417029"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679417028"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-164"></span><span id="splitStack"><span class="annot"><span class="annottext">splitStack :: forall p w.
(Predicate p w, Eq w) =&gt;
Maybe (Stack w)
-&gt; p
-&gt; Maybe w
-&gt; Maybe w
-&gt; X (Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
</span><a href="XMonad.Layout.LayoutBuilderP.html#splitStack"><span class="hs-identifier hs-var hs-var">splitStack</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack w)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
-&gt; X (Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack w)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (Stack w)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe w
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe w
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#splitStack"><span class="hs-identifier hs-var">splitStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416515"><span class="annot"><span class="annottext">Stack w
</span><a href="#local-6989586621679416515"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416514"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416514"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span id="local-6989586621679416513"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416513"><span class="hs-identifier hs-var">subf</span></a></span></span><span> </span><span id="local-6989586621679416512"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416512"><span class="hs-identifier hs-var">nextf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679416511"><span class="annot"><span class="annottext">ws :: [w]
</span><a href="#local-6989586621679416511"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack w -&gt; [w]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack w
</span><a href="#local-6989586621679416515"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679416509"><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416509"><span class="hs-identifier hs-var">good</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679416508"><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416508"><span class="hs-identifier hs-var">other</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">p -&gt; [w] -&gt; X ([w], [w])
forall p w. Predicate p w =&gt; p -&gt; [w] -&gt; X ([w], [w])
</span><a href="XMonad.Layout.LayoutBuilderP.html#splitBy"><span class="hs-identifier hs-var">splitBy</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679416514"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416511"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679416507"><span class="annot"><span class="annottext">subf' :: Maybe w
</span><a href="#local-6989586621679416507"><span class="hs-identifier hs-var hs-var">subf'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[w] -&gt; Maybe w -&gt; Maybe w
</span><a href="#local-6989586621679416506"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416509"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416513"><span class="hs-identifier hs-var">subf</span></a></span><span>
</span><span id="line-169"></span><span>        </span><span id="local-6989586621679416505"><span class="annot"><span class="annottext">nextf' :: Maybe w
</span><a href="#local-6989586621679416505"><span class="hs-identifier hs-var hs-var">nextf'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[w] -&gt; Maybe w -&gt; Maybe w
</span><a href="#local-6989586621679416506"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416508"><span class="hs-identifier hs-var">other</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416512"><span class="hs-identifier hs-var">nextf</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="annottext">(Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
-&gt; X (Maybe (Stack w), Maybe (Stack w), Maybe w, Maybe w)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Maybe w -&gt; [w] -&gt; Maybe (Stack w)
forall q. Eq q =&gt; Maybe q -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.LayoutBuilderP.html#differentiate%27"><span class="hs-identifier hs-var">differentiate'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416507"><span class="hs-identifier hs-var">subf'</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416509"><span class="hs-identifier hs-var">good</span></a></span><span>
</span><span id="line-171"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe w -&gt; [w] -&gt; Maybe (Stack w)
forall q. Eq q =&gt; Maybe q -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.LayoutBuilderP.html#differentiate%27"><span class="hs-identifier hs-var">differentiate'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416505"><span class="hs-identifier hs-var">nextf'</span></a></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416508"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-172"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416507"><span class="hs-identifier hs-var">subf'</span></a></span><span>
</span><span id="line-173"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416505"><span class="hs-identifier hs-var">nextf'</span></a></span><span>
</span><span id="line-174"></span><span>           </span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621679416506"><span class="annot"><span class="annottext">foc :: [w] -&gt; Maybe w -&gt; Maybe w
</span><a href="#local-6989586621679416506"><span class="hs-identifier hs-var hs-var">foc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe w
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="#local-6989586621679416506"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span id="local-6989586621679416499"><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416499"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679416498"><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416498"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Stack w -&gt; w
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack w
</span><a href="#local-6989586621679416515"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">w -&gt; [w] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416499"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w -&gt; Maybe w
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(w -&gt; Maybe w) -&gt; w -&gt; Maybe w
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack w -&gt; w
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack w
</span><a href="#local-6989586621679416515"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; (w -&gt; Bool) -&gt; Maybe w -&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">w -&gt; [w] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416499"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416498"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe w
</span><a href="#local-6989586621679416498"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">w -&gt; Maybe w
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(w -&gt; Maybe w) -&gt; w -&gt; Maybe w
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[w] -&gt; w
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[w]
</span><a href="#local-6989586621679416499"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#calcArea"><span class="hs-identifier hs-type">calcArea</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-183"></span><span id="calcArea"><span class="annot"><span class="annottext">calcArea :: SubBox -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Layout.LayoutBuilderP.html#calcArea"><span class="hs-identifier hs-var hs-var">calcArea</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#SubBox"><span class="hs-identifier hs-type">B.SubBox</span></a></span><span> </span><span id="local-6989586621679416494"><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416494"><span class="hs-identifier hs-var">xpos</span></a></span></span><span> </span><span id="local-6989586621679416493"><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416493"><span class="hs-identifier hs-var">ypos</span></a></span></span><span> </span><span id="local-6989586621679416492"><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416492"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621679416491"><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416491"><span class="hs-identifier hs-var">height</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416490"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Dimension -&gt; Dimension -&gt; Rectangle
</span><span class="hs-identifier hs-var">Rectangle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679416486"><span class="hs-identifier hs-var">xpos'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679416484"><span class="hs-identifier hs-var">ypos'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679416483"><span class="hs-identifier hs-var">width'</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679416482"><span class="hs-identifier hs-var">height'</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>        </span><span id="local-6989586621679416486"><span class="annot"><span class="annottext">xpos' :: Dimension
</span><a href="#local-6989586621679416486"><span class="hs-identifier hs-var hs-var">xpos'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SubMeasure -&gt; Dimension -&gt; Dimension
forall {a} {b}. (Integral a, Num b) =&gt; Bool -&gt; SubMeasure -&gt; a -&gt; b
</span><a href="#local-6989586621679416478"><span class="hs-identifier hs-var">calc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416494"><span class="hs-identifier hs-var">xpos</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension) -&gt; Dimension -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-186"></span><span>        </span><span id="local-6989586621679416484"><span class="annot"><span class="annottext">ypos' :: Dimension
</span><a href="#local-6989586621679416484"><span class="hs-identifier hs-var hs-var">ypos'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SubMeasure -&gt; Dimension -&gt; Dimension
forall {a} {b}. (Integral a, Num b) =&gt; Bool -&gt; SubMeasure -&gt; a -&gt; b
</span><a href="#local-6989586621679416478"><span class="hs-identifier hs-var">calc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416493"><span class="hs-identifier hs-var">ypos</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension) -&gt; Dimension -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679416483"><span class="annot"><span class="annottext">width' :: Dimension
</span><a href="#local-6989586621679416483"><span class="hs-identifier hs-var hs-var">width'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SubMeasure -&gt; Dimension -&gt; Dimension
forall {a} {b}. (Integral a, Num b) =&gt; Bool -&gt; SubMeasure -&gt; a -&gt; b
</span><a href="#local-6989586621679416478"><span class="hs-identifier hs-var">calc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416492"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension) -&gt; Dimension -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679416486"><span class="hs-identifier hs-var">xpos'</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span id="local-6989586621679416482"><span class="annot"><span class="annottext">height' :: Dimension
</span><a href="#local-6989586621679416482"><span class="hs-identifier hs-var hs-var">height'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; SubMeasure -&gt; Dimension -&gt; Dimension
forall {a} {b}. (Integral a, Num b) =&gt; Bool -&gt; SubMeasure -&gt; a -&gt; b
</span><a href="#local-6989586621679416478"><span class="hs-identifier hs-var">calc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416491"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension) -&gt; Dimension -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679416490"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679416484"><span class="hs-identifier hs-var">ypos'</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span>        </span><span id="local-6989586621679416478"><span class="annot"><span class="annottext">calc :: Bool -&gt; SubMeasure -&gt; a -&gt; b
</span><a href="#local-6989586621679416478"><span class="hs-identifier hs-var hs-var">calc</span></a></span></span><span> </span><span id="local-6989586621679416439"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679416439"><span class="hs-identifier hs-var">zneg</span></a></span></span><span> </span><span id="local-6989586621679416438"><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416438"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span id="local-6989586621679416437"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416437"><span class="hs-identifier hs-var">tot</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; b
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; b) -&gt; Int -&gt; b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416437"><span class="hs-identifier hs-var">tot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-191"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SubMeasure
</span><a href="#local-6989586621679416438"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#Rel"><span class="hs-identifier hs-type">B.Rel</span></a></span><span> </span><span id="local-6989586621679416433"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679416433"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Int) -&gt; Rational -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679416433"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416437"><span class="hs-identifier hs-var">tot</span></a></span><span>
</span><span id="line-192"></span><span>                        </span><span class="annot"><a href="XMonad.Layout.LayoutBuilder.html#Abs"><span class="hs-identifier hs-type">B.Abs</span></a></span><span> </span><span id="local-6989586621679416429"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679416429"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679416429"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679416439"><span class="hs-identifier hs-var">zneg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679416429"><span class="hs-identifier hs-var">v</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                                 </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679416437"><span class="hs-identifier hs-var">tot</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679416429"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-194"></span><span>                                 </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679416429"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span id="local-6989586621679416941"><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#differentiate%27"><span class="hs-identifier hs-type">differentiate'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679416941"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679416941"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679416941"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679416941"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span id="differentiate%27"><span class="annot"><span class="annottext">differentiate' :: forall q. Eq q =&gt; Maybe q -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.LayoutBuilderP.html#differentiate%27"><span class="hs-identifier hs-var hs-var">differentiate'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe q
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack q)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#differentiate%27"><span class="hs-identifier hs-var">differentiate'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe q
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679416421"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416421"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; Maybe (Stack q)
forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416421"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-199"></span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#differentiate%27"><span class="hs-identifier hs-var">differentiate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679416419"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679416419"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679416418"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416418"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679416419"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">q -&gt; [q] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416418"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack q -&gt; Maybe (Stack q)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Stack q -&gt; Maybe (Stack q)) -&gt; Stack q -&gt; Maybe (Stack q)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack :: forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: q
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679416419"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-201"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [q]
</span><span class="hs-identifier hs-var">W.up</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; [q]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([q] -&gt; [q]) -&gt; [q] -&gt; [q]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(q -&gt; Bool) -&gt; [q] -&gt; [q]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">q -&gt; q -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679416419"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416418"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-202"></span><span>                                  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [q]
</span><span class="hs-identifier hs-var">W.down</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; [q]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([q] -&gt; [q]) -&gt; [q] -&gt; [q]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(q -&gt; Bool) -&gt; [q] -&gt; [q]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">q -&gt; q -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679416419"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416418"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-203"></span><span>                                  </span><span class="hs-special">}</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; Maybe (Stack q)
forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679416418"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutBuilderP.html#Predicate"><span class="hs-identifier hs-type">Predicate</span></a></span><span> </span><span class="annot"><a href="XMonad.Util.WindowProperties.html#Property"><span class="hs-identifier hs-type">Property</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="local-6989586621679416405"><span class="annot"><span class="annottext">alwaysTrue :: Proxy Window -&gt; Property
</span><a href="#local-6989586621679416405"><span class="hs-identifier hs-var hs-var hs-var hs-var">alwaysTrue</span></a></span></span><span> </span><span class="annot"><span class="annottext">Proxy Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
</span><a href="XMonad.Util.WindowProperties.html#Const"><span class="hs-identifier hs-var">Const</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679416403"><span class="annot"><span class="annottext">checkPredicate :: Property -&gt; Window -&gt; X Bool
</span><a href="#local-6989586621679416403"><span class="hs-identifier hs-var hs-var hs-var hs-var">checkPredicate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Property -&gt; Window -&gt; X Bool
</span><a href="XMonad.Util.WindowProperties.html#hasProperty"><span class="hs-identifier hs-var">hasProperty</span></a></span><span>
</span><span id="line-209"></span></pre></body></html>