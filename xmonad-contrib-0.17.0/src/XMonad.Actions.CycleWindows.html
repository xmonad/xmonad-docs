<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module       : XMonad.Actions.CycleWindows</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description  : Cycle windows while maintaining focus in place.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright    : (c) Wirt Wolff &lt;wirtwolff@gmail.com&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License      : BSD3-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer   : Wirt Wolff &lt;wirtwolff@gmail.com&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability    : unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability  : unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Provides bindings to cycle windows up or down on the current workspace</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- stack while maintaining focus in place.</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Bindings are available to:</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- * Cycle nearby or nth windows into the focused frame</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- * Cycle a window halfway around the stack</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- * Cycle windows through the focused position.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- * Cycle unfocused windows.</span><span>
</span><span id="line-24"></span><span class="hs-comment">--</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- These bindings are especially useful with layouts that hide some of</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- the windows in the stack, such as Full, &quot;XMonad.Layout.TwoPane&quot; or</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- when using &quot;XMonad.Layout.LimitWindows&quot; to only show three or four</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- panes. See also &quot;XMonad.Actions.RotSlaves&quot; for related actions.</span><span>
</span><span id="line-29"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.CycleWindows</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Cycling nearby or nth window into current frame</span></span><span>
</span><span id="line-35"></span><span>        </span><span class="annot"><span class="hs-comment">-- $cycle</span></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#cycleRecentWindows"><span class="hs-identifier">cycleRecentWindows</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#cycleStacks%27"><span class="hs-identifier">cycleStacks'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Cycling half the stack to get rid of a boring window</span></span><span>
</span><span id="line-39"></span><span>        </span><span class="annot"><span class="hs-comment">-- $opposite</span></span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotOpposite%27"><span class="hs-identifier">rotOpposite'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotOpposite"><span class="hs-identifier">rotOpposite</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Cycling windows through the current frame</span></span><span>
</span><span id="line-42"></span><span>        </span><span class="annot"><span class="hs-comment">-- $focused</span></span><span>
</span><span id="line-43"></span><span>        </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier">rotFocused'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocusedUp"><span class="hs-identifier">rotFocusedUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocusedDown"><span class="hs-identifier">rotFocusedDown</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#shiftToFocus%27"><span class="hs-identifier">shiftToFocus'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Cycling windows through other frames</span></span><span>
</span><span id="line-45"></span><span>        </span><span class="annot"><span class="hs-comment">-- $unfocused</span></span><span>
</span><span id="line-46"></span><span>        </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier">rotUnfocused'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocusedUp"><span class="hs-identifier">rotUnfocusedUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocusedDown"><span class="hs-identifier">rotUnfocusedDown</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Updating the mouse pointer</span></span><span>
</span><span id="line-48"></span><span>        </span><span class="annot"><span class="hs-comment">-- $pointer</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><span class="hs-comment">-- * Generic list rotations</span></span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><span class="hs-comment">-- $generic</span></span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUp"><span class="hs-identifier">rotUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotDown"><span class="hs-identifier">rotDown</span></a></span><span>
</span><span id="line-53"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.RotSlaves.html"><span class="hs-identifier">XMonad.Actions.RotSlaves</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- You can use this module with the following in your @~\/.xmonad\/xmonad.hs@ file:</span><span>
</span><span id="line-63"></span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &gt; import XMonad.Actions.CycleWindows</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;    -- config</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &gt;    -- other key bindings with x here your config</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &gt;              -- make sure mod matches keysym</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- &gt;  , ((mod4Mask,  xK_s), cycleRecentWindows [xK_Super_L] xK_s xK_w)</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- &gt;  , ((modm, xK_z), rotOpposite)</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt;  , ((modm                , xK_i), rotUnfocusedUp)</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- &gt;  , ((modm                , xK_u), rotUnfocusedDown)</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask, xK_i), rotFocusedUp)</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask, xK_u), rotFocusedDown)</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Also, if you use focus follows mouse, you will want to read the section</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- on updating the mouse pointer below.  For detailed instructions on</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- editing your key bindings, see &quot;XMonad.Doc.Extending#Editing_key_bindings&quot;.</span><span>
</span><span id="line-79"></span><span class="hs-comment">{- $pointer
With FocusFollowsMouse == True, the focus is updated after binding
actions, possibly focusing a window you didn't intend to focus. Most
people using TwoPane probably already have a logHook causing the mouse
to follow focus. (See &quot;XMonad.Actions.UpdatePointer&quot;, or &quot;XMonad.Actions.Warp&quot;)

If you want this built into the key binding instead, use the appropriate
action from one of those modules to also have your bindings move the pointer
to the point of your choice on the current window:

&gt; import XMonad.Actions.UpdatePointer -- or Actions.Warp

and either

&gt; -- modify the window rotation bindings
&gt; , ((modm .|. controlMask, xK_i   ), rotFocusedUp
&gt;                                            &gt;&gt; updatePointer (Relative 1 1))
&gt; , ((modm .|. controlMask, xK_u   ), rotFocusedDown
&gt;                                            &gt;&gt; updatePointer (Relative 1 1))
&gt;
&gt;    -- or add to xmonad's logHook
&gt;    , logHook = dynamicLogWithPP xmobarPP
&gt;                    &gt;&gt; updatePointer Nearest -- or your preference

-}</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- $cycle</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Cycle windows into focus from below or above the focused pane by pressing</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- a key while one or more modifier keys is held down. The window order isn't</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- changed until a modifier is released, leaving the previously focused window</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- just below the new one, (or above if the window just above is chosen.) For</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- best results use the same modifier + key combination as the one used to invoke</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- the \&quot;bring from below\&quot; action.  Also, once cycling, pressing a number key n</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- will focus the nth window, with 0 being the one originally focused.</span><span>
</span><span id="line-113"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#cycleRecentWindows"><span class="hs-identifier hs-type">cycleRecentWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A list of modifier keys used when invoking this action.</span><span>
</span><span id="line-114"></span><span>                               </span><span class="hs-comment">--   As soon as one of them is released, the final switch is made.</span><span>
</span><span id="line-115"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span>  </span><span class="hs-comment">-- ^ Key used to shift windows from below the current choice into the current frame.</span><span>
</span><span id="line-116"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span>  </span><span class="hs-comment">-- ^ Key used to shift windows from above the current choice into the current frame.</span><span>
</span><span id="line-117"></span><span>                               </span><span class="hs-comment">--   If it's the same as the first key, it is effectively ignored.</span><span>
</span><span id="line-118"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span id="cycleRecentWindows"><span class="annot"><span class="annottext">cycleRecentWindows :: [KeySym] -&gt; KeySym -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.CycleWindows.html#cycleRecentWindows"><span class="hs-identifier hs-var hs-var">cycleRecentWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; [Stack KeySym])
-&gt; [KeySym] -&gt; KeySym -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.CycleWindows.html#cycleStacks%27"><span class="hs-identifier hs-var">cycleStacks'</span></a></span><span> </span><span class="annot"><span class="annottext">Stack KeySym -&gt; [Stack KeySym]
forall a. (Eq a, Show a, Read a) =&gt; Stack a -&gt; [Stack a]
</span><a href="#local-6989586621679354911"><span class="hs-identifier hs-var">stacks</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679354911"><span class="annot"><span class="annottext">stacks :: Stack a -&gt; [Stack a]
</span><a href="#local-6989586621679354911"><span class="hs-identifier hs-var hs-var">stacks</span></a></span></span><span> </span><span id="local-6989586621679354910"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354910"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Stack a) -&gt; [a] -&gt; [Stack a]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Stack a -&gt; Stack a
forall a. (Eq a, Show a, Read a) =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#shiftToFocus%27"><span class="hs-operator hs-var">`shiftToFocus'`</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354910"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><a href="#local-6989586621679354909"><span class="hs-identifier hs-var">wins</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354910"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679354909"><span class="annot"><span class="annottext">wins :: Stack a -&gt; [a]
</span><a href="#local-6989586621679354909"><span class="hs-identifier hs-var hs-var">wins</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679354907"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354907"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679354906"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354906"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679354905"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354905"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354907"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354905"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354906"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Cycle through a /finite/ list of window stacks with repeated presses</span><span>
</span><span id="line-125"></span><span class="hs-comment">--   of a key while a modifier key is held down. For best results use the same</span><span>
</span><span id="line-126"></span><span class="hs-comment">--   mod key + key combination as the one used to invoke the \&quot;bring from below\&quot;</span><span>
</span><span id="line-127"></span><span class="hs-comment">--   action. You could use cycleStacks' with a different stack permutations</span><span>
</span><span id="line-128"></span><span class="hs-comment">--   function to, for example, cycle from one below to one above to two below,</span><span>
</span><span id="line-129"></span><span class="hs-comment">--   etc. instead of in order. You are responsible for having it generate a</span><span>
</span><span id="line-130"></span><span class="hs-comment">--   finite list, though, or xmonad may hang seeking its length.</span><span>
</span><span id="line-131"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#cycleStacks%27"><span class="hs-identifier hs-type">cycleStacks'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ A function to a finite list of permutations of a given stack.</span><span>
</span><span id="line-132"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ A list of modifier keys used to invoke 'cycleStacks''.</span><span>
</span><span id="line-133"></span><span>                                                 </span><span class="hs-comment">--   As soon as any is released, we're no longer cycling on the [Stack Window]</span><span>
</span><span id="line-134"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span>    </span><span class="hs-comment">-- ^ Key used to select a \&quot;next\&quot; stack.</span><span>
</span><span id="line-135"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span>    </span><span class="hs-comment">-- ^ Key used to select a \&quot;previous\&quot; stack.</span><span>
</span><span id="line-136"></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="cycleStacks%27"><span class="annot"><span class="annottext">cycleStacks' :: (Stack KeySym -&gt; [Stack KeySym])
-&gt; [KeySym] -&gt; KeySym -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.CycleWindows.html#cycleStacks%27"><span class="hs-identifier hs-var hs-var">cycleStacks'</span></a></span></span><span> </span><span id="local-6989586621679354902"><span class="annot"><span class="annottext">Stack KeySym -&gt; [Stack KeySym]
</span><a href="#local-6989586621679354902"><span class="hs-identifier hs-var">filteredPerms</span></a></span></span><span> </span><span id="local-6989586621679354901"><span class="annot"><span class="annottext">[KeySym]
</span><a href="#local-6989586621679354901"><span class="hs-identifier hs-var">mods</span></a></span></span><span> </span><span id="local-6989586621679354900"><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354900"><span class="hs-identifier hs-var">keyNext</span></a></span></span><span> </span><span id="local-6989586621679354899"><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354899"><span class="hs-identifier hs-var">keyPrev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">XConf</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">theRoot :: XConf -&gt; KeySym
</span><span class="hs-identifier hs-var">theRoot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679354896"><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354896"><span class="hs-identifier hs-var">root</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">display :: XConf -&gt; Display
</span><span class="hs-identifier hs-var">display</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679354894"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679354894"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X XConf
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-139"></span><span>    </span><span id="local-6989586621679354892"><span class="annot"><span class="annottext">[Stack KeySym]
</span><a href="#local-6989586621679354892"><span class="hs-identifier hs-var">stacks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; [Stack KeySym]) -&gt; X [Stack KeySym]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XState -&gt; [Stack KeySym]) -&gt; X [Stack KeySym])
-&gt; (XState -&gt; [Stack KeySym]) -&gt; X [Stack KeySym]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Stack KeySym]
-&gt; (Stack KeySym -&gt; [Stack KeySym])
-&gt; Maybe (Stack KeySym)
-&gt; [Stack KeySym]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Stack KeySym -&gt; [Stack KeySym]
</span><a href="#local-6989586621679354902"><span class="hs-identifier hs-var">filteredPerms</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack KeySym) -&gt; [Stack KeySym])
-&gt; (XState -&gt; Maybe (Stack KeySym)) -&gt; XState -&gt; [Stack KeySym]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout KeySym) KeySym
-&gt; Maybe (Stack KeySym)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceId (Layout KeySym) KeySym
 -&gt; Maybe (Stack KeySym))
-&gt; (XState -&gt; Workspace WorkspaceId (Layout KeySym) KeySym)
-&gt; XState
-&gt; Maybe (Stack KeySym)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; Workspace WorkspaceId (Layout KeySym) KeySym
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; Workspace WorkspaceId (Layout KeySym) KeySym)
-&gt; (XState
    -&gt; Screen WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; XState
-&gt; Workspace WorkspaceId (Layout KeySym) KeySym
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; Screen WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; Screen WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; (XState
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; XState
-&gt; Screen WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679354884"><span class="annot"><span class="annottext">evt :: IO (EventType, KeySym)
</span><a href="#local-6989586621679354884"><span class="hs-identifier hs-var hs-var">evt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XEventPtr -&gt; IO (EventType, KeySym)) -&gt; IO (EventType, KeySym)
forall a. (XEventPtr -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">allocaXEvent</span></span><span> </span><span class="annot"><span class="annottext">((XEventPtr -&gt; IO (EventType, KeySym)) -&gt; IO (EventType, KeySym))
-&gt; (XEventPtr -&gt; IO (EventType, KeySym)) -&gt; IO (EventType, KeySym)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-142"></span><span>                  </span><span class="hs-glyph">\</span><span id="local-6989586621679354882"><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679354882"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Display -&gt; KeySym -&gt; XEventPtr -&gt; IO ()
</span><span class="hs-identifier hs-var">maskEvent</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679354894"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">keyPressMask</span></span><span> </span><span class="annot"><span class="annottext">KeySym -&gt; KeySym -&gt; KeySym
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">keyReleaseMask</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679354882"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-143"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">KeyEvent</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_event_type :: Event -&gt; EventType
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679354875"><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354875"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_keycode :: Event -&gt; KeyCode
</span><span class="hs-identifier hs-var">ev_keycode</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679354873"><span class="annot"><span class="annottext">KeyCode
</span><a href="#local-6989586621679354873"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">XEventPtr -&gt; IO Event
</span><span class="hs-identifier hs-var">getEvent</span></span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679354882"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-144"></span><span>                           </span><span id="local-6989586621679354871"><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354871"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Display -&gt; KeyCode -&gt; CInt -&gt; IO KeySym
</span><span class="hs-identifier hs-var">keycodeToKeysym</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679354894"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">KeyCode
</span><a href="#local-6989586621679354873"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-145"></span><span>                           </span><span class="annot"><span class="annottext">(EventType, KeySym) -&gt; IO (EventType, KeySym)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354875"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354871"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621679354869"><span class="annot"><span class="annottext">choose :: Int -&gt; (EventType, KeySym) -&gt; X ()
</span><a href="#local-6989586621679354869"><span class="hs-identifier hs-var hs-var">choose</span></a></span></span><span> </span><span id="local-6989586621679354868"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354868"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679354867"><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354867"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679354866"><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354866"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354867"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">EventType -&gt; EventType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">keyPress</span></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354866"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym -&gt; KeySym -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354900"><span class="hs-identifier hs-var">keyNext</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym) -&gt; X (EventType, KeySym)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym)
</span><a href="#local-6989586621679354884"><span class="hs-identifier hs-var">evt</span></a></span><span> </span><span class="annot"><span class="annottext">X (EventType, KeySym) -&gt; ((EventType, KeySym) -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (EventType, KeySym) -&gt; X ()
</span><a href="#local-6989586621679354869"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354868"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354867"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">EventType -&gt; EventType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">keyPress</span></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354866"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym -&gt; KeySym -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354899"><span class="hs-identifier hs-var">keyPrev</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym) -&gt; X (EventType, KeySym)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym)
</span><a href="#local-6989586621679354884"><span class="hs-identifier hs-var">evt</span></a></span><span> </span><span class="annot"><span class="annottext">X (EventType, KeySym) -&gt; ((EventType, KeySym) -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (EventType, KeySym) -&gt; X ()
</span><a href="#local-6989586621679354869"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354868"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354867"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">EventType -&gt; EventType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">keyPress</span></span><span>   </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354866"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym -&gt; [KeySym] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_0</span></span><span class="hs-glyph">..</span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_9</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym) -&gt; X (EventType, KeySym)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym)
</span><a href="#local-6989586621679354884"><span class="hs-identifier hs-var">evt</span></a></span><span> </span><span class="annot"><span class="annottext">X (EventType, KeySym) -&gt; ((EventType, KeySym) -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (EventType, KeySym) -&gt; X ()
</span><a href="#local-6989586621679354869"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeySym -&gt; Int
</span><a href="#local-6989586621679354858"><span class="hs-identifier hs-var">numKeyToN</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354866"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679354867"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">EventType -&gt; EventType -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">keyRelease</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354866"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym -&gt; [KeySym] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[KeySym]
</span><a href="#local-6989586621679354901"><span class="hs-identifier hs-var">mods</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; X ()
</span><a href="#local-6989586621679354856"><span class="hs-identifier hs-var">doStack</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354868"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">X () -&gt; X (EventType, KeySym) -&gt; X (EventType, KeySym)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym) -&gt; X (EventType, KeySym)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym)
</span><a href="#local-6989586621679354884"><span class="hs-identifier hs-var">evt</span></a></span><span> </span><span class="annot"><span class="annottext">X (EventType, KeySym) -&gt; ((EventType, KeySym) -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (EventType, KeySym) -&gt; X ()
</span><a href="#local-6989586621679354869"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354868"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-152"></span><span>        </span><span id="local-6989586621679354856"><span class="annot"><span class="annottext">doStack :: Int -&gt; X ()
</span><a href="#local-6989586621679354856"><span class="hs-identifier hs-var hs-var">doStack</span></a></span></span><span> </span><span id="local-6989586621679354855"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354855"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (Stack KeySym
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; Stack KeySym
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; Stack KeySym)
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack KeySym -&gt; Stack KeySym)
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; (Stack KeySym -&gt; Stack KeySym -&gt; Stack KeySym)
-&gt; Stack KeySym
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stack KeySym -&gt; Stack KeySym -&gt; Stack KeySym
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; X ()) -&gt; Stack KeySym -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Stack KeySym]
</span><a href="#local-6989586621679354892"><span class="hs-identifier hs-var">stacks</span></a></span><span> </span><span class="annot"><span class="annottext">[Stack KeySym] -&gt; Int -&gt; Stack KeySym
forall a. [a] -&gt; Int -&gt; a
</span><a href="#local-6989586621679354851"><span class="hs-operator hs-var">`cycref`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354855"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">IO CInt -&gt; X CInt
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO CInt -&gt; X CInt) -&gt; IO CInt -&gt; X CInt
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; KeySym -&gt; Bool -&gt; CInt -&gt; CInt -&gt; KeySym -&gt; IO CInt
</span><span class="hs-identifier hs-var">grabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679354894"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679354896"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">IO (EventType, KeySym) -&gt; X (EventType, KeySym)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">IO (EventType, KeySym)
</span><a href="#local-6989586621679354884"><span class="hs-identifier hs-var">evt</span></a></span><span> </span><span class="annot"><span class="annottext">X (EventType, KeySym) -&gt; ((EventType, KeySym) -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; (EventType, KeySym) -&gt; X ()
</span><a href="#local-6989586621679354869"><span class="hs-identifier hs-var">choose</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; X ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; X ()) -&gt; IO () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; KeySym -&gt; IO ()
</span><span class="hs-identifier hs-var">ungrabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679354894"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679354851"><span class="annot"><span class="annottext">cycref :: [a] -&gt; Int -&gt; a
</span><a href="#local-6989586621679354851"><span class="hs-identifier hs-var hs-var">cycref</span></a></span></span><span> </span><span id="local-6989586621679354846"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354846"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679354845"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354845"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354846"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int -&gt; a
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354845"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354846"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- modify' ensures l is never [], but must also be finite</span><span>
</span><span id="line-158"></span><span>        </span><span id="local-6989586621679354858"><span class="annot"><span class="annottext">numKeyToN :: KeySym -&gt; Int
</span><a href="#local-6989586621679354858"><span class="hs-identifier hs-var hs-var">numKeyToN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">subtract</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">48</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (KeySym -&gt; Int) -&gt; KeySym -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; Int
forall a. Read a =&gt; WorkspaceId -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(WorkspaceId -&gt; Int) -&gt; (KeySym -&gt; WorkspaceId) -&gt; KeySym -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">KeySym -&gt; WorkspaceId
forall a. Show a =&gt; a -&gt; WorkspaceId
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Given a stack element and a stack, shift or insert the element (window)</span><span>
</span><span id="line-161"></span><span class="hs-comment">--   at the currently focused position.</span><span>
</span><span id="line-162"></span><span id="local-6989586621679355018"><span class="annot"><a href="XMonad.Actions.CycleWindows.html#shiftToFocus%27"><span class="hs-identifier hs-type">shiftToFocus'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679355018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679355018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679355018"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679355018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679355018"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679355018"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-163"></span><span id="shiftToFocus%27"><span class="annot"><span class="annottext">shiftToFocus' :: a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#shiftToFocus%27"><span class="hs-identifier hs-var hs-var">shiftToFocus'</span></a></span></span><span> </span><span id="local-6989586621679354838"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354838"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679354837"><span class="annot"><span class="annottext">s :: Stack a
</span><a href="#local-6989586621679354837"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679354836"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354836"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354838"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354835"><span class="hs-identifier hs-var">revls'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354834"><span class="hs-identifier hs-var">rs'</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679354835"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354835"><span class="hs-identifier hs-var">revls'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679354834"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354834"><span class="hs-identifier hs-var">rs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354836"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; ([a], [a])) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; ([a], [a])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354838"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; ([a], [a])) -&gt; [a] -&gt; ([a], [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354837"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- $opposite</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- Shifts the focused window as far as possible from the current focus,</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- i.e. halfway around the stack. Windows above the focus up to the \&quot;opposite\&quot;</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- position remain in place, while those above the insertion shift toward</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- the current focus. This is useful for people who use lots of windows in Full,</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- TwoPane, etc., to get rid of boring windows while cycling and swapping</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- near the focus.</span><span>
</span><span id="line-174"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotOpposite"><span class="hs-identifier hs-type">rotOpposite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span id="rotOpposite"><span class="annot"><span class="annottext">rotOpposite :: X ()
</span><a href="XMonad.Actions.CycleWindows.html#rotOpposite"><span class="hs-identifier hs-var hs-var">rotOpposite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; Stack KeySym)
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">Stack KeySym -&gt; Stack KeySym
forall a. Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotOpposite%27"><span class="hs-identifier hs-var">rotOpposite'</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | The opposite rotation on a Stack.</span><span>
</span><span id="line-178"></span><span id="local-6989586621679354938"><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotOpposite%27"><span class="hs-identifier hs-type">rotOpposite'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679354938"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679354938"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-179"></span><span id="rotOpposite%27"><span class="annot"><span class="annottext">rotOpposite' :: Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotOpposite%27"><span class="hs-identifier hs-var hs-var">rotOpposite'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679354830"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354830"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679354829"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354829"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679354828"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354828"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354827"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354826"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354825"><span class="hs-identifier hs-var">r'</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679354824"><span class="annot"><span class="annottext">rrvl :: [a]
</span><a href="#local-6989586621679354824"><span class="hs-identifier hs-var hs-var">rrvl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354828"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354829"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span id="local-6989586621679354823"><span class="annot"><span class="annottext">part :: Int
</span><a href="#local-6989586621679354823"><span class="hs-identifier hs-var hs-var">part</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354824"><span class="hs-identifier hs-var">rrvl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679354826"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354826"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679354827"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354827"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679354825"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354825"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a], [a]) -&gt; ([a], [a])
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(([a], [a]) -&gt; ([a], [a]))
-&gt; ([a] -&gt; ([a], [a])) -&gt; [a] -&gt; ([a], [a])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354829"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; ([a], [a])) -&gt; [a] -&gt; ([a], [a])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-183"></span><span>                                </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354823"><span class="hs-identifier hs-var">part</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354824"><span class="hs-identifier hs-var">rrvl</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354830"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679354823"><span class="hs-identifier hs-var">part</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354824"><span class="hs-identifier hs-var">rrvl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">-- $focused</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Most people will want the @rotAllUp@ or @rotAllDown@ actions from</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- &quot;XMonad.Actions.RotSlaves&quot; to cycle all windows in the stack.</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- The following actions keep the \&quot;next\&quot; window stable, which is</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- mostly useful in two window layouts, or when you have a log viewer or</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- buffer window you want to keep next to the cycled window.</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Rotate windows through the focused frame, excluding the \&quot;next\&quot; window.</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- With, e.g. TwoPane, this allows cycling windows through either the</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- master or slave pane, without changing the other frame. When the master</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- is focused, the window below is skipped, when a non-master window is</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- focused, the master is skipped.</span><span>
</span><span id="line-199"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocusedUp"><span class="hs-identifier hs-type">rotFocusedUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span id="rotFocusedUp"><span class="annot"><span class="annottext">rotFocusedUp :: X ()
</span><a href="XMonad.Actions.CycleWindows.html#rotFocusedUp"><span class="hs-identifier hs-var hs-var">rotFocusedUp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
 -&gt; X ())
-&gt; ((Stack KeySym -&gt; Stack KeySym)
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; (Stack KeySym -&gt; Stack KeySym)
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; Stack KeySym)
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack KeySym -&gt; Stack KeySym) -&gt; X ())
-&gt; (Stack KeySym -&gt; Stack KeySym) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([KeySym] -&gt; [KeySym]) -&gt; Stack KeySym -&gt; Stack KeySym
forall a. ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier hs-var">rotFocused'</span></a></span><span> </span><span class="annot"><span class="annottext">[KeySym] -&gt; [KeySym]
forall a. [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotUp"><span class="hs-identifier hs-var">rotUp</span></a></span><span>
</span><span id="line-201"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocusedDown"><span class="hs-identifier hs-type">rotFocusedDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span id="rotFocusedDown"><span class="annot"><span class="annottext">rotFocusedDown :: X ()
</span><a href="XMonad.Actions.CycleWindows.html#rotFocusedDown"><span class="hs-identifier hs-var hs-var">rotFocusedDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
 -&gt; X ())
-&gt; ((Stack KeySym -&gt; Stack KeySym)
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; (Stack KeySym -&gt; Stack KeySym)
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; Stack KeySym)
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack KeySym -&gt; Stack KeySym) -&gt; X ())
-&gt; (Stack KeySym -&gt; Stack KeySym) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([KeySym] -&gt; [KeySym]) -&gt; Stack KeySym -&gt; Stack KeySym
forall a. ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier hs-var">rotFocused'</span></a></span><span> </span><span class="annot"><span class="annottext">[KeySym] -&gt; [KeySym]
forall a. [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotDown"><span class="hs-identifier hs-var">rotDown</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | The focused rotation on a stack.</span><span>
</span><span id="line-205"></span><span id="local-6989586621679354930"><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier hs-type">rotFocused'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679354930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679354930"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-206"></span><span id="rotFocused%27"><span class="annot"><span class="annottext">rotFocused' :: ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier hs-var hs-var">rotFocused'</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679354819"><span class="annot"><span class="annottext">s :: Stack a
</span><a href="#local-6989586621679354819"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354819"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-207"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier hs-var">rotFocused'</span></a></span><span> </span><span id="local-6989586621679354818"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354818"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679354817"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354817"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679354816"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354816"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679354815"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354815"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354814"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354816"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354813"><span class="hs-identifier hs-var">rs'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- Master has focus</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679354814"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354814"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679354813"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354813"><span class="hs-identifier hs-var">rs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354818"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354817"><span class="hs-identifier hs-var">t</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354815"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotFocused%27"><span class="hs-identifier hs-var">rotFocused'</span></a></span><span> </span><span id="local-6989586621679354812"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354812"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679354811"><span class="annot"><span class="annottext">s :: Stack a
</span><a href="#local-6989586621679354811"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
forall a. ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.RotSlaves.html#rotSlaves%27"><span class="hs-identifier hs-var">rotSlaves'</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354812"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354811"><span class="hs-identifier hs-var">s</span></a></span><span>                    </span><span class="hs-comment">-- otherwise</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- $unfocused</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- Rotate windows through the unfocused frames. This is similar to</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- @rotSlaves@, from &quot;XMonad.Actions.RotSlaves&quot;, but excludes the current</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- frame rather than master.</span><span>
</span><span id="line-216"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocusedUp"><span class="hs-identifier hs-type">rotUnfocusedUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span id="rotUnfocusedUp"><span class="annot"><span class="annottext">rotUnfocusedUp :: X ()
</span><a href="XMonad.Actions.CycleWindows.html#rotUnfocusedUp"><span class="hs-identifier hs-var hs-var">rotUnfocusedUp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
 -&gt; X ())
-&gt; ((Stack KeySym -&gt; Stack KeySym)
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; (Stack KeySym -&gt; Stack KeySym)
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; Stack KeySym)
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack KeySym -&gt; Stack KeySym) -&gt; X ())
-&gt; (Stack KeySym -&gt; Stack KeySym) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([KeySym] -&gt; [KeySym]) -&gt; Stack KeySym -&gt; Stack KeySym
forall a. ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier hs-var">rotUnfocused'</span></a></span><span> </span><span class="annot"><span class="annottext">[KeySym] -&gt; [KeySym]
forall a. [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotUp"><span class="hs-identifier hs-var">rotUp</span></a></span><span>
</span><span id="line-218"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocusedDown"><span class="hs-identifier hs-type">rotUnfocusedDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span id="rotUnfocusedDown"><span class="annot"><span class="annottext">rotUnfocusedDown :: X ()
</span><a href="XMonad.Actions.CycleWindows.html#rotUnfocusedDown"><span class="hs-identifier hs-var hs-var">rotUnfocusedDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
 -&gt; X ())
-&gt; ((Stack KeySym -&gt; Stack KeySym)
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail)
-&gt; (Stack KeySym -&gt; Stack KeySym)
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Stack KeySym -&gt; Stack KeySym)
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceId (Layout KeySym) KeySym ScreenId ScreenDetail
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack KeySym -&gt; Stack KeySym) -&gt; X ())
-&gt; (Stack KeySym -&gt; Stack KeySym) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([KeySym] -&gt; [KeySym]) -&gt; Stack KeySym -&gt; Stack KeySym
forall a. ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier hs-var">rotUnfocused'</span></a></span><span> </span><span class="annot"><span class="annottext">[KeySym] -&gt; [KeySym]
forall a. [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotDown"><span class="hs-identifier hs-var">rotDown</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | The unfocused rotation on a stack.</span><span>
</span><span id="line-222"></span><span id="local-6989586621679354809"><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier hs-type">rotUnfocused'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354809"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354809"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679354809"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679354809"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-223"></span><span id="rotUnfocused%27"><span class="annot"><span class="annottext">rotUnfocused' :: ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier hs-var hs-var">rotUnfocused'</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679354808"><span class="annot"><span class="annottext">s :: Stack a
</span><a href="#local-6989586621679354808"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354808"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-224"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier hs-var">rotUnfocused'</span></a></span><span> </span><span id="local-6989586621679354807"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354807"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679354806"><span class="annot"><span class="annottext">s :: Stack a
</span><a href="#local-6989586621679354806"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
forall a. ([a] -&gt; [a]) -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Actions.RotSlaves.html#rotSlaves%27"><span class="hs-identifier hs-var">rotSlaves'</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354807"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679354806"><span class="hs-identifier hs-var">s</span></a></span><span>                 </span><span class="hs-comment">-- Master has focus</span><span>
</span><span id="line-225"></span><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUnfocused%27"><span class="hs-identifier hs-var">rotUnfocused'</span></a></span><span> </span><span id="local-6989586621679354805"><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354805"><span class="hs-identifier hs-var">f</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679354804"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354804"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679354803"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354803"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679354802"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354802"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354804"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354801"><span class="hs-identifier hs-var">revls'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354800"><span class="hs-identifier hs-var">rs'</span></a></span><span> </span><span class="hs-comment">-- otherwise</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-keyword">where</span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679354799"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354799"><span class="hs-identifier hs-var">master</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679354798"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354798"><span class="hs-identifier hs-var">revls</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354803"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-227"></span><span>           </span><span class="hs-special">(</span><span id="local-6989586621679354801"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354801"><span class="hs-identifier hs-var">revls'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679354800"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354800"><span class="hs-identifier hs-var">rs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354803"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a] -&gt; [a]
</span><a href="#local-6989586621679354805"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679354799"><span class="hs-identifier hs-var">master</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354798"><span class="hs-identifier hs-var">revls</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354802"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- $generic</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Generic list rotations such that @rotUp [1..4]@ is equivalent to</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- @[2,3,4,1]@ and @rotDown [1..4]@ to @[4,1,2,3]@. They both are</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- @id@ for null or singleton lists.</span><span>
</span><span id="line-233"></span><span id="local-6989586621679354797"><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotUp"><span class="hs-identifier hs-type">rotUp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354797"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-234"></span><span id="rotUp"><span class="annot"><span class="annottext">rotUp :: [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotUp"><span class="hs-identifier hs-var hs-var">rotUp</span></a></span></span><span>   </span><span id="local-6989586621679354796"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354796"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354796"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679354796"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-235"></span><span id="local-6989586621679354795"><span class="annot"><a href="XMonad.Actions.CycleWindows.html#rotDown"><span class="hs-identifier hs-type">rotDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354795"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679354795"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-236"></span><span id="rotDown"><span class="annot"><span class="annottext">rotDown :: [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotDown"><span class="hs-identifier hs-var hs-var">rotDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><a href="XMonad.Actions.CycleWindows.html#rotUp"><span class="hs-identifier hs-var">rotUp</span></a></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [a]) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-237"></span></pre></body></html>