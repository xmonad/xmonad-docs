<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  XMonad.Util.Run</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description :  This modules provides several commands to run an external process.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (C) 2007 Spencer Janssen, Andrea Rossato, glasser@mit.edu</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Christian Thiemann &lt;mail@christian-thiemann.de&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- This modules provides several commands to run an external process.</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- It is composed of functions formerly defined in &quot;XMonad.Util.Dmenu&quot; (by</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Spencer Janssen), &quot;XMonad.Util.Dzen&quot; (by glasser\@mit.edu) and</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- XMonad.Util.RunInXTerm (by Andrea Rossato).</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Util.Run</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>                          </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-21"></span><span>                          </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-22"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#runProcessWithInput"><span class="hs-identifier">runProcessWithInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#runProcessWithInputAndWait"><span class="hs-identifier">runProcessWithInputAndWait</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#safeSpawn"><span class="hs-identifier">safeSpawn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#safeSpawnProg"><span class="hs-identifier">safeSpawnProg</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#unsafeSpawn"><span class="hs-identifier">unsafeSpawn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#runInTerm"><span class="hs-identifier">runInTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#safeRunInTerm"><span class="hs-identifier">safeRunInTerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#seconds"><span class="hs-identifier">seconds</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#spawnPipe"><span class="hs-identifier">spawnPipe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#spawnPipeWithLocaleEncoding"><span class="hs-identifier">spawnPipeWithLocaleEncoding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#spawnPipeWithUtf8Encoding"><span class="hs-identifier">spawnPipeWithUtf8Encoding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                          </span><span class="annot"><a href="XMonad.Util.Run.html#spawnPipeWithNoEncoding"><span class="hs-identifier">spawnPipeWithNoEncoding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                          </span><span class="annot"><span class="hs-identifier">hPutStr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span>  </span><span class="hs-comment">-- re-export for convenience</span><span>
</span><span id="line-35"></span><span>                         </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Binary.UTF8.String</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.IO</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix.Process</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createSession</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">executeFile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forkProcess</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">threadDelay</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runInteractiveProcess</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- For an example usage of 'runInTerm' see &quot;XMonad.Prompt.Ssh&quot;</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- For an example usage of 'runProcessWithInput' see</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &quot;XMonad.Prompt.DirectoryPrompt&quot;, &quot;XMonad.Util.Dmenu&quot;,</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- &quot;XMonad.Prompt.ShellPrompt&quot;, &quot;XMonad.Actions.WmiiActions&quot;,</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- &quot;XMonad.Prompt.WorkspaceDir&quot;</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- For an example usage of 'runProcessWithInputAndWait' see</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &quot;XMonad.Util.Dzen&quot;</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Returns the output.</span><span>
</span><span id="line-58"></span><span id="local-6989586621679380039"><span class="annot"><a href="XMonad.Util.Run.html#runProcessWithInput"><span class="hs-identifier hs-type">runProcessWithInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380039"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380039"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-59"></span><span id="runProcessWithInput"><span class="annot"><span class="annottext">runProcessWithInput :: FilePath -&gt; [FilePath] -&gt; FilePath -&gt; m FilePath
</span><a href="XMonad.Util.Run.html#runProcessWithInput"><span class="hs-identifier hs-var hs-var">runProcessWithInput</span></a></span></span><span> </span><span id="local-6989586621679380037"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380037"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679380036"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679380036"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679380035"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380035"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO FilePath -&gt; m FilePath
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO FilePath -&gt; m FilePath) -&gt; IO FilePath -&gt; m FilePath
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679380033"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380033"><span class="hs-identifier hs-var">pin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679380032"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380032"><span class="hs-identifier hs-var">pout</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679380031"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380031"><span class="hs-identifier hs-var">perr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; Maybe FilePath
-&gt; Maybe [(FilePath, FilePath)]
-&gt; IO (Handle, Handle, Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">runInteractiveProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380037"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679380036"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(FilePath, FilePath)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380033"><span class="hs-identifier hs-var">pin</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380035"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380033"><span class="hs-identifier hs-var">pin</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621679380028"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380028"><span class="hs-identifier hs-var">output</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO FilePath
</span><span class="hs-identifier hs-var">hGetContents</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380032"><span class="hs-identifier hs-var">pout</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380028"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380028"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380032"><span class="hs-identifier hs-var">pout</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380031"><span class="hs-identifier hs-var">perr</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-comment">-- no need to waitForProcess, we ignore SIGCHLD</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="annottext">FilePath -&gt; IO FilePath
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380028"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | Wait is in &amp;#956; (microseconds)</span><span>
</span><span id="line-72"></span><span id="local-6989586621679380025"><span class="annot"><a href="XMonad.Util.Run.html#runProcessWithInputAndWait"><span class="hs-identifier hs-type">runProcessWithInputAndWait</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380025"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380025"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-73"></span><span id="runProcessWithInputAndWait"><span class="annot"><span class="annottext">runProcessWithInputAndWait :: FilePath -&gt; [FilePath] -&gt; FilePath -&gt; Int -&gt; m ()
</span><a href="XMonad.Util.Run.html#runProcessWithInputAndWait"><span class="hs-identifier hs-var hs-var">runProcessWithInputAndWait</span></a></span></span><span> </span><span id="local-6989586621679380024"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380024"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679380023"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679380023"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span id="local-6989586621679380022"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380022"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span id="local-6989586621679380021"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679380021"><span class="hs-identifier hs-var">timeout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="annottext">ProcessID
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ProcessID
forall (m :: * -&gt; *). MonadIO m =&gt; IO () -&gt; m ProcessID
</span><span class="hs-identifier hs-var">xfork</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ProcessID) -&gt; IO () -&gt; IO ProcessID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-75"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679380019"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380019"><span class="hs-identifier hs-var">pin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679380018"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380018"><span class="hs-identifier hs-var">pout</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679380017"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380017"><span class="hs-identifier hs-var">perr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">FilePath
-&gt; [FilePath]
-&gt; Maybe FilePath
-&gt; Maybe [(FilePath, FilePath)]
-&gt; IO (Handle, Handle, Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">runInteractiveProcess</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380024"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>                                            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679380023"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe FilePath
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe [(FilePath, FilePath)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-77"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; FilePath -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380019"><span class="hs-identifier hs-var">pin</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380022"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-78"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hFlush</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380019"><span class="hs-identifier hs-var">pin</span></a></span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679380021"><span class="hs-identifier hs-var">timeout</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380019"><span class="hs-identifier hs-var">pin</span></a></span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380018"><span class="hs-identifier hs-var">pout</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hClose</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679380017"><span class="hs-identifier hs-var">perr</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-comment">-- no need to waitForProcess, we ignore SIGCHLD</span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Multiplies by ONE MILLION, for functions that take microseconds.</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- Use like:</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt; (5.5 `seconds`)</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- In GHC 7 and later, you must either enable the PostfixOperators extension</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- (by adding</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &gt; {-# LANGUAGE PostfixOperators #-}</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- to the top of your file) or use seconds in prefix form:</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt; seconds 5.5</span><span>
</span><span id="line-101"></span><span class="annot"><a href="XMonad.Util.Run.html#seconds"><span class="hs-identifier hs-type">seconds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-102"></span><span id="seconds"><span class="annot"><span class="annottext">seconds :: Rational -&gt; Int
</span><a href="XMonad.Util.Run.html#seconds"><span class="hs-identifier hs-var hs-var">seconds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Int) -&gt; (Rational -&gt; Rational) -&gt; Rational -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1000000</span></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">{- | 'safeSpawn' bypasses 'spawn', because spawn passes
strings to \/bin\/sh to be interpreted as shell commands. This is
often what one wants, but in many cases the passed string will contain
shell metacharacters which one does not want interpreted as such (URLs
particularly often have shell metacharacters like \'&amp;\' in them). In
this case, it is more useful to specify a file or program to be run
and a string to give it as an argument so as to bypass the shell and
be certain the program will receive the string as you typed it.

Examples:

&gt; , ((modm, xK_Print), unsafeSpawn &quot;import -window root $HOME/xwd-$(date +%s)$$.png&quot;)
&gt; , ((modm, xK_d    ), safeSpawn &quot;firefox&quot; [])

Note that the unsafeSpawn example must be unsafe and not safe because
it makes use of shell interpretation by relying on @$HOME@ and
interpolation, whereas the safeSpawn example can be safe because
Firefox doesn't need any arguments if it is just being started. -}</span><span>
</span><span id="line-122"></span><span id="local-6989586621679380084"><span class="annot"><a href="XMonad.Util.Run.html#safeSpawn"><span class="hs-identifier hs-type">safeSpawn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380084"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380084"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-123"></span><span id="safeSpawn"><span class="annot"><span class="annottext">safeSpawn :: FilePath -&gt; [FilePath] -&gt; m ()
</span><a href="XMonad.Util.Run.html#safeSpawn"><span class="hs-identifier hs-var hs-var">safeSpawn</span></a></span></span><span> </span><span id="local-6989586621679380012"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380012"><span class="hs-identifier hs-var">prog</span></a></span></span><span> </span><span id="local-6989586621679380011"><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679380011"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; m ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; m ()) -&gt; IO () -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO ProcessID -&gt; IO ()
forall a. IO a -&gt; IO ()
</span><a href="#local-6989586621679380010"><span class="hs-identifier hs-var">void_</span></a></span><span> </span><span class="annot"><span class="annottext">(IO ProcessID -&gt; IO ()) -&gt; IO ProcessID -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ProcessID
</span><span class="hs-identifier hs-var">forkProcess</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ProcessID) -&gt; IO () -&gt; IO ProcessID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-124"></span><span>  </span><span class="annot"><span class="annottext">IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; m ()
</span><span class="hs-identifier hs-var">uninstallSignalHandlers</span></span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">ProcessID
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ProcessID
</span><span class="hs-identifier hs-var">createSession</span></span><span>
</span><span id="line-126"></span><span>  </span><span class="annot"><span class="annottext">FilePath
-&gt; Bool -&gt; [FilePath] -&gt; Maybe [(FilePath, FilePath)] -&gt; IO ()
forall a.
FilePath
-&gt; Bool -&gt; [FilePath] -&gt; Maybe [(FilePath, FilePath)] -&gt; IO a
</span><span class="hs-identifier hs-var">executeFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380012"><span class="hs-identifier hs-var">prog</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(FilePath -&gt; FilePath) -&gt; [FilePath] -&gt; [FilePath]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">[FilePath]
</span><a href="#local-6989586621679380011"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe [(FilePath, FilePath)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679380010"><span class="annot"><span class="annottext">void_ :: IO a -&gt; IO ()
</span><a href="#local-6989586621679380010"><span class="hs-identifier hs-var hs-var">void_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO a -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- TODO: replace with Control.Monad.void / void not in ghc6 apparently</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Simplified 'safeSpawn'; only takes a program (and no arguments):</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt; , ((modm, xK_d    ), safeSpawnProg &quot;firefox&quot;)</span><span>
</span><span id="line-132"></span><span id="local-6989586621679380008"><span class="annot"><a href="XMonad.Util.Run.html#safeSpawnProg"><span class="hs-identifier hs-type">safeSpawnProg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380008"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380008"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-133"></span><span id="safeSpawnProg"><span class="annot"><span class="annottext">safeSpawnProg :: FilePath -&gt; m ()
</span><a href="XMonad.Util.Run.html#safeSpawnProg"><span class="hs-identifier hs-var hs-var">safeSpawnProg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; [FilePath] -&gt; m ()) -&gt; [FilePath] -&gt; FilePath -&gt; m ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; [FilePath] -&gt; m ()
</span><a href="XMonad.Util.Run.html#safeSpawn"><span class="hs-identifier hs-var">safeSpawn</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | An alias for 'spawn'; the name emphasizes that one is calling out to a</span><span>
</span><span id="line-136"></span><span class="hs-comment">--   Turing-complete interpreter which may do things one dislikes; for details, see 'safeSpawn'.</span><span>
</span><span id="line-137"></span><span id="local-6989586621679380006"><span class="annot"><a href="XMonad.Util.Run.html#unsafeSpawn"><span class="hs-identifier hs-type">unsafeSpawn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380006"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-138"></span><span id="unsafeSpawn"><span class="annot"><span class="annottext">unsafeSpawn :: FilePath -&gt; m ()
</span><a href="XMonad.Util.Run.html#unsafeSpawn"><span class="hs-identifier hs-var hs-var">unsafeSpawn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><span class="hs-identifier hs-var">spawn</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Open a terminal emulator. The terminal emulator is specified in the default configuration as xterm by default. It is then</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- asked to pass the shell a command with certain options. This is unsafe in the sense of 'unsafeSpawn'</span><span>
</span><span id="line-142"></span><span class="annot"><a href="XMonad.Util.Run.html#unsafeRunInTerm"><span class="hs-identifier hs-type">unsafeRunInTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Run.html#runInTerm"><span class="hs-identifier hs-type">runInTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="unsafeRunInTerm"><span class="annot"><span class="annottext">unsafeRunInTerm :: FilePath -&gt; FilePath -&gt; X ()
</span><a href="XMonad.Util.Run.html#unsafeRunInTerm"><span class="hs-identifier hs-var hs-var">unsafeRunInTerm</span></a></span></span><span> </span><span id="local-6989586621679380003"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380003"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679380002"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380002"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XConf -&gt; FilePath) -&gt; X FilePath
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XConfig Layout -&gt; FilePath
forall (l :: * -&gt; *). XConfig l -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var">terminal</span></span><span> </span><span class="annot"><span class="annottext">(XConfig Layout -&gt; FilePath)
-&gt; (XConf -&gt; XConfig Layout) -&gt; XConf -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var hs-var">config</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X FilePath -&gt; (FilePath -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679379998"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379998"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; X ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m ()
</span><a href="XMonad.Util.Run.html#unsafeSpawn"><span class="hs-identifier hs-var">unsafeSpawn</span></a></span><span> </span><span class="annot"><span class="annottext">(FilePath -&gt; X ()) -&gt; FilePath -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379998"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380003"><span class="hs-identifier hs-var">options</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; -e &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679380002"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-144"></span><span id="runInTerm"><span class="annot"><span class="annottext">runInTerm :: FilePath -&gt; FilePath -&gt; X ()
</span><a href="XMonad.Util.Run.html#runInTerm"><span class="hs-identifier hs-var hs-var">runInTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; X ()
</span><a href="XMonad.Util.Run.html#unsafeRunInTerm"><span class="hs-identifier hs-var">unsafeRunInTerm</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Run a given program in the preferred terminal emulator; see 'runInTerm'. This makes use of 'safeSpawn'.</span><span>
</span><span id="line-147"></span><span class="annot"><a href="XMonad.Util.Run.html#safeRunInTerm"><span class="hs-identifier hs-type">safeRunInTerm</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span id="safeRunInTerm"><span class="annot"><span class="annottext">safeRunInTerm :: FilePath -&gt; FilePath -&gt; X ()
</span><a href="XMonad.Util.Run.html#safeRunInTerm"><span class="hs-identifier hs-var hs-var">safeRunInTerm</span></a></span></span><span> </span><span id="local-6989586621679379997"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379997"><span class="hs-identifier hs-var">options</span></a></span></span><span> </span><span id="local-6989586621679379996"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379996"><span class="hs-identifier hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XConf -&gt; FilePath) -&gt; X FilePath
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XConfig Layout -&gt; FilePath
forall (l :: * -&gt; *). XConfig l -&gt; FilePath
</span><span class="hs-identifier hs-var hs-var">terminal</span></span><span> </span><span class="annot"><span class="annottext">(XConfig Layout -&gt; FilePath)
-&gt; (XConf -&gt; XConfig Layout) -&gt; XConf -&gt; FilePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var hs-var">config</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X FilePath -&gt; (FilePath -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679379995"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379995"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; [FilePath] -&gt; X ()
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; [FilePath] -&gt; m ()
</span><a href="XMonad.Util.Run.html#safeSpawn"><span class="hs-identifier hs-var">safeSpawn</span></a></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379995"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379997"><span class="hs-identifier hs-var">options</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot; -e &quot;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath -&gt; FilePath
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379996"><span class="hs-identifier hs-var">command</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Launch an external application through the system shell and</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- return a 'Handle' to its standard input. Note that the 'Handle'</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- is a text 'Handle' using the current locale encoding.</span><span>
</span><span id="line-153"></span><span id="local-6989586621679379994"><span class="annot"><a href="XMonad.Util.Run.html#spawnPipe"><span class="hs-identifier hs-type">spawnPipe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679379994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679379994"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span></span><span>
</span><span id="line-154"></span><span id="spawnPipe"><span class="annot"><span class="annottext">spawnPipe :: FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipe"><span class="hs-identifier hs-var hs-var">spawnPipe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; m Handle
forall (m :: * -&gt; *). MonadIO m =&gt; FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipeWithLocaleEncoding"><span class="hs-identifier hs-var">spawnPipeWithLocaleEncoding</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Same as 'spawnPipe'.</span><span>
</span><span id="line-157"></span><span id="local-6989586621679380068"><span class="annot"><a href="XMonad.Util.Run.html#spawnPipeWithLocaleEncoding"><span class="hs-identifier hs-type">spawnPipeWithLocaleEncoding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span></span><span>
</span><span id="line-158"></span><span id="spawnPipeWithLocaleEncoding"><span class="annot"><span class="annottext">spawnPipeWithLocaleEncoding :: FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipeWithLocaleEncoding"><span class="hs-identifier hs-var hs-var">spawnPipeWithLocaleEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TextEncoding -&gt; FilePath -&gt; m Handle
forall (m :: * -&gt; *).
MonadIO m =&gt;
TextEncoding -&gt; FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipe%27"><span class="hs-identifier hs-var">spawnPipe'</span></a></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><span class="hs-identifier hs-var">localeEncoding</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Same as 'spawnPipe', but forces the UTF-8 encoding regardless of locale.</span><span>
</span><span id="line-161"></span><span id="local-6989586621679379991"><span class="annot"><a href="XMonad.Util.Run.html#spawnPipeWithUtf8Encoding"><span class="hs-identifier hs-type">spawnPipeWithUtf8Encoding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679379991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679379991"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span></span><span>
</span><span id="line-162"></span><span id="spawnPipeWithUtf8Encoding"><span class="annot"><span class="annottext">spawnPipeWithUtf8Encoding :: FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipeWithUtf8Encoding"><span class="hs-identifier hs-var hs-var">spawnPipeWithUtf8Encoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TextEncoding -&gt; FilePath -&gt; m Handle
forall (m :: * -&gt; *).
MonadIO m =&gt;
TextEncoding -&gt; FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipe%27"><span class="hs-identifier hs-var">spawnPipe'</span></a></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><span class="hs-identifier hs-var">utf8</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Same as 'spawnPipe', but forces the 'char8' encoding, so unicode strings</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- need 'Codec.Binary.UTF8.String.encodeString'. Should never be needed, but</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- some X functions return already encoded Strings, so it may possibly be</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- useful for someone.</span><span>
</span><span id="line-168"></span><span id="local-6989586621679379989"><span class="annot"><a href="XMonad.Util.Run.html#spawnPipeWithNoEncoding"><span class="hs-identifier hs-type">spawnPipeWithNoEncoding</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679379989"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679379989"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span></span><span>
</span><span id="line-169"></span><span id="spawnPipeWithNoEncoding"><span class="annot"><span class="annottext">spawnPipeWithNoEncoding :: FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipeWithNoEncoding"><span class="hs-identifier hs-var hs-var">spawnPipeWithNoEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TextEncoding -&gt; FilePath -&gt; m Handle
forall (m :: * -&gt; *).
MonadIO m =&gt;
TextEncoding -&gt; FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipe%27"><span class="hs-identifier hs-var">spawnPipe'</span></a></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><span class="hs-identifier hs-var">char8</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621679380065"><span class="annot"><a href="XMonad.Util.Run.html#spawnPipe%27"><span class="hs-identifier hs-type">spawnPipe'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679380065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TextEncoding</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679380065"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span></span><span>
</span><span id="line-172"></span><span id="spawnPipe%27"><span class="annot"><span class="annottext">spawnPipe' :: TextEncoding -&gt; FilePath -&gt; m Handle
</span><a href="XMonad.Util.Run.html#spawnPipe%27"><span class="hs-identifier hs-var hs-var">spawnPipe'</span></a></span></span><span> </span><span id="local-6989586621679379987"><span class="annot"><span class="annottext">TextEncoding
</span><a href="#local-6989586621679379987"><span class="hs-identifier hs-var">encoding</span></a></span></span><span> </span><span id="local-6989586621679379986"><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379986"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Handle -&gt; m Handle
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO Handle -&gt; m Handle) -&gt; IO Handle -&gt; m Handle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679379985"><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679379985"><span class="hs-identifier hs-var">rd</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679379984"><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679379984"><span class="hs-identifier hs-var">wr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Fd, Fd)
</span><span class="hs-identifier hs-var">createPipe</span></span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="annottext">Fd -&gt; FdOption -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">setFdOption</span></span><span> </span><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679379984"><span class="hs-identifier hs-var">wr</span></a></span><span> </span><span class="annot"><span class="annottext">FdOption
</span><span class="hs-identifier hs-var">CloseOnExec</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-175"></span><span>    </span><span id="local-6989586621679379980"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679379980"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fd -&gt; IO Handle
</span><span class="hs-identifier hs-var">fdToHandle</span></span><span> </span><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679379984"><span class="hs-identifier hs-var">wr</span></a></span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; TextEncoding -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEncoding</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679379980"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><a href="#local-6989586621679379987"><span class="hs-identifier hs-var">encoding</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679379980"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">BufferMode
</span><span class="hs-identifier hs-var">LineBuffering</span></span><span>
</span><span id="line-178"></span><span>    </span><span class="annot"><span class="annottext">ProcessID
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ProcessID
forall (m :: * -&gt; *). MonadIO m =&gt; IO () -&gt; m ProcessID
</span><span class="hs-identifier hs-var">xfork</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ProcessID) -&gt; IO () -&gt; IO ProcessID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>          </span><span class="annot"><span class="annottext">Fd
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Fd -&gt; Fd -&gt; IO Fd
</span><span class="hs-identifier hs-var">dupTo</span></span><span> </span><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679379985"><span class="hs-identifier hs-var">rd</span></a></span><span> </span><span class="annot"><span class="annottext">Fd
</span><span class="hs-identifier hs-var">stdInput</span></span><span>
</span><span id="line-180"></span><span>          </span><span class="annot"><span class="annottext">FilePath
-&gt; Bool -&gt; [FilePath] -&gt; Maybe [(FilePath, FilePath)] -&gt; IO ()
forall a.
FilePath
-&gt; Bool -&gt; [FilePath] -&gt; Maybe [(FilePath, FilePath)] -&gt; IO a
</span><span class="hs-identifier hs-var">executeFile</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;/bin/sh&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">FilePath
</span><span class="hs-string">&quot;-c&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; FilePath
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">FilePath
</span><a href="#local-6989586621679379986"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Maybe [(FilePath, FilePath)]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><span class="annottext">Fd -&gt; IO ()
</span><span class="hs-identifier hs-var">closeFd</span></span><span> </span><span class="annot"><span class="annottext">Fd
</span><a href="#local-6989586621679379985"><span class="hs-identifier hs-var">rd</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; IO Handle
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679379980"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-183"></span></pre></body></html>