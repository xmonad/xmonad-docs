<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- {-# LANGUAGE PatternGuards, FlexibleContexts, FlexibleInstances, TypeSynonymInstances, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE PatternGuards, FlexibleContexts, FlexibleInstances, MultiParamTypeClasses #-}</span><span>
</span><span id="line-3"></span><span class="hs-comment">---------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  XMonad.Layout.TallMastersCombo</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Description :  A version of @Tall@ with two permanent master windows.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  (c) 2019 Ningji Wei</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  :  Ningji Wei &lt;tidues@gmail.com&gt;</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- A layout combinator that support Shrink, Expand, and IncMasterN just as the</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- 'Tall' layout, and also support operations of two master windows:</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- a main master, which is the original master window;</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- a sub master, the first window of the second pane.</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- This combinator can be nested, and has a good support for using</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- 'XMonad.Layout.Tabbed' as a sublayout.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Layout.TallMastersCombo</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#tmsCombineTwoDefault"><span class="hs-identifier">tmsCombineTwoDefault</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#tmsCombineTwo"><span class="hs-identifier">tmsCombineTwo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier">TMSCombineTwo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier">RowsOrColumns</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#%7C%7C%7C"><span class="hs-operator">(|||)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Messages</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwitchOrientation"><span class="hs-identifier">SwitchOrientation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwapSubMaster"><span class="hs-identifier">SwapSubMaster</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusSubMaster"><span class="hs-identifier">FocusSubMaster</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusedNextLayout"><span class="hs-identifier">FocusedNextLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChangeFocus"><span class="hs-identifier">ChangeFocus</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier">ChooseWrapper</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#swapWindow"><span class="hs-identifier">swapWindow</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#focusWindow"><span class="hs-identifier">focusWindow</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#handleMessages"><span class="hs-identifier">handleMessages</span></a></span><span>
</span><span id="line-42"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">focus</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(|||)</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">delete</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Workspace</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">integrate'</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">Stack</span></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.Layout</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">LL</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.Simplest.html"><span class="hs-identifier">XMonad.Layout.Simplest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Simplest.html#Simplest"><span class="hs-identifier">Simplest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html"><span class="hs-identifier">XMonad.Layout.Decoration</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">---------------------------------------------------------------------------------</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- You can use this module with the following in your @~\/.xmonad\/xmonad.hs@:</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt; import XMonad.Layout.TallMastersCombo</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- and make sure the Choose layout operator (|||) is hidden by adding the followings:</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- &gt; import XMonad hiding ((|||))</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt; import XMonad.Layout hiding ((|||))</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- then, add something like</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt; tmsCombineTwoDefault (Tall 0 (3/100) 0) simpleTabbed</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- This will make the 'Tall' layout as the master pane, and 'simpleTabbed' layout as the second pane.</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- You can shrink, expand, and increase more windows to the master pane just like using the</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- 'Tall' layout.</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- To swap and/or focus the sub master window (the first window in the second pane), you can add</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- the following key bindings</span><span>
</span><span id="line-73"></span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;      , ((modm .|. shiftMask, m),         sendMessage $ FocusSubMaster)</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- &gt;      , ((modm .|. shiftMask, xK_Return), sendMessage $ SwapSubMaster)</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- In each pane, you can use multiple layouts with the '(|||)' combinator provided by this module,</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- and switch between them with the 'FocusedNextLayout' message. Below is one example</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- &gt; layout1 = Simplest ||| Tabbed</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- &gt; layout2 = Full ||| Tabbed ||| (RowsOrColumns True)</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- &gt; myLayout = tmsCombineTwoDefault layout1 layout2</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- then add the following key binding,</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt;      , ((modm, w), sendMessage $ FocusedNextLayout)</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- Now, pressing this key will toggle the multiple layouts in the currently focused pane.</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- You can mirror this layout with the default 'Mirror' key binding. But to have a more natural</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- behaviors, you can use the 'SwitchOrientation' message:</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;      , ((modm, xK_space), sendMessage $ SwitchOrientation)</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- This will not mirror the tabbed decoration, and will keep sub-layouts that made by TallMastersCombo</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- and RowsOrColumns display in natural orientations.</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- To merge layouts more flexibly, you can use 'tmsCombineTwo' instead.</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt; tmsCombineTwo False 1 (3/100) (1/3) Simplest simpleTabbed</span><span>
</span><span id="line-101"></span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- This creates a vertical merged layout with 1 window in the master pane, and the master pane shrinks</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- and expands with a step of (3\/100), and occupies (1\/3) of the screen.</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Each sub-layout have a focused window. To rotate between the focused windows across all the</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- sub-layouts, using the following messages:</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt;      , ((modm .|. mod1, j), sendMessage $ NextFocus)</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt;      , ((modm .|. mod1, k), sendMessage $ PrevFocus)</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- this let you jump to the focused window in the next/previous sub-layout.</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Finally, this combinator can be nested. Here is one example,</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- subLayout  = tmsCombineTwo False 1 (3\/100) (1\/2) Simplest simpleTabbed</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- layout1    = simpleTabbed ||| subLayout</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- layout2    = subLayout ||| simpleTabbed ||| (RowsOrColumns True)</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- baseLayout = tmsCombineTwoDefault layout1 layout2</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- mylayouts = smartBorders $</span><span>
</span><span id="line-123"></span><span class="hs-comment">--             avoidStruts $</span><span>
</span><span id="line-124"></span><span class="hs-comment">--             mkToggle (FULL ?? EOT) $</span><span>
</span><span id="line-125"></span><span class="hs-comment">--             baseLayout</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- this is a realization of the cool idea from</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- &lt;https://www.reddit.com/r/xmonad/comments/3vkrc3/does_this_layout_exist_if_not_can_anyone_suggest/&gt;</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- and is more flexible.</span><span>
</span><span id="line-133"></span><span class="hs-comment">--</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | A simple layout that arranges windows in a row or a column with equal sizes.</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- It can switch between row mode and column mode by listening to the message 'SwitchOrientation'.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">newtype</span><span> </span><span id="RowsOrColumns"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-var">RowsOrColumns</span></a></span></span><span> </span><span id="local-6989586621679409490"><span class="annot"><a href="#local-6989586621679409490"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RowsOrColumns"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-var">RowsOrColumns</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="rowMode"><span class="annot"><span class="annottext">RowsOrColumns a -&gt; Bool
</span><a href="XMonad.Layout.TallMastersCombo.html#rowMode"><span class="hs-identifier hs-var hs-var">rowMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ arrange windows in rows or columns</span><span>
</span><span id="line-138"></span><span>                                        </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409272"><span id="local-6989586621679409274"><span id="local-6989586621679409276"><span class="annot"><span class="annottext">Int -&gt; RowsOrColumns a -&gt; ShowS
[RowsOrColumns a] -&gt; ShowS
RowsOrColumns a -&gt; String
(Int -&gt; RowsOrColumns a -&gt; ShowS)
-&gt; (RowsOrColumns a -&gt; String)
-&gt; ([RowsOrColumns a] -&gt; ShowS)
-&gt; Show (RowsOrColumns a)
forall a. Int -&gt; RowsOrColumns a -&gt; ShowS
forall a. [RowsOrColumns a] -&gt; ShowS
forall a. RowsOrColumns a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [RowsOrColumns a] -&gt; ShowS
$cshowList :: forall a. [RowsOrColumns a] -&gt; ShowS
show :: RowsOrColumns a -&gt; String
$cshow :: forall a. RowsOrColumns a -&gt; String
showsPrec :: Int -&gt; RowsOrColumns a -&gt; ShowS
$cshowsPrec :: forall a. Int -&gt; RowsOrColumns a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409263"><span id="local-6989586621679409265"><span id="local-6989586621679409267"><span id="local-6989586621679409269"><span class="annot"><span class="annottext">ReadPrec [RowsOrColumns a]
ReadPrec (RowsOrColumns a)
Int -&gt; ReadS (RowsOrColumns a)
ReadS [RowsOrColumns a]
(Int -&gt; ReadS (RowsOrColumns a))
-&gt; ReadS [RowsOrColumns a]
-&gt; ReadPrec (RowsOrColumns a)
-&gt; ReadPrec [RowsOrColumns a]
-&gt; Read (RowsOrColumns a)
forall a. ReadPrec [RowsOrColumns a]
forall a. ReadPrec (RowsOrColumns a)
forall a. Int -&gt; ReadS (RowsOrColumns a)
forall a. ReadS [RowsOrColumns a]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [RowsOrColumns a]
$creadListPrec :: forall a. ReadPrec [RowsOrColumns a]
readPrec :: ReadPrec (RowsOrColumns a)
$creadPrec :: forall a. ReadPrec (RowsOrColumns a)
readList :: ReadS [RowsOrColumns a]
$creadList :: forall a. ReadS [RowsOrColumns a]
readsPrec :: Int -&gt; ReadS (RowsOrColumns a)
$creadsPrec :: forall a. Int -&gt; ReadS (RowsOrColumns a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679409261"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679409250"><span id="local-6989586621679409252"><span id="local-6989586621679409255"><span id="local-6989586621679409257"><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-type">RowsOrColumns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409261"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679409246"><span class="annot"><span class="annottext">description :: RowsOrColumns a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">description</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-type">RowsOrColumns</span></a></span><span> </span><span id="local-6989586621679409244"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409244"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409244"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Rows&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Columns&quot;</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>  </span><span id="local-6989586621679409243"><span class="annot"><span class="annottext">pureLayout :: RowsOrColumns a -&gt; Rectangle -&gt; Stack a -&gt; [(a, Rectangle)]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pureLayout</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-type">RowsOrColumns</span></a></span><span> </span><span id="local-6989586621679409241"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409241"><span class="hs-identifier hs-var">rows</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679409240"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409240"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679409239"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679409239"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [Rectangle] -&gt; [(a, Rectangle)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679409238"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679409237"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679409238"><span class="annot"><span class="annottext">ws :: [a]
</span><a href="#local-6989586621679409238"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679409239"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-146"></span><span>          </span><span id="local-6989586621679409235"><span class="annot"><span class="annottext">len :: Int
</span><a href="#local-6989586621679409235"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679409238"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-147"></span><span>          </span><span id="local-6989586621679409237"><span class="annot"><span class="annottext">rs :: [Rectangle]
</span><a href="#local-6989586621679409237"><span class="hs-identifier hs-var hs-var">rs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409241"><span class="hs-identifier hs-var">rows</span></a></span><span>
</span><span id="line-148"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rectangle -&gt; [Rectangle]
</span><span class="hs-identifier hs-var">splitVertically</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409235"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409240"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-149"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rectangle -&gt; [Rectangle]
</span><span class="hs-identifier hs-var">splitHorizontally</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409235"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409240"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span>  </span><span id="local-6989586621679409231"><span class="annot"><span class="annottext">pureMessage :: RowsOrColumns a -&gt; SomeMessage -&gt; Maybe (RowsOrColumns a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">pureMessage</span></span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-type">RowsOrColumns</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span id="local-6989586621679409229"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409229"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Orientation
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409229"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RowsOrColumns a -&gt; Maybe (RowsOrColumns a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RowsOrColumns a -&gt; Maybe (RowsOrColumns a))
-&gt; RowsOrColumns a -&gt; Maybe (RowsOrColumns a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RowsOrColumns a
forall a. Bool -&gt; RowsOrColumns a
</span><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-var">RowsOrColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Orientation
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409229"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RowsOrColumns a -&gt; Maybe (RowsOrColumns a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(RowsOrColumns a -&gt; Maybe (RowsOrColumns a))
-&gt; RowsOrColumns a -&gt; Maybe (RowsOrColumns a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; RowsOrColumns a
forall a. Bool -&gt; RowsOrColumns a
</span><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-var">RowsOrColumns</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (RowsOrColumns a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-keyword">data</span><span> </span><span id="TMSCombineTwo"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span></span><span> </span><span id="local-6989586621679409451"><span class="annot"><a href="#local-6989586621679409451"><span class="hs-identifier hs-type">l1</span></a></span></span><span> </span><span id="local-6989586621679409450"><span class="annot"><a href="#local-6989586621679409450"><span class="hs-identifier hs-type">l2</span></a></span></span><span> </span><span id="local-6989586621679409452"><span class="annot"><a href="#local-6989586621679409452"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>  </span><span id="TMSCombineTwo"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="focusLst"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; [a]
</span><a href="XMonad.Layout.TallMastersCombo.html#focusLst"><span class="hs-identifier hs-var hs-var">focusLst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409452"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-159"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="ws1"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; [a]
</span><a href="XMonad.Layout.TallMastersCombo.html#ws1"><span class="hs-identifier hs-var hs-var">ws1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409452"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="ws2"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; [a]
</span><a href="XMonad.Layout.TallMastersCombo.html#ws2"><span class="hs-identifier hs-var hs-var">ws2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409452"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-161"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="rowMod"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; Bool
</span><a href="XMonad.Layout.TallMastersCombo.html#rowMod"><span class="hs-identifier hs-var hs-var">rowMod</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ merge two layouts in a column or a row</span><span>
</span><span id="line-162"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="nMaster"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; Int
</span><a href="XMonad.Layout.TallMastersCombo.html#nMaster"><span class="hs-identifier hs-var hs-var">nMaster</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>     </span><span class="hs-comment">-- ^ number of windows in the master pane</span><span>
</span><span id="line-163"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="rationInc"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; Rational
</span><a href="XMonad.Layout.TallMastersCombo.html#rationInc"><span class="hs-identifier hs-var hs-var">rationInc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-comment">-- ^ percent of screen to increment by when resizing panes</span><span>
</span><span id="line-164"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="tallComboRatio"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; Rational
</span><a href="XMonad.Layout.TallMastersCombo.html#tallComboRatio"><span class="hs-identifier hs-var hs-var">tallComboRatio</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-comment">-- ^ default proportion of screen occupied by master pane</span><span>
</span><span id="line-165"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="layoutFst"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; l1 a
</span><a href="XMonad.Layout.TallMastersCombo.html#layoutFst"><span class="hs-identifier hs-var hs-var">layoutFst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679409451"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409452"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ layout for the master pane</span><span>
</span><span id="line-166"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="layoutSnd"><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#layoutSnd"><span class="hs-identifier hs-var hs-var">layoutSnd</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679409450"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409452"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ layout for the second pane</span><span>
</span><span id="line-167"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409210"><span id="local-6989586621679409212"><span id="local-6989586621679409214"><span class="annot"><span class="annottext">Int -&gt; TMSCombineTwo l1 l2 a -&gt; ShowS
[TMSCombineTwo l1 l2 a] -&gt; ShowS
TMSCombineTwo l1 l2 a -&gt; String
(Int -&gt; TMSCombineTwo l1 l2 a -&gt; ShowS)
-&gt; (TMSCombineTwo l1 l2 a -&gt; String)
-&gt; ([TMSCombineTwo l1 l2 a] -&gt; ShowS)
-&gt; Show (TMSCombineTwo l1 l2 a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show (l1 a), Show (l2 a)) =&gt;
Int -&gt; TMSCombineTwo l1 l2 a -&gt; ShowS
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show (l1 a), Show (l2 a)) =&gt;
[TMSCombineTwo l1 l2 a] -&gt; ShowS
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show (l1 a), Show (l2 a)) =&gt;
TMSCombineTwo l1 l2 a -&gt; String
showList :: [TMSCombineTwo l1 l2 a] -&gt; ShowS
$cshowList :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show (l1 a), Show (l2 a)) =&gt;
[TMSCombineTwo l1 l2 a] -&gt; ShowS
show :: TMSCombineTwo l1 l2 a -&gt; String
$cshow :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show (l1 a), Show (l2 a)) =&gt;
TMSCombineTwo l1 l2 a -&gt; String
showsPrec :: Int -&gt; TMSCombineTwo l1 l2 a -&gt; ShowS
$cshowsPrec :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Show a, Show (l1 a), Show (l2 a)) =&gt;
Int -&gt; TMSCombineTwo l1 l2 a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409202"><span id="local-6989586621679409204"><span id="local-6989586621679409206"><span id="local-6989586621679409208"><span class="annot"><span class="annottext">ReadPrec [TMSCombineTwo l1 l2 a]
ReadPrec (TMSCombineTwo l1 l2 a)
Int -&gt; ReadS (TMSCombineTwo l1 l2 a)
ReadS [TMSCombineTwo l1 l2 a]
(Int -&gt; ReadS (TMSCombineTwo l1 l2 a))
-&gt; ReadS [TMSCombineTwo l1 l2 a]
-&gt; ReadPrec (TMSCombineTwo l1 l2 a)
-&gt; ReadPrec [TMSCombineTwo l1 l2 a]
-&gt; Read (TMSCombineTwo l1 l2 a)
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec [TMSCombineTwo l1 l2 a]
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec (TMSCombineTwo l1 l2 a)
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
Int -&gt; ReadS (TMSCombineTwo l1 l2 a)
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
ReadS [TMSCombineTwo l1 l2 a]
readListPrec :: ReadPrec [TMSCombineTwo l1 l2 a]
$creadListPrec :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec [TMSCombineTwo l1 l2 a]
readPrec :: ReadPrec (TMSCombineTwo l1 l2 a)
$creadPrec :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
ReadPrec (TMSCombineTwo l1 l2 a)
readList :: ReadS [TMSCombineTwo l1 l2 a]
$creadList :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
ReadS [TMSCombineTwo l1 l2 a]
readsPrec :: Int -&gt; ReadS (TMSCombineTwo l1 l2 a)
$creadsPrec :: forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
(Read a, Read (l1 a), Read (l2 a)) =&gt;
Int -&gt; ReadS (TMSCombineTwo l1 l2 a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Combine two layouts l1 l2 with default behaviors.</span><span>
</span><span id="line-171"></span><span id="local-6989586621679409200"><span id="local-6989586621679409201"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#tmsCombineTwoDefault"><span class="hs-identifier hs-type">tmsCombineTwoDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409201"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409200"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-172"></span><span>                          </span><span class="annot"><a href="#local-6989586621679409201"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409200"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409201"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409200"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span></span></span><span>
</span><span id="line-173"></span><span id="tmsCombineTwoDefault"><span class="annot"><span class="annottext">tmsCombineTwoDefault :: l1 Window -&gt; l2 Window -&gt; TMSCombineTwo l1 l2 Window
</span><a href="XMonad.Layout.TallMastersCombo.html#tmsCombineTwoDefault"><span class="hs-identifier hs-var hs-var">tmsCombineTwoDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">3</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | A more flexible way of merging two layouts. User can specify if merge them vertical or horizontal,</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- the number of windows in the first pane (master pane), the shink and expand increment, and the proportion</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- occupied by the master pane.</span><span>
</span><span id="line-178"></span><span id="local-6989586621679409197"><span id="local-6989586621679409198"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#tmsCombineTwo"><span class="hs-identifier hs-type">tmsCombineTwo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409198"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409197"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-179"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409198"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409197"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409198"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409197"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span></span></span><span>
</span><span id="line-180"></span><span id="tmsCombineTwo"><span class="annot"><span class="annottext">tmsCombineTwo :: Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
</span><a href="XMonad.Layout.TallMastersCombo.html#tmsCombineTwo"><span class="hs-identifier hs-var hs-var">tmsCombineTwo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-keyword">data</span><span> </span><span id="Orientation"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#Orientation"><span class="hs-identifier hs-var">Orientation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Row"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Col"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409189"><span id="local-6989586621679409191"><span id="local-6989586621679409193"><span id="local-6989586621679409195"><span class="annot"><span class="annottext">ReadPrec [Orientation]
ReadPrec Orientation
Int -&gt; ReadS Orientation
ReadS [Orientation]
(Int -&gt; ReadS Orientation)
-&gt; ReadS [Orientation]
-&gt; ReadPrec Orientation
-&gt; ReadPrec [Orientation]
-&gt; Read Orientation
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Orientation]
$creadListPrec :: ReadPrec [Orientation]
readPrec :: ReadPrec Orientation
$creadPrec :: ReadPrec Orientation
readList :: ReadS [Orientation]
$creadList :: ReadS [Orientation]
readsPrec :: Int -&gt; ReadS Orientation
$creadsPrec :: Int -&gt; ReadS Orientation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409183"><span id="local-6989586621679409185"><span id="local-6989586621679409187"><span class="annot"><span class="annottext">Int -&gt; Orientation -&gt; ShowS
[Orientation] -&gt; ShowS
Orientation -&gt; String
(Int -&gt; Orientation -&gt; ShowS)
-&gt; (Orientation -&gt; String)
-&gt; ([Orientation] -&gt; ShowS)
-&gt; Show Orientation
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Orientation] -&gt; ShowS
$cshowList :: [Orientation] -&gt; ShowS
show :: Orientation -&gt; String
$cshow :: Orientation -&gt; String
showsPrec :: Int -&gt; Orientation -&gt; ShowS
$cshowsPrec :: Int -&gt; Orientation -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#Orientation"><span class="hs-identifier hs-type">Orientation</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | A message that switches the orientation of TallMasterCombo layout and the RowsOrColumns layout.</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- This is similar to the 'Mirror' message, but 'Mirror' cannot apply to hidden layouts, and when 'Mirror'</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- applies to the 'XMonad.Layout.Tabbed' decoration, it will also mirror the tabs, which may lead to unintended</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- visualizations. The 'SwitchOrientation' message refreshes layouts according to the orientation of the parent layout,</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- and will not affect the 'XMonad.Layout.Tabbed' decoration.</span><span>
</span><span id="line-190"></span><span class="hs-keyword">data</span><span> </span><span id="SwitchOrientation"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwitchOrientation"><span class="hs-identifier hs-var">SwitchOrientation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SwitchOrientation"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwitchOrientation"><span class="hs-identifier hs-var">SwitchOrientation</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409172"><span id="local-6989586621679409174"><span id="local-6989586621679409176"><span id="local-6989586621679409178"><span class="annot"><span class="annottext">ReadPrec [SwitchOrientation]
ReadPrec SwitchOrientation
Int -&gt; ReadS SwitchOrientation
ReadS [SwitchOrientation]
(Int -&gt; ReadS SwitchOrientation)
-&gt; ReadS [SwitchOrientation]
-&gt; ReadPrec SwitchOrientation
-&gt; ReadPrec [SwitchOrientation]
-&gt; Read SwitchOrientation
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [SwitchOrientation]
$creadListPrec :: ReadPrec [SwitchOrientation]
readPrec :: ReadPrec SwitchOrientation
$creadPrec :: ReadPrec SwitchOrientation
readList :: ReadS [SwitchOrientation]
$creadList :: ReadS [SwitchOrientation]
readsPrec :: Int -&gt; ReadS SwitchOrientation
$creadsPrec :: Int -&gt; ReadS SwitchOrientation
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409166"><span id="local-6989586621679409168"><span id="local-6989586621679409170"><span class="annot"><span class="annottext">Int -&gt; SwitchOrientation -&gt; ShowS
[SwitchOrientation] -&gt; ShowS
SwitchOrientation -&gt; String
(Int -&gt; SwitchOrientation -&gt; ShowS)
-&gt; (SwitchOrientation -&gt; String)
-&gt; ([SwitchOrientation] -&gt; ShowS)
-&gt; Show SwitchOrientation
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SwitchOrientation] -&gt; ShowS
$cshowList :: [SwitchOrientation] -&gt; ShowS
show :: SwitchOrientation -&gt; String
$cshow :: SwitchOrientation -&gt; String
showsPrec :: Int -&gt; SwitchOrientation -&gt; ShowS
$cshowsPrec :: Int -&gt; SwitchOrientation -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwitchOrientation"><span class="hs-identifier hs-type">SwitchOrientation</span></a></span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | This message swaps the current focused window with the sub master window (first window in the second pane).</span><span>
</span><span id="line-194"></span><span class="hs-keyword">data</span><span> </span><span id="SwapSubMaster"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwapSubMaster"><span class="hs-identifier hs-var">SwapSubMaster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SwapSubMaster"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwapSubMaster"><span class="hs-identifier hs-var">SwapSubMaster</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409156"><span id="local-6989586621679409158"><span id="local-6989586621679409160"><span id="local-6989586621679409162"><span class="annot"><span class="annottext">ReadPrec [SwapSubMaster]
ReadPrec SwapSubMaster
Int -&gt; ReadS SwapSubMaster
ReadS [SwapSubMaster]
(Int -&gt; ReadS SwapSubMaster)
-&gt; ReadS [SwapSubMaster]
-&gt; ReadPrec SwapSubMaster
-&gt; ReadPrec [SwapSubMaster]
-&gt; Read SwapSubMaster
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [SwapSubMaster]
$creadListPrec :: ReadPrec [SwapSubMaster]
readPrec :: ReadPrec SwapSubMaster
$creadPrec :: ReadPrec SwapSubMaster
readList :: ReadS [SwapSubMaster]
$creadList :: ReadS [SwapSubMaster]
readsPrec :: Int -&gt; ReadS SwapSubMaster
$creadsPrec :: Int -&gt; ReadS SwapSubMaster
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409150"><span id="local-6989586621679409152"><span id="local-6989586621679409154"><span class="annot"><span class="annottext">Int -&gt; SwapSubMaster -&gt; ShowS
[SwapSubMaster] -&gt; ShowS
SwapSubMaster -&gt; String
(Int -&gt; SwapSubMaster -&gt; ShowS)
-&gt; (SwapSubMaster -&gt; String)
-&gt; ([SwapSubMaster] -&gt; ShowS)
-&gt; Show SwapSubMaster
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SwapSubMaster] -&gt; ShowS
$cshowList :: [SwapSubMaster] -&gt; ShowS
show :: SwapSubMaster -&gt; String
$cshow :: SwapSubMaster -&gt; String
showsPrec :: Int -&gt; SwapSubMaster -&gt; ShowS
$cshowsPrec :: Int -&gt; SwapSubMaster -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#SwapSubMaster"><span class="hs-identifier hs-type">SwapSubMaster</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | This message changes the focus to the sub master window (first window in the second pane).</span><span>
</span><span id="line-198"></span><span class="hs-keyword">data</span><span> </span><span id="FocusSubMaster"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusSubMaster"><span class="hs-identifier hs-var">FocusSubMaster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FocusSubMaster"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusSubMaster"><span class="hs-identifier hs-var">FocusSubMaster</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409140"><span id="local-6989586621679409142"><span id="local-6989586621679409144"><span id="local-6989586621679409146"><span class="annot"><span class="annottext">ReadPrec [FocusSubMaster]
ReadPrec FocusSubMaster
Int -&gt; ReadS FocusSubMaster
ReadS [FocusSubMaster]
(Int -&gt; ReadS FocusSubMaster)
-&gt; ReadS [FocusSubMaster]
-&gt; ReadPrec FocusSubMaster
-&gt; ReadPrec [FocusSubMaster]
-&gt; Read FocusSubMaster
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [FocusSubMaster]
$creadListPrec :: ReadPrec [FocusSubMaster]
readPrec :: ReadPrec FocusSubMaster
$creadPrec :: ReadPrec FocusSubMaster
readList :: ReadS [FocusSubMaster]
$creadList :: ReadS [FocusSubMaster]
readsPrec :: Int -&gt; ReadS FocusSubMaster
$creadsPrec :: Int -&gt; ReadS FocusSubMaster
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409134"><span id="local-6989586621679409136"><span id="local-6989586621679409138"><span class="annot"><span class="annottext">Int -&gt; FocusSubMaster -&gt; ShowS
[FocusSubMaster] -&gt; ShowS
FocusSubMaster -&gt; String
(Int -&gt; FocusSubMaster -&gt; ShowS)
-&gt; (FocusSubMaster -&gt; String)
-&gt; ([FocusSubMaster] -&gt; ShowS)
-&gt; Show FocusSubMaster
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FocusSubMaster] -&gt; ShowS
$cshowList :: [FocusSubMaster] -&gt; ShowS
show :: FocusSubMaster -&gt; String
$cshow :: FocusSubMaster -&gt; String
showsPrec :: Int -&gt; FocusSubMaster -&gt; ShowS
$cshowsPrec :: Int -&gt; FocusSubMaster -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusSubMaster"><span class="hs-identifier hs-type">FocusSubMaster</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | This message triggers the 'NextLayout' message in the pane that contains the focused window.</span><span>
</span><span id="line-202"></span><span class="hs-keyword">data</span><span> </span><span id="FocusedNextLayout"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusedNextLayout"><span class="hs-identifier hs-var">FocusedNextLayout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FocusedNextLayout"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusedNextLayout"><span class="hs-identifier hs-var">FocusedNextLayout</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409124"><span id="local-6989586621679409126"><span id="local-6989586621679409128"><span id="local-6989586621679409130"><span class="annot"><span class="annottext">ReadPrec [FocusedNextLayout]
ReadPrec FocusedNextLayout
Int -&gt; ReadS FocusedNextLayout
ReadS [FocusedNextLayout]
(Int -&gt; ReadS FocusedNextLayout)
-&gt; ReadS [FocusedNextLayout]
-&gt; ReadPrec FocusedNextLayout
-&gt; ReadPrec [FocusedNextLayout]
-&gt; Read FocusedNextLayout
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [FocusedNextLayout]
$creadListPrec :: ReadPrec [FocusedNextLayout]
readPrec :: ReadPrec FocusedNextLayout
$creadPrec :: ReadPrec FocusedNextLayout
readList :: ReadS [FocusedNextLayout]
$creadList :: ReadS [FocusedNextLayout]
readsPrec :: Int -&gt; ReadS FocusedNextLayout
$creadsPrec :: Int -&gt; ReadS FocusedNextLayout
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409118"><span id="local-6989586621679409120"><span id="local-6989586621679409122"><span class="annot"><span class="annottext">Int -&gt; FocusedNextLayout -&gt; ShowS
[FocusedNextLayout] -&gt; ShowS
FocusedNextLayout -&gt; String
(Int -&gt; FocusedNextLayout -&gt; ShowS)
-&gt; (FocusedNextLayout -&gt; String)
-&gt; ([FocusedNextLayout] -&gt; ShowS)
-&gt; Show FocusedNextLayout
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [FocusedNextLayout] -&gt; ShowS
$cshowList :: [FocusedNextLayout] -&gt; ShowS
show :: FocusedNextLayout -&gt; String
$cshow :: FocusedNextLayout -&gt; String
showsPrec :: Int -&gt; FocusedNextLayout -&gt; ShowS
$cshowsPrec :: Int -&gt; FocusedNextLayout -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#FocusedNextLayout"><span class="hs-identifier hs-type">FocusedNextLayout</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | This is a message for changing to the previous or next focused window across all the sub-layouts.</span><span>
</span><span id="line-206"></span><span class="hs-keyword">data</span><span> </span><span id="ChangeFocus"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChangeFocus"><span class="hs-identifier hs-var">ChangeFocus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NextFocus"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#NextFocus"><span class="hs-identifier hs-var">NextFocus</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="PrevFocus"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#PrevFocus"><span class="hs-identifier hs-var">PrevFocus</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409107"><span id="local-6989586621679409109"><span id="local-6989586621679409111"><span id="local-6989586621679409113"><span class="annot"><span class="annottext">ReadPrec [ChangeFocus]
ReadPrec ChangeFocus
Int -&gt; ReadS ChangeFocus
ReadS [ChangeFocus]
(Int -&gt; ReadS ChangeFocus)
-&gt; ReadS [ChangeFocus]
-&gt; ReadPrec ChangeFocus
-&gt; ReadPrec [ChangeFocus]
-&gt; Read ChangeFocus
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [ChangeFocus]
$creadListPrec :: ReadPrec [ChangeFocus]
readPrec :: ReadPrec ChangeFocus
$creadPrec :: ReadPrec ChangeFocus
readList :: ReadS [ChangeFocus]
$creadList :: ReadS [ChangeFocus]
readsPrec :: Int -&gt; ReadS ChangeFocus
$creadsPrec :: Int -&gt; ReadS ChangeFocus
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409101"><span id="local-6989586621679409103"><span id="local-6989586621679409105"><span class="annot"><span class="annottext">Int -&gt; ChangeFocus -&gt; ShowS
[ChangeFocus] -&gt; ShowS
ChangeFocus -&gt; String
(Int -&gt; ChangeFocus -&gt; ShowS)
-&gt; (ChangeFocus -&gt; String)
-&gt; ([ChangeFocus] -&gt; ShowS)
-&gt; Show ChangeFocus
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ChangeFocus] -&gt; ShowS
$cshowList :: [ChangeFocus] -&gt; ShowS
show :: ChangeFocus -&gt; String
$cshow :: ChangeFocus -&gt; String
showsPrec :: Int -&gt; ChangeFocus -&gt; ShowS
$cshowsPrec :: Int -&gt; ChangeFocus -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChangeFocus"><span class="hs-identifier hs-type">ChangeFocus</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- instance (Typeable l1, Typeable l2, LayoutClass l1 Window, LayoutClass l2 Window) =&gt; LayoutClass (TMSCombineTwo l1 l2) Window where</span><span>
</span><span id="line-210"></span><span id="local-6989586621679409098"><span id="local-6989586621679409099"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679409086"><span id="local-6989586621679409089"><span id="local-6989586621679409091"><span id="local-6989586621679409093"><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409099"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409098"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409099"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409098"><span class="hs-identifier hs-type">l2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="local-6989586621679409084"><span class="annot"><span class="annottext">description :: TMSCombineTwo l1 l2 Window -&gt; String
</span><a href="#local-6989586621679409084"><span class="hs-identifier hs-var hs-var hs-var hs-var">description</span></a></span></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TallMasters&quot;</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679409083"><span class="annot"><span class="annottext">runLayout :: Workspace String (TMSCombineTwo l1 l2 Window) Window
-&gt; Rectangle
-&gt; X ([(Window, Rectangle)], Maybe (TMSCombineTwo l1 l2 Window))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">runLayout</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Workspace</span></span><span> </span><span id="local-6989586621679409080"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679409080"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span id="local-6989586621679409079"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409079"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679409078"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409078"><span class="hs-identifier hs-var">vsp</span></a></span></span><span> </span><span id="local-6989586621679409077"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409077"><span class="hs-identifier hs-var">nmaster</span></a></span></span><span> </span><span id="local-6989586621679409076"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409076"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span id="local-6989586621679409075"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409075"><span class="hs-identifier hs-var">frac</span></a></span></span><span> </span><span id="local-6989586621679409074"><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409074"><span class="hs-identifier hs-var">layout1</span></a></span></span><span> </span><span id="local-6989586621679409073"><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409073"><span class="hs-identifier hs-var">layout2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679409072"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409072"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679409071"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409071"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679409070"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409070"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679409069"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409069"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679409068"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409068"><span class="hs-identifier hs-var">frac'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679409067"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409067"><span class="hs-identifier hs-var">slst1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679409066"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409066"><span class="hs-identifier hs-var">slst2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack Window)
-&gt; (Maybe (Stack Window), Maybe (Stack Window), Rational, [Window],
    [Window])
forall a.
Eq a =&gt;
[a]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack a)
-&gt; (Maybe (Stack a), Maybe (Stack a), Rational, [a], [a])
</span><a href="XMonad.Layout.TallMastersCombo.html#splitStack"><span class="hs-identifier hs-var">splitStack</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409079"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409077"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409075"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409072"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-215"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679409064"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409064"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409063"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409063"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409078"><span class="hs-identifier hs-var">vsp</span></a></span><span>
</span><span id="line-216"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rectangle -&gt; (Rectangle, Rectangle)
forall r. RealFrac r =&gt; r -&gt; Rectangle -&gt; (Rectangle, Rectangle)
</span><span class="hs-identifier hs-var">splitHorizontallyBy</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409068"><span class="hs-identifier hs-var">frac'</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409071"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-217"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rectangle -&gt; (Rectangle, Rectangle)
forall r. RealFrac r =&gt; r -&gt; Rectangle -&gt; (Rectangle, Rectangle)
</span><span class="hs-identifier hs-var">splitVerticallyBy</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409068"><span class="hs-identifier hs-var">frac'</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409071"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="hs-keyword">in</span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-keyword">do</span><span>
</span><span id="line-220"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679409060"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679409060"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409059"><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679409059"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Workspace String (l1 Window) Window
-&gt; Rectangle -&gt; X ([(Window, Rectangle)], Maybe (l1 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; l1 Window
-&gt; Maybe (Stack Window)
-&gt; Workspace String (l1 Window) Window
forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679409080"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409074"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409070"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409064"><span class="hs-identifier hs-var">r1</span></a></span><span>
</span><span id="line-221"></span><span>         </span><span class="hs-special">(</span><span id="local-6989586621679409058"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679409058"><span class="hs-identifier hs-var">ws'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679409057"><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679409057"><span class="hs-identifier hs-var">ml'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Workspace String (l2 Window) Window
-&gt; Rectangle -&gt; X ([(Window, Rectangle)], Maybe (l2 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; l2 Window
-&gt; Maybe (Stack Window)
-&gt; Workspace String (l2 Window) Window
forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679409080"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409073"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409069"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679409063"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-222"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409056"><span class="annot"><span class="annottext">newlayout1 :: l1 Window
</span><a href="#local-6989586621679409056"><span class="hs-identifier hs-var hs-var">newlayout1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; Maybe (l1 Window) -&gt; l1 Window
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409074"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679409059"><span class="hs-identifier hs-var">ml</span></a></span><span>
</span><span id="line-223"></span><span>             </span><span id="local-6989586621679409055"><span class="annot"><span class="annottext">newlayout2 :: l2 Window
</span><a href="#local-6989586621679409055"><span class="hs-identifier hs-var hs-var">newlayout2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; Maybe (l2 Window) -&gt; l2 Window
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409073"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679409057"><span class="hs-identifier hs-var">ml'</span></a></span><span>
</span><span id="line-224"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621679409054"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409054"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; Maybe (Stack Window) -&gt; ([Window], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409056"><span class="hs-identifier hs-var">newlayout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409070"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-225"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621679409052"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409052"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; Maybe (Stack Window) -&gt; ([Window], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409055"><span class="hs-identifier hs-var">newlayout2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409069"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-226"></span><span>             </span><span id="local-6989586621679409051"><span class="annot"><span class="annottext">fnew :: [Window]
</span><a href="#local-6989586621679409051"><span class="hs-identifier hs-var hs-var">fnew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409054"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [Window] -&gt; [Window]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409052"><span class="hs-identifier hs-var">f2</span></a></span><span>
</span><span id="line-227"></span><span>         </span><span class="annot"><span class="annottext">([(Window, Rectangle)], Maybe (TMSCombineTwo l1 l2 Window))
-&gt; X ([(Window, Rectangle)], Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679409060"><span class="hs-identifier hs-var">ws</span></a></span><span class="annot"><span class="annottext">[(Window, Rectangle)]
-&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679409058"><span class="hs-identifier hs-var">ws'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window -&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMSCombineTwo l1 l2 Window -&gt; Maybe (TMSCombineTwo l1 l2 Window))
-&gt; TMSCombineTwo l1 l2 Window -&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409051"><span class="hs-identifier hs-var">fnew</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409067"><span class="hs-identifier hs-var">slst1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409066"><span class="hs-identifier hs-var">slst2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409078"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409077"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409076"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409075"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409056"><span class="hs-identifier hs-var">newlayout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409055"><span class="hs-identifier hs-var">newlayout2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679409050"><span class="annot"><span class="annottext">handleMessage :: TMSCombineTwo l1 l2 Window
-&gt; SomeMessage -&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">handleMessage</span></span></span><span> </span><span id="local-6989586621679409048"><span class="annot"><span class="annottext">i :: TMSCombineTwo l1 l2 Window
</span><a href="#local-6989586621679409048"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span id="local-6989586621679409047"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679409046"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621679409045"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span id="local-6989586621679409044"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span></span><span> </span><span id="local-6989586621679409043"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span></span><span> </span><span id="local-6989586621679409042"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span id="local-6989586621679409041"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span></span><span> </span><span id="local-6989586621679409040"><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span></span><span> </span><span id="local-6989586621679409039"><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679409038"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- messages that only traverse one level</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Resize
</span><span class="hs-identifier hs-var">Shrink</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Resize
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; (TMSCombineTwo l1 l2 Window
    -&gt; Maybe (TMSCombineTwo l1 l2 Window))
-&gt; TMSCombineTwo l1 l2 Window
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window -&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMSCombineTwo l1 l2 Window
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; TMSCombineTwo l1 l2 Window
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Rational) -&gt; Rational -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Resize
</span><span class="hs-identifier hs-var">Expand</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Resize
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; (TMSCombineTwo l1 l2 Window
    -&gt; Maybe (TMSCombineTwo l1 l2 Window))
-&gt; TMSCombineTwo l1 l2 Window
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window -&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMSCombineTwo l1 l2 Window
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; TMSCombineTwo l1 l2 Window
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Rational) -&gt; Rational -&gt; Rational
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IncMasterN</span></span><span> </span><span id="local-6989586621679409030"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409030"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe IncMasterN
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409029"><span class="annot"><span class="annottext">w :: [Window]
</span><a href="#local-6989586621679409029"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span class="annot"><span class="annottext">[Window] -&gt; [Window] -&gt; [Window]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-236"></span><span>            </span><span id="local-6989586621679409028"><span class="annot"><span class="annottext">nmasterNew :: Int
</span><a href="#local-6989586621679409028"><span class="hs-identifier hs-var hs-var">nmasterNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409030"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Window] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409029"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679409027"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409027"><span class="hs-identifier hs-var">w1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679409026"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409026"><span class="hs-identifier hs-var">w2'</span></a></span></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Window] -&gt; ([Window], [Window])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409028"><span class="hs-identifier hs-var">nmasterNew</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409029"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; (TMSCombineTwo l1 l2 Window
    -&gt; Maybe (TMSCombineTwo l1 l2 Window))
-&gt; TMSCombineTwo l1 l2 Window
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window -&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMSCombineTwo l1 l2 Window
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; TMSCombineTwo l1 l2 Window
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409027"><span class="hs-identifier hs-var">w1'</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409026"><span class="hs-identifier hs-var">w2'</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409028"><span class="hs-identifier hs-var">nmasterNew</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SwitchOrientation
</span><a href="XMonad.Layout.TallMastersCombo.html#SwitchOrientation"><span class="hs-identifier hs-var">SwitchOrientation</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe SwitchOrientation
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-240"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409024"><span class="annot"><span class="annottext">m1 :: SomeMessage
</span><a href="#local-6989586621679409024"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span>
</span><span id="line-241"></span><span>            </span><span class="hs-keyword">in</span><span>
</span><span id="line-242"></span><span>            </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679409022"><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679409022"><span class="hs-identifier hs-var">mlayout1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; SomeMessage -&gt; X (Maybe (l1 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409024"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-243"></span><span>               </span><span id="local-6989586621679409021"><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679409021"><span class="hs-identifier hs-var">mlayout2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; SomeMessage -&gt; X (Maybe (l2 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409024"><span class="hs-identifier hs-var">m1</span></a></span><span>
</span><span id="line-244"></span><span>               </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
-&gt; Maybe (l2 Window)
-&gt; TMSCombineTwo l1 l2 Window
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *).
Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var">mergeSubLayouts</span></a></span><span>  </span><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679409022"><span class="hs-identifier hs-var">mlayout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679409021"><span class="hs-identifier hs-var">mlayout2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">SwapSubMaster
</span><a href="XMonad.Layout.TallMastersCombo.html#SwapSubMaster"><span class="hs-identifier hs-var">SwapSubMaster</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe SwapSubMaster
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-comment">-- first get the submaster window</span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409018"><span class="annot"><span class="annottext">subMaster :: Maybe Window
</span><a href="#local-6989586621679409018"><span class="hs-identifier hs-var hs-var">subMaster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe Window
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Maybe Window) -&gt; Window -&gt; Maybe Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Window
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-248"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679409018"><span class="hs-identifier hs-var">subMaster</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679409015"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679409015"><span class="hs-identifier hs-var">mw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (WindowSet -&gt; WindowSet) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet)
-&gt; (Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Stack Window -&gt; Stack Window
forall a. Eq a =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Layout.TallMastersCombo.html#swapWindow"><span class="hs-identifier hs-var">swapWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679409015"><span class="hs-identifier hs-var">mw</span></a></span><span>
</span><span id="line-250"></span><span>                          </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-251"></span><span>            </span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FocusSubMaster
</span><a href="XMonad.Layout.TallMastersCombo.html#FocusSubMaster"><span class="hs-identifier hs-var">FocusSubMaster</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe FocusSubMaster
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-comment">-- first get the submaster window</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409012"><span class="annot"><span class="annottext">subMaster :: Maybe Window
</span><a href="#local-6989586621679409012"><span class="hs-identifier hs-var hs-var">subMaster</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe Window
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Maybe Window) -&gt; Window -&gt; Maybe Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Window
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679409012"><span class="hs-identifier hs-var">subMaster</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-256"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679409011"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679409011"><span class="hs-identifier hs-var">mw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (WindowSet -&gt; WindowSet) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet)
-&gt; (Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Stack Window -&gt; Stack Window
forall a. Eq a =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Layout.TallMastersCombo.html#focusWindow"><span class="hs-identifier hs-var">focusWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679409011"><span class="hs-identifier hs-var">mw</span></a></span><span>
</span><span id="line-257"></span><span>                          </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-258"></span><span>            </span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ChangeFocus
</span><a href="XMonad.Layout.TallMastersCombo.html#NextFocus"><span class="hs-identifier hs-var">NextFocus</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe ChangeFocus
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-261"></span><span>          </span><span class="hs-comment">-- All toggle message is passed to the sublayout with focused window</span><span>
</span><span id="line-262"></span><span>          </span><span id="local-6989586621679409010"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409010"><span class="hs-identifier hs-var">mst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Maybe (Stack Window)) -&gt; X (Maybe (Stack Window))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Workspace String (Layout Window) Window -&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace String (Layout Window) Window -&gt; Maybe (Stack Window))
-&gt; (XState -&gt; Workspace String (Layout Window) Window)
-&gt; XState
-&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen String (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace String (Layout Window) Window
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen String (Layout Window) Window ScreenId ScreenDetail
 -&gt; Workspace String (Layout Window) Window)
-&gt; (XState
    -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; Workspace String (Layout Window) Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet
 -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; (XState -&gt; WindowSet)
-&gt; XState
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409004"><span class="annot"><span class="annottext">nextw :: Maybe Window
</span><a href="#local-6989586621679409004"><span class="hs-identifier hs-var hs-var">nextw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Maybe (Stack Window) -&gt; Bool -&gt; Maybe Window
forall a. Eq a =&gt; [a] -&gt; Maybe (Stack a) -&gt; Bool -&gt; Maybe a
</span><a href="XMonad.Layout.TallMastersCombo.html#adjFocus"><span class="hs-identifier hs-var">adjFocus</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409010"><span class="hs-identifier hs-var">mst</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-264"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679409004"><span class="hs-identifier hs-var">nextw</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-265"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679409002"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679409002"><span class="hs-identifier hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (WindowSet -&gt; WindowSet) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet)
-&gt; (Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Stack Window -&gt; Stack Window
forall a. Eq a =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Layout.TallMastersCombo.html#focusWindow"><span class="hs-identifier hs-var">focusWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679409002"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-266"></span><span>                                      </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ChangeFocus
</span><a href="XMonad.Layout.TallMastersCombo.html#PrevFocus"><span class="hs-identifier hs-var">PrevFocus</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe ChangeFocus
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>        </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>          </span><span class="hs-comment">-- All toggle message is passed to the sublayout with focused window</span><span>
</span><span id="line-270"></span><span>          </span><span id="local-6989586621679409001"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409001"><span class="hs-identifier hs-var">mst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Maybe (Stack Window)) -&gt; X (Maybe (Stack Window))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Workspace String (Layout Window) Window -&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace String (Layout Window) Window -&gt; Maybe (Stack Window))
-&gt; (XState -&gt; Workspace String (Layout Window) Window)
-&gt; XState
-&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen String (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace String (Layout Window) Window
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen String (Layout Window) Window ScreenId ScreenDetail
 -&gt; Workspace String (Layout Window) Window)
-&gt; (XState
    -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; Workspace String (Layout Window) Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet
 -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; (XState -&gt; WindowSet)
-&gt; XState
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679409000"><span class="annot"><span class="annottext">prevw :: Maybe Window
</span><a href="#local-6989586621679409000"><span class="hs-identifier hs-var hs-var">prevw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Maybe (Stack Window) -&gt; Bool -&gt; Maybe Window
forall a. Eq a =&gt; [a] -&gt; Maybe (Stack a) -&gt; Bool -&gt; Maybe a
</span><a href="XMonad.Layout.TallMastersCombo.html#adjFocus"><span class="hs-identifier hs-var">adjFocus</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679409001"><span class="hs-identifier hs-var">mst</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-272"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679409000"><span class="hs-identifier hs-var">prevw</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-273"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408999"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679408999"><span class="hs-identifier hs-var">w</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (WindowSet -&gt; WindowSet) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">((Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet)
-&gt; (Stack Window -&gt; Stack Window) -&gt; WindowSet -&gt; WindowSet
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Stack Window -&gt; Stack Window
forall a. Eq a =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Layout.TallMastersCombo.html#focusWindow"><span class="hs-identifier hs-var">focusWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679408999"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-274"></span><span>                                      </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- messages that traverse recursively</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Orientation
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679408998"><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408998"><span class="hs-identifier hs-var">mlayout1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; SomeMessage -&gt; X (Maybe (l1 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>           </span><span id="local-6989586621679408997"><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408997"><span class="hs-identifier hs-var">mlayout2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; SomeMessage -&gt; X (Maybe (l2 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>           </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
-&gt; Maybe (l2 Window)
-&gt; TMSCombineTwo l1 l2 Window
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *).
Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var">mergeSubLayouts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408998"><span class="hs-identifier hs-var">mlayout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408997"><span class="hs-identifier hs-var">mlayout2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe Orientation
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>        </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679408996"><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408996"><span class="hs-identifier hs-var">mlayout1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; SomeMessage -&gt; X (Maybe (l1 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>           </span><span id="local-6989586621679408995"><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408995"><span class="hs-identifier hs-var">mlayout2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; SomeMessage -&gt; X (Maybe (l2 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>           </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
-&gt; Maybe (l2 Window)
-&gt; TMSCombineTwo l1 l2 Window
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *).
Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var">mergeSubLayouts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408996"><span class="hs-identifier hs-var">mlayout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408995"><span class="hs-identifier hs-var">mlayout2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Window]
-&gt; [Window]
-&gt; [Window]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 Window
-&gt; l2 Window
-&gt; TMSCombineTwo l1 l2 Window
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409047"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679409043"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409042"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679409041"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">FocusedNextLayout
</span><a href="XMonad.Layout.TallMastersCombo.html#FocusedNextLayout"><span class="hs-identifier hs-var">FocusedNextLayout</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe FocusedNextLayout
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-285"></span><span>       </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>       </span><span class="hs-comment">-- All toggle message is passed to the sublayout with focused window</span><span>
</span><span id="line-287"></span><span>         </span><span id="local-6989586621679408994"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408994"><span class="hs-identifier hs-var">mst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Maybe (Stack Window)) -&gt; X (Maybe (Stack Window))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Workspace String (Layout Window) Window -&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(Workspace String (Layout Window) Window -&gt; Maybe (Stack Window))
-&gt; (XState -&gt; Workspace String (Layout Window) Window)
-&gt; XState
-&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen String (Layout Window) Window ScreenId ScreenDetail
-&gt; Workspace String (Layout Window) Window
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen String (Layout Window) Window ScreenId ScreenDetail
 -&gt; Workspace String (Layout Window) Window)
-&gt; (XState
    -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; Workspace String (Layout Window) Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet
 -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; (XState -&gt; WindowSet)
-&gt; XState
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408993"><span class="annot"><span class="annottext">focId :: Int
</span><a href="#local-6989586621679408993"><span class="hs-identifier hs-var hs-var">focId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; [Window] -&gt; [Window] -&gt; Int
forall a. Eq a =&gt; Maybe (Stack a) -&gt; [a] -&gt; [a] -&gt; Int
</span><a href="XMonad.Layout.TallMastersCombo.html#findFocused"><span class="hs-identifier hs-var">findFocused</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408994"><span class="hs-identifier hs-var">mst</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409046"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679409045"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-289"></span><span>             </span><span id="local-6989586621679408991"><span class="annot"><span class="annottext">m1 :: SomeMessage
</span><a href="#local-6989586621679408991"><span class="hs-identifier hs-var hs-var">m1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679409044"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Row"><span class="hs-identifier hs-var">Row</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Orientation -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">Orientation
</span><a href="XMonad.Layout.TallMastersCombo.html#Col"><span class="hs-identifier hs-var">Col</span></a></span><span>
</span><span id="line-290"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408993"><span class="hs-identifier hs-var">focId</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-291"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>                 </span><span id="local-6989586621679408990"><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408990"><span class="hs-identifier hs-var">mlay1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; [SomeMessage] -&gt; X (Maybe (l1 Window))
forall (l :: * -&gt; *) a.
LayoutClass l a =&gt;
l a -&gt; [SomeMessage] -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handleMessages"><span class="hs-identifier hs-var">handleMessages</span></a></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ChangeLayout -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">NextLayout</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408991"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-293"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408988"><span class="annot"><span class="annottext">mlay2 :: Maybe a
</span><a href="#local-6989586621679408988"><span class="hs-identifier hs-var hs-var">mlay2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-294"></span><span>                 </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
-&gt; Maybe (l2 Window)
-&gt; TMSCombineTwo l1 l2 Window
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *).
Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var">mergeSubLayouts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408990"><span class="hs-identifier hs-var">mlay1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
forall a. Maybe a
</span><a href="#local-6989586621679408988"><span class="hs-identifier hs-var">mlay2</span></a></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window
</span><a href="#local-6989586621679409048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-295"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408987"><span class="annot"><span class="annottext">mlay1 :: Maybe a
</span><a href="#local-6989586621679408987"><span class="hs-identifier hs-var hs-var">mlay1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-297"></span><span>                 </span><span id="local-6989586621679408986"><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408986"><span class="hs-identifier hs-var">mlay2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; [SomeMessage] -&gt; X (Maybe (l2 Window))
forall (l :: * -&gt; *) a.
LayoutClass l a =&gt;
l a -&gt; [SomeMessage] -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handleMessages"><span class="hs-identifier hs-var">handleMessages</span></a></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ChangeLayout -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">NextLayout</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408991"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-298"></span><span>                 </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
-&gt; Maybe (l2 Window)
-&gt; TMSCombineTwo l1 l2 Window
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *).
Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var">mergeSubLayouts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
forall a. Maybe a
</span><a href="#local-6989586621679408987"><span class="hs-identifier hs-var">mlay1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408986"><span class="hs-identifier hs-var">mlay2</span></a></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window
</span><a href="#local-6989586621679409048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>            </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>              </span><span id="local-6989586621679408985"><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408985"><span class="hs-identifier hs-var">mlayout1</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l1 Window -&gt; SomeMessage -&gt; X (Maybe (l1 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l1 Window
</span><a href="#local-6989586621679409040"><span class="hs-identifier hs-var">layout1</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-302"></span><span>              </span><span id="local-6989586621679408984"><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408984"><span class="hs-identifier hs-var">mlayout2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l2 Window -&gt; SomeMessage -&gt; X (Maybe (l2 Window))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l2 Window
</span><a href="#local-6989586621679409039"><span class="hs-identifier hs-var">layout2</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679409038"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-303"></span><span>              </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (TMSCombineTwo l1 l2 Window)
 -&gt; X (Maybe (TMSCombineTwo l1 l2 Window)))
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
-&gt; X (Maybe (TMSCombineTwo l1 l2 Window))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
-&gt; Maybe (l2 Window)
-&gt; TMSCombineTwo l1 l2 Window
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 Window)
forall (l1 :: * -&gt; *) a (l2 :: * -&gt; *).
Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var">mergeSubLayouts</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 Window)
</span><a href="#local-6989586621679408985"><span class="hs-identifier hs-var">mlayout1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 Window)
</span><a href="#local-6989586621679408984"><span class="hs-identifier hs-var">mlayout2</span></a></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 Window
</span><a href="#local-6989586621679409048"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span></span></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="hs-comment">-- code from CombineTwo</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- given two sets of zs and xs takes the first z from zs that also belongs to xs</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- and turns xs into a stack with z being current element. Acts as</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- StackSet.differentiate if zs and xs don't intersect</span><span>
</span><span id="line-311"></span><span id="local-6989586621679409369"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-type">differentiate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679409369"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409369"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409369"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409369"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-312"></span><span id="differentiate"><span class="annot"><span class="annottext">differentiate :: [q] -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-var hs-var">differentiate</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408982"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679408982"><span class="hs-identifier hs-var">z</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679408981"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408981"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408980"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408980"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679408982"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">q -&gt; [q] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408980"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack q -&gt; Maybe (Stack q)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Stack q -&gt; Maybe (Stack q)) -&gt; Stack q -&gt; Maybe (Stack q)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack :: forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: q
</span><span class="hs-identifier hs-var">focus</span></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679408982"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-313"></span><span>                                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [q]
</span><span class="hs-identifier hs-var">up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; [q]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([q] -&gt; [q]) -&gt; [q] -&gt; [q]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(q -&gt; Bool) -&gt; [q] -&gt; [q]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">q -&gt; q -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679408982"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408980"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-314"></span><span>                                                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [q]
</span><span class="hs-identifier hs-var">down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; [q]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([q] -&gt; [q]) -&gt; [q] -&gt; [q]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(q -&gt; Bool) -&gt; [q] -&gt; [q]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">q -&gt; q -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679408982"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408980"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-315"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; [q] -&gt; Maybe (Stack q)
forall q. Eq q =&gt; [q] -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408981"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408980"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-316"></span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679408969"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408969"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[q] -&gt; Maybe (Stack q)
forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679408969"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-comment">-- | Swap a given window with the focused window.</span><span>
</span><span id="line-319"></span><span id="local-6989586621679409405"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#swapWindow"><span class="hs-identifier hs-type">swapWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679409405"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409405"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409405"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-320"></span><span id="swapWindow"><span class="annot"><span class="annottext">swapWindow :: a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Layout.TallMastersCombo.html#swapWindow"><span class="hs-identifier hs-var hs-var">swapWindow</span></a></span></span><span> </span><span id="local-6989586621679408967"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408967"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679408966"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408966"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408965"><span class="annot"><span class="annottext">upLst :: [a]
</span><a href="#local-6989586621679408965"><span class="hs-identifier hs-var hs-var">upLst</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408966"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span id="local-6989586621679408964"><span class="annot"><span class="annottext">foc :: a
</span><a href="#local-6989586621679408964"><span class="hs-identifier hs-var hs-var">foc</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; a
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408966"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679408963"><span class="annot"><span class="annottext">downLst :: [a]
</span><a href="#local-6989586621679408963"><span class="hs-identifier hs-var hs-var">downLst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408966"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408967"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408963"><span class="hs-identifier hs-var">downLst</span></a></span><span>
</span><span id="line-325"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408962"><span class="annot"><span class="annottext">us :: [a]
</span><a href="#local-6989586621679408962"><span class="hs-identifier hs-var hs-var">us</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408967"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408963"><span class="hs-identifier hs-var">downLst</span></a></span><span>
</span><span id="line-326"></span><span>              </span><span id="local-6989586621679408961"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408961"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679408960"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408960"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408967"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408963"><span class="hs-identifier hs-var">downLst</span></a></span><span>
</span><span id="line-327"></span><span>              </span><span id="local-6989586621679408959"><span class="annot"><span class="annottext">us' :: [a]
</span><a href="#local-6989586621679408959"><span class="hs-identifier hs-var hs-var">us'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408962"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408961"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408965"><span class="hs-identifier hs-var">upLst</span></a></span><span>
</span><span id="line-328"></span><span>          </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408964"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408959"><span class="hs-identifier hs-var">us'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408960"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-329"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408958"><span class="annot"><span class="annottext">ds :: [a]
</span><a href="#local-6989586621679408958"><span class="hs-identifier hs-var hs-var">ds</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408967"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408965"><span class="hs-identifier hs-var">upLst</span></a></span><span>
</span><span id="line-330"></span><span>              </span><span id="local-6989586621679408957"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408957"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679408956"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408956"><span class="hs-identifier hs-var">us</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; [a]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408967"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408965"><span class="hs-identifier hs-var">upLst</span></a></span><span>
</span><span id="line-331"></span><span>              </span><span id="local-6989586621679408955"><span class="annot"><span class="annottext">ds' :: [a]
</span><a href="#local-6989586621679408955"><span class="hs-identifier hs-var hs-var">ds'</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408958"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408957"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408963"><span class="hs-identifier hs-var">downLst</span></a></span><span>
</span><span id="line-332"></span><span>          </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408964"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408956"><span class="hs-identifier hs-var">us</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408955"><span class="hs-identifier hs-var">ds'</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="hs-comment">-- | Focus a given window.</span><span>
</span><span id="line-336"></span><span id="local-6989586621679408954"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#focusWindow"><span class="hs-identifier hs-type">focusWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679408954"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679408954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679408954"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679408954"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-337"></span><span id="focusWindow"><span class="annot"><span class="annottext">focusWindow :: a -&gt; Stack a -&gt; Stack a
</span><a href="XMonad.Layout.TallMastersCombo.html#focusWindow"><span class="hs-identifier hs-var hs-var">focusWindow</span></a></span></span><span> </span><span id="local-6989586621679408953"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408953"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679408952"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408952"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408953"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408952"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stack a -&gt; Stack a
forall a. Eq a =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="#local-6989586621679408951"><span class="hs-identifier hs-var">focusSubMasterU</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408953"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408952"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stack a -&gt; Stack a
forall a. Eq a =&gt; a -&gt; Stack a -&gt; Stack a
</span><a href="#local-6989586621679408950"><span class="hs-identifier hs-var">focusSubMasterD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408953"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408952"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>      </span><span id="local-6989586621679408951"><span class="annot"><span class="annottext">focusSubMasterU :: a -&gt; Stack a -&gt; Stack a
</span><a href="#local-6989586621679408951"><span class="hs-identifier hs-var hs-var">focusSubMasterU</span></a></span></span><span> </span><span id="local-6989586621679408949"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408949"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679408948"><span class="annot"><span class="annottext">i :: Stack a
</span><a href="#local-6989586621679408948"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span id="local-6989586621679408947"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408947"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408946"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408946"><span class="hs-identifier hs-var">l</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679408945"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408945"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408944"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408944"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408947"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408949"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408948"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408946"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408949"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408943"><span class="hs-identifier hs-var">news</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stack a -&gt; Stack a
</span><a href="#local-6989586621679408951"><span class="hs-identifier hs-var">focusSubMasterU</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408949"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408943"><span class="hs-identifier hs-var">news</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-347"></span><span>            </span><span id="local-6989586621679408943"><span class="annot"><span class="annottext">news :: Stack a
</span><a href="#local-6989586621679408943"><span class="hs-identifier hs-var hs-var">news</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408946"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408945"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408947"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408944"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><a href="#local-6989586621679408951"><span class="hs-identifier hs-var">focusSubMasterU</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span id="local-6989586621679408942"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408942"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span id="local-6989586621679408941"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408941"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-349"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408942"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408941"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-350"></span><span>      </span><span id="local-6989586621679408950"><span class="annot"><span class="annottext">focusSubMasterD :: a -&gt; Stack a -&gt; Stack a
</span><a href="#local-6989586621679408950"><span class="hs-identifier hs-var hs-var">focusSubMasterD</span></a></span></span><span> </span><span id="local-6989586621679408940"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408940"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679408939"><span class="annot"><span class="annottext">i :: Stack a
</span><a href="#local-6989586621679408939"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span id="local-6989586621679408938"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408938"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679408937"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408937"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408936"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408936"><span class="hs-identifier hs-var">r</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679408935"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408935"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408938"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408940"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408939"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408936"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408940"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408934"><span class="hs-identifier hs-var">news</span></a></span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Stack a -&gt; Stack a
</span><a href="#local-6989586621679408950"><span class="hs-identifier hs-var">focusSubMasterD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408940"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408934"><span class="hs-identifier hs-var">news</span></a></span><span>
</span><span id="line-354"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-355"></span><span>            </span><span id="local-6989586621679408934"><span class="annot"><span class="annottext">news :: Stack a
</span><a href="#local-6989586621679408934"><span class="hs-identifier hs-var hs-var">news</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408936"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408938"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408937"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408935"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-356"></span><span>      </span><span class="annot"><a href="#local-6989586621679408950"><span class="hs-identifier hs-var">focusSubMasterD</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span id="local-6989586621679408933"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408933"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679408932"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408932"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-357"></span><span>          </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a] -&gt; Stack a
forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408933"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408932"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="hs-comment">-- | Merge two Maybe sublayouts.</span><span>
</span><span id="line-360"></span><span id="local-6989586621679409415"><span id="local-6989586621679409416"><span id="local-6989586621679409417"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-type">mergeSubLayouts</span></a></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409417"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409416"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- ^ Left  layout</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409415"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409416"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- ^ Right layout</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409417"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409415"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409416"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="hs-comment">-- ^ How to combine the layouts</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                   </span><span class="hs-comment">-- ^ Return a 'Just' no matter what</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409417"><span class="hs-identifier hs-type">l1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409415"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409416"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-366"></span><span id="mergeSubLayouts"><span class="annot"><span class="annottext">mergeSubLayouts :: Maybe (l1 a)
-&gt; Maybe (l2 a)
-&gt; TMSCombineTwo l1 l2 a
-&gt; Bool
-&gt; Maybe (TMSCombineTwo l1 l2 a)
</span><a href="XMonad.Layout.TallMastersCombo.html#mergeSubLayouts"><span class="hs-identifier hs-var hs-var">mergeSubLayouts</span></a></span></span><span> </span><span id="local-6989586621679408931"><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679408931"><span class="hs-identifier hs-var">ml1</span></a></span></span><span> </span><span id="local-6989586621679408930"><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679408930"><span class="hs-identifier hs-var">ml2</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span id="local-6989586621679408929"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408929"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679408928"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408928"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621679408927"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408927"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span id="local-6989586621679408926"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408926"><span class="hs-identifier hs-var">vsp</span></a></span></span><span> </span><span id="local-6989586621679408925"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408925"><span class="hs-identifier hs-var">nmaster</span></a></span></span><span> </span><span id="local-6989586621679408924"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408924"><span class="hs-identifier hs-var">delta</span></a></span></span><span> </span><span id="local-6989586621679408923"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408923"><span class="hs-identifier hs-var">frac</span></a></span></span><span> </span><span id="local-6989586621679408922"><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679408922"><span class="hs-identifier hs-var">l1</span></a></span></span><span> </span><span id="local-6989586621679408921"><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679408921"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408920"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408920"><span class="hs-identifier hs-var">alwaysReturn</span></a></span></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408920"><span class="hs-identifier hs-var">alwaysReturn</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; Maybe (TMSCombineTwo l1 l2 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMSCombineTwo l1 l2 a -&gt; Maybe (TMSCombineTwo l1 l2 a))
-&gt; TMSCombineTwo l1 l2 a -&gt; Maybe (TMSCombineTwo l1 l2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408929"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408928"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408927"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408926"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408925"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408924"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408923"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l1 a -&gt; Maybe (l1 a) -&gt; l1 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679408922"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679408931"><span class="hs-identifier hs-var">ml1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l2 a -&gt; Maybe (l2 a) -&gt; l2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679408921"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679408930"><span class="hs-identifier hs-var">ml2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679408931"><span class="hs-identifier hs-var">ml1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679408930"><span class="hs-identifier hs-var">ml2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l1 l2 a -&gt; Maybe (TMSCombineTwo l1 l2 a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TMSCombineTwo l1 l2 a -&gt; Maybe (TMSCombineTwo l1 l2 a))
-&gt; TMSCombineTwo l1 l2 a -&gt; Maybe (TMSCombineTwo l1 l2 a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
forall (l1 :: * -&gt; *) (l2 :: * -&gt; *) a.
[a]
-&gt; [a]
-&gt; [a]
-&gt; Bool
-&gt; Int
-&gt; Rational
-&gt; Rational
-&gt; l1 a
-&gt; l2 a
-&gt; TMSCombineTwo l1 l2 a
</span><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-var">TMSCombineTwo</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408929"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408928"><span class="hs-identifier hs-var">w1</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408927"><span class="hs-identifier hs-var">w2</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408926"><span class="hs-identifier hs-var">vsp</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408925"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408924"><span class="hs-identifier hs-var">delta</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408923"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l1 a -&gt; Maybe (l1 a) -&gt; l1 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l1 a
</span><a href="#local-6989586621679408922"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l1 a)
</span><a href="#local-6989586621679408931"><span class="hs-identifier hs-var">ml1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l2 a -&gt; Maybe (l2 a) -&gt; l2 a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l2 a
</span><a href="#local-6989586621679408921"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (l2 a)
</span><a href="#local-6989586621679408930"><span class="hs-identifier hs-var">ml2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (TMSCombineTwo l1 l2 a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span id="local-6989586621679409381"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#findFocused"><span class="hs-identifier hs-type">findFocused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679409381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409381"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-372"></span><span id="findFocused"><span class="annot"><span class="annottext">findFocused :: Maybe (Stack a) -&gt; [a] -&gt; [a] -&gt; Int
</span><a href="XMonad.Layout.TallMastersCombo.html#findFocused"><span class="hs-identifier hs-var hs-var">findFocused</span></a></span></span><span> </span><span id="local-6989586621679408918"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408918"><span class="hs-identifier hs-var">mst</span></a></span></span><span> </span><span id="local-6989586621679408917"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408917"><span class="hs-identifier hs-var">w1</span></a></span></span><span> </span><span id="local-6989586621679408916"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408916"><span class="hs-identifier hs-var">w2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408918"><span class="hs-identifier hs-var">mst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-374"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-375"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408915"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408915"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408914"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408917"><span class="hs-identifier hs-var">w1</span></a></span><span>
</span><span id="line-376"></span><span>                     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-377"></span><span>                     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679408914"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408916"><span class="hs-identifier hs-var">w2</span></a></span><span>
</span><span id="line-378"></span><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-379"></span><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-380"></span><span>                     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679408914"><span class="annot"><span class="annottext">foc :: a
</span><a href="#local-6989586621679408914"><span class="hs-identifier hs-var hs-var">foc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; a
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408915"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-381"></span><span>
</span><span id="line-382"></span><span class="hs-comment">-- | Handle a list of messages one by one, then return the last refreshed layout.</span><span>
</span><span id="line-383"></span><span id="local-6989586621679409378"><span id="local-6989586621679409379"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#handleMessages"><span class="hs-identifier hs-type">handleMessages</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409379"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409378"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409379"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409378"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409379"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409378"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-384"></span><span id="handleMessages"><span class="annot"><span class="annottext">handleMessages :: l a -&gt; [SomeMessage] -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handleMessages"><span class="hs-identifier hs-var hs-var">handleMessages</span></a></span></span><span> </span><span id="local-6989586621679408913"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408913"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe (l a) -&gt; SomeMessage -&gt; X (Maybe (l a)))
-&gt; Maybe (l a) -&gt; [SomeMessage] -&gt; X (Maybe (l a))
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span>  </span><span class="annot"><span class="annottext">Maybe (l a) -&gt; SomeMessage -&gt; X (Maybe (l a))
forall (l :: * -&gt; *) a.
LayoutClass l a =&gt;
Maybe (l a) -&gt; SomeMessage -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handleMaybeMsg"><span class="hs-identifier hs-var">handleMaybeMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a -&gt; Maybe (l a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408913"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>
</span><span id="line-386"></span><span id="local-6989586621679409350"><span id="local-6989586621679409351"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#handleMaybeMsg"><span class="hs-identifier hs-type">handleMaybeMsg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409351"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409350"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409351"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409350"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409351"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409350"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-387"></span><span id="handleMaybeMsg"><span class="annot"><span class="annottext">handleMaybeMsg :: Maybe (l a) -&gt; SomeMessage -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handleMaybeMsg"><span class="hs-identifier hs-var hs-var">handleMaybeMsg</span></a></span></span><span> </span><span id="local-6989586621679408911"><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408911"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span id="local-6989586621679408910"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408910"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408911"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408909"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408909"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>                                              </span><span id="local-6989586621679408908"><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408908"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l a -&gt; SomeMessage -&gt; X (Maybe (l a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408909"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408910"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-389"></span><span>                                              </span><span class="annot"><span class="annottext">Maybe (l a) -&gt; X (Maybe (l a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (l a) -&gt; X (Maybe (l a))) -&gt; Maybe (l a) -&gt; X (Maybe (l a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l a) -&gt; Maybe (l a) -&gt; Maybe (l a)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="XMonad.Layout.TallMastersCombo.html#elseOr"><span class="hs-identifier hs-var">elseOr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a -&gt; Maybe (l a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408909"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408908"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-390"></span><span>                                 </span><span class="annot"><span class="annottext">Maybe (l a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (l a) -&gt; X (Maybe (l a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (l a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- function for splitting given stack for TallMastersCombo Layouts</span><span>
</span><span id="line-393"></span><span id="local-6989586621679409437"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#splitStack"><span class="hs-identifier hs-type">splitStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409437"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span></span><span>
</span><span id="line-394"></span><span id="splitStack"><span class="annot"><span class="annottext">splitStack :: [a]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack a)
-&gt; (Maybe (Stack a), Maybe (Stack a), Rational, [a], [a])
</span><a href="XMonad.Layout.TallMastersCombo.html#splitStack"><span class="hs-identifier hs-var hs-var">splitStack</span></a></span></span><span> </span><span id="local-6989586621679408906"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408906"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679408905"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408905"><span class="hs-identifier hs-var">nmaster</span></a></span></span><span> </span><span id="local-6989586621679408904"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408904"><span class="hs-identifier hs-var">frac</span></a></span></span><span> </span><span id="local-6989586621679408903"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408903"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408902"><span class="annot"><span class="annottext">slst :: [a]
</span><a href="#local-6989586621679408902"><span class="hs-identifier hs-var hs-var">slst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a) -&gt; [a]
forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">integrate'</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408903"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span id="local-6989586621679408901"><span class="annot"><span class="annottext">f' :: [a]
</span><a href="#local-6989586621679408901"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408903"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408900"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408900"><span class="hs-identifier hs-var">s'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; a
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408900"><span class="hs-identifier hs-var">s'</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">delete</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack a -&gt; a
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408900"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408906"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-397"></span><span>                       </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408906"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-398"></span><span>        </span><span id="local-6989586621679408899"><span class="annot"><span class="annottext">snum :: Int
</span><a href="#local-6989586621679408899"><span class="hs-identifier hs-var hs-var">snum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408902"><span class="hs-identifier hs-var">slst</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408898"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408898"><span class="hs-identifier hs-var">slst1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408897"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408897"><span class="hs-identifier hs-var">slst2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408905"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408902"><span class="hs-identifier hs-var">slst</span></a></span><span>
</span><span id="line-400"></span><span>        </span><span id="local-6989586621679408896"><span class="annot"><span class="annottext">s0 :: Maybe (Stack a)
</span><a href="#local-6989586621679408896"><span class="hs-identifier hs-var hs-var">s0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Maybe (Stack a)
forall q. Eq q =&gt; [q] -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408901"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408902"><span class="hs-identifier hs-var">slst</span></a></span><span>
</span><span id="line-401"></span><span>        </span><span id="local-6989586621679408895"><span class="annot"><span class="annottext">s1' :: Maybe (Stack a)
</span><a href="#local-6989586621679408895"><span class="hs-identifier hs-var hs-var">s1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Maybe (Stack a)
forall q. Eq q =&gt; [q] -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408901"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408898"><span class="hs-identifier hs-var">slst1</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span id="local-6989586621679408894"><span class="annot"><span class="annottext">s2' :: Maybe (Stack a)
</span><a href="#local-6989586621679408894"><span class="hs-identifier hs-var hs-var">s2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; Maybe (Stack a)
forall q. Eq q =&gt; [q] -&gt; [q] -&gt; Maybe (Stack q)
</span><a href="XMonad.Layout.TallMastersCombo.html#differentiate"><span class="hs-identifier hs-var">differentiate</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408901"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408897"><span class="hs-identifier hs-var">slst2</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408893"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408893"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408892"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408892"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408891"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408891"><span class="hs-identifier hs-var">frac'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408905"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408896"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408905"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408899"><span class="hs-identifier hs-var">snum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408896"><span class="hs-identifier hs-var">s0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (Stack a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>                      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408895"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408894"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408904"><span class="hs-identifier hs-var">frac</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408893"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408892"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408891"><span class="hs-identifier hs-var">frac'</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408898"><span class="hs-identifier hs-var">slst1</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408897"><span class="hs-identifier hs-var">slst2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span class="hs-comment">-- find adjacent window of the current focus window</span><span>
</span><span id="line-409"></span><span class="hs-keyword">type</span><span> </span><span id="Next"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#Next"><span class="hs-identifier hs-var">Next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-410"></span><span id="local-6989586621679409382"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#adjFocus"><span class="hs-identifier hs-type">adjFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679409382"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409382"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409382"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#Next"><span class="hs-identifier hs-type">Next</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679409382"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-411"></span><span id="adjFocus"><span class="annot"><span class="annottext">adjFocus :: [a] -&gt; Maybe (Stack a) -&gt; Bool -&gt; Maybe a
</span><a href="XMonad.Layout.TallMastersCombo.html#adjFocus"><span class="hs-identifier hs-var hs-var">adjFocus</span></a></span></span><span> </span><span id="local-6989586621679408889"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408889"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621679408888"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408888"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span id="local-6989586621679408887"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408887"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-412"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408888"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-413"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408886"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408886"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408885"><span class="annot"><span class="annottext">searchLst :: [a]
</span><a href="#local-6989586621679408885"><span class="hs-identifier hs-var hs-var">searchLst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679408887"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-414"></span><span>                                        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408886"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408886"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>                                        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408886"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408886"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>                        </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; [a] -&gt; Maybe a
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408889"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679408885"><span class="hs-identifier hs-var">searchLst</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- right biased maybe merge</span><span>
</span><span id="line-419"></span><span id="local-6989586621679409347"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#elseOr"><span class="hs-identifier hs-type">elseOr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679409347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679409347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679409347"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-420"></span><span id="elseOr"><span class="annot"><span class="annottext">elseOr :: Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="XMonad.Layout.TallMastersCombo.html#elseOr"><span class="hs-identifier hs-var hs-var">elseOr</span></a></span></span><span> </span><span id="local-6989586621679408884"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679408884"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679408883"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679408883"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679408883"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-421"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679408883"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-422"></span><span>              </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679408884"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="hs-comment">----------------- All the rest are for changing focus functionality -------------------</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- | A wrapper for Choose, for monitoring the current active layout. This is because</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- the original Choose layout does not export the data constructor.</span><span>
</span><span id="line-428"></span><span class="hs-keyword">data</span><span> </span><span id="LR"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#LR"><span class="hs-identifier hs-var">LR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="L"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="R"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408875"><span id="local-6989586621679408877"><span id="local-6989586621679408879"><span class="annot"><span class="annottext">Int -&gt; LR -&gt; ShowS
[LR] -&gt; ShowS
LR -&gt; String
(Int -&gt; LR -&gt; ShowS)
-&gt; (LR -&gt; String) -&gt; ([LR] -&gt; ShowS) -&gt; Show LR
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [LR] -&gt; ShowS
$cshowList :: [LR] -&gt; ShowS
show :: LR -&gt; String
$cshow :: LR -&gt; String
showsPrec :: Int -&gt; LR -&gt; ShowS
$cshowsPrec :: Int -&gt; LR -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408867"><span id="local-6989586621679408869"><span id="local-6989586621679408871"><span id="local-6989586621679408873"><span class="annot"><span class="annottext">ReadPrec [LR]
ReadPrec LR
Int -&gt; ReadS LR
ReadS [LR]
(Int -&gt; ReadS LR)
-&gt; ReadS [LR] -&gt; ReadPrec LR -&gt; ReadPrec [LR] -&gt; Read LR
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [LR]
$creadListPrec :: ReadPrec [LR]
readPrec :: ReadPrec LR
$creadPrec :: ReadPrec LR
readList :: ReadS [LR]
$creadList :: ReadS [LR]
readsPrec :: Int -&gt; ReadS LR
$creadsPrec :: Int -&gt; ReadS LR
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408863"><span id="local-6989586621679408865"><span class="annot"><span class="annottext">LR -&gt; LR -&gt; Bool
(LR -&gt; LR -&gt; Bool) -&gt; (LR -&gt; LR -&gt; Bool) -&gt; Eq LR
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: LR -&gt; LR -&gt; Bool
$c/= :: LR -&gt; LR -&gt; Bool
== :: LR -&gt; LR -&gt; Bool
$c== :: LR -&gt; LR -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span class="hs-keyword">data</span><span> </span><span id="ChooseWrapper"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span></span><span> </span><span id="local-6989586621679409323"><span class="annot"><a href="#local-6989586621679409323"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679409321"><span class="annot"><a href="#local-6989586621679409321"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679409322"><span class="annot"><a href="#local-6989586621679409322"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ChooseWrapper"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#LR"><span class="hs-identifier hs-type">LR</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409323"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409322"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409321"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409322"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Choose</span></span><span> </span><span class="annot"><a href="#local-6989586621679409323"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409321"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409322"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408855"><span id="local-6989586621679408857"><span id="local-6989586621679408859"><span class="annot"><span class="annottext">Int -&gt; ChooseWrapper l r a -&gt; ShowS
[ChooseWrapper l r a] -&gt; ShowS
ChooseWrapper l r a -&gt; String
(Int -&gt; ChooseWrapper l r a -&gt; ShowS)
-&gt; (ChooseWrapper l r a -&gt; String)
-&gt; ([ChooseWrapper l r a] -&gt; ShowS)
-&gt; Show (ChooseWrapper l r a)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Show (l a), Show (r a)) =&gt;
Int -&gt; ChooseWrapper l r a -&gt; ShowS
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Show (l a), Show (r a)) =&gt;
[ChooseWrapper l r a] -&gt; ShowS
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Show (l a), Show (r a)) =&gt;
ChooseWrapper l r a -&gt; String
showList :: [ChooseWrapper l r a] -&gt; ShowS
$cshowList :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Show (l a), Show (r a)) =&gt;
[ChooseWrapper l r a] -&gt; ShowS
show :: ChooseWrapper l r a -&gt; String
$cshow :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Show (l a), Show (r a)) =&gt;
ChooseWrapper l r a -&gt; String
showsPrec :: Int -&gt; ChooseWrapper l r a -&gt; ShowS
$cshowsPrec :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Show (l a), Show (r a)) =&gt;
Int -&gt; ChooseWrapper l r a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408847"><span id="local-6989586621679408849"><span id="local-6989586621679408851"><span id="local-6989586621679408853"><span class="annot"><span class="annottext">ReadPrec [ChooseWrapper l r a]
ReadPrec (ChooseWrapper l r a)
Int -&gt; ReadS (ChooseWrapper l r a)
ReadS [ChooseWrapper l r a]
(Int -&gt; ReadS (ChooseWrapper l r a))
-&gt; ReadS [ChooseWrapper l r a]
-&gt; ReadPrec (ChooseWrapper l r a)
-&gt; ReadPrec [ChooseWrapper l r a]
-&gt; Read (ChooseWrapper l r a)
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
ReadPrec [ChooseWrapper l r a]
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
ReadPrec (ChooseWrapper l r a)
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
Int -&gt; ReadS (ChooseWrapper l r a)
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
ReadS [ChooseWrapper l r a]
readListPrec :: ReadPrec [ChooseWrapper l r a]
$creadListPrec :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
ReadPrec [ChooseWrapper l r a]
readPrec :: ReadPrec (ChooseWrapper l r a)
$creadPrec :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
ReadPrec (ChooseWrapper l r a)
readList :: ReadS [ChooseWrapper l r a]
$creadList :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
ReadS [ChooseWrapper l r a]
readsPrec :: Int -&gt; ReadS (ChooseWrapper l r a)
$creadsPrec :: forall (l :: * -&gt; *) (r :: * -&gt; *) a.
(Read (l a), Read (r a)) =&gt;
Int -&gt; ReadS (ChooseWrapper l r a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-keyword">data</span><span> </span><span id="NextNoWrap"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-var">NextNoWrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NextNoWrap"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-var">NextNoWrap</span></a></span></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408842"><span id="local-6989586621679408844"><span class="annot"><span class="annottext">NextNoWrap -&gt; NextNoWrap -&gt; Bool
(NextNoWrap -&gt; NextNoWrap -&gt; Bool)
-&gt; (NextNoWrap -&gt; NextNoWrap -&gt; Bool) -&gt; Eq NextNoWrap
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NextNoWrap -&gt; NextNoWrap -&gt; Bool
$c/= :: NextNoWrap -&gt; NextNoWrap -&gt; Bool
== :: NextNoWrap -&gt; NextNoWrap -&gt; Bool
$c== :: NextNoWrap -&gt; NextNoWrap -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408836"><span id="local-6989586621679408838"><span id="local-6989586621679408840"><span class="annot"><span class="annottext">Int -&gt; NextNoWrap -&gt; ShowS
[NextNoWrap] -&gt; ShowS
NextNoWrap -&gt; String
(Int -&gt; NextNoWrap -&gt; ShowS)
-&gt; (NextNoWrap -&gt; String)
-&gt; ([NextNoWrap] -&gt; ShowS)
-&gt; Show NextNoWrap
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NextNoWrap] -&gt; ShowS
$cshowList :: [NextNoWrap] -&gt; ShowS
show :: NextNoWrap -&gt; String
$cshow :: NextNoWrap -&gt; String
showsPrec :: Int -&gt; NextNoWrap -&gt; ShowS
$cshowsPrec :: Int -&gt; NextNoWrap -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-type">NextNoWrap</span></a></span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span id="local-6989586621679409318"><span id="local-6989586621679409319"><span id="local-6989586621679409320"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-type">handle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409320"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409319"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="#local-6989586621679409318"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409320"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409319"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409318"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679409320"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409319"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-435"></span><span id="handle"><span class="annot"><span class="annottext">handle :: l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679408833"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408833"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679408832"><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679408832"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l a -&gt; SomeMessage -&gt; X (Maybe (l a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408833"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">m -&gt; SomeMessage
forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">m
</span><a href="#local-6989586621679408832"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span class="hs-keyword">data</span><span> </span><span id="End"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#End"><span class="hs-identifier hs-var">End</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="End"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#End"><span class="hs-identifier hs-var">End</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NoEnd"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#NoEnd"><span class="hs-identifier hs-var">NoEnd</span></a></span></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span id="local-6989586621679408827"><span id="local-6989586621679408828"><span id="local-6989586621679408829"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679408815"><span id="local-6989586621679408818"><span id="local-6989586621679408820"><span id="local-6989586621679408822"><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408829"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408828"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408827"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408828"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408829"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408827"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679408828"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-440"></span><span>  </span><span id="local-6989586621679408813"><span class="annot"><span class="annottext">description :: ChooseWrapper l r a -&gt; String
</span><a href="#local-6989586621679408813"><span class="hs-identifier hs-var hs-var hs-var hs-var">description</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">l a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">r a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679408812"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408812"><span class="hs-identifier hs-var">lr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Choose l r a -&gt; String
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; String
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408812"><span class="hs-identifier hs-var">lr</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>  </span><span id="local-6989586621679408811"><span class="annot"><span class="annottext">runLayout :: Workspace String (ChooseWrapper l r a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (ChooseWrapper l r a))
</span><a href="#local-6989586621679408811"><span class="hs-identifier hs-var hs-var hs-var hs-var">runLayout</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Workspace</span></span><span> </span><span id="local-6989586621679408810"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679408810"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span id="local-6989586621679408809"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408809"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679408808"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408808"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679408807"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408807"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679408806"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408806"><span class="hs-identifier hs-var">lr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408805"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408805"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408804"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679408804"><span class="hs-identifier hs-var">rec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408803"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408803"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408802"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408802"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408809"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a -&gt; Maybe (Stack a) -&gt; l a
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; l a
</span><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var">savFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408808"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408805"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408807"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>                               </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408808"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a -&gt; Maybe (Stack a) -&gt; r a
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; l a
</span><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var">savFocused</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408807"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408805"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679408800"><span class="annot"><span class="annottext">[(a, Rectangle)]
</span><a href="#local-6989586621679408800"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408799"><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408799"><span class="hs-identifier hs-var">ml0</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Workspace String (Choose l r a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (Choose l r a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
-&gt; Choose l r a
-&gt; Maybe (Stack a)
-&gt; Workspace String (Choose l r a) a
forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679408810"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408806"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408805"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679408804"><span class="hs-identifier hs-var">rec</span></a></span><span>
</span><span id="line-447"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408798"><span class="annot"><span class="annottext">l1 :: Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408798"><span class="hs-identifier hs-var hs-var">l1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408799"><span class="hs-identifier hs-var">ml0</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408797"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408797"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408809"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408803"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408802"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408797"><span class="hs-identifier hs-var">l0</span></a></span><span>
</span><span id="line-448"></span><span>                           </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-449"></span><span>      </span><span class="annot"><span class="annottext">([(a, Rectangle)], Maybe (ChooseWrapper l r a))
-&gt; X ([(a, Rectangle)], Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(a, Rectangle)]
</span><a href="#local-6989586621679408800"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408798"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621679408796"><span class="annot"><span class="annottext">handleMessage :: ChooseWrapper l r a
-&gt; SomeMessage -&gt; X (Maybe (ChooseWrapper l r a))
</span><a href="#local-6989586621679408796"><span class="hs-identifier hs-var hs-var hs-var hs-var">handleMessage</span></a></span></span><span> </span><span id="local-6989586621679408795"><span class="annot"><span class="annottext">c :: ChooseWrapper l r a
</span><a href="#local-6989586621679408795"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span id="local-6989586621679408794"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408794"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679408793"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679408792"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679408791"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408790"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">NextLayout</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe ChangeLayout
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-453"></span><span>        </span><span id="local-6989586621679408789"><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408789"><span class="hs-identifier hs-var">mlr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Choose l r a -&gt; SomeMessage -&gt; X (Maybe (Choose l r a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span id="local-6989586621679408788"><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408788"><span class="hs-identifier hs-var">mlrf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a
-&gt; NextNoWrap -&gt; X (Maybe (ChooseWrapper l r a))
forall (l :: * -&gt; *) a m.
(LayoutClass l a, Message m) =&gt;
l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a
</span><a href="#local-6989586621679408795"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">NextNoWrap
</span><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-var">NextNoWrap</span></a></span><span>
</span><span id="line-455"></span><span>        </span><span id="local-6989586621679408787"><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408787"><span class="hs-identifier hs-var">fstf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a
-&gt; ChangeLayout -&gt; X (Maybe (ChooseWrapper l r a))
forall (l :: * -&gt; *) a m.
(LayoutClass l a, Message m) =&gt;
l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a
</span><a href="#local-6989586621679408795"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">FirstLayout</span></span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679408785"><span class="annot"><span class="annottext">mlf :: Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408785"><span class="hs-identifier hs-var hs-var">mlf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
-&gt; Maybe (ChooseWrapper l r a) -&gt; Maybe (ChooseWrapper l r a)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
</span><a href="XMonad.Layout.TallMastersCombo.html#elseOr"><span class="hs-identifier hs-var">elseOr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408787"><span class="hs-identifier hs-var">fstf</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408788"><span class="hs-identifier hs-var">mlrf</span></a></span><span>
</span><span id="line-457"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679408784"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408784"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408783"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408783"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408782"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408782"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><a href="#local-6989586621679408785"><span class="hs-identifier hs-var">mlf</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span id="local-6989586621679408781"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408781"><span class="hs-identifier hs-var">d0</span></a></span></span><span> </span><span id="local-6989586621679408780"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408780"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span id="local-6989586621679408779"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408779"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408781"><span class="hs-identifier hs-var">d0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408780"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408779"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>                                     </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408794"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408789"><span class="hs-identifier hs-var">mlr'</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408778"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408778"><span class="hs-identifier hs-var">lrt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a)))
-&gt; Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408784"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408783"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408782"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408778"><span class="hs-identifier hs-var">lrt</span></a></span><span>
</span><span id="line-460"></span><span>                     </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">NextNoWrap
</span><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-var">NextNoWrap</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe NextNoWrap
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>        </span><span id="local-6989586621679408777"><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408777"><span class="hs-identifier hs-var">mlr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Choose l r a -&gt; SomeMessage -&gt; X (Maybe (Choose l r a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408776"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408776"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408775"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408775"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408774"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408774"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408773"><span class="annot"><span class="annottext">End
</span><a href="#local-6989586621679408773"><span class="hs-identifier hs-var">end</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-464"></span><span>              </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408794"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-465"></span><span>                </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>                       </span><span id="local-6989586621679408772"><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408772"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l a -&gt; NextNoWrap -&gt; X (Maybe (l a))
forall (l :: * -&gt; *) a m.
(LayoutClass l a, Message m) =&gt;
l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">NextNoWrap
</span><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-var">NextNoWrap</span></a></span><span>
</span><span id="line-467"></span><span>                       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408772"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-468"></span><span>                           </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408771"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408771"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a, End) -&gt; X (LR, l a, r a, End)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408771"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#NoEnd"><span class="hs-identifier hs-var">NoEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>                           </span><span class="annot"><span class="annottext">Maybe (l a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>                                  </span><span id="local-6989586621679408770"><span class="annot"><span class="annottext">Maybe (r a)
</span><a href="#local-6989586621679408770"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">r a -&gt; ChangeLayout -&gt; X (Maybe (r a))
forall (l :: * -&gt; *) a m.
(LayoutClass l a, Message m) =&gt;
l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">FirstLayout</span></span><span>
</span><span id="line-471"></span><span>                                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (r a)
</span><a href="#local-6989586621679408770"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-472"></span><span>                                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408769"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408769"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a, End) -&gt; X (LR, l a, r a, End)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408769"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#NoEnd"><span class="hs-identifier hs-var">NoEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>                                    </span><span class="annot"><span class="annottext">Maybe (r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a, End) -&gt; X (LR, l a, r a, End)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#NoEnd"><span class="hs-identifier hs-var">NoEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>                </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-475"></span><span>                       </span><span id="local-6989586621679408768"><span class="annot"><span class="annottext">Maybe (r a)
</span><a href="#local-6989586621679408768"><span class="hs-identifier hs-var">mr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">r a -&gt; NextNoWrap -&gt; X (Maybe (r a))
forall (l :: * -&gt; *) a m.
(LayoutClass l a, Message m) =&gt;
l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">NextNoWrap
</span><a href="XMonad.Layout.TallMastersCombo.html#NextNoWrap"><span class="hs-identifier hs-var">NextNoWrap</span></a></span><span>
</span><span id="line-476"></span><span>                       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (r a)
</span><a href="#local-6989586621679408768"><span class="hs-identifier hs-var">mr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-477"></span><span>                         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408767"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408767"><span class="hs-identifier hs-var">r0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a, End) -&gt; X (LR, l a, r a, End)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408767"><span class="hs-identifier hs-var">r0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#NoEnd"><span class="hs-identifier hs-var">NoEnd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                         </span><span class="annot"><span class="annottext">Maybe (r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a, End) -&gt; X (LR, l a, r a, End)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408794"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#End"><span class="hs-identifier hs-var">End</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408777"><span class="hs-identifier hs-var">mlr'</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408766"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408766"><span class="hs-identifier hs-var">lrt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a)))
-&gt; Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408776"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408775"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408774"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408766"><span class="hs-identifier hs-var">lrt</span></a></span><span>
</span><span id="line-480"></span><span>                     </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-481"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="#local-6989586621679408773"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#NoEnd"><span class="hs-identifier hs-var">NoEnd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a)))
-&gt; Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408776"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408775"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408774"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span><span>
</span><span id="line-482"></span><span>                                    </span><span class="annot"><span class="annottext">End
</span><a href="XMonad.Layout.TallMastersCombo.html#End"><span class="hs-identifier hs-var">End</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">FirstLayout</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SomeMessage -&gt; Maybe ChangeLayout
forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-484"></span><span>        </span><span id="local-6989586621679408765"><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408765"><span class="hs-identifier hs-var">mlr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Choose l r a -&gt; SomeMessage -&gt; X (Maybe (Choose l r a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-485"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408764"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408764"><span class="hs-identifier hs-var">d'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408763"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408763"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408762"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408762"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-486"></span><span>                        </span><span id="local-6989586621679408761"><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408761"><span class="hs-identifier hs-var">ml</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">l a -&gt; ChangeLayout -&gt; X (Maybe (l a))
forall (l :: * -&gt; *) a m.
(LayoutClass l a, Message m) =&gt;
l a -&gt; m -&gt; X (Maybe (l a))
</span><a href="XMonad.Layout.TallMastersCombo.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">FirstLayout</span></span><span>
</span><span id="line-487"></span><span>                        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (l a)
</span><a href="#local-6989586621679408761"><span class="hs-identifier hs-var">ml</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-488"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408760"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408760"><span class="hs-identifier hs-var">l0</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a) -&gt; X (LR, l a, r a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408760"><span class="hs-identifier hs-var">l0</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>                          </span><span class="annot"><span class="annottext">Maybe (l a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(LR, l a, r a) -&gt; X (LR, l a, r a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408765"><span class="hs-identifier hs-var">mlr'</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408759"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408759"><span class="hs-identifier hs-var">lrt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a)))
-&gt; Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408764"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408763"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408762"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408759"><span class="hs-identifier hs-var">lrt</span></a></span><span>
</span><span id="line-491"></span><span>                     </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a)))
-&gt; Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408764"><span class="hs-identifier hs-var">d'</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408763"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408762"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>        </span><span id="local-6989586621679408758"><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408758"><span class="hs-identifier hs-var">mlr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Choose l r a -&gt; SomeMessage -&gt; X (Maybe (Choose l r a))
forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408791"><span class="hs-identifier hs-var">lr</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679408790"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-494"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><a href="#local-6989586621679408758"><span class="hs-identifier hs-var">mlr'</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408757"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408757"><span class="hs-identifier hs-var">lrt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a)))
-&gt; Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a))
-&gt; ChooseWrapper l r a -&gt; Maybe (ChooseWrapper l r a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408794"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408793"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408792"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408757"><span class="hs-identifier hs-var">lrt</span></a></span><span>
</span><span id="line-495"></span><span>                     </span><span class="annot"><span class="annottext">Maybe (Choose l r a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a) -&gt; X (Maybe (ChooseWrapper l r a))
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ChooseWrapper l r a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span></span></span></span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- | This is same as the Choose combination operator.</span><span>
</span><span id="line-498"></span><span id="local-6989586621679408754"><span id="local-6989586621679408755"><span id="local-6989586621679408756"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#%7C%7C%7C"><span class="hs-operator hs-type">(|||)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679408756"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679408754"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408755"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408756"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408754"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408755"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-499"></span><span id="%7C%7C%7C"><span class="annot"><span class="annottext">||| :: l a -&gt; r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#%7C%7C%7C"><span class="hs-operator hs-var hs-var">(|||)</span></a></span></span><span> </span><span id="local-6989586621679408753"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408753"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679408752"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408752"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408752"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">l a -&gt; r a -&gt; Choose l r a
forall (l :: * -&gt; *) a (r :: * -&gt; *). l a -&gt; r a -&gt; Choose l r a
</span><span class="hs-operator hs-var">LL.|||</span></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408752"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span class="hs-comment">-- a subclass of layout, which contain extra method to return focused window in sub-layouts</span><span>
</span><span id="line-502"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679409431"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="GetFocused"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-var">GetFocused</span></a></span></span><span> </span><span id="local-6989586621679409431"><span class="annot"><a href="#local-6989586621679409431"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679409430"><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-503"></span><span>  </span><span id="getFocused"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-type">getFocused</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679409431"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>  </span><span id="local-6989586621679408751"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679408750"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408750"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408750"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679408749"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408749"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">Stack a -&gt; a
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679408749"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Base&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>               </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Base&quot;</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-507"></span><span>  </span><span id="savFocused"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-type">savFocused</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679409431"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679409431"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679409430"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621679408748"><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var hs-var">savFocused</span></a></span><span> </span><span id="local-6989586621679408747"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408747"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408747"><span class="hs-identifier hs-var">l</span></a></span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span id="local-6989586621679408745"><span id="local-6989586621679408746"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408746"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408745"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408746"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408745"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-511"></span><span>  </span><span id="local-6989586621679408740"><span class="annot"><span class="annottext">getFocused :: TMSCombineTwo l r Window
-&gt; Maybe (Stack Window) -&gt; ([Window], String)
</span><a href="#local-6989586621679408740"><span class="hs-identifier hs-var hs-var hs-var hs-var">getFocused</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span id="local-6989586621679408739"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408739"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679408738"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408738"><span class="hs-identifier hs-var">nmaster</span></a></span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679408737"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408737"><span class="hs-identifier hs-var">frac</span></a></span></span><span> </span><span id="local-6989586621679408736"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679408736"><span class="hs-identifier hs-var">lay1</span></a></span></span><span> </span><span id="local-6989586621679408735"><span class="annot"><span class="annottext">r Window
</span><a href="#local-6989586621679408735"><span class="hs-identifier hs-var">lay2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408734"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408734"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-512"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408733"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408733"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408732"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408732"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack Window)
-&gt; (Maybe (Stack Window), Maybe (Stack Window), Rational, [Window],
    [Window])
forall a.
Eq a =&gt;
[a]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack a)
-&gt; (Maybe (Stack a), Maybe (Stack a), Rational, [a], [a])
</span><a href="XMonad.Layout.TallMastersCombo.html#splitStack"><span class="hs-identifier hs-var">splitStack</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408739"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408738"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408737"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408734"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-513"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408731"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408731"><span class="hs-identifier hs-var">f1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408730"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679408730"><span class="hs-identifier hs-var">str1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l Window -&gt; Maybe (Stack Window) -&gt; ([Window], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679408736"><span class="hs-identifier hs-var">lay1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408733"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408729"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408729"><span class="hs-identifier hs-var">f2</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408728"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679408728"><span class="hs-identifier hs-var">str2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r Window -&gt; Maybe (Stack Window) -&gt; ([Window], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">r Window
</span><a href="#local-6989586621679408735"><span class="hs-identifier hs-var">lay2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408732"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408731"><span class="hs-identifier hs-var">f1</span></a></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [Window] -&gt; [Window]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408729"><span class="hs-identifier hs-var">f2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;TMS: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408739"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;::&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679408730"><span class="hs-identifier hs-var">str1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679408728"><span class="hs-identifier hs-var">str2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>  </span><span id="local-6989586621679408726"><span class="annot"><span class="annottext">savFocused :: TMSCombineTwo l r Window
-&gt; Maybe (Stack Window) -&gt; TMSCombineTwo l r Window
</span><a href="#local-6989586621679408726"><span class="hs-identifier hs-var hs-var hs-var hs-var">savFocused</span></a></span></span><span> </span><span id="local-6989586621679408725"><span class="annot"><span class="annottext">i :: TMSCombineTwo l r Window
</span><a href="#local-6989586621679408725"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#TMSCombineTwo"><span class="hs-identifier hs-type">TMSCombineTwo</span></a></span><span> </span><span id="local-6989586621679408724"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408724"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679408723"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408723"><span class="hs-identifier hs-var">nmaster</span></a></span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679408722"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408722"><span class="hs-identifier hs-var">frac</span></a></span></span><span> </span><span id="local-6989586621679408721"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679408721"><span class="hs-identifier hs-var">lay1</span></a></span></span><span> </span><span id="local-6989586621679408720"><span class="annot"><span class="annottext">r Window
</span><a href="#local-6989586621679408720"><span class="hs-identifier hs-var">lay2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408719"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408719"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-517"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408718"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408718"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679408717"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408717"><span class="hs-identifier hs-var">s2</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack Window)
-&gt; (Maybe (Stack Window), Maybe (Stack Window), Rational, [Window],
    [Window])
forall a.
Eq a =&gt;
[a]
-&gt; Int
-&gt; Rational
-&gt; Maybe (Stack a)
-&gt; (Maybe (Stack a), Maybe (Stack a), Rational, [a], [a])
</span><a href="XMonad.Layout.TallMastersCombo.html#splitStack"><span class="hs-identifier hs-var">splitStack</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408724"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679408723"><span class="hs-identifier hs-var">nmaster</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679408722"><span class="hs-identifier hs-var">frac</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408719"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-518"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679408716"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408716"><span class="hs-identifier hs-var">f'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l r Window
-&gt; Maybe (Stack Window) -&gt; ([Window], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l r Window
</span><a href="#local-6989586621679408725"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408719"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-519"></span><span>        </span><span id="local-6989586621679408715"><span class="annot"><span class="annottext">lay1' :: l Window
</span><a href="#local-6989586621679408715"><span class="hs-identifier hs-var hs-var">lay1'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l Window -&gt; Maybe (Stack Window) -&gt; l Window
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; l a
</span><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var">savFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679408721"><span class="hs-identifier hs-var">lay1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408718"><span class="hs-identifier hs-var">s1</span></a></span><span>
</span><span id="line-520"></span><span>        </span><span id="local-6989586621679408714"><span class="annot"><span class="annottext">lay2' :: r Window
</span><a href="#local-6989586621679408714"><span class="hs-identifier hs-var hs-var">lay2'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r Window -&gt; Maybe (Stack Window) -&gt; r Window
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; l a
</span><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var">savFocused</span></a></span><span> </span><span class="annot"><span class="annottext">r Window
</span><a href="#local-6989586621679408720"><span class="hs-identifier hs-var">lay2</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679408717"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">TMSCombineTwo l r Window
</span><a href="#local-6989586621679408725"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">focusLst :: [Window]
</span><a href="XMonad.Layout.TallMastersCombo.html#focusLst"><span class="hs-identifier hs-var">focusLst</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679408716"><span class="hs-identifier hs-var">f'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">layoutFst :: l Window
</span><a href="XMonad.Layout.TallMastersCombo.html#layoutFst"><span class="hs-identifier hs-var">layoutFst</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679408715"><span class="hs-identifier hs-var">lay1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">layoutSnd :: r Window
</span><a href="XMonad.Layout.TallMastersCombo.html#layoutSnd"><span class="hs-identifier hs-var">layoutSnd</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">r Window
</span><a href="#local-6989586621679408714"><span class="hs-identifier hs-var">lay2'</span></a></span><span class="hs-special">}</span></span></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span id="local-6989586621679408711"><span id="local-6989586621679408712"><span id="local-6989586621679408713"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408713"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408712"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408711"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408712"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408713"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408711"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679408712"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-524"></span><span>  </span><span id="local-6989586621679408707"><span class="annot"><span class="annottext">getFocused :: ChooseWrapper l r a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="#local-6989586621679408707"><span class="hs-identifier hs-var hs-var hs-var hs-var">getFocused</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span id="local-6989586621679408706"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408706"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679408705"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408705"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679408704"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408704"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408703"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408703"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408706"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">l a -&gt; Maybe (Stack a) -&gt; ([a], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408705"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408703"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-526"></span><span>              </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">r a -&gt; Maybe (Stack a) -&gt; ([a], String)
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; ([a], String)
</span><a href="XMonad.Layout.TallMastersCombo.html#getFocused"><span class="hs-identifier hs-var">getFocused</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408704"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408703"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span id="local-6989586621679408702"><span class="annot"><span class="annottext">savFocused :: ChooseWrapper l r a -&gt; Maybe (Stack a) -&gt; ChooseWrapper l r a
</span><a href="#local-6989586621679408702"><span class="hs-identifier hs-var hs-var hs-var hs-var">savFocused</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-type">ChooseWrapper</span></a></span><span> </span><span id="local-6989586621679408701"><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408701"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679408700"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408700"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679408699"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408699"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679408698"><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408698"><span class="hs-identifier hs-var">lr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679408697"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408697"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679408696"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408696"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679408695"><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408695"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-529"></span><span>                  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408701"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#L"><span class="hs-identifier hs-var">L</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a -&gt; Maybe (Stack a) -&gt; l a
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; l a
</span><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var">savFocused</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408700"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408697"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408699"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>                            </span><span class="annot"><span class="annottext">LR
</span><a href="XMonad.Layout.TallMastersCombo.html#R"><span class="hs-identifier hs-var">R</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408700"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r a -&gt; Maybe (Stack a) -&gt; r a
forall (l :: * -&gt; *) a.
GetFocused l a =&gt;
l a -&gt; Maybe (Stack a) -&gt; l a
</span><a href="XMonad.Layout.TallMastersCombo.html#savFocused"><span class="hs-identifier hs-var">savFocused</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408699"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679408697"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
forall (l :: * -&gt; *) (r :: * -&gt; *) a.
LR -&gt; l a -&gt; r a -&gt; Choose l r a -&gt; ChooseWrapper l r a
</span><a href="XMonad.Layout.TallMastersCombo.html#ChooseWrapper"><span class="hs-identifier hs-var">ChooseWrapper</span></a></span><span> </span><span class="annot"><span class="annottext">LR
</span><a href="#local-6989586621679408701"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679408696"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">r a
</span><a href="#local-6989586621679408695"><span class="hs-identifier hs-var">r'</span></a></span><span> </span><span class="annot"><span class="annottext">Choose l r a
</span><a href="#local-6989586621679408698"><span class="hs-identifier hs-var">lr</span></a></span></span></span></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span id="local-6989586621679408694"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679408689"><span id="local-6989586621679408691"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408694"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.Simplest.html#Simplest"><span class="hs-identifier hs-type">Simplest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408694"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-534"></span><span id="local-6989586621679408688"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679408683"><span id="local-6989586621679408685"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408688"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#RowsOrColumns"><span class="hs-identifier hs-type">RowsOrColumns</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408688"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-535"></span><span id="local-6989586621679408682"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679408677"><span id="local-6989586621679408679"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408682"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Full</span></span><span> </span><span class="annot"><a href="#local-6989586621679408682"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-536"></span><span id="local-6989586621679408676"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679408671"><span id="local-6989586621679408673"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tall</span></span><span> </span><span class="annot"><a href="#local-6989586621679408676"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-537"></span><span id="local-6989586621679408668"><span id="local-6989586621679408669"><span id="local-6989586621679408670"><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679408663"><span id="local-6989586621679408665"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408670"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679408668"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#LayoutModifier"><span class="hs-identifier hs-type">LayoutModifier</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408668"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679408670"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408669"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.TallMastersCombo.html#GetFocused"><span class="hs-identifier hs-type">GetFocused</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-type">ModifiedLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408668"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679408670"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679408669"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span><span>
</span><span id="line-538"></span></pre></body></html>