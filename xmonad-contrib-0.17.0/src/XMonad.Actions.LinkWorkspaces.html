<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  XMonad.Actions.LinkWorkspaces</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description : Bindings to add and delete links between workspaces.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) Jan-David Quesel &lt;quesel@gmail.org&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  none</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Provides bindings to add and delete links between workspaces. It is aimed</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- at providing useful links between workspaces in a multihead setup. Linked</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- workspaces are view at the same time.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.LinkWorkspaces</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-19"></span><span>                                         </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-20"></span><span>                                         </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-21"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#switchWS"><span class="hs-identifier">switchWS</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#removeAllMatchings"><span class="hs-identifier">removeAllMatchings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#unMatch"><span class="hs-identifier">unMatch</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces"><span class="hs-identifier">toggleLinkWorkspaces</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#defaultMessageConf"><span class="hs-identifier">defaultMessageConf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier">MessageConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>                                       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">for_</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.IndependentScreens.html"><span class="hs-identifier">XMonad.Layout.IndependentScreens</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.IndependentScreens.html#countScreens"><span class="hs-identifier">countScreens</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier">put</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html"><span class="hs-identifier">XMonad.Actions.OnScreen</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.OnScreen.html#Focus"><span class="hs-identifier">Focus</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier">FocusCurrent</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onScreen%27"><span class="hs-identifier">onScreen'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">insert</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">delete</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">lookup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filter</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- You can use this module with the following in your @~\/.xmonad\/xmonad.hs@ file:</span><span>
</span><span id="line-40"></span><span class="hs-comment">--</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- &gt; import XMonad.Actions.LinkWorkspaces</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- and add a function to print messages like</span><span>
</span><span id="line-44"></span><span class="hs-comment">--</span><span>
</span><span id="line-45"></span><span class="hs-comment">-- &gt; message_command (S screen) = &quot; dzen2 -p 1 -w 300 -xs &quot; ++ show (screen + 1)</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- &gt; message_color_func c1 c2 msg = dzenColor c1 c2 msg</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- &gt; message screen c1 c2 msg = spawn $ &quot;echo '&quot; ++ (message_color_func c1 c2 msg) ++ &quot;' | &quot; ++ message_command screen</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- alternatively you can use the noMessages function as the argument</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- Then add keybindings like the following:</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- &gt; ,((modm, xK_p), toggleLinkWorkspaces message)</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- &gt; ,((modm .|. shiftMask, xK_p), removeAllMatchings message)</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;   [ ((modm .|. m, k), a i)</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt;       | (a, m) &lt;- [(switchWS (\y -&gt; windows $ view y) message, 0),(switchWS (\x -&gt; windows $ shift x . view x) message, shiftMask)]</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt;       , (i, k) &lt;- zip (XMonad.workspaces conf) [xK_1 .. xK_9]]</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- For detailed instructions on editing your key bindings, see</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#Editing_key_bindings&quot;.</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">data</span><span> </span><span id="MessageConfig"><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-var">MessageConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MessageConfig"><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-var">MessageConfig</span></a></span></span><span> </span><span class="hs-special">{</span><span>  </span><span id="messageFunction"><span class="annot"><span class="annottext">MessageConfig -&gt; ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#messageFunction"><span class="hs-identifier hs-var hs-var">messageFunction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="foreground"><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#foreground"><span class="hs-identifier hs-var hs-var">foreground</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span>
</span><span id="line-65"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="alertedForeground"><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#alertedForeground"><span class="hs-identifier hs-var hs-var">alertedForeground</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span>
</span><span id="line-66"></span><span>                    </span><span class="hs-special">,</span><span> </span><span id="background"><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span>
</span><span id="line-67"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#defaultMessageConf"><span class="hs-identifier hs-type">defaultMessageConf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span>
</span><span id="line-70"></span><span id="defaultMessageConf"><span class="annot"><span class="annottext">defaultMessageConf :: MessageConfig
</span><a href="XMonad.Actions.LinkWorkspaces.html#defaultMessageConf"><span class="hs-identifier hs-var hs-var">defaultMessageConf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MessageConfig :: (ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ())
-&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; MessageConfig
</span><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">messageFunction :: ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#messageFunction"><span class="hs-identifier hs-var">messageFunction</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#noMessageFn"><span class="hs-identifier hs-var">noMessageFn</span></a></span><span>
</span><span id="line-71"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">background :: [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#background"><span class="hs-identifier hs-var">background</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#000000&quot;</span></span><span>
</span><span id="line-72"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alertedForeground :: [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#alertedForeground"><span class="hs-identifier hs-var">alertedForeground</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#ff7701&quot;</span></span><span>
</span><span id="line-73"></span><span>                     </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">foreground :: [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#foreground"><span class="hs-identifier hs-var">foreground</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;#00ff00&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#noMessageFn"><span class="hs-identifier hs-type">noMessageFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span id="noMessageFn"><span class="annot"><span class="annottext">noMessageFn :: ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#noMessageFn"><span class="hs-identifier hs-var hs-var">noMessageFn</span></a></span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-comment">-- | Stuff for linking workspaces</span><span>
</span><span id="line-79"></span><span class="hs-keyword">newtype</span><span> </span><span id="WorkspaceMap"><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="WorkspaceMap"><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679397629"><span id="local-6989586621679397631"><span id="local-6989586621679397633"><span id="local-6989586621679397635"><span class="annot"><span class="annottext">ReadPrec [WorkspaceMap]
ReadPrec WorkspaceMap
Int -&gt; ReadS WorkspaceMap
ReadS [WorkspaceMap]
(Int -&gt; ReadS WorkspaceMap)
-&gt; ReadS [WorkspaceMap]
-&gt; ReadPrec WorkspaceMap
-&gt; ReadPrec [WorkspaceMap]
-&gt; Read WorkspaceMap
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [WorkspaceMap]
$creadListPrec :: ReadPrec [WorkspaceMap]
readPrec :: ReadPrec WorkspaceMap
$creadPrec :: ReadPrec WorkspaceMap
readList :: ReadS [WorkspaceMap]
$creadList :: ReadS [WorkspaceMap]
readsPrec :: Int -&gt; ReadS WorkspaceMap
$creadsPrec :: Int -&gt; ReadS WorkspaceMap
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679397622"><span id="local-6989586621679397624"><span id="local-6989586621679397626"><span class="annot"><span class="annottext">Int -&gt; WorkspaceMap -&gt; ShowS
[WorkspaceMap] -&gt; ShowS
WorkspaceMap -&gt; [Char]
(Int -&gt; WorkspaceMap -&gt; ShowS)
-&gt; (WorkspaceMap -&gt; [Char])
-&gt; ([WorkspaceMap] -&gt; ShowS)
-&gt; Show WorkspaceMap
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [WorkspaceMap] -&gt; ShowS
$cshowList :: [WorkspaceMap] -&gt; ShowS
show :: WorkspaceMap -&gt; [Char]
$cshow :: WorkspaceMap -&gt; [Char]
showsPrec :: Int -&gt; WorkspaceMap -&gt; ShowS
$cshowsPrec :: Int -&gt; WorkspaceMap -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679397616"><span class="annot"><span class="annottext">initialValue :: WorkspaceMap
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char] -&gt; WorkspaceMap
</span><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-82"></span><span>          </span><span id="local-6989586621679397614"><span class="annot"><span class="annottext">extensionType :: WorkspaceMap -&gt; StateExtension
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">extensionType</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceMap -&gt; StateExtension
forall a. (Read a, Show a, ExtensionClass a) =&gt; a -&gt; StateExtension
</span><span class="hs-identifier hs-var">PersistentExtension</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#switchWS"><span class="hs-identifier hs-type">switchWS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span id="switchWS"><span class="annot"><span class="annottext">switchWS :: ([Char] -&gt; X ()) -&gt; MessageConfig -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#switchWS"><span class="hs-identifier hs-var hs-var">switchWS</span></a></span></span><span> </span><span id="local-6989586621679397611"><span class="annot"><span class="annottext">[Char] -&gt; X ()
</span><a href="#local-6989586621679397611"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679397610"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397610"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679397609"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397609"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; X ())
-&gt; MessageConfig -&gt; [Char] -&gt; Maybe ScreenId -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#switchWS%27"><span class="hs-identifier hs-var">switchWS'</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; X ()
</span><a href="#local-6989586621679397611"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397610"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397609"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScreenId
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-comment">-- | Switch to the given workspace in a non greedy way, stop if we reached the first screen</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | we already did switching on</span><span>
</span><span id="line-89"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#switchWS%27"><span class="hs-identifier hs-type">switchWS'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span id="switchWS%27"><span class="annot"><span class="annottext">switchWS' :: ([Char] -&gt; X ())
-&gt; MessageConfig -&gt; [Char] -&gt; Maybe ScreenId -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#switchWS%27"><span class="hs-identifier hs-var hs-var">switchWS'</span></a></span></span><span> </span><span id="local-6989586621679397607"><span class="annot"><span class="annottext">[Char] -&gt; X ()
</span><a href="#local-6989586621679397607"><span class="hs-identifier hs-var">switchFn</span></a></span></span><span> </span><span id="local-6989586621679397606"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397606"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span id="local-6989586621679397605"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397605"><span class="hs-identifier hs-var">workspace</span></a></span></span><span> </span><span id="local-6989586621679397604"><span class="annot"><span class="annottext">Maybe ScreenId
</span><a href="#local-6989586621679397604"><span class="hs-identifier hs-var">stopAtScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679397603"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WindowSet) -&gt; X WindowSet
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679397600"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397600"><span class="hs-identifier hs-var">nScreens</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X ScreenId
forall (m :: * -&gt; *) i. (MonadIO m, Integral i) =&gt; m i
</span><a href="XMonad.Layout.IndependentScreens.html#countScreens"><span class="hs-identifier hs-var">countScreens</span></a></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397599"><span class="annot"><span class="annottext">now :: ScreenId
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen [Char] (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenId
forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var hs-var">W.screen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen [Char] (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397603"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397596"><span class="annot"><span class="annottext">next :: ScreenId
</span><a href="#local-6989586621679397596"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; ScreenId
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; ScreenId
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397600"><span class="hs-identifier hs-var">nScreens</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">[Char] -&gt; X ()
</span><a href="#local-6989586621679397607"><span class="hs-identifier hs-var">switchFn</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397605"><span class="hs-identifier hs-var">workspace</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ScreenId
</span><a href="#local-6989586621679397604"><span class="hs-identifier hs-var">stopAtScreen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">Maybe ScreenId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; Maybe ScreenId -&gt; X ()
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">sTM</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397596"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId -&gt; Maybe ScreenId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var">now</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679397592"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">sId</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">sId</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397596"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; Maybe ScreenId -&gt; X ()
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var">sTM</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397599"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397596"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId -&gt; Maybe ScreenId
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397592"><span class="hs-identifier hs-var">sId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679397593"><span class="annot"><span class="annottext">sTM :: ScreenId -&gt; ScreenId -&gt; Maybe ScreenId -&gt; X ()
</span><a href="#local-6989586621679397593"><span class="hs-identifier hs-var hs-var">sTM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Maybe ScreenId -&gt; X ())
-&gt; MessageConfig
-&gt; [Char]
-&gt; ScreenId
-&gt; ScreenId
-&gt; Maybe ScreenId
-&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#switchToMatching"><span class="hs-identifier hs-var">switchToMatching</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; X ())
-&gt; MessageConfig -&gt; [Char] -&gt; Maybe ScreenId -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#switchWS%27"><span class="hs-identifier hs-var">switchWS'</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; X ()
</span><a href="#local-6989586621679397607"><span class="hs-identifier hs-var">switchFn</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397606"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397606"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397605"><span class="hs-identifier hs-var">workspace</span></a></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-comment">-- | Switch to the workspace that matches the current one, executing switches for that workspace as well.</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | The function switchWorkspaceNonGreedy' will take of stopping if we reached the first workspace again.</span><span>
</span><span id="line-103"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#switchToMatching"><span class="hs-identifier hs-type">switchToMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span id="switchToMatching"><span class="annot"><span class="annottext">switchToMatching :: ([Char] -&gt; Maybe ScreenId -&gt; X ())
-&gt; MessageConfig
-&gt; [Char]
-&gt; ScreenId
-&gt; ScreenId
-&gt; Maybe ScreenId
-&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#switchToMatching"><span class="hs-identifier hs-var hs-var">switchToMatching</span></a></span></span><span> </span><span id="local-6989586621679397590"><span class="annot"><span class="annottext">[Char] -&gt; Maybe ScreenId -&gt; X ()
</span><a href="#local-6989586621679397590"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679397589"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397589"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span id="local-6989586621679397588"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397588"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679397587"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397587"><span class="hs-identifier hs-var">now</span></a></span></span><span> </span><span id="local-6989586621679397586"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397586"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span id="local-6989586621679397585"><span class="annot"><span class="annottext">Maybe ScreenId
</span><a href="#local-6989586621679397585"><span class="hs-identifier hs-var">stopAtScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span> </span><span id="local-6989586621679397584"><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397584"><span class="hs-identifier hs-var">matchings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceMap
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Map [Char] [Char] -&gt; Maybe [Char]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397588"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397584"><span class="hs-identifier hs-var">matchings</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679397583"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397583"><span class="hs-identifier hs-var">newWorkspace</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>            </span><span class="annot"><span class="annottext">X () -&gt; Focus -&gt; ScreenId -&gt; X ()
</span><a href="XMonad.Actions.OnScreen.html#onScreen%27"><span class="hs-identifier hs-var">onScreen'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe ScreenId -&gt; X ()
</span><a href="#local-6989586621679397590"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397583"><span class="hs-identifier hs-var">newWorkspace</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ScreenId
</span><a href="#local-6989586621679397585"><span class="hs-identifier hs-var">stopAtScreen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397586"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-111"></span><span>            </span><span class="annot"><span class="annottext">MessageConfig -&gt; ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#messageFunction"><span class="hs-identifier hs-var hs-var">messageFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397589"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397587"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#foreground"><span class="hs-identifier hs-var hs-var">foreground</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397589"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397589"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Switching to: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397588"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397583"><span class="hs-identifier hs-var">newWorkspace</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Insert a mapping between t1 and t2 or remove it was already present</span><span>
</span><span id="line-114"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#toggleMatching"><span class="hs-identifier hs-type">toggleMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span id="toggleMatching"><span class="annot"><span class="annottext">toggleMatching :: MessageConfig -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#toggleMatching"><span class="hs-identifier hs-var hs-var">toggleMatching</span></a></span></span><span> </span><span id="local-6989586621679397581"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397581"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span id="local-6989586621679397580"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397580"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397579"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397579"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span> </span><span id="local-6989586621679397578"><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397578"><span class="hs-identifier hs-var">matchings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceMap
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Map [Char] [Char] -&gt; Maybe [Char]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397580"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397578"><span class="hs-identifier hs-var">matchings</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-118"></span><span>        </span><span class="annot"><span class="annottext">Maybe [Char]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char] -&gt; [Char] -&gt; Map [Char] [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#setMatching"><span class="hs-identifier hs-var">setMatching</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397581"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397580"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397579"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397578"><span class="hs-identifier hs-var">matchings</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679397576"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397576"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397576"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397579"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char] -&gt; [Char] -&gt; Map [Char] [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#removeMatching%27"><span class="hs-identifier hs-var">removeMatching'</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397581"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397580"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397579"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397578"><span class="hs-identifier hs-var">matchings</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char] -&gt; [Char] -&gt; Map [Char] [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#setMatching"><span class="hs-identifier hs-var">setMatching</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397581"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397580"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397579"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397578"><span class="hs-identifier hs-var">matchings</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Insert a mapping between t1 and t2 and display a message</span><span>
</span><span id="line-123"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#setMatching"><span class="hs-identifier hs-type">setMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span id="setMatching"><span class="annot"><span class="annottext">setMatching :: MessageConfig -&gt; [Char] -&gt; [Char] -&gt; Map [Char] [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#setMatching"><span class="hs-identifier hs-var hs-var">setMatching</span></a></span></span><span> </span><span id="local-6989586621679397574"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397574"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span id="local-6989586621679397573"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397573"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397572"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397572"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679397571"><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397571"><span class="hs-identifier hs-var">matchings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-125"></span><span>   </span><span id="local-6989586621679397570"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397570"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WindowSet) -&gt; X WindowSet
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-126"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397569"><span class="annot"><span class="annottext">now :: ScreenId
</span><a href="#local-6989586621679397569"><span class="hs-identifier hs-var hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen [Char] (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenId
forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var hs-var">W.screen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen [Char] (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397570"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>   </span><span class="annot"><span class="annottext">WorkspaceMap -&gt; X ()
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">(WorkspaceMap -&gt; X ()) -&gt; WorkspaceMap -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char] -&gt; WorkspaceMap
</span><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map [Char] [Char] -&gt; WorkspaceMap)
-&gt; Map [Char] [Char] -&gt; WorkspaceMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Map [Char] [Char] -&gt; Map [Char] [Char]
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397573"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397572"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397571"><span class="hs-identifier hs-var">matchings</span></a></span><span>
</span><span id="line-128"></span><span>   </span><span class="annot"><span class="annottext">MessageConfig -&gt; ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#messageFunction"><span class="hs-identifier hs-var hs-var">messageFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397574"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397569"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#foreground"><span class="hs-identifier hs-var hs-var">foreground</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397574"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397574"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Linked: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397573"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397572"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- currently this function is called manually this means that if workspaces</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- were deleted, some links stay in the RAM even though they are not used</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- anymore... because of the small amount of memory used for those there is no</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- special cleanup so far</span><span>
</span><span id="line-134"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#removeMatching%27"><span class="hs-identifier hs-type">removeMatching'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span id="removeMatching%27"><span class="annot"><span class="annottext">removeMatching' :: MessageConfig -&gt; [Char] -&gt; [Char] -&gt; Map [Char] [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#removeMatching%27"><span class="hs-identifier hs-var hs-var">removeMatching'</span></a></span></span><span> </span><span id="local-6989586621679397568"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397568"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span id="local-6989586621679397567"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397567"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679397566"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397566"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679397565"><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397565"><span class="hs-identifier hs-var">matchings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>   </span><span id="local-6989586621679397564"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397564"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WindowSet) -&gt; X WindowSet
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-137"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397563"><span class="annot"><span class="annottext">now :: ScreenId
</span><a href="#local-6989586621679397563"><span class="hs-identifier hs-var hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen [Char] (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenId
forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var hs-var">W.screen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen [Char] (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397564"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>   </span><span class="annot"><span class="annottext">WorkspaceMap -&gt; X ()
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">(WorkspaceMap -&gt; X ()) -&gt; WorkspaceMap -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char] -&gt; WorkspaceMap
</span><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map [Char] [Char] -&gt; WorkspaceMap)
-&gt; Map [Char] [Char] -&gt; WorkspaceMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Map [Char] [Char] -&gt; Map [Char] [Char]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397567"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397565"><span class="hs-identifier hs-var">matchings</span></a></span><span>
</span><span id="line-139"></span><span>   </span><span class="annot"><span class="annottext">MessageConfig -&gt; ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#messageFunction"><span class="hs-identifier hs-var hs-var">messageFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397568"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397563"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#alertedForeground"><span class="hs-identifier hs-var hs-var">alertedForeground</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397568"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397568"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Unlinked: &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397567"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397566"><span class="hs-identifier hs-var">t2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Remove all maps between workspaces</span><span>
</span><span id="line-142"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#removeAllMatchings"><span class="hs-identifier hs-type">removeAllMatchings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="removeAllMatchings"><span class="annot"><span class="annottext">removeAllMatchings :: MessageConfig -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#removeAllMatchings"><span class="hs-identifier hs-var hs-var">removeAllMatchings</span></a></span></span><span> </span><span id="local-6989586621679397562"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397562"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>   </span><span id="local-6989586621679397561"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397561"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WindowSet) -&gt; X WindowSet
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-145"></span><span>   </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397560"><span class="annot"><span class="annottext">now :: ScreenId
</span><a href="#local-6989586621679397560"><span class="hs-identifier hs-var hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen [Char] (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenId
forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var hs-var">W.screen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen [Char] (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397561"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>   </span><span class="annot"><span class="annottext">WorkspaceMap -&gt; X ()
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">(WorkspaceMap -&gt; X ()) -&gt; WorkspaceMap -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char] -&gt; WorkspaceMap
</span><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-147"></span><span>   </span><span class="annot"><span class="annottext">MessageConfig -&gt; ScreenId -&gt; [Char] -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#messageFunction"><span class="hs-identifier hs-var hs-var">messageFunction</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397562"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397560"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#alertedForeground"><span class="hs-identifier hs-var hs-var">alertedForeground</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397562"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char]
</span><a href="XMonad.Actions.LinkWorkspaces.html#background"><span class="hs-identifier hs-var hs-var">background</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397562"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;All links removed!&quot;</span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | remove all matching regarding a given workspace</span><span>
</span><span id="line-150"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#unMatch"><span class="hs-identifier hs-type">unMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="unMatch"><span class="annot"><span class="annottext">unMatch :: [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#unMatch"><span class="hs-identifier hs-var hs-var">unMatch</span></a></span></span><span> </span><span id="local-6989586621679397559"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397559"><span class="hs-identifier hs-var">workspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span> </span><span id="local-6989586621679397558"><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397558"><span class="hs-identifier hs-var">matchings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceMap
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-type">WorkspaceMap</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><span class="annottext">WorkspaceMap -&gt; X ()
forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">(WorkspaceMap -&gt; X ()) -&gt; WorkspaceMap -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char] -&gt; WorkspaceMap
</span><a href="XMonad.Actions.LinkWorkspaces.html#WorkspaceMap"><span class="hs-identifier hs-var">WorkspaceMap</span></a></span><span> </span><span class="annot"><span class="annottext">(Map [Char] [Char] -&gt; WorkspaceMap)
-&gt; Map [Char] [Char] -&gt; WorkspaceMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Map [Char] [Char] -&gt; Map [Char] [Char]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397559"><span class="hs-identifier hs-var">workspace</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Char] -&gt; Bool) -&gt; Map [Char] [Char] -&gt; Map [Char] [Char]
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679397559"><span class="hs-identifier hs-var">workspace</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map [Char] [Char]
</span><a href="#local-6989586621679397558"><span class="hs-identifier hs-var">matchings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | Toggle the currently displayed workspaces as matching. Starting from the one with focus</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | a linked list of workspaces is created that will later be iterated by switchToMatching.</span><span>
</span><span id="line-157"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces"><span class="hs-identifier hs-type">toggleLinkWorkspaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span id="toggleLinkWorkspaces"><span class="annot"><span class="annottext">toggleLinkWorkspaces :: MessageConfig -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces"><span class="hs-identifier hs-var hs-var">toggleLinkWorkspaces</span></a></span></span><span> </span><span id="local-6989586621679397556"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397556"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679397554"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397554"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; MessageConfig -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces%27"><span class="hs-identifier hs-var">toggleLinkWorkspaces'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen [Char] (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenId
forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var hs-var">W.screen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen [Char] (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397554"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397556"><span class="hs-identifier hs-var">message</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces%27"><span class="hs-identifier hs-type">toggleLinkWorkspaces'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.LinkWorkspaces.html#MessageConfig"><span class="hs-identifier hs-type">MessageConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="toggleLinkWorkspaces%27"><span class="annot"><span class="annottext">toggleLinkWorkspaces' :: ScreenId -&gt; MessageConfig -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces%27"><span class="hs-identifier hs-var hs-var">toggleLinkWorkspaces'</span></a></span></span><span> </span><span id="local-6989586621679397552"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397552"><span class="hs-identifier hs-var">first</span></a></span></span><span> </span><span id="local-6989586621679397551"><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397551"><span class="hs-identifier hs-var">message</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679397550"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397550"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WindowSet) -&gt; X WindowSet
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-163"></span><span>    </span><span id="local-6989586621679397549"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397549"><span class="hs-identifier hs-var">nScreens</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X ScreenId
forall (m :: * -&gt; *) i. (MonadIO m, Integral i) =&gt; m i
</span><a href="XMonad.Layout.IndependentScreens.html#countScreens"><span class="hs-identifier hs-var">countScreens</span></a></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397548"><span class="annot"><span class="annottext">now :: ScreenId
</span><a href="#local-6989586621679397548"><span class="hs-identifier hs-var hs-var">now</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen [Char] (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenId
forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var hs-var">W.screen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen [Char] (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397550"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679397547"><span class="annot"><span class="annottext">next :: ScreenId
</span><a href="#local-6989586621679397547"><span class="hs-identifier hs-var hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397548"><span class="hs-identifier hs-var">now</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; ScreenId
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; ScreenId
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397549"><span class="hs-identifier hs-var">nScreens</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397547"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; ScreenId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397552"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- this is also the case if there is only one screen</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">Maybe [Char] -&gt; ([Char] -&gt; X ()) -&gt; X ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId -&gt; WindowSet -&gt; Maybe [Char]
forall s i l a sd. Eq s =&gt; s -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">W.lookupWorkspace</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397547"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397550"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MessageConfig -&gt; [Char] -&gt; [Char] -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#toggleMatching"><span class="hs-identifier hs-var">toggleMatching</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397551"><span class="hs-identifier hs-var">message</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; [Char]
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679397550"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span class="annot"><span class="annottext">X () -&gt; Focus -&gt; ScreenId -&gt; X ()
</span><a href="XMonad.Actions.OnScreen.html#onScreen%27"><span class="hs-identifier hs-var">onScreen'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId -&gt; MessageConfig -&gt; X ()
</span><a href="XMonad.Actions.LinkWorkspaces.html#toggleLinkWorkspaces%27"><span class="hs-identifier hs-var">toggleLinkWorkspaces'</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397552"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">MessageConfig
</span><a href="#local-6989586621679397551"><span class="hs-identifier hs-var">message</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679397547"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-170"></span></pre></body></html>