<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description :  Toggle arbitrary windows to and from the current workspace.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) Konstantin Sobolev &lt;konstantin.sobolev@gmail.com&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Konstantin Sobolev &lt;konstantin.sobolev@gmail.com&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Named scratchpads that support several arbitrary applications at the same time.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Util.NamedScratchpad</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier">NamedScratchpad</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier">scratchpadWorkspaceTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nonFloating"><span class="hs-identifier">nonFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#defaultFloating"><span class="hs-identifier">defaultFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customFloating"><span class="hs-identifier">customFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier">NamedScratchpads</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadAction"><span class="hs-identifier">namedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#spawnHereNamedScratchpadAction"><span class="hs-identifier">spawnHereNamedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier">customRunNamedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#allNamedScratchpadAction"><span class="hs-identifier">allNamedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadManageHook"><span class="hs-identifier">namedScratchpadManageHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier">namedScratchpadFilterOutWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspacePP"><span class="hs-identifier">namedScratchpadFilterOutWorkspacePP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsHideOnFocusLoss"><span class="hs-identifier">nsHideOnFocusLoss</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html"><span class="hs-identifier">XMonad.Actions.DynamicWorkspaces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier">addHiddenWorkspace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.SpawnOn.html"><span class="hs-identifier">XMonad.Actions.SpawnOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.SpawnOn.html#spawnHere"><span class="hs-identifier">spawnHere</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html"><span class="hs-identifier">XMonad.Hooks.StatusBar.PP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier">PP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#ppSort"><span class="hs-identifier">ppSort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html"><span class="hs-identifier">XMonad.Hooks.ManageHelpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier">doRectFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html"><span class="hs-identifier">XMonad.Hooks.RefocusLast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier">withRecentsIn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">filterM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- Allows to have several floating scratchpads running different applications.</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- Bind a key to 'namedScratchpadSpawnAction'.</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- Pressing it will spawn configured application, or bring it to the current</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- workspace if it already exists.</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- Pressing the key with the application on the current workspace will</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- send it to a hidden workspace called @NSP@.</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- If you already have a workspace called @NSP@, it will use that.</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- @NSP@ will also appear in xmobar and dzen status bars. You can tweak your</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- @dynamicLog@ settings to filter it out if you like.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- Create named scratchpads configuration in your xmonad.hs like this:</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt; import XMonad.StackSet as W</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt; import XMonad.ManageHook</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &gt; import XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &gt; scratchpads = [</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- &gt; -- run htop in xterm, find it by title, use default floating window placement</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &gt;     NS &quot;htop&quot; &quot;xterm -e htop&quot; (title =? &quot;htop&quot;) defaultFloating ,</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- &gt; -- run stardict, find it by class name, place it in the floating window</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt; -- 1/6 of screen width from the left, 1/6 of screen height</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- &gt; -- from the top, 2/3 of screen width by 2/3 of screen height</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- &gt;     NS &quot;stardict&quot; &quot;stardict&quot; (className =? &quot;Stardict&quot;)</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;         (customFloating $ W.RationalRect (1/6) (1/6) (2/3) (2/3)) ,</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- &gt; -- run gvim, find by role, don't float</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- &gt;     NS &quot;notes&quot; &quot;gvim --role notes ~/notes.txt&quot; (role =? &quot;notes&quot;) nonFloating</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &gt; ] where role = stringProperty &quot;WM_WINDOW_ROLE&quot;</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- Add keybindings:</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask .|. shiftMask, xK_t), namedScratchpadAction scratchpads &quot;htop&quot;)</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask .|. shiftMask, xK_s), namedScratchpadAction scratchpads &quot;stardict&quot;)</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask .|. shiftMask, xK_n), namedScratchpadAction scratchpads &quot;notes&quot;)</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- ... and a manage hook:</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt;  , manageHook = namedScratchpadManageHook scratchpads</span><span>
</span><span id="line-89"></span><span class="hs-comment">--</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- For detailed instruction on editing the key binding see</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#Editing_key_bindings&quot;</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- For some applications (like displaying your workspaces in a status bar) it</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- is convenient to filter out the @NSP@ workspace when looking at all</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- workspaces. For this, you can use 'XMonad.Hooks.StatusBar.PP.filterOutWsPP',</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- or 'XMonad.Util.WorkspaceCompare.filterOutWs' together with</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- 'XMonad.Hooks.EwmhDesktops.addEwmhWorkspaceSort' if your status bar gets</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- the list of workspaces from EWMH.  See the documentation of these functions</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- for examples.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- Further, there is also a @logHook@ that you can use to hide</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- scratchpads when they lose focus; this is functionality akin to what</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- some dropdown terminals provide.  See the documentation of</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- 'nsHideOnFocusLoss' for an example how to set this up.</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | Single named scratchpad configuration</span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="NamedScratchpad"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-var">NamedScratchpad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NS"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NS"><span class="hs-identifier hs-var">NS</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="name"><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>      </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-109"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="cmd"><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>      </span><span class="hs-comment">-- ^ Command used to run application</span><span>
</span><span id="line-110"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="query"><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ Query to find already running application</span><span>
</span><span id="line-111"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="hook"><span class="annot"><span class="annottext">NamedScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#hook"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>  </span><span class="hs-comment">-- ^ Manage hook called for application window, use it to define the placement. See @nonFloating@, @defaultFloating@ and @customFloating@</span><span>
</span><span id="line-112"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Manage hook that makes the window non-floating</span><span>
</span><span id="line-115"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nonFloating"><span class="hs-identifier hs-type">nonFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-116"></span><span id="nonFloating"><span class="annot"><span class="annottext">nonFloating :: ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#nonFloating"><span class="hs-identifier hs-var hs-var">nonFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManageHook
forall m. Monoid m =&gt; m
</span><span class="hs-identifier hs-var">idHook</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | Manage hook that makes the window floating with the default placement</span><span>
</span><span id="line-119"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#defaultFloating"><span class="hs-identifier hs-type">defaultFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-120"></span><span id="defaultFloating"><span class="annot"><span class="annottext">defaultFloating :: ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#defaultFloating"><span class="hs-identifier hs-var hs-var">defaultFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManageHook
</span><span class="hs-identifier hs-var">doFloat</span></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Manage hook that makes the window floating with custom placement</span><span>
</span><span id="line-123"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customFloating"><span class="hs-identifier hs-type">customFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-124"></span><span id="customFloating"><span class="annot"><span class="annottext">customFloating :: RationalRect -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#customFloating"><span class="hs-identifier hs-var hs-var">customFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; ManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier hs-var">doRectFloat</span></a></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Named scratchpads configuration</span><span>
</span><span id="line-127"></span><span class="hs-keyword">type</span><span> </span><span id="NamedScratchpads"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-var">NamedScratchpads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Finds named scratchpad configuration by name</span><span>
</span><span id="line-130"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#findByName"><span class="hs-identifier hs-type">findByName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span>
</span><span id="line-131"></span><span id="findByName"><span class="annot"><span class="annottext">findByName :: NamedScratchpads -&gt; String -&gt; Maybe NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#findByName"><span class="hs-identifier hs-var hs-var">findByName</span></a></span></span><span> </span><span id="local-6989586621679404263"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679404263"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679404262"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404262"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; Bool)
-&gt; NamedScratchpads -&gt; Maybe NamedScratchpad
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404262"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool)
-&gt; (NamedScratchpad -&gt; String) -&gt; NamedScratchpad -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679404263"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- | Runs application which should appear in specified scratchpad</span><span>
</span><span id="line-134"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-type">runApplication</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span id="runApplication"><span class="annot"><span class="annottext">runApplication :: NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-var hs-var">runApplication</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; X ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ()
</span><span class="hs-identifier hs-var">spawn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; X ())
-&gt; (NamedScratchpad -&gt; String) -&gt; NamedScratchpad -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var hs-var">cmd</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span class="hs-comment">-- | Runs application which should appear in a specified scratchpad on the workspace it was launched on</span><span>
</span><span id="line-138"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#runApplicationHere"><span class="hs-identifier hs-type">runApplicationHere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span id="runApplicationHere"><span class="annot"><span class="annottext">runApplicationHere :: NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplicationHere"><span class="hs-identifier hs-var hs-var">runApplicationHere</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Actions.SpawnOn.html#spawnHere"><span class="hs-identifier hs-var">spawnHere</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; X ())
-&gt; (NamedScratchpad -&gt; String) -&gt; NamedScratchpad -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var hs-var">cmd</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- | Action to pop up specified named scratchpad</span><span>
</span><span id="line-142"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadAction"><span class="hs-identifier hs-type">namedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-143"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>           </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-144"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span id="namedScratchpadAction"><span class="annot"><span class="annottext">namedScratchpadAction :: NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadAction"><span class="hs-identifier hs-var hs-var">namedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var">customRunNamedScratchpadAction</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-var">runApplication</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Action to pop up specified named scratchpad, initially starting it on the current workspace.</span><span>
</span><span id="line-148"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#spawnHereNamedScratchpadAction"><span class="hs-identifier hs-type">spawnHereNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>           </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-149"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                     </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-150"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="spawnHereNamedScratchpadAction"><span class="annot"><span class="annottext">spawnHereNamedScratchpadAction :: NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#spawnHereNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">spawnHereNamedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var">customRunNamedScratchpadAction</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplicationHere"><span class="hs-identifier hs-var">runApplicationHere</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Action to pop up specified named scratchpad, given a custom way to initially start the application.</span><span>
</span><span id="line-154"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-type">customRunNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Function initially running the application, given the configured @scratchpad@ cmd</span><span>
</span><span id="line-155"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>           </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-156"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                     </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-157"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span id="customRunNamedScratchpadAction"><span class="annot"><span class="annottext">customRunNamedScratchpadAction :: (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">customRunNamedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ())
-&gt; (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-var">someNamedScratchpadAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679404256"><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679404256"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679404255"><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679404255"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679404256"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; Window -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Window -&gt; Window
forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NE.head</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679404255"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#allNamedScratchpadAction"><span class="hs-identifier hs-type">allNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>
</span><span id="line-161"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-162"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span id="allNamedScratchpadAction"><span class="annot"><span class="annottext">allNamedScratchpadAction :: NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#allNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">allNamedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ())
-&gt; (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-var">someNamedScratchpadAction</span></a></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-var">runApplication</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | A @logHook@ to hide scratchpads when they lose focus.  This can be</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- useful for e.g. dropdown terminals.  Note that this also requires you</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- to use the 'XMonad.Hooks.RefocusLast.refocusLastLogHook'.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- ==== __Example__</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.RefocusLast (refocusLastLogHook)</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- &gt; import XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- &gt; main = xmonad $ def</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- &gt;   { logHook = refocusLastLogHook</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- &gt;            &gt;&gt; nsHideOnFocusLoss myScratchpads</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- &gt;               -- enable hiding for all of @myScratchpads@</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- &gt;   }</span><span>
</span><span id="line-179"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsHideOnFocusLoss"><span class="hs-identifier hs-type">nsHideOnFocusLoss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span id="nsHideOnFocusLoss"><span class="annot"><span class="annottext">nsHideOnFocusLoss :: NamedScratchpads -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#nsHideOnFocusLoss"><span class="hs-identifier hs-var hs-var">nsHideOnFocusLoss</span></a></span></span><span> </span><span id="local-6989586621679404252"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679404252"><span class="hs-identifier hs-var">scratches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679404250"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404250"><span class="hs-identifier hs-var">winSet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404249"><span class="annot"><span class="annottext">cur :: String
</span><a href="#local-6989586621679404249"><span class="hs-identifier hs-var hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; String
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404250"><span class="hs-identifier hs-var">winSet</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; () -&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a. String -&gt; a -&gt; (Window -&gt; Window -&gt; X a) -&gt; X a
</span><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-var">withRecentsIn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404249"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; Window -&gt; X ()) -&gt; X ())
-&gt; (Window -&gt; Window -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679404247"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">lastFocus</span></a></span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">lastFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; [Window] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; [Window]
forall i l a s sd. StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.index</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404250"><span class="hs-identifier hs-var">winSet</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404249"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-184"></span><span>            </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X Bool
</span><a href="#local-6989586621679404241"><span class="hs-identifier hs-var">isNS</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">lastFocus</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-185"></span><span>                </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var">shiftToNSP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; [WindowSpace]
forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404250"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; Window -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679404247"><span class="hs-identifier hs-var">lastFocus</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621679404241"><span class="hs-identifier hs-type">isNS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-188"></span><span>    </span><span id="local-6989586621679404241"><span class="annot"><span class="annottext">isNS :: Window -&gt; X Bool
</span><a href="#local-6989586621679404241"><span class="hs-identifier hs-var hs-var">isNS</span></a></span></span><span> </span><span id="local-6989586621679404238"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679404238"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Bool] -&gt; Bool
forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">([Bool] -&gt; Bool) -&gt; X [Bool] -&gt; X Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; X Bool) -&gt; NamedScratchpads -&gt; X [Bool]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query Bool -&gt; Window -&gt; X Bool
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-operator hs-var">`runQuery`</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679404238"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Query Bool -&gt; X Bool)
-&gt; (NamedScratchpad -&gt; Query Bool) -&gt; NamedScratchpad -&gt; X Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679404252"><span class="hs-identifier hs-var">scratches</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | execute some action on a named scratchpad</span><span>
</span><span id="line-191"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-type">someNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>
</span><span id="line-194"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-195"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span id="someNamedScratchpadAction"><span class="annot"><span class="annottext">someNamedScratchpadAction :: ((Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ())
-&gt; (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">someNamedScratchpadAction</span></a></span></span><span> </span><span id="local-6989586621679404233"><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
</span><a href="#local-6989586621679404233"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679404232"><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="#local-6989586621679404232"><span class="hs-identifier hs-var">runApp</span></a></span></span><span> </span><span id="local-6989586621679404231"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679404231"><span class="hs-identifier hs-var">scratchpadConfig</span></a></span></span><span> </span><span id="local-6989586621679404230"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404230"><span class="hs-identifier hs-var">scratchpadName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads -&gt; String -&gt; Maybe NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#findByName"><span class="hs-identifier hs-var">findByName</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679404231"><span class="hs-identifier hs-var">scratchpadConfig</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404230"><span class="hs-identifier hs-var">scratchpadName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-198"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404229"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404229"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X ()) -&gt; X ()
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X ()) -&gt; X ()) -&gt; (WindowSet -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679404228"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404228"><span class="hs-identifier hs-var">winSet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679404227"><span class="annot"><span class="annottext">focusedWspWindows :: [Window]
</span><a href="#local-6989586621679404227"><span class="hs-identifier hs-var hs-var">focusedWspWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window]
-&gt; (Stack Window -&gt; [Window]) -&gt; Maybe (Stack Window) -&gt; [Window]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Stack Window -&gt; [Window]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSpace -&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">(WindowSpace -&gt; Maybe (Stack Window))
-&gt; (WindowSet -&gt; WindowSpace) -&gt; WindowSet -&gt; Maybe (Stack Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen String (Layout Window) Window ScreenId ScreenDetail
-&gt; WindowSpace
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">(Screen String (Layout Window) Window ScreenId ScreenDetail
 -&gt; WindowSpace)
-&gt; (WindowSet
    -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; WindowSet
-&gt; WindowSpace
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; Maybe (Stack Window))
-&gt; WindowSet -&gt; Maybe (Stack Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404228"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                </span><span id="local-6989586621679404221"><span class="annot"><span class="annottext">allWindows :: [Window]
</span><a href="#local-6989586621679404221"><span class="hs-identifier hs-var hs-var">allWindows</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; [Window]
forall a i l s sd. Eq a =&gt; StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.allWindows</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404228"><span class="hs-identifier hs-var">winSet</span></a></span><span>
</span><span id="line-201"></span><span>            </span><span id="local-6989586621679404219"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679404219"><span class="hs-identifier hs-var">matchingOnCurrent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X Bool) -&gt; [Window] -&gt; X [Window]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query Bool -&gt; Window -&gt; X Bool
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404229"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679404227"><span class="hs-identifier hs-var">focusedWspWindows</span></a></span><span>
</span><span id="line-202"></span><span>            </span><span id="local-6989586621679404218"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679404218"><span class="hs-identifier hs-var">matchingOnAll</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X Bool) -&gt; [Window] -&gt; X [Window]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query Bool -&gt; Window -&gt; X Bool
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404229"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679404221"><span class="hs-identifier hs-var">allWindows</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Maybe (NonEmpty Window)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679404219"><span class="hs-identifier hs-var">matchingOnCurrent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-205"></span><span>                </span><span class="hs-comment">-- no matching window on the current workspace -&gt; scratchpad not running or in background</span><span>
</span><span id="line-206"></span><span>                </span><span class="annot"><span class="annottext">Maybe (NonEmpty Window)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Maybe (NonEmpty Window)
forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679404218"><span class="hs-identifier hs-var">matchingOnAll</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>                    </span><span class="annot"><span class="annottext">Maybe (NonEmpty Window)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="#local-6989586621679404232"><span class="hs-identifier hs-var">runApp</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404229"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-208"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404216"><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679404216"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
</span><a href="#local-6989586621679404233"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (Window -&gt; WindowSet -&gt; WindowSet) -&gt; Window -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; WindowSet -&gt; WindowSet
forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; String
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404228"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679404216"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>                </span><span class="hs-comment">-- matching window running on current workspace -&gt; window should be shifted to scratchpad workspace</span><span>
</span><span id="line-211"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679404213"><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679404213"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var">shiftToNSP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; [WindowSpace]
forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679404228"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
</span><a href="#local-6989586621679404233"><span class="hs-operator hs-var">`f`</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679404213"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="annot"><span class="annottext">Maybe NamedScratchpad
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Tag of the scratchpad workspace</span><span>
</span><span id="line-215"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-type">scratchpadWorkspaceTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-216"></span><span id="scratchpadWorkspaceTag"><span class="annot"><span class="annottext">scratchpadWorkspaceTag :: String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var hs-var">scratchpadWorkspaceTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NSP&quot;</span></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-comment">-- | Manage hook to use with named scratchpads</span><span>
</span><span id="line-219"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadManageHook"><span class="hs-identifier hs-type">namedScratchpadManageHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-220"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-221"></span><span id="namedScratchpadManageHook"><span class="annot"><span class="annottext">namedScratchpadManageHook :: NamedScratchpads -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadManageHook"><span class="hs-identifier hs-var hs-var">namedScratchpadManageHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ManageHook] -&gt; ManageHook
forall m. Monoid m =&gt; [m] -&gt; m
</span><span class="hs-identifier hs-var">composeAll</span></span><span> </span><span class="annot"><span class="annottext">([ManageHook] -&gt; ManageHook)
-&gt; (NamedScratchpads -&gt; [ManageHook])
-&gt; NamedScratchpads
-&gt; ManageHook
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; ManageHook) -&gt; NamedScratchpads -&gt; [ManageHook]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679404211"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404211"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404211"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool -&gt; ManageHook -&gt; ManageHook
forall (m :: * -&gt; *) a. (Monad m, Monoid a) =&gt; m Bool -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">--&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#hook"><span class="hs-identifier hs-var hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679404211"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Shift some windows to the scratchpad workspace according to the</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- given function.  The workspace is created if necessary.</span><span>
</span><span id="line-225"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-type">shiftToNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span id="shiftToNSP"><span class="annot"><span class="annottext">shiftToNSP :: [WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var hs-var">shiftToNSP</span></a></span></span><span> </span><span id="local-6989586621679404209"><span class="annot"><span class="annottext">[WindowSpace]
</span><a href="#local-6989586621679404209"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621679404208"><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><a href="#local-6989586621679404208"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSpace -&gt; Bool) -&gt; [WindowSpace] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; (WindowSpace -&gt; String) -&gt; WindowSpace -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSpace -&gt; String
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">W.tag</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WindowSpace]
</span><a href="#local-6989586621679404209"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier hs-var">addHiddenWorkspace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><a href="#local-6989586621679404208"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; X ())
-&gt; (Window -&gt; WindowSet -&gt; WindowSet) -&gt; Window -&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; WindowSet -&gt; WindowSet
forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Transforms a workspace list containing the NSP workspace into one that</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- doesn't contain it. Intended for use with logHooks.</span><span>
</span><span id="line-233"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier hs-type">namedScratchpadFilterOutWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span>
</span><span id="line-234"></span><span id="namedScratchpadFilterOutWorkspace"><span class="annot"><span class="annottext">namedScratchpadFilterOutWorkspace :: [WindowSpace] -&gt; [WindowSpace]
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier hs-var hs-var">namedScratchpadFilterOutWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSpace -&gt; Bool) -&gt; [WindowSpace] -&gt; [WindowSpace]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Workspace</span></span><span> </span><span id="local-6989586621679404204"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404204"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="annot"><span class="annottext">Layout Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679404204"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">namedScratchpadFilterOutWorkspace</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Util.WorkspaceCompare.filterOutWs [scratchpadWorkspaceTag] instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Transforms a pretty-printer into one not displaying the NSP workspace.</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- A simple use could be:</span><span>
</span><span id="line-240"></span><span class="hs-comment">--</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- &gt; logHook = dynamicLogWithPP . namedScratchpadFilterOutWorkspace $ def</span><span>
</span><span id="line-242"></span><span class="hs-comment">--</span><span>
</span><span id="line-243"></span><span class="hs-comment">-- Here is another example, when using &quot;XMonad.Layout.IndependentScreens&quot;.</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- If you have handles @hLeft@ and @hRight@ for bars on the left and right screens, respectively, and @pp@ is a pretty-printer function that takes a handle, you could write</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- &gt; logHook = let log screen handle = dynamicLogWithPP . namedScratchpadFilterOutWorkspacePP . marshallPP screen . pp $ handle</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- &gt;           in log 0 hLeft &gt;&gt; log 1 hRight</span><span>
</span><span id="line-248"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspacePP"><span class="hs-identifier hs-type">namedScratchpadFilterOutWorkspacePP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span>
</span><span id="line-249"></span><span id="namedScratchpadFilterOutWorkspacePP"><span class="annot"><span class="annottext">namedScratchpadFilterOutWorkspacePP :: PP -&gt; PP
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspacePP"><span class="hs-identifier hs-var hs-var">namedScratchpadFilterOutWorkspacePP</span></a></span></span><span> </span><span id="local-6989586621679404203"><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679404203"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679404203"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">ppSort :: X ([WindowSpace] -&gt; [WindowSpace])
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppSort"><span class="hs-identifier hs-var">ppSort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(([WindowSpace] -&gt; [WindowSpace])
 -&gt; [WindowSpace] -&gt; [WindowSpace])
-&gt; X ([WindowSpace] -&gt; [WindowSpace])
-&gt; X ([WindowSpace] -&gt; [WindowSpace])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([WindowSpace] -&gt; [WindowSpace])
-&gt; ([WindowSpace] -&gt; [WindowSpace])
-&gt; [WindowSpace]
-&gt; [WindowSpace]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; [WindowSpace]
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier hs-var">namedScratchpadFilterOutWorkspace</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PP -&gt; X ([WindowSpace] -&gt; [WindowSpace])
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppSort"><span class="hs-identifier hs-var hs-var">ppSort</span></a></span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679404203"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-252"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">namedScratchpadFilterOutWorkspacePP</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Hooks.StatusBar.PP.filterOutWsPP [scratchpadWorkspaceTag] instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- vim:ts=4:shiftwidth=4:softtabstop=4:expandtab:foldlevel=20:</span><span>
</span><span id="line-255"></span></pre></body></html>