<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-9"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Module      :  XMonad.Prompt</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Copyright   :  (C) 2007 Andrea Rossato, 2015 Evgeny Kurnevsky</span><span>
</span><span id="line-13"></span><span class="hs-comment">--                    2015 Sibi Prabakaran, 2018 Yclept Nemo</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- License     :  BSD3</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Maintainer  :  Spencer Janssen &lt;spencerjanssen@gmail.com&gt;</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- A module for writing graphical prompts for XMonad</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Bugs:</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- if 'alwaysHighlight' is True, and</span><span>
</span><span id="line-27"></span><span class="hs-comment">--  1 type several characters</span><span>
</span><span id="line-28"></span><span class="hs-comment">--  2 tab-complete past several entries</span><span>
</span><span id="line-29"></span><span class="hs-comment">--  3 backspace back to the several characters</span><span>
</span><span id="line-30"></span><span class="hs-comment">--  4 tab-complete once (results in the entry past the one in [2])</span><span>
</span><span id="line-31"></span><span class="hs-comment">--  5 tab-complete against this shorter list of completions</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- then the prompt will freeze (XMonad continues however).</span><span>
</span><span id="line-33"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Prompt</span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-37"></span><span>      </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-38"></span><span>      </span><span class="annot"><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier">mkXPrompt</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkXPromptWithReturn"><span class="hs-identifier">mkXPromptWithReturn</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkXPromptWithModes"><span class="hs-identifier">mkXPromptWithModes</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#amberXPConfig"><span class="hs-identifier">amberXPConfig</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#greenXPConfig"><span class="hs-identifier">greenXPConfig</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPMode"><span class="hs-identifier">XPMode</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier">XPType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier">XPColor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPPosition"><span class="hs-identifier">XPPosition</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier">XPConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier">XPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier">XP</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#defaultXPKeymap"><span class="hs-identifier">defaultXPKeymap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#defaultXPKeymap%27"><span class="hs-identifier">defaultXPKeymap'</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#emacsLikeXPKeymap"><span class="hs-identifier">emacsLikeXPKeymap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#emacsLikeXPKeymap%27"><span class="hs-identifier">emacsLikeXPKeymap'</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#vimLikeXPKeymap"><span class="hs-identifier">vimLikeXPKeymap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#vimLikeXPKeymap%27"><span class="hs-identifier">vimLikeXPKeymap'</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#quit"><span class="hs-identifier">quit</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#promptSubmap"><span class="hs-identifier">promptSubmap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#promptBuffer"><span class="hs-identifier">promptBuffer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#toHeadChar"><span class="hs-identifier">toHeadChar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#bufferOne"><span class="hs-identifier">bufferOne</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier">killBefore</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier">killAfter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier">startOfLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier">endOfLine</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#insertString"><span class="hs-identifier">insertString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#pasteString"><span class="hs-identifier">pasteString</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#pasteString%27"><span class="hs-identifier">pasteString'</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier">clipCursor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier">moveCursor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier">moveCursorClip</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setInput"><span class="hs-identifier">setInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#getInput"><span class="hs-identifier">getInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#getOffset"><span class="hs-identifier">getOffset</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#defaultColor"><span class="hs-identifier">defaultColor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#modifyColor"><span class="hs-identifier">modifyColor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setColor"><span class="hs-identifier">setColor</span></a></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#resetColor"><span class="hs-identifier">resetColor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setBorderColor"><span class="hs-identifier">setBorderColor</span></a></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#modifyPrompter"><span class="hs-identifier">modifyPrompter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setPrompter"><span class="hs-identifier">setPrompter</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#resetPrompter"><span class="hs-identifier">resetPrompter</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#moveWord"><span class="hs-identifier">moveWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier">moveWord'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#killWord"><span class="hs-identifier">killWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier">killWord'</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#changeWord"><span class="hs-identifier">changeWord</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier">deleteString</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier">moveHistory</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier">setSuccess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier">setDone</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier">setModeDone</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier">Direction1D</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier">ComplFunction</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplCaseSensitivity"><span class="hs-identifier">ComplCaseSensitivity</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><span class="hs-comment">-- * X Utilities</span></span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-comment">-- $xutils</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkUnmanagedWindow"><span class="hs-identifier">mkUnmanagedWindow</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#fillDrawable"><span class="hs-identifier">fillDrawable</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Other Utilities</span></span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-comment">-- $utils</span></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkComplFunFromList"><span class="hs-identifier">mkComplFunFromList</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier">mkComplFunFromList'</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="hs-comment">-- * @nextCompletion@ implementations</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#getNextOfLastWord"><span class="hs-identifier">getNextOfLastWord</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#getNextCompletion"><span class="hs-identifier">getNextCompletion</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-comment">-- * List utilities</span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#getLastWord"><span class="hs-identifier">getLastWord</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#skipLastWord"><span class="hs-identifier">skipLastWord</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#splitInSubListsAt"><span class="hs-identifier">splitInSubListsAt</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#breakAtSpace"><span class="hs-identifier">breakAtSpace</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#uniqSort"><span class="hs-identifier">uniqSort</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#historyCompletion"><span class="hs-identifier">historyCompletion</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#historyCompletionP"><span class="hs-identifier">historyCompletionP</span></a></span><span>
</span><span id="line-88"></span><span>    </span><span class="annot"><span class="hs-comment">-- * History filters</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#deleteAllDuplicates"><span class="hs-identifier">deleteAllDuplicates</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#deleteConsecutive"><span class="hs-identifier">deleteConsecutive</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier">HistoryMatches</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#initMatches"><span class="hs-identifier">initMatches</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#historyUpMatching"><span class="hs-identifier">historyUpMatching</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#historyDownMatching"><span class="hs-identifier">historyDownMatching</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier">XPState</span></a></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>                       </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">cleanMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">config</span></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>               </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>                       </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">numberlockMask</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.Font.html"><span class="hs-identifier">XMonad.Util.Font</span></a></span><span>
</span><span id="line-104"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.Types.html"><span class="hs-identifier">XMonad.Util.Types</span></a></span><span>
</span><span id="line-105"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.XSelection.html"><span class="hs-identifier">XMonad.Util.XSelection</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.XSelection.html#getSelection"><span class="hs-identifier">getSelection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Codec.Binary.UTF8.String</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeString</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier">isUTF8Encoded</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">first</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(***)</span></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Concurrent</span></span><span>           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">threadDelay</span></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span>            </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">handle</span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-112"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>               </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">bimap</span></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>
</span><span id="line-114"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.IORef</span></span><span>
</span><span id="line-115"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-116"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span>                     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromList</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.IO.Unsafe</span></span><span>             </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unsafePerformIO</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">System.Posix.Files</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- For usage examples see &quot;XMonad.Prompt.Shell&quot;,</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- &quot;XMonad.Prompt.XMonad&quot; or &quot;XMonad.Prompt.Ssh&quot;</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- TODO:</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- * scrolling the completions that don't fit in the window (?)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-keyword">type</span><span> </span><span id="XP"><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-var">XP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-keyword">data</span><span> </span><span id="XPState"><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-var">XPState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>    </span><span id="XPS"><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-var">XPS</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="dpy"><span class="annot"><span class="annottext">XPState -&gt; Display
</span><a href="XMonad.Prompt.html#dpy"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span>
</span><span id="line-133"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="rootw"><span class="annot"><span class="annottext">XPState -&gt; Window
</span><a href="XMonad.Prompt.html#rootw"><span class="hs-identifier hs-var hs-var">rootw</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="win"><span class="annot"><span class="annottext">XPState -&gt; Window
</span><a href="XMonad.Prompt.html#win"><span class="hs-identifier hs-var hs-var">win</span></a></span></span><span>                   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-135"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="screen"><span class="annot"><span class="annottext">XPState -&gt; Rectangle
</span><a href="XMonad.Prompt.html#screen"><span class="hs-identifier hs-var hs-var">screen</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="winWidth"><span class="annot"><span class="annottext">XPState -&gt; Dimension
</span><a href="XMonad.Prompt.html#winWidth"><span class="hs-identifier hs-var hs-var">winWidth</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-comment">-- ^ Width of the prompt window</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="complWinDim"><span class="annot"><span class="annottext">XPState -&gt; Maybe ComplWindowDim
</span><a href="XMonad.Prompt.html#complWinDim"><span class="hs-identifier hs-var hs-var">complWinDim</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="complIndex"><span class="annot"><span class="annottext">XPState -&gt; (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var hs-var">complIndex</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="complWin"><span class="annot"><span class="annottext">XPState -&gt; IORef (Maybe Window)
</span><a href="XMonad.Prompt.html#complWin"><span class="hs-identifier hs-var hs-var">complWin</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>        </span><span class="hs-comment">-- ^ This is an 'IORef' to enable removal of the completion</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-comment">-- window if an exception occurs, since otherwise the most</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-comment">-- recent value of 'complWin' would not be available.</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="showComplWin"><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#showComplWin"><span class="hs-identifier hs-var hs-var">showComplWin</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="operationMode"><span class="annot"><span class="annottext">XPState -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var hs-var">operationMode</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPOperationMode"><span class="hs-identifier hs-type">XPOperationMode</span></a></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="highlightedCompl"><span class="annot"><span class="annottext">XPState -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var hs-var">highlightedCompl</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="gcon"><span class="annot"><span class="annottext">XPState -&gt; GC
</span><a href="XMonad.Prompt.html#gcon"><span class="hs-identifier hs-var hs-var">gcon</span></a></span></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="fontS"><span class="annot"><span class="annottext">XPState -&gt; XMonadFont
</span><a href="XMonad.Prompt.html#fontS"><span class="hs-identifier hs-var hs-var">fontS</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="commandHistory"><span class="annot"><span class="annottext">XPState -&gt; Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var hs-var">commandHistory</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="offset"><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-150"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="config"><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="successful"><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#successful"><span class="hs-identifier hs-var hs-var">successful</span></a></span></span><span>            </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="numlockMask"><span class="annot"><span class="annottext">XPState -&gt; KeyMask
</span><a href="XMonad.Prompt.html#numlockMask"><span class="hs-identifier hs-var hs-var">numlockMask</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="done"><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#done"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="modeDone"><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#modeDone"><span class="hs-identifier hs-var hs-var">modeDone</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="color"><span class="annot"><span class="annottext">XPState -&gt; XPColor
</span><a href="XMonad.Prompt.html#color"><span class="hs-identifier hs-var hs-var">color</span></a></span></span><span>                 </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="prompter"><span class="annot"><span class="annottext">XPState -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#prompter"><span class="hs-identifier hs-var hs-var">prompter</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="eventBuffer"><span class="annot"><span class="annottext">XPState -&gt; [(Window, String, Event)]
</span><a href="XMonad.Prompt.html#eventBuffer"><span class="hs-identifier hs-var hs-var">eventBuffer</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="inputBuffer"><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#inputBuffer"><span class="hs-identifier hs-var hs-var">inputBuffer</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="currentCompletions"><span class="annot"><span class="annottext">XPState -&gt; Maybe [String]
</span><a href="XMonad.Prompt.html#currentCompletions"><span class="hs-identifier hs-var hs-var">currentCompletions</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-keyword">data</span><span> </span><span id="XPConfig"><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-var">XPConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>    </span><span id="XPC"><span class="annot"><a href="XMonad.Prompt.html#XPC"><span class="hs-identifier hs-var">XPC</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="font"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#font"><span class="hs-identifier hs-var hs-var">font</span></a></span></span><span>                  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Font. For TrueType fonts, use something like</span><span>
</span><span id="line-164"></span><span>                                                </span><span class="hs-comment">-- @&quot;xft:Hack:pixelsize=1&quot;@. Alternatively, use X Logical Font</span><span>
</span><span id="line-165"></span><span>                                                </span><span class="hs-comment">-- Description, i.e. something like</span><span>
</span><span id="line-166"></span><span>                                                </span><span class="hs-comment">-- @&quot;-*-dejavu sans mono-medium-r-normal--*-80-*-*-*-*-iso10646-1&quot;@.</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="bgColor"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#bgColor"><span class="hs-identifier hs-var hs-var">bgColor</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Background color</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="fgColor"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#fgColor"><span class="hs-identifier hs-var hs-var">fgColor</span></a></span></span><span>               </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Font color</span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="bgHLight"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#bgHLight"><span class="hs-identifier hs-var hs-var">bgHLight</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Background color of a highlighted completion entry</span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="fgHLight"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#fgHLight"><span class="hs-identifier hs-var hs-var">fgHLight</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Font color of a highlighted completion entry</span><span>
</span><span id="line-171"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="borderColor"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#borderColor"><span class="hs-identifier hs-var hs-var">borderColor</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Border color</span><span>
</span><span id="line-172"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="promptBorderWidth"><span class="annot"><span class="annottext">XPConfig -&gt; Dimension
</span><a href="XMonad.Prompt.html#promptBorderWidth"><span class="hs-identifier hs-var hs-var">promptBorderWidth</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>   </span><span class="hs-comment">-- ^ Border width</span><span>
</span><span id="line-173"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="position"><span class="annot"><span class="annottext">XPConfig -&gt; XPPosition
</span><a href="XMonad.Prompt.html#position"><span class="hs-identifier hs-var hs-var">position</span></a></span></span><span>              </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPPosition"><span class="hs-identifier hs-type">XPPosition</span></a></span><span>   </span><span class="hs-comment">-- ^ Position: 'Top', 'Bottom', or 'CenteredAt'</span><span>
</span><span id="line-174"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="alwaysHighlight"><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>        </span><span class="hs-comment">-- ^ Always highlight an item, overriden to True with multiple modes</span><span>
</span><span id="line-175"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="height"><span class="annot"><span class="annottext">XPConfig -&gt; Dimension
</span><a href="XMonad.Prompt.html#height"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>   </span><span class="hs-comment">-- ^ Window height</span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="maxComplRows"><span class="annot"><span class="annottext">XPConfig -&gt; Maybe Dimension
</span><a href="XMonad.Prompt.html#maxComplRows"><span class="hs-identifier hs-var hs-var">maxComplRows</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>
</span><span id="line-177"></span><span>                                                </span><span class="hs-comment">-- ^ Just x: maximum number of rows to show in completion window</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="maxComplColumns"><span class="annot"><span class="annottext">XPConfig -&gt; Maybe Dimension
</span><a href="XMonad.Prompt.html#maxComplColumns"><span class="hs-identifier hs-var hs-var">maxComplColumns</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>
</span><span id="line-179"></span><span>                                                </span><span class="hs-comment">-- ^ Just x: maximum number of columns to show in completion window</span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="historySize"><span class="annot"><span class="annottext">XPConfig -&gt; Int
</span><a href="XMonad.Prompt.html#historySize"><span class="hs-identifier hs-var hs-var">historySize</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>         </span><span class="hs-comment">-- ^ The number of history entries to be saved</span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="historyFilter"><span class="annot"><span class="annottext">XPConfig -&gt; [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#historyFilter"><span class="hs-identifier hs-var hs-var">historyFilter</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>                                                </span><span class="hs-comment">-- ^ a filter to determine which</span><span>
</span><span id="line-183"></span><span>                                                </span><span class="hs-comment">-- history entries to remember</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="promptKeymap"><span class="annot"><span class="annottext">XPConfig -&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#promptKeymap"><span class="hs-identifier hs-var hs-var">promptKeymap</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                                                </span><span class="hs-comment">-- ^ Mapping from key combinations to actions</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="completionKey"><span class="annot"><span class="annottext">XPConfig -&gt; (KeyMask, Window)
</span><a href="XMonad.Prompt.html#completionKey"><span class="hs-identifier hs-var hs-var">completionKey</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ Key that should trigger completion</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="changeModeKey"><span class="annot"><span class="annottext">XPConfig -&gt; Window
</span><a href="XMonad.Prompt.html#changeModeKey"><span class="hs-identifier hs-var hs-var">changeModeKey</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span>       </span><span class="hs-comment">-- ^ Key to change mode (when the prompt has multiple modes)</span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="defaultText"><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#defaultText"><span class="hs-identifier hs-var hs-var">defaultText</span></a></span></span><span>           </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ The text by default in the prompt line</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="autoComplete"><span class="annot"><span class="annottext">XPConfig -&gt; Maybe Int
</span><a href="XMonad.Prompt.html#autoComplete"><span class="hs-identifier hs-var hs-var">autoComplete</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-comment">-- ^ Just x: if only one completion remains, auto-select it,</span><span>
</span><span id="line-190"></span><span>                                                </span><span class="hs-comment">--   and delay by x microseconds</span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="showCompletionOnTab"><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#showCompletionOnTab"><span class="hs-identifier hs-var hs-var">showCompletionOnTab</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>         </span><span class="hs-comment">-- ^ Only show list of completions when Tab was pressed</span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="complCaseSensitivity"><span class="annot"><span class="annottext">XPConfig -&gt; ComplCaseSensitivity
</span><a href="XMonad.Prompt.html#complCaseSensitivity"><span class="hs-identifier hs-var hs-var">complCaseSensitivity</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplCaseSensitivity"><span class="hs-identifier hs-type">ComplCaseSensitivity</span></a></span><span>
</span><span id="line-193"></span><span>                                                </span><span class="hs-comment">-- ^ Perform completion in a case-sensitive manner</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="searchPredicate"><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; String -&gt; Bool
</span><a href="XMonad.Prompt.html#searchPredicate"><span class="hs-identifier hs-var hs-var">searchPredicate</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-195"></span><span>                                                </span><span class="hs-comment">-- ^ Given the typed string and a possible</span><span>
</span><span id="line-196"></span><span>                                                </span><span class="hs-comment">--   completion, is the completion valid?</span><span>
</span><span id="line-197"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="defaultPrompter"><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#defaultPrompter"><span class="hs-identifier hs-var hs-var">defaultPrompter</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-198"></span><span>                                                </span><span class="hs-comment">-- ^ Modifies the prompt given by 'showXPrompt'</span><span>
</span><span id="line-199"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="sorter"><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#sorter"><span class="hs-identifier hs-var hs-var">sorter</span></a></span></span><span>                </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>                                                </span><span class="hs-comment">-- ^ Used to sort the possible completions by how well they</span><span>
</span><span id="line-201"></span><span>                                                </span><span class="hs-comment">--   match the search string (see X.P.FuzzyMatch for an</span><span>
</span><span id="line-202"></span><span>                                                </span><span class="hs-comment">--   example).</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-keyword">data</span><span> </span><span id="XPType"><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-var">XPType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679390381"><span class="annot"><a href="#local-6989586621679390381"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390381"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="XPT"><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-var">XPT</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679390381"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-206"></span><span class="hs-keyword">type</span><span> </span><span id="ComplFunction"><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-var">ComplFunction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-207"></span><span class="hs-keyword">type</span><span> </span><span id="XPMode"><span class="annot"><a href="XMonad.Prompt.html#XPMode"><span class="hs-identifier hs-var">XPMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span><span>
</span><span id="line-208"></span><span class="hs-keyword">data</span><span> </span><span id="XPOperationMode"><span class="annot"><a href="XMonad.Prompt.html#XPOperationMode"><span class="hs-identifier hs-var">XPOperationMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XPSingleMode"><span class="annot"><a href="XMonad.Prompt.html#XPSingleMode"><span class="hs-identifier hs-var">XPSingleMode</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="XPMultipleModes"><span class="annot"><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-var">XPMultipleModes</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-keyword">data</span><span> </span><span id="ComplCaseSensitivity"><span class="annot"><a href="XMonad.Prompt.html#ComplCaseSensitivity"><span class="hs-identifier hs-var">ComplCaseSensitivity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CaseSensitive"><span class="annot"><a href="XMonad.Prompt.html#CaseSensitive"><span class="hs-identifier hs-var">CaseSensitive</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="CaseInSensitive"><span class="annot"><a href="XMonad.Prompt.html#CaseInSensitive"><span class="hs-identifier hs-var">CaseInSensitive</span></a></span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679390039"><span id="local-6989586621679390042"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>    </span><span id="local-6989586621679390037"><span class="annot"><span class="annottext">show :: XPType -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-type">XPT</span></a></span><span> </span><span id="local-6989586621679390035"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390035"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; String
forall t. XPrompt t =&gt; t -&gt; String
</span><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-var">showXPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390035"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621679390026"><span class="annot"><span class="annottext">showXPrompt :: XPType -&gt; String
</span><a href="#local-6989586621679390026"><span class="hs-identifier hs-var hs-var hs-var hs-var">showXPrompt</span></a></span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621679390025"><span class="annot"><span class="annottext">nextCompletion :: XPType -&gt; String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#nextCompletion"><span class="hs-identifier hs-var hs-var hs-var hs-var">nextCompletion</span></a></span></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-type">XPT</span></a></span><span> </span><span id="local-6989586621679390023"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390023"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; String -&gt; [String] -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#nextCompletion"><span class="hs-identifier hs-var">nextCompletion</span></a></span><span>      </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390023"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span id="local-6989586621679390022"><span class="annot"><span class="annottext">commandToComplete :: XPType -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-var hs-var hs-var hs-var">commandToComplete</span></a></span></span><span>   </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-type">XPT</span></a></span><span> </span><span id="local-6989586621679390020"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390020"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-var">commandToComplete</span></a></span><span>   </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390020"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span id="local-6989586621679390019"><span class="annot"><span class="annottext">completionToCommand :: XPType -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-var hs-var hs-var hs-var">completionToCommand</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-type">XPT</span></a></span><span> </span><span id="local-6989586621679390017"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390017"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-var">completionToCommand</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390017"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679390016"><span class="annot"><span class="annottext">completionFunction :: XPType -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#completionFunction"><span class="hs-identifier hs-var hs-var hs-var hs-var">completionFunction</span></a></span></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-type">XPT</span></a></span><span> </span><span id="local-6989586621679390014"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390014"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; ComplFunction
forall t. XPrompt t =&gt; t -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#completionFunction"><span class="hs-identifier hs-var">completionFunction</span></a></span><span>  </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390014"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679390013"><span class="annot"><span class="annottext">modeAction :: XPType -&gt; String -&gt; String -&gt; X ()
</span><a href="XMonad.Prompt.html#modeAction"><span class="hs-identifier hs-var hs-var hs-var hs-var">modeAction</span></a></span></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-type">XPT</span></a></span><span> </span><span id="local-6989586621679390011"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390011"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">p -&gt; String -&gt; String -&gt; X ()
forall t. XPrompt t =&gt; t -&gt; String -&gt; String -&gt; X ()
</span><a href="XMonad.Prompt.html#modeAction"><span class="hs-identifier hs-var">modeAction</span></a></span><span>          </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679390011"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | A class for an abstract prompt. In order for your data type to be a</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- valid prompt you _must_ make it an instance of this class.</span><span>
</span><span id="line-225"></span><span class="hs-comment">--</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- The minimal complete definition is just 'showXPrompt', i.e. the name</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- of the prompt. This string will be displayed in the command line</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- window (before the cursor).</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- As an example of a complete 'XPrompt' instance definition, we can</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- look at the 'XMonad.Prompt.Shell.Shell' prompt from</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- &quot;XMonad.Prompt.Shell&quot;:</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- &gt;     data Shell = Shell</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- &gt;     instance XPrompt Shell where</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- &gt;          showXPrompt Shell = &quot;Run: &quot;</span><span>
</span><span id="line-238"></span><span class="hs-keyword">class</span><span> </span><span id="XPrompt"><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-var">XPrompt</span></a></span></span><span> </span><span id="local-6989586621679390433"><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-pragma">{-# MINIMAL</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-pragma hs-type">showXPrompt</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-comment">-- | This method is used to print the string to be</span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-comment">-- displayed in the command line window.</span><span>
</span><span id="line-243"></span><span>    </span><span id="showXPrompt"><span class="annot"><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-type">showXPrompt</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-comment">-- | This method is used to generate the next completion to be</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-comment">-- printed in the command line when tab is pressed, given the</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- string presently in the command line and the list of</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-comment">-- completion.</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- This function is not used when in multiple modes (because alwaysHighlight in XPConfig is True)</span><span>
</span><span id="line-250"></span><span>    </span><span id="nextCompletion"><span class="annot"><a href="XMonad.Prompt.html#nextCompletion"><span class="hs-identifier hs-type">nextCompletion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679390010"><span class="annot"><a href="XMonad.Prompt.html#nextCompletion"><span class="hs-identifier hs-var hs-var">nextCompletion</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; String -&gt; [String] -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#getNextOfLastWord"><span class="hs-identifier hs-var">getNextOfLastWord</span></a></span></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">-- | This method is used to generate the string to be passed to</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-comment">-- the completion function.</span><span>
</span><span id="line-255"></span><span>    </span><span id="commandToComplete"><span class="annot"><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-type">commandToComplete</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-256"></span><span>    </span><span id="local-6989586621679390009"><span class="annot"><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-var hs-var">commandToComplete</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#getLastWord"><span class="hs-identifier hs-var">getLastWord</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- | This method is used to process each completion in order to</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-comment">-- generate the string that will be compared with the command</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- presently displayed in the command line. If the prompt is using</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-comment">-- 'getNextOfLastWord' for implementing 'nextCompletion' (the</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-comment">-- default implementation), this method is also used to generate,</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- from the returned completion, the string that will form the</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- next command line when tab is pressed.</span></span><span>
</span><span id="line-265"></span><span>    </span><span id="completionToCommand"><span class="annot"><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-type">completionToCommand</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621679390008"><span class="annot"><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-var hs-var">completionToCommand</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679390007"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679390007"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679390007"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-comment">-- | When the prompt has multiple modes, this is the function</span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- used to generate the autocompletion list.</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- The argument passed to this function is given by `commandToComplete`</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- The default implementation shows an error message.</span></span><span>
</span><span id="line-272"></span><span>    </span><span id="completionFunction"><span class="annot"><a href="XMonad.Prompt.html#completionFunction"><span class="hs-identifier hs-type">completionFunction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679390006"><span class="annot"><a href="XMonad.Prompt.html#completionFunction"><span class="hs-identifier hs-var hs-var">completionFunction</span></a></span><span> </span><span id="local-6989586621679390005"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679390005"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Completions for &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; String
forall t. XPrompt t =&gt; t -&gt; String
</span><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-var">showXPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679390005"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; could not be loaded&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- | When the prompt has multiple modes (created with mkXPromptWithModes), this function is called</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">-- when the user picks an item from the autocompletion list.</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- The first argument is the prompt (or mode) on which the item was picked</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- The first string argument is the autocompleted item's text.</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-comment">-- The second string argument is the query made by the user (written in the prompt's buffer).</span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- See XMonad/Actions/Launcher.hs for a usage example.</span></span><span>
</span><span id="line-281"></span><span>    </span><span id="modeAction"><span class="annot"><a href="XMonad.Prompt.html#modeAction"><span class="hs-identifier hs-type">modeAction</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679390433"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621679390004"><span class="annot"><a href="XMonad.Prompt.html#modeAction"><span class="hs-identifier hs-var hs-var">modeAction</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-keyword">data</span><span> </span><span id="XPPosition"><span class="annot"><a href="XMonad.Prompt.html#XPPosition"><span class="hs-identifier hs-var">XPPosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Top"><span class="annot"><a href="XMonad.Prompt.html#Top"><span class="hs-identifier hs-var">Top</span></a></span></span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="Bottom"><span class="annot"><a href="XMonad.Prompt.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span></span><span>
</span><span id="line-286"></span><span>                </span><span class="hs-comment">-- | Prompt will be placed in the center horizontally and</span><span>
</span><span id="line-287"></span><span>                </span><span class="hs-comment">--   in the certain place of screen vertically. If it's in the upper</span><span>
</span><span id="line-288"></span><span>                </span><span class="hs-comment">--   part of the screen, completion window will be placed below(like</span><span>
</span><span id="line-289"></span><span>                </span><span class="hs-comment">--   in 'Top') and otherwise above(like in 'Bottom')</span><span>
</span><span id="line-290"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span id="CenteredAt"><span class="annot"><a href="XMonad.Prompt.html#CenteredAt"><span class="hs-identifier hs-var">CenteredAt</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="xpCenterY"><span class="annot"><span class="annottext">XPPosition -&gt; Rational
</span><a href="XMonad.Prompt.html#xpCenterY"><span class="hs-identifier hs-var hs-var">xpCenterY</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-291"></span><span>                             </span><span class="hs-comment">-- ^ Rational between 0 and 1, giving</span><span>
</span><span id="line-292"></span><span>                             </span><span class="hs-comment">-- y coordinate of center of the prompt relative to the screen height.</span><span>
</span><span id="line-293"></span><span>                             </span><span class="hs-special">,</span><span> </span><span id="xpWidth"><span class="annot"><span class="annottext">XPPosition -&gt; Rational
</span><a href="XMonad.Prompt.html#xpWidth"><span class="hs-identifier hs-var hs-var">xpWidth</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span>
</span><span id="line-294"></span><span>                             </span><span class="hs-comment">-- ^ Rational between 0 and 1, giving</span><span>
</span><span id="line-295"></span><span>                             </span><span class="hs-comment">-- width of the prompt relatave to the screen width.</span><span>
</span><span id="line-296"></span><span>                             </span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>                  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389993"><span id="local-6989586621679389995"><span id="local-6989586621679389997"><span class="annot"><span class="annottext">Int -&gt; XPPosition -&gt; String -&gt; String
[XPPosition] -&gt; String -&gt; String
XPPosition -&gt; String
(Int -&gt; XPPosition -&gt; String -&gt; String)
-&gt; (XPPosition -&gt; String)
-&gt; ([XPPosition] -&gt; String -&gt; String)
-&gt; Show XPPosition
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [XPPosition] -&gt; String -&gt; String
$cshowList :: [XPPosition] -&gt; String -&gt; String
show :: XPPosition -&gt; String
$cshow :: XPPosition -&gt; String
showsPrec :: Int -&gt; XPPosition -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; XPPosition -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679389985"><span id="local-6989586621679389987"><span id="local-6989586621679389989"><span id="local-6989586621679389991"><span class="annot"><span class="annottext">ReadPrec [XPPosition]
ReadPrec XPPosition
Int -&gt; ReadS XPPosition
ReadS [XPPosition]
(Int -&gt; ReadS XPPosition)
-&gt; ReadS [XPPosition]
-&gt; ReadPrec XPPosition
-&gt; ReadPrec [XPPosition]
-&gt; Read XPPosition
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [XPPosition]
$creadListPrec :: ReadPrec [XPPosition]
readPrec :: ReadPrec XPPosition
$creadPrec :: ReadPrec XPPosition
readList :: ReadS [XPPosition]
$creadList :: ReadS [XPPosition]
readsPrec :: Int -&gt; ReadS XPPosition
$creadsPrec :: Int -&gt; ReadS XPPosition
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-keyword">data</span><span> </span><span id="XPColor"><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-var">XPColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-300"></span><span>    </span><span id="XPColor"><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-var">XPColor</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="bgNormal"><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Background color</span><span>
</span><span id="line-301"></span><span>            </span><span class="hs-special">,</span><span> </span><span id="fgNormal"><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var hs-var">fgNormal</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Font color</span><span>
</span><span id="line-302"></span><span>            </span><span class="hs-special">,</span><span> </span><span id="bgHighlight"><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgHighlight"><span class="hs-identifier hs-var hs-var">bgHighlight</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Background color of a highlighted completion entry</span><span>
</span><span id="line-303"></span><span>            </span><span class="hs-special">,</span><span> </span><span id="fgHighlight"><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgHighlight"><span class="hs-identifier hs-var hs-var">fgHighlight</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Font color of a highlighted completion entry</span><span>
</span><span id="line-304"></span><span>            </span><span class="hs-special">,</span><span> </span><span id="border"><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var hs-var">border</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="hs-comment">-- ^ Border color</span><span>
</span><span id="line-305"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><a href="XMonad.Prompt.html#amberXPConfig"><span class="hs-identifier hs-type">amberXPConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#greenXPConfig"><span class="hs-identifier hs-type">greenXPConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679389975"><span class="annot"><span class="annottext">def :: XPColor
</span><a href="#local-6989586621679389975"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>        </span><span class="annot"><span class="annottext">XPColor :: String -&gt; String -&gt; String -&gt; String -&gt; String -&gt; XPColor
</span><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bgNormal :: String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var">bgNormal</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;grey22&quot;</span></span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgNormal :: String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var">fgNormal</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;grey80&quot;</span></span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bgHighlight :: String
</span><a href="XMonad.Prompt.html#bgHighlight"><span class="hs-identifier hs-var">bgHighlight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;grey&quot;</span></span><span>
</span><span id="line-314"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgHighlight :: String
</span><a href="XMonad.Prompt.html#fgHighlight"><span class="hs-identifier hs-var">fgHighlight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-315"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">border :: String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var">border</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;white&quot;</span></span><span>
</span><span id="line-316"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>  </span><span id="local-6989586621679389973"><span class="annot"><span class="annottext">def :: XPConfig
</span><a href="#local-6989586621679389973"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#ifdef XFT
</span><span>    </span><span class="annot"><span class="annottext">XPC :: String
-&gt; String
-&gt; String
-&gt; String
-&gt; String
-&gt; String
-&gt; Dimension
-&gt; XPPosition
-&gt; Bool
-&gt; Dimension
-&gt; Maybe Dimension
-&gt; Maybe Dimension
-&gt; Int
-&gt; ([String] -&gt; [String])
-&gt; Map (KeyMask, Window) (XP ())
-&gt; (KeyMask, Window)
-&gt; Window
-&gt; String
-&gt; Maybe Int
-&gt; Bool
-&gt; ComplCaseSensitivity
-&gt; (String -&gt; String -&gt; Bool)
-&gt; (String -&gt; String)
-&gt; (String -&gt; [String] -&gt; [String])
-&gt; XPConfig
</span><a href="XMonad.Prompt.html#XPC"><span class="hs-identifier hs-type">XPC</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">font :: String
</span><a href="XMonad.Prompt.html#font"><span class="hs-identifier hs-var">font</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xft:monospace-12&quot;</span></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-identifier">XPC</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">font</span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-misc-fixed-*-*-*-*-12-*-*-*-*-*-*-*&quot;</span><span class="hs-cpp">
#endif
</span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bgColor :: String
</span><a href="XMonad.Prompt.html#bgColor"><span class="hs-identifier hs-var">bgColor</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-326"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgColor :: String
</span><a href="XMonad.Prompt.html#fgColor"><span class="hs-identifier hs-var">fgColor</span></a></span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var hs-var">fgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bgHLight :: String
</span><a href="XMonad.Prompt.html#bgHLight"><span class="hs-identifier hs-var">bgHLight</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgHighlight"><span class="hs-identifier hs-var hs-var">bgHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-328"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgHLight :: String
</span><a href="XMonad.Prompt.html#fgHLight"><span class="hs-identifier hs-var">fgHLight</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgHighlight"><span class="hs-identifier hs-var hs-var">fgHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">borderColor :: String
</span><a href="XMonad.Prompt.html#borderColor"><span class="hs-identifier hs-var">borderColor</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var hs-var">border</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">promptBorderWidth :: Dimension
</span><a href="XMonad.Prompt.html#promptBorderWidth"><span class="hs-identifier hs-var">promptBorderWidth</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">1</span></span><span>
</span><span id="line-331"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">promptKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#promptKeymap"><span class="hs-identifier hs-var">promptKeymap</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#defaultXPKeymap"><span class="hs-identifier hs-var">defaultXPKeymap</span></a></span><span>
</span><span id="line-332"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">completionKey :: (KeyMask, Window)
</span><a href="XMonad.Prompt.html#completionKey"><span class="hs-identifier hs-var">completionKey</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Tab</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">changeModeKey :: Window
</span><a href="XMonad.Prompt.html#changeModeKey"><span class="hs-identifier hs-var">changeModeKey</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_grave</span></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">position :: XPPosition
</span><a href="XMonad.Prompt.html#position"><span class="hs-identifier hs-var">position</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPPosition
</span><a href="XMonad.Prompt.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">height :: Dimension
</span><a href="XMonad.Prompt.html#height"><span class="hs-identifier hs-var">height</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">18</span></span><span>
</span><span id="line-336"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxComplRows :: Maybe Dimension
</span><a href="XMonad.Prompt.html#maxComplRows"><span class="hs-identifier hs-var">maxComplRows</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Dimension
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxComplColumns :: Maybe Dimension
</span><a href="XMonad.Prompt.html#maxComplColumns"><span class="hs-identifier hs-var">maxComplColumns</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Dimension
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">historySize :: Int
</span><a href="XMonad.Prompt.html#historySize"><span class="hs-identifier hs-var">historySize</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">256</span></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">historyFilter :: [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#historyFilter"><span class="hs-identifier hs-var">historyFilter</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-340"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defaultText :: String
</span><a href="XMonad.Prompt.html#defaultText"><span class="hs-identifier hs-var">defaultText</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-341"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">autoComplete :: Maybe Int
</span><a href="XMonad.Prompt.html#autoComplete"><span class="hs-identifier hs-var">autoComplete</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">showCompletionOnTab :: Bool
</span><a href="XMonad.Prompt.html#showCompletionOnTab"><span class="hs-identifier hs-var">showCompletionOnTab</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">complCaseSensitivity :: ComplCaseSensitivity
</span><a href="XMonad.Prompt.html#complCaseSensitivity"><span class="hs-identifier hs-var">complCaseSensitivity</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComplCaseSensitivity
</span><a href="XMonad.Prompt.html#CaseSensitive"><span class="hs-identifier hs-var">CaseSensitive</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">searchPredicate :: String -&gt; String -&gt; Bool
</span><a href="XMonad.Prompt.html#searchPredicate"><span class="hs-identifier hs-var">searchPredicate</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">alwaysHighlight :: Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var">alwaysHighlight</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">defaultPrompter :: String -&gt; String
</span><a href="XMonad.Prompt.html#defaultPrompter"><span class="hs-identifier hs-var">defaultPrompter</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sorter :: String -&gt; [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#sorter"><span class="hs-identifier hs-var">sorter</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; String -&gt; [String] -&gt; [String]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-349"></span><span id="greenXPConfig"><span class="annot"><span class="annottext">greenXPConfig :: XPConfig
</span><a href="XMonad.Prompt.html#greenXPConfig"><span class="hs-identifier hs-var hs-var">greenXPConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bgColor :: String
</span><a href="XMonad.Prompt.html#bgColor"><span class="hs-identifier hs-var">bgColor</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-350"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgColor :: String
</span><a href="XMonad.Prompt.html#fgColor"><span class="hs-identifier hs-var">fgColor</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;green&quot;</span></span><span>
</span><span id="line-351"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">promptBorderWidth :: Dimension
</span><a href="XMonad.Prompt.html#promptBorderWidth"><span class="hs-identifier hs-var">promptBorderWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">0</span></span><span>
</span><span id="line-352"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-353"></span><span id="amberXPConfig"><span class="annot"><span class="annottext">amberXPConfig :: XPConfig
</span><a href="XMonad.Prompt.html#amberXPConfig"><span class="hs-identifier hs-var hs-var">amberXPConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bgColor :: String
</span><a href="XMonad.Prompt.html#bgColor"><span class="hs-identifier hs-var">bgColor</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;black&quot;</span></span><span>
</span><span id="line-354"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgColor :: String
</span><a href="XMonad.Prompt.html#fgColor"><span class="hs-identifier hs-var">fgColor</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#ca8f2d&quot;</span></span><span>
</span><span id="line-355"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgHLight :: String
</span><a href="XMonad.Prompt.html#fgHLight"><span class="hs-identifier hs-var">fgHLight</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;#eaaf4c&quot;</span></span><span>
</span><span id="line-356"></span><span>                    </span><span class="hs-special">}</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="annot"><a href="XMonad.Prompt.html#initState"><span class="hs-identifier hs-type">initState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPOperationMode"><span class="hs-identifier hs-type">XPOperationMode</span></a></span><span>
</span><span id="line-359"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>
</span><span id="line-360"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span>
</span><span id="line-361"></span><span id="initState"><span class="annot"><span class="annottext">initState :: Display
-&gt; Window
-&gt; Window
-&gt; Rectangle
-&gt; XPOperationMode
-&gt; GC
-&gt; XMonadFont
-&gt; [String]
-&gt; XPConfig
-&gt; KeyMask
-&gt; Dimension
-&gt; XPState
</span><a href="XMonad.Prompt.html#initState"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span id="local-6989586621679389966"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389966"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679389965"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389965"><span class="hs-identifier hs-var">rw</span></a></span></span><span> </span><span id="local-6989586621679389964"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389964"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679389963"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389963"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679389962"><span class="annot"><span class="annottext">XPOperationMode
</span><a href="#local-6989586621679389962"><span class="hs-identifier hs-var">opMode</span></a></span></span><span> </span><span id="local-6989586621679389961"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389961"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span id="local-6989586621679389960"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389960"><span class="hs-identifier hs-var">fonts</span></a></span></span><span> </span><span id="local-6989586621679389959"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389959"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679389958"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389957"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389957"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span id="local-6989586621679389956"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389956"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-362"></span><span>    </span><span class="annot"><span class="annottext">XPS :: Display
-&gt; Window
-&gt; Window
-&gt; Rectangle
-&gt; Dimension
-&gt; Maybe ComplWindowDim
-&gt; (Int, Int)
-&gt; IORef (Maybe Window)
-&gt; Bool
-&gt; XPOperationMode
-&gt; Maybe String
-&gt; GC
-&gt; XMonadFont
-&gt; Stack String
-&gt; Int
-&gt; XPConfig
-&gt; Bool
-&gt; KeyMask
-&gt; Bool
-&gt; Bool
-&gt; XPColor
-&gt; (String -&gt; String)
-&gt; [(Window, String, Event)]
-&gt; String
-&gt; Maybe [String]
-&gt; XPState
</span><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">dpy :: Display
</span><a href="XMonad.Prompt.html#dpy"><span class="hs-identifier hs-var">dpy</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389966"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rootw :: Window
</span><a href="XMonad.Prompt.html#rootw"><span class="hs-identifier hs-var">rootw</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389965"><span class="hs-identifier hs-var">rw</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">win :: Window
</span><a href="XMonad.Prompt.html#win"><span class="hs-identifier hs-var">win</span></a></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389964"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">screen :: Rectangle
</span><a href="XMonad.Prompt.html#screen"><span class="hs-identifier hs-var">screen</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389963"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">winWidth :: Dimension
</span><a href="XMonad.Prompt.html#winWidth"><span class="hs-identifier hs-var">winWidth</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389956"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">complWinDim :: Maybe ComplWindowDim
</span><a href="XMonad.Prompt.html#complWinDim"><span class="hs-identifier hs-var">complWinDim</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-368"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">complWin :: IORef (Maybe Window)
</span><a href="XMonad.Prompt.html#complWin"><span class="hs-identifier hs-var">complWin</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO (IORef (Maybe Window)) -&gt; IORef (Maybe Window)
forall a. IO a -&gt; a
</span><span class="hs-identifier hs-var">unsafePerformIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Window -&gt; IO (IORef (Maybe Window))
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">showComplWin :: Bool
</span><a href="XMonad.Prompt.html#showComplWin"><span class="hs-identifier hs-var">showComplWin</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#showCompletionOnTab"><span class="hs-identifier hs-var hs-var">showCompletionOnTab</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">operationMode :: XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var">operationMode</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPOperationMode
</span><a href="#local-6989586621679389962"><span class="hs-identifier hs-var">opMode</span></a></span><span>
</span><span id="line-371"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">highlightedCompl :: Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var">highlightedCompl</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-372"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">gcon :: GC
</span><a href="XMonad.Prompt.html#gcon"><span class="hs-identifier hs-var">gcon</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389961"><span class="hs-identifier hs-var">gc</span></a></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fontS :: XMonadFont
</span><a href="XMonad.Prompt.html#fontS"><span class="hs-identifier hs-var">fontS</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389960"><span class="hs-identifier hs-var">fonts</span></a></span><span>
</span><span id="line-374"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">commandHistory :: Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var">commandHistory</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack :: forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: String
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#defaultText"><span class="hs-identifier hs-var hs-var">defaultText</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-375"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [String]
</span><span class="hs-identifier hs-var">W.up</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>                                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [String]
</span><span class="hs-identifier hs-var">W.down</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389959"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-377"></span><span>                                          </span><span class="hs-special">}</span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">complIndex :: (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var">complIndex</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">--(column index, row index), used when `alwaysHighlight` in XPConfig is True</span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#defaultText"><span class="hs-identifier hs-var hs-var">defaultText</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">config :: XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var">config</span></a></span><span>                </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">successful :: Bool
</span><a href="XMonad.Prompt.html#successful"><span class="hs-identifier hs-var">successful</span></a></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-382"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">done :: Bool
</span><a href="XMonad.Prompt.html#done"><span class="hs-identifier hs-var">done</span></a></span><span>                  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-383"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">modeDone :: Bool
</span><a href="XMonad.Prompt.html#modeDone"><span class="hs-identifier hs-var">modeDone</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-384"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">numlockMask :: KeyMask
</span><a href="XMonad.Prompt.html#numlockMask"><span class="hs-identifier hs-var">numlockMask</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389957"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">prompter :: String -&gt; String
</span><a href="XMonad.Prompt.html#prompter"><span class="hs-identifier hs-var">prompter</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#defaultPrompter"><span class="hs-identifier hs-var hs-var">defaultPrompter</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-386"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">color :: XPColor
</span><a href="XMonad.Prompt.html#color"><span class="hs-identifier hs-var">color</span></a></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; XPColor
</span><a href="XMonad.Prompt.html#defaultColor"><span class="hs-identifier hs-var">defaultColor</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389958"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">eventBuffer :: [(Window, String, Event)]
</span><a href="XMonad.Prompt.html#eventBuffer"><span class="hs-identifier hs-var">eventBuffer</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-388"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">inputBuffer :: String
</span><a href="XMonad.Prompt.html#inputBuffer"><span class="hs-identifier hs-var">inputBuffer</span></a></span><span>           </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">currentCompletions :: Maybe [String]
</span><a href="XMonad.Prompt.html#currentCompletions"><span class="hs-identifier hs-var">currentCompletions</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [String]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-390"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-391"></span><span>
</span><span id="line-392"></span><span class="hs-comment">-- Returns the current XPType</span><span>
</span><span id="line-393"></span><span class="annot"><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-type">currentXPMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span><span>
</span><span id="line-394"></span><span id="currentXPMode"><span class="annot"><span class="annottext">currentXPMode :: XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var hs-var">currentXPMode</span></a></span></span><span> </span><span id="local-6989586621679389947"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389947"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var hs-var">operationMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389947"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-type">XPMultipleModes</span></a></span><span> </span><span id="local-6989586621679389946"><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389946"><span class="hs-identifier hs-var">modes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; XPType
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389946"><span class="hs-identifier hs-var">modes</span></a></span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPSingleMode"><span class="hs-identifier hs-type">XPSingleMode</span></a></span><span> </span><span class="annot"><span class="annottext">ComplFunction
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679389945"><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389945"><span class="hs-identifier hs-var">xptype</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389945"><span class="hs-identifier hs-var">xptype</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="hs-comment">-- When in multiple modes, this function sets the next mode</span><span>
</span><span id="line-399"></span><span class="hs-comment">-- in the list of modes as active</span><span>
</span><span id="line-400"></span><span class="annot"><a href="XMonad.Prompt.html#setNextMode"><span class="hs-identifier hs-type">setNextMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span>
</span><span id="line-401"></span><span id="setNextMode"><span class="annot"><span class="annottext">setNextMode :: XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setNextMode"><span class="hs-identifier hs-var hs-var">setNextMode</span></a></span></span><span> </span><span id="local-6989586621679389943"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389943"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var hs-var">operationMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389943"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-402"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-type">XPMultipleModes</span></a></span><span> </span><span id="local-6989586621679389942"><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389942"><span class="hs-identifier hs-var">modes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; [XPType]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389942"><span class="hs-identifier hs-var">modes</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-403"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389943"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-comment">-- there is no next mode, return same state</span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679389941"><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389941"><span class="hs-identifier hs-var">m</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679389940"><span class="annot"><span class="annottext">[XPType]
</span><a href="#local-6989586621679389940"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-405"></span><span>      </span><span id="local-6989586621679389939"><span class="annot"><span class="annottext">currentMode :: XPType
</span><a href="#local-6989586621679389939"><span class="hs-identifier hs-var hs-var">currentMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; XPType
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389942"><span class="hs-identifier hs-var">modes</span></a></span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389943"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">operationMode :: XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var">operationMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-var">XPMultipleModes</span></a></span><span> </span><span class="annot"><span class="annottext">Stack :: forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">up :: [XPType]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">focus :: XPType
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389941"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [XPType]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[XPType]
</span><a href="#local-6989586621679389940"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">[XPType] -&gt; [XPType] -&gt; [XPType]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389939"><span class="hs-identifier hs-var">currentMode</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span class="hs-special">}</span><span> </span><span class="hs-comment">--set next and move previous current mode to the of the stack</span><span>
</span><span id="line-407"></span><span>  </span><span class="annot"><span class="annottext">XPOperationMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389943"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-comment">--nothing to do, the prompt's operation has only one mode</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- Returns the highlighted item</span><span>
</span><span id="line-410"></span><span class="annot"><a href="XMonad.Prompt.html#highlightedItem"><span class="hs-identifier hs-type">highlightedItem</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-411"></span><span id="highlightedItem"><span class="annot"><span class="annottext">highlightedItem :: XPState -&gt; [String] -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedItem"><span class="hs-identifier hs-var hs-var">highlightedItem</span></a></span></span><span> </span><span id="local-6989586621679389937"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389937"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span id="local-6989586621679389936"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389936"><span class="hs-identifier hs-var">completions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Maybe ComplWindowDim
</span><a href="XMonad.Prompt.html#complWinDim"><span class="hs-identifier hs-var hs-var">complWinDim</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389937"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-412"></span><span>  </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-comment">-- when there isn't any compl win, we can't say how many cols,rows there are</span><span>
</span><span id="line-413"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389935"><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389935"><span class="hs-identifier hs-var">winDim</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-keyword">let</span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389933"><span class="annot"><span class="annottext">[Position]
cwCols :: ComplWindowDim -&gt; [Position]
cwCols :: [Position]
</span><a href="XMonad.Prompt.html#cwCols"><span class="hs-identifier hs-var hs-var">cwCols</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389931"><span class="annot"><span class="annottext">[Position]
cwRows :: ComplWindowDim -&gt; [Position]
cwRows :: [Position]
</span><a href="XMonad.Prompt.html#cwRows"><span class="hs-identifier hs-var hs-var">cwRows</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389935"><span class="hs-identifier hs-var">winDim</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span id="local-6989586621679389929"><span class="annot"><span class="annottext">complMatrix :: [[String]]
</span><a href="#local-6989586621679389929"><span class="hs-identifier hs-var hs-var">complMatrix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [[String]]
forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="XMonad.Prelude.html#chunksOf"><span class="hs-identifier hs-var">chunksOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389931"><span class="hs-identifier hs-var">cwRows</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389933"><span class="hs-identifier hs-var">cwCols</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389931"><span class="hs-identifier hs-var">cwRows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389936"><span class="hs-identifier hs-var">completions</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679389925"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389925"><span class="hs-identifier hs-var">col_index</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389924"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389924"><span class="hs-identifier hs-var">row_index</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var hs-var">complIndex</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389937"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389936"><span class="hs-identifier hs-var">completions</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-419"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679389929"><span class="hs-identifier hs-var">complMatrix</span></a></span><span> </span><span class="annot"><span class="annottext">[[String]] -&gt; Int -&gt; Maybe [String]
forall a. [a] -&gt; Int -&gt; Maybe a
</span><a href="XMonad.Prelude.html#%21%3F"><span class="hs-operator hs-var">!?</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389925"><span class="hs-identifier hs-var">col_index</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [String] -&gt; ([String] -&gt; Maybe String) -&gt; Maybe String
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; Maybe String
forall a. [a] -&gt; Int -&gt; Maybe a
</span><a href="XMonad.Prelude.html#%21%3F"><span class="hs-operator hs-var">!?</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389924"><span class="hs-identifier hs-var">row_index</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="hs-comment">-- | Return the selected completion, i.e. the 'String' we actually act</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- upon after the user confirmed their selection (by pressing @Enter@).</span><span>
</span><span id="line-424"></span><span class="annot"><a href="XMonad.Prompt.html#selectedCompletion"><span class="hs-identifier hs-type">selectedCompletion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-425"></span><span id="selectedCompletion"><span class="annot"><span class="annottext">selectedCompletion :: XPState -&gt; String
</span><a href="XMonad.Prompt.html#selectedCompletion"><span class="hs-identifier hs-var hs-var">selectedCompletion</span></a></span></span><span> </span><span id="local-6989586621679389921"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389921"><span class="hs-identifier hs-var">st</span></a></span></span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-comment">-- If 'alwaysHighlight' is used, look at the currently selected item (if any)</span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389921"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389921"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; String) -&gt; Maybe String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var hs-var">highlightedCompl</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389921"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-comment">-- Otherwise, look at what the user actually wrote so far</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389921"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-430"></span><span>
</span><span id="line-431"></span><span class="hs-comment">-- this would be much easier with functional references</span><span>
</span><span id="line-432"></span><span class="annot"><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-type">command</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-433"></span><span id="command"><span class="annot"><span class="annottext">command :: XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var hs-var">command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; String
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; String)
-&gt; (XPState -&gt; Stack String) -&gt; XPState -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var hs-var">commandHistory</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="annot"><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-type">setCommand</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span>
</span><span id="line-436"></span><span id="setCommand"><span class="annot"><span class="annottext">setCommand :: String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var hs-var">setCommand</span></a></span></span><span> </span><span id="local-6989586621679389916"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389916"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679389915"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389915"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389915"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">commandHistory :: Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var">commandHistory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var hs-var">commandHistory</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389915"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: String
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389916"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | Sets the input string to the given value.</span><span>
</span><span id="line-439"></span><span class="annot"><a href="XMonad.Prompt.html#setInput"><span class="hs-identifier hs-type">setInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span id="setInput"><span class="annot"><span class="annottext">setInput :: String -&gt; XP ()
</span><a href="XMonad.Prompt.html#setInput"><span class="hs-identifier hs-var hs-var">setInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ())
-&gt; (String -&gt; XPState -&gt; XPState) -&gt; String -&gt; XP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">-- | Returns the current input string. Intented for use in custom keymaps</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- where 'get' or similar can't be used to retrieve it.</span><span>
</span><span id="line-444"></span><span class="annot"><a href="XMonad.Prompt.html#getInput"><span class="hs-identifier hs-type">getInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-445"></span><span id="getInput"><span class="annot"><span class="annottext">getInput :: XP String
</span><a href="XMonad.Prompt.html#getInput"><span class="hs-identifier hs-var hs-var">getInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String) -&gt; XP String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span class="hs-comment">-- | Returns the offset of the current input string. Intended for use in custom</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- keys where 'get' or similar can't be used to retrieve it.</span><span>
</span><span id="line-449"></span><span class="annot"><a href="XMonad.Prompt.html#getOffset"><span class="hs-identifier hs-type">getOffset</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-450"></span><span id="getOffset"><span class="annot"><span class="annottext">getOffset :: XP Int
</span><a href="XMonad.Prompt.html#getOffset"><span class="hs-identifier hs-var hs-var">getOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Int) -&gt; XP Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- | Accessor encapsulating disparate color fields of 'XPConfig' into an</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- 'XPColor' (the configuration provides default values).</span><span>
</span><span id="line-454"></span><span class="annot"><a href="XMonad.Prompt.html#defaultColor"><span class="hs-identifier hs-type">defaultColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span>
</span><span id="line-455"></span><span id="defaultColor"><span class="annot"><span class="annottext">defaultColor :: XPConfig -&gt; XPColor
</span><a href="XMonad.Prompt.html#defaultColor"><span class="hs-identifier hs-var hs-var">defaultColor</span></a></span></span><span> </span><span id="local-6989586621679389912"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389912"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor :: String -&gt; String -&gt; String -&gt; String -&gt; String -&gt; XPColor
</span><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">bgNormal :: String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var">bgNormal</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#bgColor"><span class="hs-identifier hs-var hs-var">bgColor</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389912"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-456"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgNormal :: String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var">fgNormal</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#fgColor"><span class="hs-identifier hs-var hs-var">fgColor</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389912"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-457"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bgHighlight :: String
</span><a href="XMonad.Prompt.html#bgHighlight"><span class="hs-identifier hs-var">bgHighlight</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#bgHLight"><span class="hs-identifier hs-var hs-var">bgHLight</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389912"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-458"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fgHighlight :: String
</span><a href="XMonad.Prompt.html#fgHighlight"><span class="hs-identifier hs-var">fgHighlight</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#fgHLight"><span class="hs-identifier hs-var hs-var">fgHLight</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389912"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-459"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">border :: String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var">border</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#borderColor"><span class="hs-identifier hs-var hs-var">borderColor</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389912"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-460"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- | Modify the prompt colors.</span><span>
</span><span id="line-463"></span><span class="annot"><a href="XMonad.Prompt.html#modifyColor"><span class="hs-identifier hs-type">modifyColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span id="modifyColor"><span class="annot"><span class="annottext">modifyColor :: (XPColor -&gt; XPColor) -&gt; XP ()
</span><a href="XMonad.Prompt.html#modifyColor"><span class="hs-identifier hs-var hs-var">modifyColor</span></a></span></span><span> </span><span id="local-6989586621679389911"><span class="annot"><span class="annottext">XPColor -&gt; XPColor
</span><a href="#local-6989586621679389911"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389910"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389910"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389910"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">color :: XPColor
</span><a href="XMonad.Prompt.html#color"><span class="hs-identifier hs-var">color</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; XPColor
</span><a href="#local-6989586621679389911"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">(XPColor -&gt; XPColor) -&gt; XPColor -&gt; XPColor
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPColor
</span><a href="XMonad.Prompt.html#color"><span class="hs-identifier hs-var hs-var">color</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389910"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Set the prompt colors.</span><span>
</span><span id="line-467"></span><span class="annot"><a href="XMonad.Prompt.html#setColor"><span class="hs-identifier hs-type">setColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span id="setColor"><span class="annot"><span class="annottext">setColor :: XPColor -&gt; XP ()
</span><a href="XMonad.Prompt.html#setColor"><span class="hs-identifier hs-var hs-var">setColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPColor -&gt; XPColor) -&gt; XP ()
</span><a href="XMonad.Prompt.html#modifyColor"><span class="hs-identifier hs-var">modifyColor</span></a></span><span> </span><span class="annot"><span class="annottext">((XPColor -&gt; XPColor) -&gt; XP ())
-&gt; (XPColor -&gt; XPColor -&gt; XPColor) -&gt; XPColor -&gt; XP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; XPColor -&gt; XPColor
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">-- | Reset the prompt colors to those from 'XPConfig'.</span><span>
</span><span id="line-471"></span><span class="annot"><a href="XMonad.Prompt.html#resetColor"><span class="hs-identifier hs-type">resetColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span id="resetColor"><span class="annot"><span class="annottext">resetColor :: XP ()
</span><a href="XMonad.Prompt.html#resetColor"><span class="hs-identifier hs-var hs-var">resetColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPColor) -&gt; StateT XPState IO XPColor
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; XPColor
</span><a href="XMonad.Prompt.html#defaultColor"><span class="hs-identifier hs-var">defaultColor</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; XPColor)
-&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; XPColor
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPColor -&gt; (XPColor -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; XP ()
</span><a href="XMonad.Prompt.html#setColor"><span class="hs-identifier hs-var">setColor</span></a></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-comment">-- | Set the prompt border color.</span><span>
</span><span id="line-475"></span><span class="annot"><a href="XMonad.Prompt.html#setBorderColor"><span class="hs-identifier hs-type">setBorderColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span>
</span><span id="line-476"></span><span id="setBorderColor"><span class="annot"><span class="annottext">setBorderColor :: String -&gt; XPColor -&gt; XPColor
</span><a href="XMonad.Prompt.html#setBorderColor"><span class="hs-identifier hs-var hs-var">setBorderColor</span></a></span></span><span> </span><span id="local-6989586621679389909"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389909"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span id="local-6989586621679389908"><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389908"><span class="hs-identifier hs-var">xpc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389908"><span class="hs-identifier hs-var">xpc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">border :: String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var">border</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389909"><span class="hs-identifier hs-var">bc</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- | Modify the prompter, i.e. for chaining prompters.</span><span>
</span><span id="line-479"></span><span class="annot"><a href="XMonad.Prompt.html#modifyPrompter"><span class="hs-identifier hs-type">modifyPrompter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span id="modifyPrompter"><span class="annot"><span class="annottext">modifyPrompter :: ((String -&gt; String) -&gt; String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#modifyPrompter"><span class="hs-identifier hs-var hs-var">modifyPrompter</span></a></span></span><span> </span><span id="local-6989586621679389907"><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
</span><a href="#local-6989586621679389907"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389906"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389906"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389906"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">prompter :: String -&gt; String
</span><a href="XMonad.Prompt.html#prompter"><span class="hs-identifier hs-var">prompter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
</span><a href="#local-6989586621679389907"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">((String -&gt; String) -&gt; String -&gt; String)
-&gt; (String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#prompter"><span class="hs-identifier hs-var hs-var">prompter</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389906"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Set the prompter.</span><span>
</span><span id="line-483"></span><span class="annot"><a href="XMonad.Prompt.html#setPrompter"><span class="hs-identifier hs-type">setPrompter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span id="setPrompter"><span class="annot"><span class="annottext">setPrompter :: (String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#setPrompter"><span class="hs-identifier hs-var hs-var">setPrompter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((String -&gt; String) -&gt; String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#modifyPrompter"><span class="hs-identifier hs-var">modifyPrompter</span></a></span><span> </span><span class="annot"><span class="annottext">(((String -&gt; String) -&gt; String -&gt; String) -&gt; XP ())
-&gt; ((String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String)
-&gt; (String -&gt; String)
-&gt; XP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- | Reset the prompter to the one from 'XPConfig'.</span><span>
</span><span id="line-487"></span><span class="annot"><a href="XMonad.Prompt.html#resetPrompter"><span class="hs-identifier hs-type">resetPrompter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span id="resetPrompter"><span class="annot"><span class="annottext">resetPrompter :: XP ()
</span><a href="XMonad.Prompt.html#resetPrompter"><span class="hs-identifier hs-var hs-var">resetPrompter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String -&gt; String)
-&gt; StateT XPState IO (String -&gt; String)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#defaultPrompter"><span class="hs-identifier hs-var hs-var">defaultPrompter</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; String -&gt; String)
-&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO (String -&gt; String)
-&gt; ((String -&gt; String) -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#setPrompter"><span class="hs-identifier hs-var">setPrompter</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | Set the current completion list, or 'Nothing' to invalidate the current</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- completions.</span><span>
</span><span id="line-492"></span><span class="annot"><a href="XMonad.Prompt.html#setCurrentCompletions"><span class="hs-identifier hs-type">setCurrentCompletions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span id="setCurrentCompletions"><span class="annot"><span class="annottext">setCurrentCompletions :: Maybe [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#setCurrentCompletions"><span class="hs-identifier hs-var hs-var">setCurrentCompletions</span></a></span></span><span> </span><span id="local-6989586621679389904"><span class="annot"><span class="annottext">Maybe [String]
</span><a href="#local-6989586621679389904"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389903"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389903"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389903"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">currentCompletions :: Maybe [String]
</span><a href="XMonad.Prompt.html#currentCompletions"><span class="hs-identifier hs-var">currentCompletions</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [String]
</span><a href="#local-6989586621679389904"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span class="hs-comment">-- | Get the current completion list.</span><span>
</span><span id="line-496"></span><span class="annot"><a href="XMonad.Prompt.html#getCurrentCompletions"><span class="hs-identifier hs-type">getCurrentCompletions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span id="getCurrentCompletions"><span class="annot"><span class="annottext">getCurrentCompletions :: XP (Maybe [String])
</span><a href="XMonad.Prompt.html#getCurrentCompletions"><span class="hs-identifier hs-var hs-var">getCurrentCompletions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Maybe [String]) -&gt; XP (Maybe [String])
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Maybe [String]
</span><a href="XMonad.Prompt.html#currentCompletions"><span class="hs-identifier hs-var hs-var">currentCompletions</span></a></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="hs-comment">-- | Same as 'mkXPrompt', except that the action function can have</span><span>
</span><span id="line-500"></span><span class="hs-comment">--   type @String -&gt; X a@, for any @a@, and the final action returned</span><span>
</span><span id="line-501"></span><span class="hs-comment">--   by 'mkXPromptWithReturn' will have type @X (Maybe a)@.  @Nothing@</span><span>
</span><span id="line-502"></span><span class="hs-comment">--   is yielded if the user cancels the prompt (by e.g. hitting Esc or</span><span>
</span><span id="line-503"></span><span class="hs-comment">--   Ctrl-G).  For an example of use, see the 'XMonad.Prompt.Input'</span><span>
</span><span id="line-504"></span><span class="hs-comment">--   module.</span><span>
</span><span id="line-505"></span><span id="local-6989586621679390373"><span id="local-6989586621679390374"><span class="annot"><a href="XMonad.Prompt.html#mkXPromptWithReturn"><span class="hs-identifier hs-type">mkXPromptWithReturn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679390374"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679390374"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679390373"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679390373"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-506"></span><span id="mkXPromptWithReturn"><span class="annot"><span class="annottext">mkXPromptWithReturn :: p -&gt; XPConfig -&gt; ComplFunction -&gt; (String -&gt; X a) -&gt; X (Maybe a)
</span><a href="XMonad.Prompt.html#mkXPromptWithReturn"><span class="hs-identifier hs-var hs-var">mkXPromptWithReturn</span></a></span></span><span> </span><span id="local-6989586621679389901"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389901"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679389900"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389900"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679389899"><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389899"><span class="hs-identifier hs-var">compl</span></a></span></span><span> </span><span id="local-6989586621679389898"><span class="annot"><span class="annottext">String -&gt; X a
</span><a href="#local-6989586621679389898"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679389897"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389897"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPConfig -&gt; XPOperationMode -&gt; X XPState
</span><a href="XMonad.Prompt.html#mkXPromptImplementation"><span class="hs-identifier hs-var">mkXPromptImplementation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; String
forall t. XPrompt t =&gt; t -&gt; String
</span><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-var">showXPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389901"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389900"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComplFunction -&gt; XPType -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#XPSingleMode"><span class="hs-identifier hs-var">XPSingleMode</span></a></span><span> </span><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389899"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p -&gt; XPType
forall p. XPrompt p =&gt; p -&gt; XPType
</span><a href="XMonad.Prompt.html#XPT"><span class="hs-identifier hs-var">XPT</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389901"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#successful"><span class="hs-identifier hs-var hs-var">successful</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389897"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-509"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; X a -&gt; X (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; X a
</span><a href="#local-6989586621679389898"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#selectedCompletion"><span class="hs-identifier hs-var">selectedCompletion</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389897"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; X (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | Creates a prompt given:</span><span>
</span><span id="line-513"></span><span class="hs-comment">--</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- * a prompt type, instance of the 'XPrompt' class.</span><span>
</span><span id="line-515"></span><span class="hs-comment">--</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- * a prompt configuration ('def' can be used as a starting point)</span><span>
</span><span id="line-517"></span><span class="hs-comment">--</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- * a completion function ('mkComplFunFromList' can be used to</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- create a completions function given a list of possible completions)</span><span>
</span><span id="line-520"></span><span class="hs-comment">--</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- * an action to be run: the action must take a string and return 'XMonad.X' ()</span><span>
</span><span id="line-522"></span><span id="local-6989586621679389894"><span class="annot"><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-type">mkXPrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679389894"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679389894"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-523"></span><span id="mkXPrompt"><span class="annot"><span class="annottext">mkXPrompt :: p -&gt; XPConfig -&gt; ComplFunction -&gt; (String -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var hs-var">mkXPrompt</span></a></span></span><span> </span><span id="local-6989586621679389893"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389893"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679389892"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389892"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679389891"><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389891"><span class="hs-identifier hs-var">compl</span></a></span></span><span> </span><span id="local-6989586621679389890"><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="#local-6989586621679389890"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Maybe ()) -&gt; X ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(X (Maybe ()) -&gt; X ()) -&gt; X (Maybe ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">p -&gt; XPConfig -&gt; ComplFunction -&gt; (String -&gt; X ()) -&gt; X (Maybe ())
forall p a.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (String -&gt; X a) -&gt; X (Maybe a)
</span><a href="XMonad.Prompt.html#mkXPromptWithReturn"><span class="hs-identifier hs-var">mkXPromptWithReturn</span></a></span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389893"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389892"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389891"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="#local-6989586621679389890"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-524"></span><span>
</span><span id="line-525"></span><span class="hs-comment">-- | Creates a prompt with multiple modes given:</span><span>
</span><span id="line-526"></span><span class="hs-comment">--</span><span>
</span><span id="line-527"></span><span class="hs-comment">-- * A non-empty list of modes</span><span>
</span><span id="line-528"></span><span class="hs-comment">-- * A prompt configuration</span><span>
</span><span id="line-529"></span><span class="hs-comment">--</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- The created prompt allows to switch between modes with `changeModeKey` in `conf`. The modes are</span><span>
</span><span id="line-531"></span><span class="hs-comment">-- instances of XPrompt. See XMonad.Actions.Launcher for more details</span><span>
</span><span id="line-532"></span><span class="hs-comment">--</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- The argument supplied to the action to execute is always the current highlighted item,</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- that means that this prompt overrides the value `alwaysHighlight` for its configuration to True.</span><span>
</span><span id="line-535"></span><span class="annot"><a href="XMonad.Prompt.html#mkXPromptWithModes"><span class="hs-identifier hs-type">mkXPromptWithModes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Prompt.html#XPType"><span class="hs-identifier hs-type">XPType</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span id="mkXPromptWithModes"><span class="annot"><span class="annottext">mkXPromptWithModes :: [XPType] -&gt; XPConfig -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPromptWithModes"><span class="hs-identifier hs-var hs-var">mkXPromptWithModes</span></a></span></span><span> </span><span id="local-6989586621679389888"><span class="annot"><span class="annottext">[XPType]
</span><a href="#local-6989586621679389888"><span class="hs-identifier hs-var">modes</span></a></span></span><span> </span><span id="local-6989586621679389887"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389887"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389886"><span class="annot"><span class="annottext">defaultMode :: XPType
</span><a href="#local-6989586621679389886"><span class="hs-identifier hs-var hs-var">defaultMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[XPType] -&gt; XPType
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[XPType]
</span><a href="#local-6989586621679389888"><span class="hs-identifier hs-var">modes</span></a></span><span>
</span><span id="line-538"></span><span>      </span><span id="local-6989586621679389884"><span class="annot"><span class="annottext">modeStack :: Stack XPType
</span><a href="#local-6989586621679389884"><span class="hs-identifier hs-var hs-var">modeStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack :: forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: XPType
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389886"><span class="hs-identifier hs-var">defaultMode</span></a></span><span> </span><span class="hs-comment">-- Current mode</span><span>
</span><span id="line-539"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [XPType]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-540"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [XPType]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[XPType] -&gt; [XPType]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[XPType]
</span><a href="#local-6989586621679389888"><span class="hs-identifier hs-var">modes</span></a></span><span> </span><span class="hs-comment">-- Other modes</span><span>
</span><span id="line-541"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-542"></span><span>      </span><span id="local-6989586621679389882"><span class="annot"><span class="annottext">om :: XPOperationMode
</span><a href="#local-6989586621679389882"><span class="hs-identifier hs-var hs-var">om</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-var">XPMultipleModes</span></a></span><span> </span><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389884"><span class="hs-identifier hs-var">modeStack</span></a></span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621679389881"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389881"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPConfig -&gt; XPOperationMode -&gt; X XPState
</span><a href="XMonad.Prompt.html#mkXPromptImplementation"><span class="hs-identifier hs-var">mkXPromptImplementation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPType -&gt; String
forall t. XPrompt t =&gt; t -&gt; String
</span><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-var">showXPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">XPType
</span><a href="#local-6989586621679389886"><span class="hs-identifier hs-var">defaultMode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389887"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">alwaysHighlight :: Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var">alwaysHighlight</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">XPOperationMode
</span><a href="#local-6989586621679389882"><span class="hs-identifier hs-var">om</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#successful"><span class="hs-identifier hs-var hs-var">successful</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389881"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var hs-var">operationMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389881"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-546"></span><span>      </span><span class="annot"><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-type">XPMultipleModes</span></a></span><span> </span><span id="local-6989586621679389879"><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389879"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-547"></span><span>        </span><span id="local-6989586621679389878"><span class="annot"><span class="annottext">action :: String -&gt; String -&gt; X ()
</span><a href="#local-6989586621679389878"><span class="hs-identifier hs-var hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String -&gt; String -&gt; X ()
forall t. XPrompt t =&gt; t -&gt; String -&gt; String -&gt; X ()
</span><a href="XMonad.Prompt.html#modeAction"><span class="hs-identifier hs-var">modeAction</span></a></span><span> </span><span class="annot"><span class="annottext">(XPType -&gt; String -&gt; String -&gt; X ())
-&gt; XPType -&gt; String -&gt; String -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; XPType
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389879"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; X ()
</span><a href="#local-6989586621679389878"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389881"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; X ()) -&gt; String -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var hs-var">highlightedCompl</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389881"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>      </span><span class="annot"><span class="annottext">XPOperationMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; X ()
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;The impossible occurred: This prompt runs with multiple modes but they could not be found.&quot;</span></span><span> </span><span class="hs-comment">--we are creating a prompt with multiple modes, so its operationMode should have been constructed with XPMultipleMode</span><span>
</span><span id="line-550"></span><span>
</span><span id="line-551"></span><span class="hs-comment">-- Internal function used to implement 'mkXPromptWithReturn' and</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- 'mkXPromptWithModes'.</span><span>
</span><span id="line-553"></span><span class="annot"><a href="XMonad.Prompt.html#mkXPromptImplementation"><span class="hs-identifier hs-type">mkXPromptImplementation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPOperationMode"><span class="hs-identifier hs-type">XPOperationMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span>
</span><span id="line-554"></span><span id="mkXPromptImplementation"><span class="annot"><span class="annottext">mkXPromptImplementation :: String -&gt; XPConfig -&gt; XPOperationMode -&gt; X XPState
</span><a href="XMonad.Prompt.html#mkXPromptImplementation"><span class="hs-identifier hs-var hs-var">mkXPromptImplementation</span></a></span></span><span> </span><span id="local-6989586621679389876"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389876"><span class="hs-identifier hs-var">historyKey</span></a></span></span><span> </span><span id="local-6989586621679389875"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span id="local-6989586621679389874"><span class="annot"><span class="annottext">XPOperationMode
</span><a href="#local-6989586621679389874"><span class="hs-identifier hs-var">om</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">XConf</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">display :: XConf -&gt; Display
</span><span class="hs-identifier hs-var">display</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389871"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">theRoot :: XConf -&gt; Window
</span><span class="hs-identifier hs-var">theRoot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389869"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389869"><span class="hs-identifier hs-var">rw</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X XConf
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-556"></span><span>  </span><span id="local-6989586621679389867"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389867"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; Rectangle) -&gt; X Rectangle
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XState -&gt; Rectangle) -&gt; X Rectangle)
-&gt; (XState -&gt; Rectangle) -&gt; X Rectangle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScreenDetail -&gt; Rectangle
</span><span class="hs-identifier hs-var hs-var">screenRect</span></span><span> </span><span class="annot"><span class="annottext">(ScreenDetail -&gt; Rectangle)
-&gt; (XState -&gt; ScreenDetail) -&gt; XState -&gt; Rectangle
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Screen String (Layout Window) Window ScreenId ScreenDetail
-&gt; ScreenDetail
forall i l a sid sd. Screen i l a sid sd -&gt; sd
</span><span class="hs-identifier hs-var hs-var">W.screenDetail</span></span><span> </span><span class="annot"><span class="annottext">(Screen String (Layout Window) Window ScreenId ScreenDetail
 -&gt; ScreenDetail)
-&gt; (XState
    -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet String (Layout Window) Window ScreenId ScreenDetail
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">(StackSet String (Layout Window) Window ScreenId ScreenDetail
 -&gt; Screen String (Layout Window) Window ScreenId ScreenDetail)
-&gt; (XState
    -&gt; StackSet String (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; Screen String (Layout Window) Window ScreenId ScreenDetail
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet String (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679389862"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389862"><span class="hs-identifier hs-var">numlock</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; KeyMask) -&gt; X KeyMask
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; KeyMask
</span><span class="hs-identifier hs-var hs-var">X.numberlockMask</span></span><span>
</span><span id="line-558"></span><span>  </span><span id="local-6989586621679389861"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389861"><span class="hs-identifier hs-var">cachedir</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XConf -&gt; String) -&gt; X String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Directories' String -&gt; String
forall a. Directories' a -&gt; a
</span><span class="hs-identifier hs-var hs-var">cacheDir</span></span><span> </span><span class="annot"><span class="annottext">(Directories' String -&gt; String)
-&gt; (XConf -&gt; Directories' String) -&gt; XConf -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Directories' String
</span><span class="hs-identifier hs-var hs-var">directories</span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>  </span><span id="local-6989586621679389857"><span class="annot"><span class="annottext">History
</span><a href="#local-6989586621679389857"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO History -&gt; X History
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO History -&gt; X History) -&gt; IO History -&gt; X History
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO History
</span><a href="XMonad.Prompt.html#readHistory"><span class="hs-identifier hs-var">readHistory</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389861"><span class="hs-identifier hs-var">cachedir</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span id="local-6989586621679389854"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389854"><span class="hs-identifier hs-var">fs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; X XMonadFont
</span><a href="XMonad.Util.Font.html#initXMF"><span class="hs-identifier hs-var">initXMF</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; String
</span><a href="XMonad.Prompt.html#font"><span class="hs-identifier hs-var hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389852"><span class="annot"><span class="annottext">width :: Dimension
</span><a href="#local-6989586621679389852"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; XPPosition -&gt; Dimension
</span><a href="#local-6989586621679389851"><span class="hs-identifier hs-var">getWinWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; XPPosition
</span><a href="XMonad.Prompt.html#position"><span class="hs-identifier hs-var hs-var">position</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>  </span><span id="local-6989586621679389850"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389850"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO XPState -&gt; X XPState
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO XPState -&gt; X XPState) -&gt; IO XPState -&gt; X XPState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-563"></span><span>    </span><span class="annot"><span class="annottext">IO Window
-&gt; (Window -&gt; IO ()) -&gt; (Window -&gt; IO XPState) -&gt; IO XPState
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span>
</span><span id="line-564"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display
-&gt; Window -&gt; XPConfig -&gt; Rectangle -&gt; Dimension -&gt; IO Window
</span><a href="XMonad.Prompt.html#createPromptWin"><span class="hs-identifier hs-var">createPromptWin</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389869"><span class="hs-identifier hs-var">rw</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389852"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">destroyWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389846"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389846"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-567"></span><span>        </span><span class="annot"><span class="annottext">IO GC -&gt; (GC -&gt; IO ()) -&gt; (GC -&gt; IO XPState) -&gt; IO XPState
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span>
</span><span id="line-568"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO GC
</span><span class="hs-identifier hs-var">createGC</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389846"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; IO ()
</span><span class="hs-identifier hs-var">freeGC</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389843"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389843"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>            </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">selectInput</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389846"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; IO ()) -&gt; Window -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">exposureMask</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Window
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">keyPressMask</span></span><span>
</span><span id="line-572"></span><span>            </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">setGraphicsExposures</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389843"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-573"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389837"><span class="annot"><span class="annottext">hs :: [String]
</span><a href="#local-6989586621679389837"><span class="hs-identifier hs-var hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe [String] -&gt; [String]
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">(Maybe [String] -&gt; [String]) -&gt; Maybe [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; History -&gt; Maybe [String]
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389876"><span class="hs-identifier hs-var">historyKey</span></a></span><span> </span><span class="annot"><span class="annottext">History
</span><a href="#local-6989586621679389857"><span class="hs-identifier hs-var">hist</span></a></span><span>
</span><span id="line-574"></span><span>                </span><span id="local-6989586621679389835"><span class="annot"><span class="annottext">st :: XPState
</span><a href="#local-6989586621679389835"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Window
-&gt; Rectangle
-&gt; XPOperationMode
-&gt; GC
-&gt; XMonadFont
-&gt; [String]
-&gt; XPConfig
-&gt; KeyMask
-&gt; Dimension
-&gt; XPState
</span><a href="XMonad.Prompt.html#initState"><span class="hs-identifier hs-var">initState</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389871"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389869"><span class="hs-identifier hs-var">rw</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389846"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">XPOperationMode
</span><a href="#local-6989586621679389874"><span class="hs-identifier hs-var">om</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389843"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389854"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389837"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389862"><span class="hs-identifier hs-var">numlock</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389852"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-575"></span><span>            </span><span class="annot"><span class="annottext">XPState -&gt; IO XPState
</span><a href="XMonad.Prompt.html#runXP"><span class="hs-identifier hs-var">runXP</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389835"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>  </span><span class="annot"><span class="annottext">XMonadFont -&gt; X ()
</span><a href="XMonad.Util.Font.html#releaseXMF"><span class="hs-identifier hs-var">releaseXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389854"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#successful"><span class="hs-identifier hs-var hs-var">successful</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389850"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389832"><span class="annot"><span class="annottext">prune :: [a] -&gt; [a]
</span><a href="#local-6989586621679389832"><span class="hs-identifier hs-var hs-var">prune</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Int
</span><a href="XMonad.Prompt.html#historySize"><span class="hs-identifier hs-var hs-var">historySize</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; X ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; X ()) -&gt; IO () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; History -&gt; IO ()
</span><a href="XMonad.Prompt.html#writeHistory"><span class="hs-identifier hs-var">writeHistory</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389861"><span class="hs-identifier hs-var">cachedir</span></a></span><span> </span><span class="annot"><span class="annottext">(History -&gt; IO ()) -&gt; History -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-580"></span><span>      </span><span class="annot"><span class="annottext">([String] -&gt; [String] -&gt; [String])
-&gt; String -&gt; [String] -&gt; History -&gt; History
forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insertWith</span></span><span>
</span><span id="line-581"></span><span>      </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389829"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389829"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679389828"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389828"><span class="hs-identifier hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. [a] -&gt; [a]
</span><a href="#local-6989586621679389832"><span class="hs-identifier hs-var">prune</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; ([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#historyFilter"><span class="hs-identifier hs-var hs-var">historyFilter</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389829"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389828"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>      </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389876"><span class="hs-identifier hs-var">historyKey</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="hs-comment">-- We need to apply historyFilter before as well, since</span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-comment">-- otherwise the filter would not be applied if there is no</span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-comment">-- history</span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. [a] -&gt; [a]
</span><a href="#local-6989586621679389832"><span class="hs-identifier hs-var">prune</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#historyFilter"><span class="hs-identifier hs-var hs-var">historyFilter</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389875"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#selectedCompletion"><span class="hs-identifier hs-var">selectedCompletion</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389850"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><span class="annottext">History
</span><a href="#local-6989586621679389857"><span class="hs-identifier hs-var">hist</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><span class="annottext">XPState -&gt; X XPState
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389850"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-589"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-comment">-- | Based on the ultimate position of the prompt and the screen</span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-comment">-- dimensions, calculate its width.</span><span>
</span><span id="line-592"></span><span>  </span><span class="annot"><a href="#local-6989586621679389851"><span class="hs-identifier hs-type">getWinWidth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPPosition"><span class="hs-identifier hs-type">XPPosition</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>
</span><span id="line-593"></span><span>  </span><span id="local-6989586621679389851"><span class="annot"><span class="annottext">getWinWidth :: Rectangle -&gt; XPPosition -&gt; Dimension
</span><a href="#local-6989586621679389851"><span class="hs-identifier hs-var hs-var">getWinWidth</span></a></span></span><span> </span><span id="local-6989586621679389827"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389827"><span class="hs-identifier hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#CenteredAt"><span class="hs-identifier hs-type">CenteredAt</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389826"><span class="annot"><span class="annottext">Rational
xpWidth :: Rational
xpWidth :: XPPosition -&gt; Rational
</span><a href="#local-6989586621679389826"><span class="hs-identifier hs-var hs-var">xpWidth</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Dimension
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Dimension) -&gt; Rational -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389827"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389826"><span class="hs-identifier hs-var">xpWidth</span></a></span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><span class="annottext">XPPosition
</span><span class="hs-identifier">_</span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389827"><span class="hs-identifier hs-var">scr</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-comment">-- | Removes numlock and capslock from a keymask.</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- Duplicate of cleanMask from core, but in the</span><span>
</span><span id="line-599"></span><span class="hs-comment">-- XP monad instead of X.</span><span>
</span><span id="line-600"></span><span class="annot"><a href="XMonad.Prompt.html#cleanMask"><span class="hs-identifier hs-type">cleanMask</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span>
</span><span id="line-601"></span><span id="cleanMask"><span class="annot"><span class="annottext">cleanMask :: KeyMask -&gt; XP KeyMask
</span><a href="XMonad.Prompt.html#cleanMask"><span class="hs-identifier hs-var hs-var">cleanMask</span></a></span></span><span> </span><span id="local-6989586621679389821"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389821"><span class="hs-identifier hs-var">msk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-602"></span><span>  </span><span id="local-6989586621679389820"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389820"><span class="hs-identifier hs-var">numlock</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; KeyMask) -&gt; XP KeyMask
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; KeyMask
</span><a href="XMonad.Prompt.html#numlockMask"><span class="hs-identifier hs-var hs-var">numlockMask</span></a></span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389819"><span class="annot"><span class="annottext">highMasks :: KeyMask
</span><a href="#local-6989586621679389819"><span class="hs-identifier hs-var hs-var">highMasks</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; Int -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`shiftL`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; KeyMask
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">1</span></span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><span class="annottext">KeyMask -&gt; XP KeyMask
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389820"><span class="hs-identifier hs-var">numlock</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">lockMask</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389821"><span class="hs-identifier hs-var">msk</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389819"><span class="hs-identifier hs-var">highMasks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- | Inverse of 'Codec.Binary.UTF8.String.utf8Encode', that is, a convenience</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- function that checks to see if the input string is UTF8 encoded before</span><span>
</span><span id="line-608"></span><span class="hs-comment">-- decoding.</span><span>
</span><span id="line-609"></span><span class="annot"><a href="XMonad.Prompt.html#utf8Decode"><span class="hs-identifier hs-type">utf8Decode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-610"></span><span id="utf8Decode"><span class="annot"><span class="annottext">utf8Decode :: String -&gt; String
</span><a href="XMonad.Prompt.html#utf8Decode"><span class="hs-identifier hs-var hs-var">utf8Decode</span></a></span></span><span> </span><span id="local-6989586621679389813"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389813"><span class="hs-identifier hs-var">str</span></a></span></span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><span class="hs-identifier hs-var">isUTF8Encoded</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389813"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><span class="hs-identifier hs-var">decodeString</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389813"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389813"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="annot"><a href="XMonad.Prompt.html#runXP"><span class="hs-identifier hs-type">runXP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span>
</span><span id="line-615"></span><span id="runXP"><span class="annot"><span class="annottext">runXP :: XPState -&gt; IO XPState
</span><a href="XMonad.Prompt.html#runXP"><span class="hs-identifier hs-var hs-var">runXP</span></a></span></span><span> </span><span id="local-6989586621679389812"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389812"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389811"><span class="annot"><span class="annottext">d :: Display
</span><a href="#local-6989586621679389811"><span class="hs-identifier hs-var hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Display
</span><a href="XMonad.Prompt.html#dpy"><span class="hs-identifier hs-var hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389812"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-617"></span><span>      </span><span id="local-6989586621679389810"><span class="annot"><span class="annottext">w :: Window
</span><a href="#local-6989586621679389810"><span class="hs-identifier hs-var hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Window
</span><a href="XMonad.Prompt.html#win"><span class="hs-identifier hs-var hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389812"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="annot"><span class="annottext">IO GrabStatus
-&gt; (GrabStatus -&gt; IO ())
-&gt; (GrabStatus -&gt; IO XPState)
-&gt; IO XPState
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Bool
-&gt; GrabStatus
-&gt; GrabStatus
-&gt; Window
-&gt; IO GrabStatus
</span><span class="hs-identifier hs-var">grabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389811"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389810"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">currentTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">ungrabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389811"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">currentTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389805"><span class="annot"><span class="annottext">GrabStatus
</span><a href="#local-6989586621679389805"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-622"></span><span>      </span><span class="annot"><span class="annottext">XP () -&gt; XPState -&gt; IO XPState
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><span class="hs-identifier hs-var">execStateT</span></span><span>
</span><span id="line-623"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">GrabStatus
</span><a href="#local-6989586621679389805"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">GrabStatus -&gt; GrabStatus -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-identifier hs-var">grabSuccess</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-624"></span><span>          </span><span id="local-6989586621679389802"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389802"><span class="hs-identifier hs-var">ah</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; Bool) -&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389802"><span class="hs-identifier hs-var">ah</span></a></span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>            </span><span id="local-6989586621679389801"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679389801"><span class="hs-identifier hs-var">compl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe String
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Maybe String)
-&gt; StateT XPState IO [String] -&gt; StateT XPState IO (Maybe String)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var">getCompletions</span></a></span><span>
</span><span id="line-627"></span><span>            </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify'</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389797"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389797"><span class="hs-identifier hs-var">xpst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389797"><span class="hs-identifier hs-var">xpst</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">highlightedCompl :: Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var">highlightedCompl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679389801"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-628"></span><span>          </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-629"></span><span>          </span><span class="annot"><span class="annottext">(KeyStroke -&gt; Event -&gt; XP ()) -&gt; StateT XPState IO Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#eventLoop"><span class="hs-identifier hs-var">eventLoop</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleMain"><span class="hs-identifier hs-var">handleMain</span></a></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="XMonad.Prompt.html#evDefaultStop"><span class="hs-identifier hs-var">evDefaultStop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-630"></span><span>        </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389812"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-631"></span><span>      </span><span class="annot"><span class="annottext">IO XPState -&gt; IO () -&gt; IO XPState
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-operator hs-var">`finally`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; IO ()) -&gt; Maybe Window -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">destroyWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389811"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Window -&gt; IO ()) -&gt; IO (Maybe Window) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Window) -&gt; IO (Maybe Window)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; IORef (Maybe Window)
</span><a href="XMonad.Prompt.html#complWin"><span class="hs-identifier hs-var hs-var">complWin</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389812"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>      </span><span class="annot"><span class="annottext">IO XPState -&gt; IO () -&gt; IO XPState
forall a b. IO a -&gt; IO b -&gt; IO a
</span><span class="hs-operator hs-var">`finally`</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">sync</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389811"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>
</span><span id="line-634"></span><span class="hs-keyword">type</span><span> </span><span id="KeyStroke"><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-var">KeyStroke</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span class="hs-comment">-- | Main event &quot;loop&quot;. Gives priority to events from the state's event buffer.</span><span>
</span><span id="line-637"></span><span class="annot"><a href="XMonad.Prompt.html#eventLoop"><span class="hs-identifier hs-type">eventLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-639"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span id="eventLoop"><span class="annot"><span class="annottext">eventLoop :: (KeyStroke -&gt; Event -&gt; XP ()) -&gt; StateT XPState IO Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#eventLoop"><span class="hs-identifier hs-var hs-var">eventLoop</span></a></span></span><span> </span><span id="local-6989586621679389787"><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="#local-6989586621679389787"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679389786"><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="#local-6989586621679389786"><span class="hs-identifier hs-var">stopAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>    </span><span id="local-6989586621679389785"><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389785"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; [(Window, String, Event)])
-&gt; StateT XPState IO [(Window, String, Event)]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; [(Window, String, Event)]
</span><a href="XMonad.Prompt.html#eventBuffer"><span class="hs-identifier hs-var hs-var">eventBuffer</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679389784"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389784"><span class="hs-identifier hs-var">keysym</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389783"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389783"><span class="hs-identifier hs-var">keystr</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389782"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389782"><span class="hs-identifier hs-var">event</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389785"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-643"></span><span>        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-644"></span><span>                </span><span id="local-6989586621679389781"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389781"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Display) -&gt; StateT XPState IO Display
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Display
</span><a href="XMonad.Prompt.html#dpy"><span class="hs-identifier hs-var hs-var">dpy</span></a></span><span>
</span><span id="line-645"></span><span>                </span><span class="annot"><span class="annottext">IO (Window, String, Event)
-&gt; StateT XPState IO (Window, String, Event)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Window, String, Event)
 -&gt; StateT XPState IO (Window, String, Event))
-&gt; IO (Window, String, Event)
-&gt; StateT XPState IO (Window, String, Event)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(XEventPtr -&gt; IO (Window, String, Event))
-&gt; IO (Window, String, Event)
forall a. (XEventPtr -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">allocaXEvent</span></span><span> </span><span class="annot"><span class="annottext">((XEventPtr -&gt; IO (Window, String, Event))
 -&gt; IO (Window, String, Event))
-&gt; (XEventPtr -&gt; IO (Window, String, Event))
-&gt; IO (Window, String, Event)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389779"><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679389779"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-646"></span><span>                    </span><span class="hs-comment">-- Also capture @buttonPressMask@, see Note [Allow ButtonEvents]</span><span>
</span><span id="line-647"></span><span>                    </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; XEventPtr -&gt; IO ()
</span><span class="hs-identifier hs-var">maskEvent</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389781"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">exposureMask</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Window
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">keyPressMask</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Window
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">buttonPressMask</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679389779"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-648"></span><span>                    </span><span id="local-6989586621679389776"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389776"><span class="hs-identifier hs-var">ev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">XEventPtr -&gt; IO Event
</span><span class="hs-identifier hs-var">getEvent</span></span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679389779"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-649"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679389774"><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679389774"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389773"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389773"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">ev_event_type</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389776"><span class="hs-identifier hs-var">ev</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">keyPress</span></span><span>
</span><span id="line-650"></span><span>                              </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">XKeyEventPtr -&gt; IO (Maybe Window, String)
</span><span class="hs-identifier hs-var">lookupString</span></span><span> </span><span class="annot"><span class="annottext">(XKeyEventPtr -&gt; IO (Maybe Window, String))
-&gt; XKeyEventPtr -&gt; IO (Maybe Window, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XEventPtr -&gt; XKeyEventPtr
</span><span class="hs-identifier hs-var">asKeyEvent</span></span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679389779"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-651"></span><span>                              </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Maybe Window, String) -&gt; IO (Maybe Window, String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>                    </span><span class="annot"><span class="annottext">(Window, String, Event) -&gt; IO (Window, String, Event)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; Maybe Window -&gt; Window
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_VoidSymbol</span></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679389774"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389773"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389776"><span class="hs-identifier hs-var">ev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>        </span><span id="local-6989586621679389767"><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389767"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>                </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389766"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389766"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389766"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eventBuffer :: [(Window, String, Event)]
</span><a href="XMonad.Prompt.html#eventBuffer"><span class="hs-identifier hs-var">eventBuffer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Window, String, Event)] -&gt; [(Window, String, Event)]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389767"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-655"></span><span>                </span><span class="annot"><span class="annottext">(Window, String, Event)
-&gt; StateT XPState IO (Window, String, Event)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">((Window, String, Event)
 -&gt; StateT XPState IO (Window, String, Event))
-&gt; (Window, String, Event)
-&gt; StateT XPState IO (Window, String, Event)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(Window, String, Event)] -&gt; (Window, String, Event)
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389767"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="#local-6989586621679389787"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389784"><span class="hs-identifier hs-var">keysym</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389783"><span class="hs-identifier hs-var">keystr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389782"><span class="hs-identifier hs-var">event</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="#local-6989586621679389786"><span class="hs-identifier hs-var">stopAction</span></a></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool -&gt; (Bool -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; XP () -&gt; XP ()) -&gt; XP () -&gt; Bool -&gt; XP ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(KeyStroke -&gt; Event -&gt; XP ()) -&gt; StateT XPState IO Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#eventLoop"><span class="hs-identifier hs-var">eventLoop</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="#local-6989586621679389787"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="#local-6989586621679389786"><span class="hs-identifier hs-var">stopAction</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span class="hs-comment">-- | Default event loop stop condition.</span><span>
</span><span id="line-660"></span><span class="annot"><a href="XMonad.Prompt.html#evDefaultStop"><span class="hs-identifier hs-type">evDefaultStop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-661"></span><span id="evDefaultStop"><span class="annot"><span class="annottext">evDefaultStop :: StateT XPState IO Bool
</span><a href="XMonad.Prompt.html#evDefaultStop"><span class="hs-identifier hs-var hs-var">evDefaultStop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool -&gt; Bool) -&gt; StateT XPState IO (Bool -&gt; Bool)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(||)</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool -&gt; Bool)
-&gt; (XPState -&gt; Bool) -&gt; XPState -&gt; Bool -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#modeDone"><span class="hs-identifier hs-var hs-var">modeDone</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO (Bool -&gt; Bool)
-&gt; StateT XPState IO Bool -&gt; StateT XPState IO Bool
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#done"><span class="hs-identifier hs-var hs-var">done</span></a></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Common patterns shared by all event handlers.</span><span>
</span><span id="line-664"></span><span class="annot"><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-type">handleOther</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-665"></span><span id="handleOther"><span class="annot"><span class="annottext">handleOther :: KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-var hs-var">handleOther</span></a></span></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExposeEvent</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_window :: Event -&gt; Window
</span><span class="hs-identifier hs-var">ev_window</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389759"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389759"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-comment">-- Expose events can be triggered by switching virtual consoles.</span><span>
</span><span id="line-667"></span><span>    </span><span id="local-6989586621679389758"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389758"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Window
</span><a href="XMonad.Prompt.html#win"><span class="hs-identifier hs-var hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389758"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389759"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-669"></span><span class="annot"><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-var">handleOther</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ButtonEvent</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_event_type :: Event -&gt; Dimension
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389755"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389755"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-comment">-- See Note [Allow ButtonEvents]</span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389755"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">buttonPress</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-672"></span><span>        </span><span id="local-6989586621679389753"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389753"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Display) -&gt; StateT XPState IO Display
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Display
</span><a href="XMonad.Prompt.html#dpy"><span class="hs-identifier hs-var hs-var">dpy</span></a></span><span>
</span><span id="line-673"></span><span>        </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; GrabStatus -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">allowEvents</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389753"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-identifier hs-var">replayPointer</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-674"></span><span class="annot"><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-var">handleOther</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; XP ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">{- Note [Allow ButtonEvents]

Some settings (like @clickJustFocuses = False@) set up the passive
pointer grabs that xmonad makes to intercept clicks to unfocused windows
with @pointer_mode = grabModeSync@ and @keyboard_mode = grabModeSync@.
This means that any click in an unfocused window leads to a
pointer/keyboard grab that freezes both devices until 'allowEvents' is
called. But &quot;XMonad.Prompt&quot; has its own X event loop, so 'allowEvents'
is never called and everything remains frozen indefinitely.

This does not happen when the grabs are made with @grabModeAsync@, as
pointer events processing is not frozen and the grab only lasts as long
as the mouse button is pressed.

Hence, in this situation we call 'allowEvents' in the prompts event loop
whenever a button event is received, releasing the pointer grab. In this
case, 'replayPointer' takes care of the fact that these events are not
merely discarded, but passed to the respective application window.
-}</span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-comment">-- | Prompt event handler for the main loop. Dispatches to input, completion</span><span>
</span><span id="line-697"></span><span class="hs-comment">-- and mode switching handlers.</span><span>
</span><span id="line-698"></span><span class="annot"><a href="XMonad.Prompt.html#handleMain"><span class="hs-identifier hs-type">handleMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span id="handleMain"><span class="annot"><span class="annottext">handleMain :: KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleMain"><span class="hs-identifier hs-var hs-var">handleMain</span></a></span></span><span> </span><span id="local-6989586621679389750"><span class="annot"><span class="annottext">stroke :: KeyStroke
</span><a href="#local-6989586621679389750"><span class="hs-identifier hs-var">stroke</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span id="local-6989586621679389749"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389749"><span class="hs-identifier hs-var">keysym</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyEvent</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_event_type :: Event -&gt; Dimension
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389747"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389747"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_state :: Event -&gt; KeyMask
</span><span class="hs-identifier hs-var">ev_state</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389745"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389745"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679389744"><span class="annot"><span class="annottext">(KeyMask, Window)
</span><a href="#local-6989586621679389744"><span class="hs-identifier hs-var">compKey</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389743"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389743"><span class="hs-identifier hs-var">modeKey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; ((KeyMask, Window), Window))
-&gt; StateT XPState IO ((KeyMask, Window), Window)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; ((KeyMask, Window), Window))
 -&gt; StateT XPState IO ((KeyMask, Window), Window))
-&gt; (XPState -&gt; ((KeyMask, Window), Window))
-&gt; StateT XPState IO ((KeyMask, Window), Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; (KeyMask, Window)
</span><a href="XMonad.Prompt.html#completionKey"><span class="hs-identifier hs-var hs-var">completionKey</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; (KeyMask, Window))
-&gt; (XPConfig -&gt; Window) -&gt; XPConfig -&gt; ((KeyMask, Window), Window)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Window
</span><a href="XMonad.Prompt.html#changeModeKey"><span class="hs-identifier hs-var hs-var">changeModeKey</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; ((KeyMask, Window), Window))
-&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; ((KeyMask, Window), Window)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span>
</span><span id="line-701"></span><span>    </span><span id="local-6989586621679389742"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389742"><span class="hs-identifier hs-var">keymask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; XP KeyMask
</span><a href="XMonad.Prompt.html#cleanMask"><span class="hs-identifier hs-var">cleanMask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389745"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-702"></span><span>    </span><span class="hs-comment">-- haven't subscribed to keyRelease, so just in case</span><span>
</span><span id="line-703"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389747"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">keyPress</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-704"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389742"><span class="hs-identifier hs-var">keymask</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389749"><span class="hs-identifier hs-var">keysym</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(KeyMask, Window) -&gt; (KeyMask, Window) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">(KeyMask, Window)
</span><a href="#local-6989586621679389744"><span class="hs-identifier hs-var">compKey</span></a></span><span>
</span><span id="line-705"></span><span>           </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">XP (Maybe [String])
</span><a href="XMonad.Prompt.html#getCurrentCompletions"><span class="hs-identifier hs-var">getCurrentCompletions</span></a></span><span> </span><span class="annot"><span class="annottext">XP (Maybe [String]) -&gt; (Maybe [String] -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Maybe [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleCompletionMain"><span class="hs-identifier hs-var">handleCompletionMain</span></a></span><span>
</span><span id="line-706"></span><span>           </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-707"></span><span>                </span><span class="annot"><span class="annottext">Maybe [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#setCurrentCompletions"><span class="hs-identifier hs-var">setCurrentCompletions</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe [String]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-708"></span><span>                </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389749"><span class="hs-identifier hs-var">keysym</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389743"><span class="hs-identifier hs-var">modeKey</span></a></span><span>
</span><span id="line-709"></span><span>                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setNextMode"><span class="hs-identifier hs-var">setNextMode</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-710"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyStroke -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleInputMain"><span class="hs-identifier hs-var">handleInputMain</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389742"><span class="hs-identifier hs-var">keymask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389750"><span class="hs-identifier hs-var">stroke</span></a></span><span>
</span><span id="line-711"></span><span class="annot"><a href="XMonad.Prompt.html#handleMain"><span class="hs-identifier hs-var">handleMain</span></a></span><span> </span><span id="local-6989586621679389739"><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389739"><span class="hs-identifier hs-var">stroke</span></a></span></span><span> </span><span id="local-6989586621679389738"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389738"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-var">handleOther</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389739"><span class="hs-identifier hs-var">stroke</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389738"><span class="hs-identifier hs-var">event</span></a></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="hs-comment">-- | Prompt input handler for the main loop.</span><span>
</span><span id="line-714"></span><span class="annot"><a href="XMonad.Prompt.html#handleInputMain"><span class="hs-identifier hs-type">handleInputMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span id="handleInputMain"><span class="annot"><span class="annottext">handleInputMain :: KeyMask -&gt; KeyStroke -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleInputMain"><span class="hs-identifier hs-var hs-var">handleInputMain</span></a></span></span><span> </span><span id="local-6989586621679389737"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389737"><span class="hs-identifier hs-var">keymask</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389736"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389736"><span class="hs-identifier hs-var">keysym</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389735"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389735"><span class="hs-identifier hs-var">keystr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679389734"><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389734"><span class="hs-identifier hs-var">keymap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Map (KeyMask, Window) (XP ()))
-&gt; StateT XPState IO (Map (KeyMask, Window) (XP ()))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#promptKeymap"><span class="hs-identifier hs-var hs-var">promptKeymap</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; Map (KeyMask, Window) (XP ()))
-&gt; (XPState -&gt; XPConfig)
-&gt; XPState
-&gt; Map (KeyMask, Window) (XP ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(KeyMask, Window) -&gt; Map (KeyMask, Window) (XP ()) -&gt; Maybe (XP ())
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389737"><span class="hs-identifier hs-var">keymask</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389736"><span class="hs-identifier hs-var">keysym</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389734"><span class="hs-identifier hs-var">keymap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-718"></span><span>        </span><span class="hs-comment">-- 'null keystr' i.e. when only a modifier was pressed</span><span>
</span><span id="line-719"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389733"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389733"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389733"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-720"></span><span>        </span><span class="annot"><span class="annottext">Maybe (XP ())
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389735"><span class="hs-identifier hs-var">keystr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-721"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389737"><span class="hs-identifier hs-var">keymask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">controlMask</span></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-722"></span><span>                </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="XMonad.Prompt.html#insertString"><span class="hs-identifier hs-var">insertString</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; XP ()) -&gt; String -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#utf8Decode"><span class="hs-identifier hs-var">utf8Decode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389735"><span class="hs-identifier hs-var">keystr</span></a></span><span>
</span><span id="line-723"></span><span>                </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-724"></span><span>                </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateHighlightedCompl"><span class="hs-identifier hs-var">updateHighlightedCompl</span></a></span><span>
</span><span id="line-725"></span><span>                </span><span id="local-6989586621679389729"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389729"><span class="hs-identifier hs-var">complete</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="XMonad.Prompt.html#tryAutoComplete"><span class="hs-identifier hs-var">tryAutoComplete</span></a></span><span>
</span><span id="line-726"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389729"><span class="hs-identifier hs-var">complete</span></a></span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="hs-comment">-- There are two options to store the completion list during the main loop:</span><span>
</span><span id="line-729"></span><span class="hs-comment">-- * Use the State monad, with 'Nothing' as the initial state.</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- * Join the output of the event loop handler to the input of the (same)</span><span>
</span><span id="line-731"></span><span class="hs-comment">--   subsequent handler, using 'Nothing' as the initial input.</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- Both approaches are, under the hood, equivalent.</span><span>
</span><span id="line-733"></span><span class="hs-comment">--</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- | Prompt completion handler for the main loop. Given 'Nothing', generate the</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- current completion list. With the current list, trigger a completion.</span><span>
</span><span id="line-736"></span><span class="annot"><a href="XMonad.Prompt.html#handleCompletionMain"><span class="hs-identifier hs-type">handleCompletionMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-737"></span><span id="handleCompletionMain"><span class="annot"><span class="annottext">handleCompletionMain :: Maybe [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleCompletionMain"><span class="hs-identifier hs-var hs-var">handleCompletionMain</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe [String]
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-738"></span><span>    </span><span id="local-6989586621679389727"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389727"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var">getCompletions</span></a></span><span>
</span><span id="line-739"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389727"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-740"></span><span>        </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389725"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389725"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389725"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">showComplWin :: Bool
</span><a href="XMonad.Prompt.html#showComplWin"><span class="hs-identifier hs-var">showComplWin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-741"></span><span>    </span><span class="annot"><span class="annottext">Maybe [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#setCurrentCompletions"><span class="hs-identifier hs-var">setCurrentCompletions</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [String] -&gt; XP ()) -&gt; Maybe [String] -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe [String]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389727"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-742"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleCompletion"><span class="hs-identifier hs-var">handleCompletion</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389727"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-743"></span><span class="annot"><a href="XMonad.Prompt.html#handleCompletionMain"><span class="hs-identifier hs-var">handleCompletionMain</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389723"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389723"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleCompletion"><span class="hs-identifier hs-var">handleCompletion</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389723"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="annot"><a href="XMonad.Prompt.html#handleCompletion"><span class="hs-identifier hs-type">handleCompletion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span id="handleCompletion"><span class="annot"><span class="annottext">handleCompletion :: [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleCompletion"><span class="hs-identifier hs-var hs-var">handleCompletion</span></a></span></span><span> </span><span id="local-6989586621679389722"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389722"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-747"></span><span>    </span><span id="local-6989586621679389721"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389721"><span class="hs-identifier hs-var">alwaysHlight</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; Bool) -&gt; StateT XPState IO Bool)
-&gt; (XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; Bool) -&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span>
</span><span id="line-748"></span><span>    </span><span id="local-6989586621679389720"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389720"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389719"><span class="annot"><span class="annottext">updateWins :: [String] -&gt; XP ()
</span><a href="#local-6989586621679389719"><span class="hs-identifier hs-var hs-var">updateWins</span></a></span></span><span>  </span><span id="local-6989586621679389718"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389718"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XP () -&gt; [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#redrawWindows"><span class="hs-identifier hs-var">redrawWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; XP ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389718"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-751"></span><span>        </span><span id="local-6989586621679389716"><span class="annot"><span class="annottext">updateState :: [String] -&gt; XP ()
</span><a href="#local-6989586621679389716"><span class="hs-identifier hs-var hs-var">updateState</span></a></span></span><span> </span><span id="local-6989586621679389715"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389715"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389721"><span class="hs-identifier hs-var">alwaysHlight</span></a></span><span>
</span><span id="line-752"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; XPState -&gt; XP ()
</span><a href="#local-6989586621679389714"><span class="hs-identifier hs-var">hlComplete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#getLastWord"><span class="hs-identifier hs-var">getLastWord</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389720"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389715"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389720"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-753"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XPState -&gt; XP ()
</span><a href="#local-6989586621679389713"><span class="hs-identifier hs-var">simpleComplete</span></a></span><span>                        </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389715"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389720"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389722"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-756"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-757"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679389712"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389712"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="#local-6989586621679389716"><span class="hs-identifier hs-var">updateState</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389712"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-758"></span><span>                </span><span id="local-6989586621679389711"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389711"><span class="hs-identifier hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var">getCompletions</span></a></span><span>
</span><span id="line-759"></span><span>                </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="#local-6989586621679389719"><span class="hs-identifier hs-var">updateWins</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389711"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-760"></span><span>                </span><span class="annot"><span class="annottext">Maybe [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#setCurrentCompletions"><span class="hs-identifier hs-var">setCurrentCompletions</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe [String] -&gt; XP ()) -&gt; Maybe [String] -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Maybe [String]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389711"><span class="hs-identifier hs-var">cs'</span></a></span><span>
</span><span id="line-761"></span><span>      </span><span id="local-6989586621679389710"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389710"><span class="hs-identifier hs-var">l</span></a></span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="#local-6989586621679389716"><span class="hs-identifier hs-var">updateState</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389710"><span class="hs-identifier hs-var">l</span></a></span><span>   </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="#local-6989586621679389719"><span class="hs-identifier hs-var">updateWins</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389710"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-762"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-763"></span><span>        </span><span class="hs-comment">-- When alwaysHighlight is off, just complete based on what the</span><span>
</span><span id="line-764"></span><span>        </span><span class="hs-comment">-- user has typed so far.</span><span>
</span><span id="line-765"></span><span>        </span><span class="annot"><a href="#local-6989586621679389713"><span class="hs-identifier hs-type">simpleComplete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>        </span><span id="local-6989586621679389713"><span class="annot"><span class="annottext">simpleComplete :: [String] -&gt; XPState -&gt; XP ()
</span><a href="#local-6989586621679389713"><span class="hs-identifier hs-var hs-var">simpleComplete</span></a></span></span><span> </span><span id="local-6989586621679389709"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389709"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679389708"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389708"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-767"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389707"><span class="annot"><span class="annottext">newCommand :: String
</span><a href="#local-6989586621679389707"><span class="hs-identifier hs-var hs-var">newCommand</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String -&gt; [String] -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#nextCompletion"><span class="hs-identifier hs-var">nextCompletion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var">currentXPMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389708"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389708"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389709"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-768"></span><span>          </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389706"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389706"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389707"><span class="hs-identifier hs-var">newCommand</span></a></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XPState -&gt; XPState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-769"></span><span>                         </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389706"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389707"><span class="hs-identifier hs-var">newCommand</span></a></span><span>
</span><span id="line-770"></span><span>                           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">highlightedCompl :: Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var">highlightedCompl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389707"><span class="hs-identifier hs-var">newCommand</span></a></span><span>
</span><span id="line-771"></span><span>                           </span><span class="hs-special">}</span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span>        </span><span class="hs-comment">-- If alwaysHighlight is on, and the user wants the next</span><span>
</span><span id="line-774"></span><span>        </span><span class="hs-comment">-- completion, move to the next completion item and update the</span><span>
</span><span id="line-775"></span><span>        </span><span class="hs-comment">-- buffer to reflect that.</span><span>
</span><span id="line-776"></span><span>        </span><span class="hs-comment">--</span><span>
</span><span id="line-777"></span><span>        </span><span class="hs-comment">--TODO: Scroll or paginate results</span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><a href="#local-6989586621679389714"><span class="hs-identifier hs-type">hlComplete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>        </span><span id="local-6989586621679389714"><span class="annot"><span class="annottext">hlComplete :: String -&gt; [String] -&gt; XPState -&gt; XP ()
</span><a href="#local-6989586621679389714"><span class="hs-identifier hs-var hs-var">hlComplete</span></a></span></span><span> </span><span id="local-6989586621679389705"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389705"><span class="hs-identifier hs-var">prevCompl</span></a></span></span><span> </span><span id="local-6989586621679389704"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389704"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679389703"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span></span><span>
</span><span id="line-780"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- The current suggestion matches the command and is a</span><span>
</span><span id="line-781"></span><span>            </span><span class="hs-comment">-- proper suffix of the last suggestion, so replace it.</span><span>
</span><span id="line-782"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389702"><span class="hs-identifier hs-var">isSuffixOfCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389700"><span class="hs-identifier hs-var">isProperSuffixOfLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="#local-6989586621679389699"><span class="hs-identifier hs-var">replaceCompletion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389705"><span class="hs-identifier hs-var">prevCompl</span></a></span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- We only have one suggestion, so we need to be a little</span><span>
</span><span id="line-785"></span><span>            </span><span class="hs-comment">-- bit smart in order to avoid a loop.</span><span>
</span><span id="line-786"></span><span>            </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389722"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-787"></span><span>              </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="#local-6989586621679389699"><span class="hs-identifier hs-var">replaceCompletion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389722"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span>
</span><span id="line-789"></span><span>            </span><span class="hs-comment">-- The current suggestion matches the command, so advance</span><span>
</span><span id="line-790"></span><span>            </span><span class="hs-comment">-- to the next completion and try again.</span><span>
</span><span id="line-791"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389702"><span class="hs-identifier hs-var">isSuffixOfCmd</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-792"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; XPState -&gt; XP ()
</span><a href="#local-6989586621679389714"><span class="hs-identifier hs-var">hlComplete</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389704"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XP ()) -&gt; XPState -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">complIndex :: (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var">complIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679389696"><span class="hs-identifier hs-var">complIndex'</span></a></span><span>
</span><span id="line-793"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">highlightedCompl :: Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var">highlightedCompl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679389695"><span class="hs-identifier hs-var">nextHlCompl</span></a></span><span>
</span><span id="line-794"></span><span>                                       </span><span class="hs-special">}</span><span>
</span><span id="line-795"></span><span>
</span><span id="line-796"></span><span>            </span><span class="hs-comment">-- If nothing matches at all, delete the suggestion and</span><span>
</span><span id="line-797"></span><span>            </span><span class="hs-comment">-- highlight the next one.</span><span>
</span><span id="line-798"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="#local-6989586621679389699"><span class="hs-identifier hs-var">replaceCompletion</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389705"><span class="hs-identifier hs-var">prevCompl</span></a></span><span>
</span><span id="line-799"></span><span>         </span><span class="hs-keyword">where</span><span>
</span><span id="line-800"></span><span>          </span><span id="local-6989586621679389698"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; String
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; String) -&gt; Maybe String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; [String] -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedItem"><span class="hs-identifier hs-var">highlightedItem</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389704"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-801"></span><span>          </span><span id="local-6989586621679389696"><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679389696"><span class="hs-identifier hs-var">complIndex'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; (Int, Int)
</span><a href="XMonad.Prompt.html#nextComplIndex"><span class="hs-identifier hs-var">nextComplIndex</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-802"></span><span>          </span><span id="local-6989586621679389695"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679389695"><span class="hs-identifier hs-var">nextHlCompl</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; [String] -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedItem"><span class="hs-identifier hs-var">highlightedItem</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">complIndex :: (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var">complIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679389696"><span class="hs-identifier hs-var">complIndex'</span></a></span><span> </span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389722"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-803"></span><span>
</span><span id="line-804"></span><span>          </span><span id="local-6989586621679389702"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389702"><span class="hs-identifier hs-var">isSuffixOfCmd</span></a></span></span><span>        </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isSuffixOf`</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-805"></span><span>          </span><span id="local-6989586621679389700"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389700"><span class="hs-identifier hs-var">isProperSuffixOfLast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">=</span><span>      </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span><span>   </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isSuffixOf`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389705"><span class="hs-identifier hs-var">prevCompl</span></a></span><span>
</span><span id="line-806"></span><span>                                      </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389705"><span class="hs-identifier hs-var">prevCompl</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isSuffixOf`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-807"></span><span>
</span><span id="line-808"></span><span>          </span><span id="local-6989586621679389699"><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="#local-6989586621679389699"><span class="hs-identifier hs-var">replaceCompletion</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389692"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389692"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-809"></span><span>              </span><span class="annot"><span class="annottext">XPState -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389703"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-810"></span><span>              </span><span class="annot"><span class="annottext">Int -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m ()
</span><span class="hs-identifier hs-var">replicateM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Int) -&gt; [String] -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389692"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord"><span class="hs-identifier hs-var">killWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span>
</span><span id="line-811"></span><span>              </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="XMonad.Prompt.html#insertString%27"><span class="hs-identifier hs-var">insertString'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389698"><span class="hs-identifier hs-var">hlCompl</span></a></span><span>
</span><span id="line-812"></span><span>              </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="hs-comment">-- | Initiate a prompt sub-map event loop. Submaps are intended to provide</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- alternate keybindings. Accepts a default action and a mapping from key</span><span>
</span><span id="line-816"></span><span class="hs-comment">-- combinations to actions. If no entry matches, the default action is run.</span><span>
</span><span id="line-817"></span><span class="annot"><a href="XMonad.Prompt.html#promptSubmap"><span class="hs-identifier hs-type">promptSubmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-819"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span id="promptSubmap"><span class="annot"><span class="annottext">promptSubmap :: XP () -&gt; Map (KeyMask, Window) (XP ()) -&gt; XP ()
</span><a href="XMonad.Prompt.html#promptSubmap"><span class="hs-identifier hs-var hs-var">promptSubmap</span></a></span></span><span> </span><span id="local-6989586621679389687"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389687"><span class="hs-identifier hs-var">defaultAction</span></a></span></span><span> </span><span id="local-6989586621679389686"><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389686"><span class="hs-identifier hs-var">keymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-821"></span><span>    </span><span id="local-6989586621679389685"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389685"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#modeDone"><span class="hs-identifier hs-var hs-var">modeDone</span></a></span><span>
</span><span id="line-822"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-824"></span><span>    </span><span class="annot"><span class="annottext">(KeyStroke -&gt; Event -&gt; XP ()) -&gt; StateT XPState IO Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#eventLoop"><span class="hs-identifier hs-var">eventLoop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP ()
-&gt; Map (KeyMask, Window) (XP ()) -&gt; KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleSubmap"><span class="hs-identifier hs-var">handleSubmap</span></a></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389687"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389686"><span class="hs-identifier hs-var">keymap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="XMonad.Prompt.html#evDefaultStop"><span class="hs-identifier hs-var">evDefaultStop</span></a></span><span>
</span><span id="line-825"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389685"><span class="hs-identifier hs-var">md</span></a></span><span>
</span><span id="line-826"></span><span>
</span><span id="line-827"></span><span class="annot"><a href="XMonad.Prompt.html#handleSubmap"><span class="hs-identifier hs-type">handleSubmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span>
</span><span id="line-830"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span>
</span><span id="line-831"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-832"></span><span id="handleSubmap"><span class="annot"><span class="annottext">handleSubmap :: XP ()
-&gt; Map (KeyMask, Window) (XP ()) -&gt; KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleSubmap"><span class="hs-identifier hs-var hs-var">handleSubmap</span></a></span></span><span> </span><span id="local-6989586621679389683"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389683"><span class="hs-identifier hs-var">defaultAction</span></a></span></span><span> </span><span id="local-6989586621679389682"><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389682"><span class="hs-identifier hs-var">keymap</span></a></span></span><span> </span><span id="local-6989586621679389681"><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389681"><span class="hs-identifier hs-var">stroke</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyEvent</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_event_type :: Event -&gt; Dimension
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389680"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389680"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_state :: Event -&gt; KeyMask
</span><span class="hs-identifier hs-var">ev_state</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389679"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389679"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-833"></span><span>    </span><span id="local-6989586621679389678"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389678"><span class="hs-identifier hs-var">keymask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; XP KeyMask
</span><a href="XMonad.Prompt.html#cleanMask"><span class="hs-identifier hs-var">cleanMask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389679"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389680"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">keyPress</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XP ()
-&gt; Map (KeyMask, Window) (XP ()) -&gt; KeyMask -&gt; KeyStroke -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleInputSubmap"><span class="hs-identifier hs-var">handleInputSubmap</span></a></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389683"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389682"><span class="hs-identifier hs-var">keymap</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389678"><span class="hs-identifier hs-var">keymask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389681"><span class="hs-identifier hs-var">stroke</span></a></span><span>
</span><span id="line-835"></span><span class="annot"><a href="XMonad.Prompt.html#handleSubmap"><span class="hs-identifier hs-var">handleSubmap</span></a></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679389676"><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389676"><span class="hs-identifier hs-var">stroke</span></a></span></span><span> </span><span id="local-6989586621679389675"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389675"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-var">handleOther</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389676"><span class="hs-identifier hs-var">stroke</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389675"><span class="hs-identifier hs-var">event</span></a></span><span>
</span><span id="line-836"></span><span>
</span><span id="line-837"></span><span class="annot"><a href="XMonad.Prompt.html#handleInputSubmap"><span class="hs-identifier hs-type">handleInputSubmap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-838"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span>
</span><span id="line-840"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span>
</span><span id="line-841"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span id="handleInputSubmap"><span class="annot"><span class="annottext">handleInputSubmap :: XP ()
-&gt; Map (KeyMask, Window) (XP ()) -&gt; KeyMask -&gt; KeyStroke -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleInputSubmap"><span class="hs-identifier hs-var hs-var">handleInputSubmap</span></a></span></span><span> </span><span id="local-6989586621679389674"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389674"><span class="hs-identifier hs-var">defaultAction</span></a></span></span><span> </span><span id="local-6989586621679389673"><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389673"><span class="hs-identifier hs-var">keymap</span></a></span></span><span> </span><span id="local-6989586621679389672"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389672"><span class="hs-identifier hs-var">keymask</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389671"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389671"><span class="hs-identifier hs-var">keysym</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389670"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389670"><span class="hs-identifier hs-var">keystr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-843"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(KeyMask, Window) -&gt; Map (KeyMask, Window) (XP ()) -&gt; Maybe (XP ())
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389672"><span class="hs-identifier hs-var">keymask</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389671"><span class="hs-identifier hs-var">keysym</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389673"><span class="hs-identifier hs-var">keymap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-844"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389669"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389669"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389669"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-845"></span><span>        </span><span class="annot"><span class="annottext">Maybe (XP ())
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389670"><span class="hs-identifier hs-var">keystr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389674"><span class="hs-identifier hs-var">defaultAction</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-846"></span><span>
</span><span id="line-847"></span><span class="hs-comment">-- | Initiate a prompt input buffer event loop. Input is sent to a buffer and</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- bypasses the prompt. The provided function is given the existing buffer and</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- the input keystring. The first field of the result determines whether the</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- input loop continues (if @True@). The second field determines whether the</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- input is appended to the buffer, or dropped (if @False@). If the loop is to</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- stop without keeping input - that is, @(False,False)@ - the event is</span><span>
</span><span id="line-853"></span><span class="hs-comment">-- prepended to the event buffer to be processed by the parent loop. This</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- allows loop to process both fixed and indeterminate inputs.</span><span>
</span><span id="line-855"></span><span class="hs-comment">--</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- Result given @(continue,keep)@:</span><span>
</span><span id="line-857"></span><span class="hs-comment">--</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- * cont and keep</span><span>
</span><span id="line-859"></span><span class="hs-comment">--</span><span>
</span><span id="line-860"></span><span class="hs-comment">--      * grow input buffer</span><span>
</span><span id="line-861"></span><span class="hs-comment">--</span><span>
</span><span id="line-862"></span><span class="hs-comment">-- * stop and keep</span><span>
</span><span id="line-863"></span><span class="hs-comment">--</span><span>
</span><span id="line-864"></span><span class="hs-comment">--      * grow input buffer</span><span>
</span><span id="line-865"></span><span class="hs-comment">--      * stop loop</span><span>
</span><span id="line-866"></span><span class="hs-comment">--</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- * stop and drop</span><span>
</span><span id="line-868"></span><span class="hs-comment">--</span><span>
</span><span id="line-869"></span><span class="hs-comment">--      * buffer event</span><span>
</span><span id="line-870"></span><span class="hs-comment">--      * stop loop</span><span>
</span><span id="line-871"></span><span class="hs-comment">--</span><span>
</span><span id="line-872"></span><span class="hs-comment">-- * cont and drop</span><span>
</span><span id="line-873"></span><span class="hs-comment">--</span><span>
</span><span id="line-874"></span><span class="hs-comment">--      * do nothing</span><span>
</span><span id="line-875"></span><span class="annot"><a href="XMonad.Prompt.html#promptBuffer"><span class="hs-identifier hs-type">promptBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-876"></span><span id="promptBuffer"><span class="annot"><span class="annottext">promptBuffer :: (String -&gt; String -&gt; (Bool, Bool)) -&gt; XP String
</span><a href="XMonad.Prompt.html#promptBuffer"><span class="hs-identifier hs-var hs-var">promptBuffer</span></a></span></span><span> </span><span id="local-6989586621679389668"><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="#local-6989586621679389668"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-877"></span><span>    </span><span id="local-6989586621679389667"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389667"><span class="hs-identifier hs-var">md</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Bool
</span><a href="XMonad.Prompt.html#modeDone"><span class="hs-identifier hs-var hs-var">modeDone</span></a></span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><span class="annottext">(KeyStroke -&gt; Event -&gt; XP ()) -&gt; StateT XPState IO Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#eventLoop"><span class="hs-identifier hs-var">eventLoop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; String -&gt; (Bool, Bool)) -&gt; KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleBuffer"><span class="hs-identifier hs-var">handleBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="#local-6989586621679389668"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool
</span><a href="XMonad.Prompt.html#evDefaultStop"><span class="hs-identifier hs-var">evDefaultStop</span></a></span><span>
</span><span id="line-880"></span><span>    </span><span id="local-6989586621679389665"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389665"><span class="hs-identifier hs-var">buff</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String) -&gt; XP String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#inputBuffer"><span class="hs-identifier hs-var hs-var">inputBuffer</span></a></span><span>
</span><span id="line-881"></span><span>    </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389664"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389664"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389664"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">inputBuffer :: String
</span><a href="XMonad.Prompt.html#inputBuffer"><span class="hs-identifier hs-var">inputBuffer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-882"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389667"><span class="hs-identifier hs-var">md</span></a></span><span>
</span><span id="line-883"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; XP String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389665"><span class="hs-identifier hs-var">buff</span></a></span><span>
</span><span id="line-884"></span><span>
</span><span id="line-885"></span><span class="annot"><a href="XMonad.Prompt.html#handleBuffer"><span class="hs-identifier hs-type">handleBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span>
</span><span id="line-887"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span>
</span><span id="line-888"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span id="handleBuffer"><span class="annot"><span class="annottext">handleBuffer :: (String -&gt; String -&gt; (Bool, Bool)) -&gt; KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleBuffer"><span class="hs-identifier hs-var hs-var">handleBuffer</span></a></span></span><span> </span><span id="local-6989586621679389663"><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="#local-6989586621679389663"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679389662"><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389662"><span class="hs-identifier hs-var">stroke</span></a></span></span><span> </span><span id="local-6989586621679389661"><span class="annot"><span class="annottext">event :: Event
</span><a href="#local-6989586621679389661"><span class="hs-identifier hs-var">event</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">KeyEvent</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_event_type :: Event -&gt; Dimension
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389660"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389660"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_state :: Event -&gt; KeyMask
</span><span class="hs-identifier hs-var">ev_state</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389659"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389659"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-890"></span><span>    </span><span id="local-6989586621679389658"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389658"><span class="hs-identifier hs-var">keymask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; XP KeyMask
</span><a href="XMonad.Prompt.html#cleanMask"><span class="hs-identifier hs-var">cleanMask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389659"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-891"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389660"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">keyPress</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; (Bool, Bool))
-&gt; KeyMask -&gt; KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleInputBuffer"><span class="hs-identifier hs-var">handleInputBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="#local-6989586621679389663"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389658"><span class="hs-identifier hs-var">keymask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389662"><span class="hs-identifier hs-var">stroke</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389661"><span class="hs-identifier hs-var">event</span></a></span><span>
</span><span id="line-892"></span><span class="annot"><a href="XMonad.Prompt.html#handleBuffer"><span class="hs-identifier hs-var">handleBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679389656"><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389656"><span class="hs-identifier hs-var">stroke</span></a></span></span><span> </span><span id="local-6989586621679389655"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389655"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleOther"><span class="hs-identifier hs-var">handleOther</span></a></span><span> </span><span class="annot"><span class="annottext">KeyStroke
</span><a href="#local-6989586621679389656"><span class="hs-identifier hs-var">stroke</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389655"><span class="hs-identifier hs-var">event</span></a></span><span>
</span><span id="line-893"></span><span>
</span><span id="line-894"></span><span class="annot"><a href="XMonad.Prompt.html#handleInputBuffer"><span class="hs-identifier hs-type">handleInputBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span>
</span><span id="line-896"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#KeyStroke"><span class="hs-identifier hs-type">KeyStroke</span></a></span><span>
</span><span id="line-897"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span>
</span><span id="line-898"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span id="handleInputBuffer"><span class="annot"><span class="annottext">handleInputBuffer :: (String -&gt; String -&gt; (Bool, Bool))
-&gt; KeyMask -&gt; KeyStroke -&gt; Event -&gt; XP ()
</span><a href="XMonad.Prompt.html#handleInputBuffer"><span class="hs-identifier hs-var hs-var">handleInputBuffer</span></a></span></span><span> </span><span id="local-6989586621679389654"><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="#local-6989586621679389654"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679389653"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389653"><span class="hs-identifier hs-var">keymask</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389652"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389652"><span class="hs-identifier hs-var">keysym</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389651"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389651"><span class="hs-identifier hs-var">keystr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679389650"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389650"><span class="hs-identifier hs-var">event</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-900"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389651"><span class="hs-identifier hs-var">keystr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679389653"><span class="hs-identifier hs-var">keymask</span></a></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; KeyMask
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">controlMask</span></span><span> </span><span class="annot"><span class="annottext">KeyMask -&gt; KeyMask -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-901"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679389648"><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389648"><span class="hs-identifier hs-var">evB</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389647"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389647"><span class="hs-identifier hs-var">inB</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; ([(Window, String, Event)], String))
-&gt; StateT XPState IO ([(Window, String, Event)], String)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; [(Window, String, Event)]
</span><a href="XMonad.Prompt.html#eventBuffer"><span class="hs-identifier hs-var hs-var">eventBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; [(Window, String, Event)])
-&gt; (XPState -&gt; String)
-&gt; XPState
-&gt; ([(Window, String, Event)], String)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#inputBuffer"><span class="hs-identifier hs-var hs-var">inputBuffer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-902"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389646"><span class="annot"><span class="annottext">keystr' :: String
</span><a href="#local-6989586621679389646"><span class="hs-identifier hs-var hs-var">keystr'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#utf8Decode"><span class="hs-identifier hs-var">utf8Decode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389651"><span class="hs-identifier hs-var">keystr</span></a></span><span>
</span><span id="line-903"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389645"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389645"><span class="hs-identifier hs-var">cont</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389644"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389644"><span class="hs-identifier hs-var">keep</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="#local-6989586621679389654"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389647"><span class="hs-identifier hs-var">inB</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389646"><span class="hs-identifier hs-var">keystr'</span></a></span><span>
</span><span id="line-904"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389644"><span class="hs-identifier hs-var">keep</span></a></span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-905"></span><span>            </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389643"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389643"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389643"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">inputBuffer :: String
</span><a href="XMonad.Prompt.html#inputBuffer"><span class="hs-identifier hs-var">inputBuffer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389647"><span class="hs-identifier hs-var">inB</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389646"><span class="hs-identifier hs-var">keystr'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-906"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389645"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-907"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-908"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389645"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389644"><span class="hs-identifier hs-var">keep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-909"></span><span>            </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389642"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389642"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389642"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">eventBuffer :: [(Window, String, Event)]
</span><a href="XMonad.Prompt.html#eventBuffer"><span class="hs-identifier hs-var">eventBuffer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389652"><span class="hs-identifier hs-var">keysym</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389651"><span class="hs-identifier hs-var">keystr</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679389650"><span class="hs-identifier hs-var">event</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Window, String, Event)
-&gt; [(Window, String, Event)] -&gt; [(Window, String, Event)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Window, String, Event)]
</span><a href="#local-6989586621679389648"><span class="hs-identifier hs-var">evB</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-910"></span><span>
</span><span id="line-911"></span><span class="hs-comment">-- | Predicate instructing 'promptBuffer' to get (and keep) a single non-empty</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- 'KeyEvent'.</span><span>
</span><span id="line-913"></span><span class="annot"><a href="XMonad.Prompt.html#bufferOne"><span class="hs-identifier hs-type">bufferOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span id="bufferOne"><span class="annot"><span class="annottext">bufferOne :: String -&gt; String -&gt; (Bool, Bool)
</span><a href="XMonad.Prompt.html#bufferOne"><span class="hs-identifier hs-var hs-var">bufferOne</span></a></span></span><span> </span><span id="local-6989586621679389641"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389641"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679389640"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389640"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389641"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389640"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-915"></span><span>
</span><span id="line-916"></span><span class="hs-comment">-- | Return the @(column, row)@ of the next highlight, or @(0, 0)@ if</span><span>
</span><span id="line-917"></span><span class="hs-comment">-- there is no prompt window or a wrap-around occurs.</span><span>
</span><span id="line-918"></span><span class="annot"><a href="XMonad.Prompt.html#nextComplIndex"><span class="hs-identifier hs-type">nextComplIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span id="nextComplIndex"><span class="annot"><span class="annottext">nextComplIndex :: XPState -&gt; (Int, Int)
</span><a href="XMonad.Prompt.html#nextComplIndex"><span class="hs-identifier hs-var hs-var">nextComplIndex</span></a></span></span><span> </span><span id="local-6989586621679389639"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389639"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Maybe ComplWindowDim
</span><a href="XMonad.Prompt.html#complWinDim"><span class="hs-identifier hs-var hs-var">complWinDim</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389639"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-920"></span><span>  </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- no window dimensions (just destroyed or not created)</span><span>
</span><span id="line-921"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389638"><span class="annot"><span class="annottext">[Position]
cwCols :: [Position]
cwCols :: ComplWindowDim -&gt; [Position]
</span><a href="#local-6989586621679389638"><span class="hs-identifier hs-var hs-var">cwCols</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389637"><span class="annot"><span class="annottext">[Position]
cwRows :: [Position]
cwRows :: ComplWindowDim -&gt; [Position]
</span><a href="#local-6989586621679389637"><span class="hs-identifier hs-var hs-var">cwRows</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-922"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389636"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389636"><span class="hs-identifier hs-var">currentcol</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389635"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389635"><span class="hs-identifier hs-var">currentrow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var hs-var">complIndex</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389639"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-923"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679389634"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389634"><span class="hs-identifier hs-var">colm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389633"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389633"><span class="hs-identifier hs-var">rowm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-924"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389636"><span class="hs-identifier hs-var">currentcol</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389638"><span class="hs-identifier hs-var">cwCols</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389635"><span class="hs-identifier hs-var">currentrow</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389637"><span class="hs-identifier hs-var">cwRows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389633"><span class="hs-identifier hs-var">rowm</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389635"><span class="hs-identifier hs-var">currentrow</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-926"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389636"><span class="hs-identifier hs-var">currentcol</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389635"><span class="hs-identifier hs-var">currentrow</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- We are not in the last row, so go down</span><span>
</span><span id="line-927"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389634"><span class="hs-identifier hs-var">colm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389633"><span class="hs-identifier hs-var">rowm</span></a></span><span class="hs-special">)</span><span>                  </span><span class="hs-comment">-- otherwise advance to the next column</span><span>
</span><span id="line-928"></span><span>
</span><span id="line-929"></span><span class="annot"><a href="XMonad.Prompt.html#tryAutoComplete"><span class="hs-identifier hs-type">tryAutoComplete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-930"></span><span id="tryAutoComplete"><span class="annot"><span class="annottext">tryAutoComplete :: StateT XPState IO Bool
</span><a href="XMonad.Prompt.html#tryAutoComplete"><span class="hs-identifier hs-var hs-var">tryAutoComplete</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-931"></span><span>    </span><span id="local-6989586621679389630"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679389630"><span class="hs-identifier hs-var">ac</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Maybe Int) -&gt; StateT XPState IO (Maybe Int)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Maybe Int
</span><a href="XMonad.Prompt.html#autoComplete"><span class="hs-identifier hs-var hs-var">autoComplete</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; Maybe Int)
-&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; Maybe Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-932"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679389630"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-933"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389629"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389629"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679389628"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389628"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var">getCompletions</span></a></span><span>
</span><span id="line-934"></span><span>                     </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389628"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-935"></span><span>                         </span><span class="hs-special">[</span><span id="local-6989586621679389627"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389627"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; StateT XPState IO Bool
</span><a href="#local-6989586621679389626"><span class="hs-identifier hs-var">runCompleted</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389627"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389629"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO Bool
-&gt; StateT XPState IO Bool -&gt; StateT XPState IO Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; StateT XPState IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-936"></span><span>                         </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; StateT XPState IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-937"></span><span>        </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; StateT XPState IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-938"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389626"><span class="annot"><span class="annottext">runCompleted :: String -&gt; Int -&gt; StateT XPState IO Bool
</span><a href="#local-6989586621679389626"><span class="hs-identifier hs-var hs-var">runCompleted</span></a></span></span><span> </span><span id="local-6989586621679389625"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389625"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span id="local-6989586621679389624"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389624"><span class="hs-identifier hs-var">delay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-939"></span><span>            </span><span id="local-6989586621679389623"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389623"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-940"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389622"><span class="annot"><span class="annottext">new_command :: String
</span><a href="#local-6989586621679389622"><span class="hs-identifier hs-var hs-var">new_command</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String -&gt; [String] -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#nextCompletion"><span class="hs-identifier hs-var">nextCompletion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var">currentXPMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389623"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389623"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389625"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-941"></span><span>            </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;autocompleting...&quot;</span></span><span>
</span><span id="line-942"></span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-943"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IO ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389624"><span class="hs-identifier hs-var">delay</span></a></span><span>
</span><span id="line-944"></span><span>            </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389622"><span class="hs-identifier hs-var">new_command</span></a></span><span>
</span><span id="line-945"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; StateT XPState IO Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-946"></span><span>
</span><span id="line-947"></span><span class="hs-comment">-- KeyPresses</span><span>
</span><span id="line-948"></span><span>
</span><span id="line-949"></span><span class="hs-comment">-- | Default key bindings for prompts.  Click on the \&quot;Source\&quot; link</span><span>
</span><span id="line-950"></span><span class="hs-comment">--   to the right to see the complete list.  See also 'defaultXPKeymap''.</span><span>
</span><span id="line-951"></span><span class="annot"><a href="XMonad.Prompt.html#defaultXPKeymap"><span class="hs-identifier hs-type">defaultXPKeymap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-952"></span><span id="defaultXPKeymap"><span class="annot"><span class="annottext">defaultXPKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#defaultXPKeymap"><span class="hs-identifier hs-var hs-var">defaultXPKeymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#defaultXPKeymap%27"><span class="hs-identifier hs-var">defaultXPKeymap'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span class="hs-comment">-- | A variant of 'defaultXPKeymap' which lets you specify a custom</span><span>
</span><span id="line-955"></span><span class="hs-comment">--   predicate for identifying non-word characters, which affects all</span><span>
</span><span id="line-956"></span><span class="hs-comment">--   the word-oriented commands (move\/kill word).  The default is</span><span>
</span><span id="line-957"></span><span class="hs-comment">--   'isSpace'.  For example, by default a path like @foo\/bar\/baz@</span><span>
</span><span id="line-958"></span><span class="hs-comment">--   would be considered as a single word.  You could use a predicate</span><span>
</span><span id="line-959"></span><span class="hs-comment">--   like @(\\c -&gt; isSpace c || c == \'\/\')@ to move through or</span><span>
</span><span id="line-960"></span><span class="hs-comment">--   delete components of the path one at a time.</span><span>
</span><span id="line-961"></span><span class="annot"><a href="XMonad.Prompt.html#defaultXPKeymap%27"><span class="hs-identifier hs-type">defaultXPKeymap'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-962"></span><span id="defaultXPKeymap%27"><span class="annot"><span class="annottext">defaultXPKeymap' :: (Char -&gt; Bool) -&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#defaultXPKeymap%27"><span class="hs-identifier hs-var hs-var">defaultXPKeymap'</span></a></span></span><span> </span><span id="local-6989586621679389620"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389620"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ()))
-&gt; [((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-963"></span><span>  </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">controlMask</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- control + &lt;key&gt;</span><span>
</span><span id="line-964"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_u</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier hs-var">killBefore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-965"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var">killAfter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-966"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_a</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-967"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_e</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-968"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_y</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#pasteString"><span class="hs-identifier hs-var">pasteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-comment">-- Retain the pre-0.14 moveWord' behavior:</span><span>
</span><span id="line-970"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Right</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389620"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-971"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Left</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389620"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Delete</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389620"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389620"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-974"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_w</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389620"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_g</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-976"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_bracketleft</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-977"></span><span>  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())]
-&gt; [((KeyMask, Window), XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-978"></span><span>  </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-979"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Return</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-980"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_KP_Enter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Delete</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-983"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Left</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-984"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Right</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Home</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-986"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_End</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-987"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Down</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span>
</span><span id="line-988"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Up</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span>
</span><span id="line-989"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-990"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-991"></span><span>
</span><span id="line-992"></span><span class="hs-comment">-- | A keymap with many emacs-like key bindings.  Click on the</span><span>
</span><span id="line-993"></span><span class="hs-comment">--   \&quot;Source\&quot; link to the right to see the complete list.</span><span>
</span><span id="line-994"></span><span class="hs-comment">--   See also 'emacsLikeXPKeymap''.</span><span>
</span><span id="line-995"></span><span class="annot"><a href="XMonad.Prompt.html#emacsLikeXPKeymap"><span class="hs-identifier hs-type">emacsLikeXPKeymap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-996"></span><span id="emacsLikeXPKeymap"><span class="annot"><span class="annottext">emacsLikeXPKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#emacsLikeXPKeymap"><span class="hs-identifier hs-var hs-var">emacsLikeXPKeymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#emacsLikeXPKeymap%27"><span class="hs-identifier hs-var">emacsLikeXPKeymap'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-997"></span><span>
</span><span id="line-998"></span><span class="hs-comment">-- | A variant of 'emacsLikeXPKeymap' which lets you specify a custom</span><span>
</span><span id="line-999"></span><span class="hs-comment">--   predicate for identifying non-word characters, which affects all</span><span>
</span><span id="line-1000"></span><span class="hs-comment">--   the word-oriented commands (move\/kill word).  The default is</span><span>
</span><span id="line-1001"></span><span class="hs-comment">--   'isSpace'.  For example, by default a path like @foo\/bar\/baz@</span><span>
</span><span id="line-1002"></span><span class="hs-comment">--   would be considered as a single word.  You could use a predicate</span><span>
</span><span id="line-1003"></span><span class="hs-comment">--   like @(\\c -&gt; isSpace c || c == \'\/\')@ to move through or</span><span>
</span><span id="line-1004"></span><span class="hs-comment">--   delete components of the path one at a time.</span><span>
</span><span id="line-1005"></span><span class="annot"><a href="XMonad.Prompt.html#emacsLikeXPKeymap%27"><span class="hs-identifier hs-type">emacsLikeXPKeymap'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1006"></span><span id="emacsLikeXPKeymap%27"><span class="annot"><span class="annottext">emacsLikeXPKeymap' :: (Char -&gt; Bool) -&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#emacsLikeXPKeymap%27"><span class="hs-identifier hs-var hs-var">emacsLikeXPKeymap'</span></a></span></span><span> </span><span id="local-6989586621679389596"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389596"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ()))
-&gt; [((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1007"></span><span>  </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">controlMask</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- control + &lt;key&gt;</span><span>
</span><span id="line-1008"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_z</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier hs-var">killBefore</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">--kill line backwards</span><span>
</span><span id="line-1009"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var">killAfter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- kill line fowards</span><span>
</span><span id="line-1010"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_a</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">--move to the beginning of the line</span><span>
</span><span id="line-1011"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_e</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- move to the end of the line</span><span>
</span><span id="line-1012"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_d</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- delete a character foward</span><span>
</span><span id="line-1013"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- move cursor forward</span><span>
</span><span id="line-1014"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- move cursor backward</span><span>
</span><span id="line-1015"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389596"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- kill the previous word</span><span>
</span><span id="line-1016"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_y</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#pasteString"><span class="hs-identifier hs-var">pasteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1017"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_g</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_bracketleft</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())]
-&gt; [((KeyMask, Window), XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1020"></span><span>  </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">mod1Mask</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- meta key + &lt;key&gt;</span><span>
</span><span id="line-1021"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389596"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1022"></span><span>  </span><span class="hs-comment">-- Retain the pre-0.14 moveWord' behavior:</span><span>
</span><span id="line-1023"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389596"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- move a word forward</span><span>
</span><span id="line-1024"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_b</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389596"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- move a word backward</span><span>
</span><span id="line-1025"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_d</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389596"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- kill the next word</span><span>
</span><span id="line-1026"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_n</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_p</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-1029"></span><span>  </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())]
-&gt; [((KeyMask, Window), XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1030"></span><span>  </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- &lt;key&gt;</span><span>
</span><span id="line-1031"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Return</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1032"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_KP_Enter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1034"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Delete</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1035"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Left</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Right</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1037"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Home</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1038"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_End</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1039"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Down</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Up</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-1043"></span><span>
</span><span id="line-1044"></span><span class="hs-comment">-- | Vim-ish key bindings. Click on the \&quot;Source\&quot; link to the right to see the</span><span>
</span><span id="line-1045"></span><span class="hs-comment">-- complete list. See also 'vimLikeXPKeymap''.</span><span>
</span><span id="line-1046"></span><span class="annot"><a href="XMonad.Prompt.html#vimLikeXPKeymap"><span class="hs-identifier hs-type">vimLikeXPKeymap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1047"></span><span id="vimLikeXPKeymap"><span class="annot"><span class="annottext">vimLikeXPKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#vimLikeXPKeymap"><span class="hs-identifier hs-var hs-var">vimLikeXPKeymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPColor -&gt; XPColor)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (Char -&gt; Bool)
-&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#vimLikeXPKeymap%27"><span class="hs-identifier hs-var">vimLikeXPKeymap'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; XPColor -&gt; XPColor
</span><a href="XMonad.Prompt.html#setBorderColor"><span class="hs-identifier hs-var">setBorderColor</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;grey22&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-1048"></span><span>
</span><span id="line-1049"></span><span class="hs-comment">-- | A variant of 'vimLikeXPKeymap' with customizable aspects:</span><span>
</span><span id="line-1050"></span><span class="annot"><a href="XMonad.Prompt.html#vimLikeXPKeymap%27"><span class="hs-identifier hs-type">vimLikeXPKeymap'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPColor"><span class="hs-identifier hs-type">XPColor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1051"></span><span>                    </span><span class="hs-comment">-- ^ Modifies the prompt color when entering normal mode.</span><span>
</span><span id="line-1052"></span><span>                    </span><span class="hs-comment">-- The default is @setBorderColor &quot;grey22&quot;@ - same color as</span><span>
</span><span id="line-1053"></span><span>                    </span><span class="hs-comment">-- the default background color.</span><span>
</span><span id="line-1054"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span>                    </span><span class="hs-comment">-- ^ Prompter to use in normal mode. The default of 'id'</span><span>
</span><span id="line-1056"></span><span>                    </span><span class="hs-comment">-- balances 'defaultPrompter' but @(&quot;[n] &quot; ++)@ is a good</span><span>
</span><span id="line-1057"></span><span>                    </span><span class="hs-comment">-- alternate with 'defaultPrompter' as @(&quot;[i] &quot; ++)@.</span><span>
</span><span id="line-1058"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span>                    </span><span class="hs-comment">-- ^ Filter applied to the X Selection before pasting. The</span><span>
</span><span id="line-1060"></span><span>                    </span><span class="hs-comment">-- default is 'id' but @filter isPrint@ is a good</span><span>
</span><span id="line-1061"></span><span>                    </span><span class="hs-comment">-- alternate.</span><span>
</span><span id="line-1062"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-1063"></span><span>                    </span><span class="hs-comment">-- ^ Predicate identifying non-word characters. The default</span><span>
</span><span id="line-1064"></span><span>                    </span><span class="hs-comment">-- is 'isSpace'. See the documentation of other keymaps for</span><span>
</span><span id="line-1065"></span><span>                    </span><span class="hs-comment">-- alternates.</span><span>
</span><span id="line-1066"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1067"></span><span id="vimLikeXPKeymap%27"><span class="annot"><span class="annottext">vimLikeXPKeymap' :: (XPColor -&gt; XPColor)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (Char -&gt; Bool)
-&gt; Map (KeyMask, Window) (XP ())
</span><a href="XMonad.Prompt.html#vimLikeXPKeymap%27"><span class="hs-identifier hs-var hs-var">vimLikeXPKeymap'</span></a></span></span><span> </span><span id="local-6989586621679389588"><span class="annot"><span class="annottext">XPColor -&gt; XPColor
</span><a href="#local-6989586621679389588"><span class="hs-identifier hs-var">fromColor</span></a></span></span><span> </span><span id="local-6989586621679389587"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389587"><span class="hs-identifier hs-var">promptF</span></a></span></span><span> </span><span id="local-6989586621679389586"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389586"><span class="hs-identifier hs-var">pasteFilter</span></a></span></span><span> </span><span id="local-6989586621679389585"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ()))
-&gt; [((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1068"></span><span>    </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1069"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Return</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1070"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_KP_Enter</span></span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1071"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Delete</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1073"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Left</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1074"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Right</span></span><span class="hs-special">,</span><span>        </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1075"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Home</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1076"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_End</span></span><span class="hs-special">,</span><span>          </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1077"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Down</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Up</span></span><span class="hs-special">,</span><span>           </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1079"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span>
</span><span id="line-1080"></span><span>                            </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(XPColor -&gt; XPColor) -&gt; XP ()
</span><a href="XMonad.Prompt.html#modifyColor"><span class="hs-identifier hs-var">modifyColor</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; XPColor
</span><a href="#local-6989586621679389588"><span class="hs-identifier hs-var">fromColor</span></a></span><span>
</span><span id="line-1081"></span><span>                            </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#setPrompter"><span class="hs-identifier hs-var">setPrompter</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389587"><span class="hs-identifier hs-var">promptF</span></a></span><span>
</span><span id="line-1082"></span><span>                            </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; Map (KeyMask, Window) (XP ()) -&gt; XP ()
</span><a href="XMonad.Prompt.html#promptSubmap"><span class="hs-identifier hs-var">promptSubmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; XP ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389584"><span class="hs-identifier hs-var">normalVimXPKeymap</span></a></span><span>
</span><span id="line-1083"></span><span>                            </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#resetColor"><span class="hs-identifier hs-var">resetColor</span></a></span><span>
</span><span id="line-1084"></span><span>                            </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#resetPrompter"><span class="hs-identifier hs-var">resetPrompter</span></a></span><span>
</span><span id="line-1085"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1086"></span><span>    </span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1087"></span><span>    </span><span id="local-6989586621679389584"><span class="annot"><span class="annottext">normalVimXPKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389584"><span class="hs-identifier hs-var hs-var">normalVimXPKeymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ()))
-&gt; [((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1088"></span><span>        </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1089"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_i</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1090"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_a</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1091"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_s</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1092"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_x</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-var">clipCursor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Delete</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-var">clipCursor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1094"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_p</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span>
</span><span id="line-1095"></span><span>                                </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#pasteString%27"><span class="hs-identifier hs-var">pasteString'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389586"><span class="hs-identifier hs-var">pasteFilter</span></a></span><span>
</span><span id="line-1096"></span><span>                                </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span>
</span><span id="line-1097"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1098"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_0</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1099"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var">quit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1100"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Down</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1101"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1102"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Up</span></span><span class="hs-special">,</span><span>           </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1103"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var">moveHistory</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span>
</span><span id="line-1104"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Right</span></span><span class="hs-special">,</span><span>        </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1105"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1106"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_h</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1107"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Left</span></span><span class="hs-special">,</span><span>         </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1108"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span>    </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1109"></span><span>        </span><span class="hs-comment">-- Implementation using the original 'moveWord'':</span><span>
</span><span id="line-1110"></span><span>        </span><span class="hs-comment">--, (xK_e,            moveCursor Next &gt;&gt; moveWord' notWord Next &gt;&gt; moveCursor Prev)</span><span>
</span><span id="line-1111"></span><span>        </span><span class="hs-comment">--, (xK_b,            moveWord' notWord Prev)</span><span>
</span><span id="line-1112"></span><span>        </span><span class="hs-comment">--, (xK_w,            moveWord' (not . notWord) Next &gt;&gt; clipCursor)</span><span>
</span><span id="line-1113"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_e</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1114"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_b</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1115"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_w</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var">moveCursorClip</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1116"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_f</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; (Bool, Bool)) -&gt; XP String
</span><a href="XMonad.Prompt.html#promptBuffer"><span class="hs-identifier hs-var">promptBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="XMonad.Prompt.html#bufferOne"><span class="hs-identifier hs-var">bufferOne</span></a></span><span> </span><span class="annot"><span class="annottext">XP String -&gt; (String -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; String -&gt; XP ()
</span><a href="XMonad.Prompt.html#toHeadChar"><span class="hs-identifier hs-var">toHeadChar</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_d</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP () -&gt; Map (KeyMask, Window) (XP ()) -&gt; XP ()
</span><a href="XMonad.Prompt.html#promptSubmap"><span class="hs-identifier hs-var">promptSubmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389576"><span class="hs-identifier hs-var">deleteVimXPKeymap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_c</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP () -&gt; Map (KeyMask, Window) (XP ()) -&gt; XP ()
</span><a href="XMonad.Prompt.html#promptSubmap"><span class="hs-identifier hs-var">promptSubmap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389574"><span class="hs-identifier hs-var">changeVimXPKeymap</span></a></span><span>
</span><span id="line-1119"></span><span>                                </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1120"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-1121"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())]
-&gt; [((KeyMask, Window), XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1122"></span><span>        </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ())
forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (b, d) (c, d)
</span><span class="hs-identifier hs-var">first</span></span><span> </span><span class="annot"><span class="annottext">((Window -&gt; (KeyMask, Window))
 -&gt; (Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; (Window -&gt; (KeyMask, Window))
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">shiftMask</span></span><span class="hs-special">)</span><span>
</span><span id="line-1123"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_dollar</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1124"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_D</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var">killAfter</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1125"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_C</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var">killAfter</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1126"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_P</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#pasteString%27"><span class="hs-identifier hs-var">pasteString'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389586"><span class="hs-identifier hs-var">pasteFilter</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1127"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_A</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var">endOfLine</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1128"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_I</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var">startOfLine</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1129"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_F</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(String -&gt; String -&gt; (Bool, Bool)) -&gt; XP String
</span><a href="XMonad.Prompt.html#promptBuffer"><span class="hs-identifier hs-var">promptBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; (Bool, Bool)
</span><a href="XMonad.Prompt.html#bufferOne"><span class="hs-identifier hs-var">bufferOne</span></a></span><span> </span><span class="annot"><span class="annottext">XP String -&gt; (String -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; String -&gt; XP ()
</span><a href="XMonad.Prompt.html#toHeadChar"><span class="hs-identifier hs-var">toHeadChar</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1130"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1131"></span><span>    </span><span id="local-6989586621679389576"><span class="annot"><span class="annottext">deleteVimXPKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389576"><span class="hs-identifier hs-var hs-var">deleteVimXPKeymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ()))
-&gt; [((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1132"></span><span>        </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (XP () -&gt; XP ())
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1133"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_e</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-var">clipCursor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1134"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_w</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-var">clipCursor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1135"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_0</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier hs-var">killBefore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1136"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_b</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1137"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_d</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="XMonad.Prompt.html#setInput"><span class="hs-identifier hs-var">setInput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1138"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())]
-&gt; [((KeyMask, Window), XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1139"></span><span>        </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (XP () -&gt; XP ())
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">shiftMask</span></span><span> </span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1140"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_dollar</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var">killAfter</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1141"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1142"></span><span>    </span><span id="local-6989586621679389574"><span class="annot"><span class="annottext">changeVimXPKeymap :: Map (KeyMask, Window) (XP ())
</span><a href="#local-6989586621679389574"><span class="hs-identifier hs-var hs-var">changeVimXPKeymap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">([((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ()))
-&gt; [((KeyMask, Window), XP ())] -&gt; Map (KeyMask, Window) (XP ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1143"></span><span>        </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (XP () -&gt; XP ())
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1144"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_e</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var">deleteString</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1145"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_0</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier hs-var">killBefore</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1146"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_b</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1147"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_c</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="XMonad.Prompt.html#setInput"><span class="hs-identifier hs-var">setInput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1148"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_w</span></span><span class="hs-special">,</span><span>            </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; XP ()
</span><a href="XMonad.Prompt.html#changeWord"><span class="hs-identifier hs-var">changeWord</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389585"><span class="hs-identifier hs-var">notWord</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1149"></span><span>        </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[((KeyMask, Window), XP ())]
-&gt; [((KeyMask, Window), XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span>
</span><span id="line-1150"></span><span>        </span><span class="annot"><span class="annottext">((Window, XP ()) -&gt; ((KeyMask, Window), XP ()))
-&gt; [(Window, XP ())] -&gt; [((KeyMask, Window), XP ())]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; (KeyMask, Window))
-&gt; (XP () -&gt; XP ())
-&gt; (Window, XP ())
-&gt; ((KeyMask, Window), XP ())
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">shiftMask</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1151"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_dollar</span></span><span class="hs-special">,</span><span>       </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var">killAfter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1152"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-1153"></span><span>
</span><span id="line-1154"></span><span class="hs-comment">-- Useful for exploring off-by-one issues.</span><span>
</span><span id="line-1155"></span><span class="hs-comment">--testOffset :: XP ()</span><span>
</span><span id="line-1156"></span><span class="hs-comment">--testOffset = do</span><span>
</span><span id="line-1157"></span><span class="hs-comment">--    off &lt;- getOffset</span><span>
</span><span id="line-1158"></span><span class="hs-comment">--    str &lt;- getInput</span><span>
</span><span id="line-1159"></span><span class="hs-comment">--    setInput $ str ++ &quot;|&quot; ++ (show off) ++ &quot;:&quot; ++ (show $ length str)</span><span>
</span><span id="line-1160"></span><span>
</span><span id="line-1161"></span><span class="hs-comment">-- | Set @True@ to save the prompt's entry to history and run it via the</span><span>
</span><span id="line-1162"></span><span class="hs-comment">-- provided action.</span><span>
</span><span id="line-1163"></span><span class="annot"><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-type">setSuccess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1164"></span><span id="setSuccess"><span class="annot"><span class="annottext">setSuccess :: Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var hs-var">setSuccess</span></a></span></span><span> </span><span id="local-6989586621679389565"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389565"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389564"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389564"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389564"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">successful :: Bool
</span><a href="XMonad.Prompt.html#successful"><span class="hs-identifier hs-var">successful</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389565"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1165"></span><span>
</span><span id="line-1166"></span><span class="hs-comment">-- | Set @True@ to leave all event loops, no matter how nested.</span><span>
</span><span id="line-1167"></span><span class="annot"><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-type">setDone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1168"></span><span id="setDone"><span class="annot"><span class="annottext">setDone :: Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var hs-var">setDone</span></a></span></span><span> </span><span id="local-6989586621679389563"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389563"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389562"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389562"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389562"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">done :: Bool
</span><a href="XMonad.Prompt.html#done"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389563"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1169"></span><span>
</span><span id="line-1170"></span><span class="hs-comment">-- | Set @True@ to leave the current event loop, i.e. submaps.</span><span>
</span><span id="line-1171"></span><span class="annot"><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-type">setModeDone</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1172"></span><span id="setModeDone"><span class="annot"><span class="annottext">setModeDone :: Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var hs-var">setModeDone</span></a></span></span><span> </span><span id="local-6989586621679389561"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389561"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389560"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389560"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389560"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">modeDone :: Bool
</span><a href="XMonad.Prompt.html#modeDone"><span class="hs-identifier hs-var">modeDone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389561"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1173"></span><span>
</span><span id="line-1174"></span><span class="hs-comment">-- KeyPress and State</span><span>
</span><span id="line-1175"></span><span>
</span><span id="line-1176"></span><span class="hs-comment">-- | Quit.</span><span>
</span><span id="line-1177"></span><span class="annot"><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-type">quit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1178"></span><span id="quit"><span class="annot"><span class="annottext">quit :: XP ()
</span><a href="XMonad.Prompt.html#quit"><span class="hs-identifier hs-var hs-var">quit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#flushString"><span class="hs-identifier hs-var">flushString</span></a></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setSuccess"><span class="hs-identifier hs-var">setSuccess</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setDone"><span class="hs-identifier hs-var">setDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP ()
</span><a href="XMonad.Prompt.html#setModeDone"><span class="hs-identifier hs-var">setModeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1179"></span><span>
</span><span id="line-1180"></span><span class="hs-comment">-- | Kill the portion of the command before the cursor</span><span>
</span><span id="line-1181"></span><span class="annot"><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier hs-type">killBefore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1182"></span><span id="killBefore"><span class="annot"><span class="annottext">killBefore :: XP ()
</span><a href="XMonad.Prompt.html#killBefore"><span class="hs-identifier hs-var hs-var">killBefore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1183"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389558"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389558"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389558"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389558"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XPState -&gt; XPState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389558"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1184"></span><span>
</span><span id="line-1185"></span><span class="hs-comment">-- | Kill the portion of the command including and after the cursor</span><span>
</span><span id="line-1186"></span><span class="annot"><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-type">killAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1187"></span><span id="killAfter"><span class="annot"><span class="annottext">killAfter :: XP ()
</span><a href="XMonad.Prompt.html#killAfter"><span class="hs-identifier hs-var hs-var">killAfter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1188"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389556"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389556"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389556"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389556"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389556"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1189"></span><span>
</span><span id="line-1190"></span><span class="hs-comment">-- | Kill the next\/previous word, using 'isSpace' as the default</span><span>
</span><span id="line-1191"></span><span class="hs-comment">--   predicate for non-word characters.  See 'killWord''.</span><span>
</span><span id="line-1192"></span><span class="annot"><a href="XMonad.Prompt.html#killWord"><span class="hs-identifier hs-type">killWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1193"></span><span id="killWord"><span class="annot"><span class="annottext">killWord :: Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord"><span class="hs-identifier hs-var hs-var">killWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-1194"></span><span>
</span><span id="line-1195"></span><span class="hs-comment">-- | Kill the next\/previous word, given a predicate to identify</span><span>
</span><span id="line-1196"></span><span class="hs-comment">--   non-word characters. First delete any consecutive non-word</span><span>
</span><span id="line-1197"></span><span class="hs-comment">--   characters; then delete consecutive word characters, stopping</span><span>
</span><span id="line-1198"></span><span class="hs-comment">--   just before the next non-word character.</span><span>
</span><span id="line-1199"></span><span class="hs-comment">--</span><span>
</span><span id="line-1200"></span><span class="hs-comment">--   For example, by default (using 'killWord') a path like</span><span>
</span><span id="line-1201"></span><span class="hs-comment">--   @foo\/bar\/baz@ would be deleted in its entirety.  Instead you can</span><span>
</span><span id="line-1202"></span><span class="hs-comment">--   use something like @killWord' (\\c -&gt; isSpace c || c == \'\/\')@ to</span><span>
</span><span id="line-1203"></span><span class="hs-comment">--   delete the path one component at a time.</span><span>
</span><span id="line-1204"></span><span class="annot"><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-type">killWord'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1205"></span><span id="killWord%27"><span class="annot"><span class="annottext">killWord' :: (Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var hs-var">killWord'</span></a></span></span><span> </span><span id="local-6989586621679389555"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389555"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679389554"><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389554"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1206"></span><span>  </span><span id="local-6989586621679389553"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389553"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Int) -&gt; XP Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span>
</span><span id="line-1207"></span><span>  </span><span id="local-6989586621679389552"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389552"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String) -&gt; XP String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-1208"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389551"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389551"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389550"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389550"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389553"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389552"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1209"></span><span>      </span><span id="local-6989586621679389548"><span class="annot"><span class="annottext">delNextWord :: String -&gt; String
</span><a href="#local-6989586621679389548"><span class="hs-identifier hs-var hs-var">delNextWord</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389555"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389555"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1210"></span><span>      </span><span id="local-6989586621679389546"><span class="annot"><span class="annottext">delPrevWord :: String -&gt; String
</span><a href="#local-6989586621679389546"><span class="hs-identifier hs-var hs-var">delPrevWord</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389548"><span class="hs-identifier hs-var">delNextWord</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-1211"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679389544"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389544"><span class="hs-identifier hs-var">ncom</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389543"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389543"><span class="hs-identifier hs-var">noff</span></a></span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span>
</span><span id="line-1212"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389554"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1213"></span><span>            </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389551"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389548"><span class="hs-identifier hs-var">delNextWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389550"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389553"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1214"></span><span>            </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389546"><span class="hs-identifier hs-var">delPrevWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389551"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389550"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; String -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389546"><span class="hs-identifier hs-var">delPrevWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389551"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- laziness!!</span><span>
</span><span id="line-1215"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389542"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389542"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389544"><span class="hs-identifier hs-var">ncom</span></a></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XPState -&gt; XPState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389542"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389543"><span class="hs-identifier hs-var">noff</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1216"></span><span>
</span><span id="line-1217"></span><span class="hs-comment">-- | From Vim's @:help cw@:</span><span>
</span><span id="line-1218"></span><span class="hs-comment">--</span><span>
</span><span id="line-1219"></span><span class="hs-comment">-- * Special case: When the cursor is in a word, &quot;cw&quot; and &quot;cW&quot; do not include</span><span>
</span><span id="line-1220"></span><span class="hs-comment">--   the white space after a word, they only change up to the end of the word.</span><span>
</span><span id="line-1221"></span><span class="annot"><a href="XMonad.Prompt.html#changeWord"><span class="hs-identifier hs-type">changeWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1222"></span><span id="changeWord"><span class="annot"><span class="annottext">changeWord :: (Char -&gt; Bool) -&gt; XP ()
</span><a href="XMonad.Prompt.html#changeWord"><span class="hs-identifier hs-var hs-var">changeWord</span></a></span></span><span> </span><span id="local-6989586621679389541"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389541"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO (XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(StateT XPState IO (XP ()) -&gt; XP ())
-&gt; StateT XPState IO (XP ()) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; (Char -&gt; Bool) -&gt; XP ()
</span><a href="#local-6989586621679389540"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int -&gt; (Char -&gt; Bool) -&gt; XP ())
-&gt; XP String -&gt; StateT XPState IO (Int -&gt; (Char -&gt; Bool) -&gt; XP ())
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP String
</span><a href="XMonad.Prompt.html#getInput"><span class="hs-identifier hs-var">getInput</span></a></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO (Int -&gt; (Char -&gt; Bool) -&gt; XP ())
-&gt; XP Int -&gt; StateT XPState IO ((Char -&gt; Bool) -&gt; XP ())
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP Int
</span><a href="XMonad.Prompt.html#getOffset"><span class="hs-identifier hs-var">getOffset</span></a></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO ((Char -&gt; Bool) -&gt; XP ())
-&gt; StateT XPState IO (Char -&gt; Bool) -&gt; StateT XPState IO (XP ())
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; StateT XPState IO (Char -&gt; Bool)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389541"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1223"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-1224"></span><span>        </span><span class="annot"><a href="#local-6989586621679389540"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1225"></span><span>        </span><span id="local-6989586621679389540"><span class="annot"><span class="annottext">f :: String -&gt; Int -&gt; (Char -&gt; Bool) -&gt; XP ()
</span><a href="#local-6989586621679389540"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679389539"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389539"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679389538"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389538"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389539"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389538"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span>
</span><span id="line-1226"></span><span>                      </span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389539"><span class="hs-identifier hs-var">str</span></a></span><span>              </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; XP ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1227"></span><span>        </span><span class="annot"><a href="#local-6989586621679389540"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span id="local-6989586621679389536"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389536"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679389535"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389535"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span id="local-6989586621679389534"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389534"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389534"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Char -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389536"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; Char
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389535"><span class="hs-identifier hs-var">off</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389534"><span class="hs-identifier hs-var">p'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span>
</span><span id="line-1228"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#killWord%27"><span class="hs-identifier hs-var">killWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389534"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span>
</span><span id="line-1229"></span><span>
</span><span id="line-1230"></span><span class="hs-comment">-- | Put the cursor at the end of line</span><span>
</span><span id="line-1231"></span><span class="annot"><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-type">endOfLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1232"></span><span id="endOfLine"><span class="annot"><span class="annottext">endOfLine :: XP ()
</span><a href="XMonad.Prompt.html#endOfLine"><span class="hs-identifier hs-var hs-var">endOfLine</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-1233"></span><span>    </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389532"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389532"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389532"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389532"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1234"></span><span>
</span><span id="line-1235"></span><span class="hs-comment">-- | Put the cursor at the start of line</span><span>
</span><span id="line-1236"></span><span class="annot"><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-type">startOfLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1237"></span><span id="startOfLine"><span class="annot"><span class="annottext">startOfLine :: XP ()
</span><a href="XMonad.Prompt.html#startOfLine"><span class="hs-identifier hs-var hs-var">startOfLine</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span>
</span><span id="line-1238"></span><span>    </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389531"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389531"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389531"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1239"></span><span>
</span><span id="line-1240"></span><span class="hs-comment">-- |  Flush the command string and reset the offset</span><span>
</span><span id="line-1241"></span><span class="annot"><a href="XMonad.Prompt.html#flushString"><span class="hs-identifier hs-type">flushString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1242"></span><span id="flushString"><span class="annot"><span class="annottext">flushString :: XP ()
</span><a href="XMonad.Prompt.html#flushString"><span class="hs-identifier hs-var hs-var">flushString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389530"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389530"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XPState -&gt; XPState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389530"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span>
</span><span id="line-1243"></span><span>
</span><span id="line-1244"></span><span class="hs-comment">--reset index if config has `alwaysHighlight`. The inserted char could imply fewer autocompletions.</span><span>
</span><span id="line-1245"></span><span class="hs-comment">--If the current index was column 2, row 1 and now there are only 4 autocompletion rows with 1 column, what should we highlight? Set it to the first and start navigation again</span><span>
</span><span id="line-1246"></span><span class="annot"><a href="XMonad.Prompt.html#resetComplIndex"><span class="hs-identifier hs-type">resetComplIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span>
</span><span id="line-1247"></span><span id="resetComplIndex"><span class="annot"><span class="annottext">resetComplIndex :: XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#resetComplIndex"><span class="hs-identifier hs-var hs-var">resetComplIndex</span></a></span></span><span> </span><span id="local-6989586621679389528"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389528"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389528"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389528"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">complIndex :: (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var">complIndex</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389528"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1248"></span><span>
</span><span id="line-1249"></span><span class="hs-comment">-- | Insert a character at the cursor position</span><span>
</span><span id="line-1250"></span><span class="annot"><a href="XMonad.Prompt.html#insertString"><span class="hs-identifier hs-type">insertString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1251"></span><span id="insertString"><span class="annot"><span class="annottext">insertString :: String -&gt; XP ()
</span><a href="XMonad.Prompt.html#insertString"><span class="hs-identifier hs-var hs-var">insertString</span></a></span></span><span> </span><span id="local-6989586621679389527"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389527"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1252"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="XMonad.Prompt.html#insertString%27"><span class="hs-identifier hs-var">insertString'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389527"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1253"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#resetComplIndex"><span class="hs-identifier hs-var">resetComplIndex</span></a></span><span>
</span><span id="line-1254"></span><span>
</span><span id="line-1255"></span><span class="annot"><a href="XMonad.Prompt.html#insertString%27"><span class="hs-identifier hs-type">insertString'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1256"></span><span id="insertString%27"><span class="annot"><span class="annottext">insertString' :: String -&gt; XP ()
</span><a href="XMonad.Prompt.html#insertString%27"><span class="hs-identifier hs-var hs-var">insertString'</span></a></span></span><span> </span><span id="local-6989586621679389526"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389526"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1257"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389525"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389525"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span>
</span><span id="line-1258"></span><span>    </span><span id="local-6989586621679389524"><span class="annot"><span class="annottext">cmd :: String
</span><a href="#local-6989586621679389524"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String
</span><a href="#local-6989586621679389523"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389525"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389525"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1259"></span><span>    </span><span id="local-6989586621679389522"><span class="annot"><span class="annottext">st :: XPState
</span><a href="#local-6989586621679389522"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389525"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
</span><a href="#local-6989586621679389521"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389525"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1260"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389524"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389522"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1261"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389521"><span class="annot"><span class="annottext">o :: Int -&gt; Int
</span><a href="#local-6989586621679389521"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679389520"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389520"><span class="hs-identifier hs-var">oo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389520"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389526"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1262"></span><span>        </span><span id="local-6989586621679389523"><span class="annot"><span class="annottext">c :: String -&gt; Int -&gt; String
</span><a href="#local-6989586621679389523"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389519"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389519"><span class="hs-identifier hs-var">oc</span></a></span></span><span> </span><span id="local-6989586621679389518"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389518"><span class="hs-identifier hs-var">oo</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389518"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389519"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389519"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389526"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-1263"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389517"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389526"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389516"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1264"></span><span>                </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389517"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389517"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389516"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389516"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389518"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389519"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-1265"></span><span>
</span><span id="line-1266"></span><span class="hs-comment">-- | Insert the current X selection string at the cursor position. The X</span><span>
</span><span id="line-1267"></span><span class="hs-comment">-- selection is not modified.</span><span>
</span><span id="line-1268"></span><span class="annot"><a href="XMonad.Prompt.html#pasteString"><span class="hs-identifier hs-type">pasteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1269"></span><span id="pasteString"><span class="annot"><span class="annottext">pasteString :: XP ()
</span><a href="XMonad.Prompt.html#pasteString"><span class="hs-identifier hs-var hs-var">pasteString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#pasteString%27"><span class="hs-identifier hs-var">pasteString'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-1270"></span><span>
</span><span id="line-1271"></span><span class="hs-comment">-- | A variant of 'pasteString' which allows modifying the X selection before</span><span>
</span><span id="line-1272"></span><span class="hs-comment">-- pasting.</span><span>
</span><span id="line-1273"></span><span class="annot"><a href="XMonad.Prompt.html#pasteString%27"><span class="hs-identifier hs-type">pasteString'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1274"></span><span id="pasteString%27"><span class="annot"><span class="annottext">pasteString' :: (String -&gt; String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#pasteString%27"><span class="hs-identifier hs-var hs-var">pasteString'</span></a></span></span><span> </span><span id="local-6989586621679389515"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389515"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; XP ()
</span><a href="XMonad.Prompt.html#insertString"><span class="hs-identifier hs-var">insertString</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; XP ()) -&gt; (String -&gt; String) -&gt; String -&gt; XP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389515"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; XP ()) -&gt; XP String -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">XP String
forall (m :: * -&gt; *). MonadIO m =&gt; m String
</span><a href="XMonad.Util.XSelection.html#getSelection"><span class="hs-identifier hs-var">getSelection</span></a></span><span>
</span><span id="line-1275"></span><span>
</span><span id="line-1276"></span><span class="hs-comment">-- | Remove a character at the cursor position</span><span>
</span><span id="line-1277"></span><span class="annot"><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-type">deleteString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1278"></span><span id="deleteString"><span class="annot"><span class="annottext">deleteString :: Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#deleteString"><span class="hs-identifier hs-var hs-var">deleteString</span></a></span></span><span> </span><span id="local-6989586621679389514"><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389514"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1279"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389513"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389513"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int -&gt; String
forall a. [a] -&gt; Int -&gt; [a]
</span><a href="#local-6989586621679389512"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389513"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389513"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XPState -&gt; XPState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389513"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall p. (Ord p, Num p) =&gt; p -&gt; p
</span><a href="#local-6989586621679389511"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389513"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1280"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389511"><span class="annot"><span class="annottext">o :: p -&gt; p
</span><a href="#local-6989586621679389511"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679389510"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389510"><span class="hs-identifier hs-var">oo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389514"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; Direction1D -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389510"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">p -&gt; p -&gt; p
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679389510"><span class="hs-identifier hs-var">oo</span></a></span><span>
</span><span id="line-1281"></span><span>        </span><span id="local-6989586621679389512"><span class="annot"><span class="annottext">c :: [a] -&gt; Int -&gt; [a]
</span><a href="#local-6989586621679389512"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389508"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span></span><span> </span><span id="local-6989586621679389507"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span></span><span>
</span><span id="line-1282"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389514"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; Direction1D -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-1283"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389514"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; Direction1D -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389505"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389504"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1284"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span>  </span><span class="annot"><span class="annottext">[a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389514"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; Direction1D -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389505"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389504"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1285"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-1286"></span><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389505"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389505"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389504"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389504"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; ([a], [a])
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389507"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389508"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-1287"></span><span>
</span><span id="line-1288"></span><span class="hs-comment">-- | Ensure the cursor remains over the command by shifting left if necessary.</span><span>
</span><span id="line-1289"></span><span class="annot"><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-type">clipCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1290"></span><span id="clipCursor"><span class="annot"><span class="annottext">clipCursor :: XP ()
</span><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-var hs-var">clipCursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389503"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389503"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389503"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; Int -&gt; t a -&gt; Int
</span><a href="#local-6989586621679389502"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389503"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389503"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1291"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389502"><span class="annot"><span class="annottext">o :: Int -&gt; t a -&gt; Int
</span><a href="#local-6989586621679389502"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679389501"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389501"><span class="hs-identifier hs-var">oo</span></a></span></span><span> </span><span id="local-6989586621679389500"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679389500"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679389500"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389501"><span class="hs-identifier hs-var">oo</span></a></span><span>
</span><span id="line-1292"></span><span>
</span><span id="line-1293"></span><span class="hs-comment">-- | Move the cursor one position.</span><span>
</span><span id="line-1294"></span><span class="annot"><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-type">moveCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1295"></span><span id="moveCursor"><span class="annot"><span class="annottext">moveCursor :: Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var hs-var">moveCursor</span></a></span></span><span> </span><span id="local-6989586621679389498"><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389498"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1296"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389497"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389497"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389497"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; Int -&gt; t a -&gt; Int
</span><a href="#local-6989586621679389496"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389497"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389497"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-1297"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389496"><span class="annot"><span class="annottext">o :: Int -&gt; t a -&gt; Int
</span><a href="#local-6989586621679389496"><span class="hs-identifier hs-var hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679389495"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389495"><span class="hs-identifier hs-var">oo</span></a></span></span><span> </span><span id="local-6989586621679389494"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679389494"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389498"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; Direction1D -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389495"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679389494"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389495"><span class="hs-identifier hs-var">oo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1298"></span><span>
</span><span id="line-1299"></span><span class="hs-comment">-- | Move the cursor one position, but not beyond the command.</span><span>
</span><span id="line-1300"></span><span class="annot"><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-type">moveCursorClip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1301"></span><span id="moveCursorClip"><span class="annot"><span class="annottext">moveCursorClip :: Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursorClip"><span class="hs-identifier hs-var hs-var">moveCursorClip</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP () -&gt; XP () -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#clipCursor"><span class="hs-identifier hs-var">clipCursor</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; (Direction1D -&gt; XP ()) -&gt; Direction1D -&gt; XP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveCursor"><span class="hs-identifier hs-var">moveCursor</span></a></span><span>
</span><span id="line-1302"></span><span class="hs-comment">--  modify $ \s -&gt; s { offset = o (offset s) (command s)}</span><span>
</span><span id="line-1303"></span><span class="hs-comment">--  where o oo c = if d == Prev then max 0 (oo - 1) else min (max 0 $ length c - 1) (oo + 1)</span><span>
</span><span id="line-1304"></span><span>
</span><span id="line-1305"></span><span class="hs-comment">-- | Move the cursor one word, using 'isSpace' as the default</span><span>
</span><span id="line-1306"></span><span class="hs-comment">--   predicate for non-word characters.  See 'moveWord''.</span><span>
</span><span id="line-1307"></span><span class="annot"><a href="XMonad.Prompt.html#moveWord"><span class="hs-identifier hs-type">moveWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1308"></span><span id="moveWord"><span class="annot"><span class="annottext">moveWord :: Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord"><span class="hs-identifier hs-var hs-var">moveWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var">moveWord'</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span>
</span><span id="line-1309"></span><span>
</span><span id="line-1310"></span><span class="hs-comment">-- | Given a direction, move the cursor to just before the next</span><span>
</span><span id="line-1311"></span><span class="hs-comment">-- (predicate,not-predicate) character transition. This means a (not-word,word)</span><span>
</span><span id="line-1312"></span><span class="hs-comment">-- transition should be followed by a 'moveCursorClip' action. Always considers</span><span>
</span><span id="line-1313"></span><span class="hs-comment">-- the character under the current cursor position.  This means a</span><span>
</span><span id="line-1314"></span><span class="hs-comment">-- (word,not-word) transition should be preceded by a 'moveCursorClip' action.</span><span>
</span><span id="line-1315"></span><span class="hs-comment">-- Calculated as the length of consecutive non-predicate characters starting</span><span>
</span><span id="line-1316"></span><span class="hs-comment">-- from the cursor position, plus the length of subsequent consecutive</span><span>
</span><span id="line-1317"></span><span class="hs-comment">-- predicate characters, plus when moving backwards the distance of the cursor</span><span>
</span><span id="line-1318"></span><span class="hs-comment">-- beyond the input. Reduced by one to avoid jumping off either end of the</span><span>
</span><span id="line-1319"></span><span class="hs-comment">-- input, when present.</span><span>
</span><span id="line-1320"></span><span class="hs-comment">--</span><span>
</span><span id="line-1321"></span><span class="hs-comment">-- Use these identities to retain the pre-0.14 behavior:</span><span>
</span><span id="line-1322"></span><span class="hs-comment">--</span><span>
</span><span id="line-1323"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1324"></span><span class="hs-comment">--     (oldMoveWord' p Prev) = (moveCursor Prev &gt;&gt; moveWord' p Prev)</span><span>
</span><span id="line-1325"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1326"></span><span class="hs-comment">--</span><span>
</span><span id="line-1327"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1328"></span><span class="hs-comment">--     (oldMoveWord' p Next) = (moveWord' p Next &gt;&gt; moveCursor Next)</span><span>
</span><span id="line-1329"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1330"></span><span class="annot"><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-type">moveWord'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1331"></span><span id="moveWord%27"><span class="annot"><span class="annottext">moveWord' :: (Char -&gt; Bool) -&gt; Direction1D -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveWord%27"><span class="hs-identifier hs-var hs-var">moveWord'</span></a></span></span><span> </span><span id="local-6989586621679389493"><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389493"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679389492"><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389492"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1332"></span><span>  </span><span id="local-6989586621679389491"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389491"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String) -&gt; XP String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-1333"></span><span>  </span><span id="local-6989586621679389490"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389490"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Int) -&gt; XP Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span>
</span><span id="line-1334"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389489"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389489"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389488"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389488"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><a href="#local-6989586621679389487"><span class="hs-identifier hs-var">splitOn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389490"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389491"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1335"></span><span>      </span><span id="local-6989586621679389487"><span class="annot"><span class="annottext">splitOn :: Int -&gt; [a] -&gt; ([a], [a])
</span><a href="#local-6989586621679389487"><span class="hs-identifier hs-var hs-var">splitOn</span></a></span></span><span> </span><span id="local-6989586621679389486"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389486"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679389485"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389485"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389486"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389485"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [a]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389486"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679389485"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1336"></span><span>      </span><span id="local-6989586621679389484"><span class="annot"><span class="annottext">gap :: Int
</span><a href="#local-6989586621679389484"><span class="hs-identifier hs-var hs-var">gap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389492"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1337"></span><span>                </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389490"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389491"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-1338"></span><span>                </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1339"></span><span>      </span><span id="local-6989586621679389483"><span class="annot"><span class="annottext">len :: String -&gt; Int
</span><a href="#local-6989586621679389483"><span class="hs-identifier hs-var hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (String -&gt; Int) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; Int -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (String -&gt; Int) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389484"><span class="hs-identifier hs-var">gap</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span>
</span><span id="line-1340"></span><span>          </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; (String -&gt; Int) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(+)</span></span><span>
</span><span id="line-1341"></span><span>          </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int) -&gt; (String -&gt; (Int, Int)) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int)
-&gt; (String -&gt; Int) -&gt; (String, String) -&gt; (Int, Int)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; (String -&gt; String) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (Char -&gt; Bool) -&gt; Char -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389493"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1342"></span><span>          </span><span class="annot"><span class="annottext">((String, String) -&gt; (Int, Int))
-&gt; (String -&gt; (String, String)) -&gt; String -&gt; (Int, Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">span</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><a href="#local-6989586621679389493"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1343"></span><span>      </span><span id="local-6989586621679389479"><span class="annot"><span class="annottext">newoff :: Int
</span><a href="#local-6989586621679389479"><span class="hs-identifier hs-var hs-var">newoff</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389492"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1344"></span><span>                </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389490"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="#local-6989586621679389483"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389489"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1345"></span><span>                </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389490"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="#local-6989586621679389483"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389488"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-1346"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389478"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389478"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389478"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389479"><span class="hs-identifier hs-var">newoff</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1347"></span><span>
</span><span id="line-1348"></span><span class="hs-comment">-- | Set the prompt's input to an entry further up or further down the history</span><span>
</span><span id="line-1349"></span><span class="hs-comment">-- stack. Use 'Stack' functions from 'XMonad.StackSet', i.e. 'focusUp'' or</span><span>
</span><span id="line-1350"></span><span class="hs-comment">-- 'focusDown''.</span><span>
</span><span id="line-1351"></span><span class="annot"><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-type">moveHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1352"></span><span id="moveHistory"><span class="annot"><span class="annottext">moveHistory :: (Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#moveHistory"><span class="hs-identifier hs-var hs-var">moveHistory</span></a></span></span><span> </span><span id="local-6989586621679389477"><span class="annot"><span class="annottext">Stack String -&gt; Stack String
</span><a href="#local-6989586621679389477"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1353"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389476"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389476"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389475"><span class="annot"><span class="annottext">ch :: Stack String
</span><a href="#local-6989586621679389475"><span class="hs-identifier hs-var hs-var">ch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
</span><a href="#local-6989586621679389477"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Stack String) -&gt; Stack String -&gt; Stack String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var hs-var">commandHistory</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389476"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1354"></span><span>                 </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389476"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">commandHistory :: Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var">commandHistory</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack String
</span><a href="#local-6989586621679389475"><span class="hs-identifier hs-var">ch</span></a></span><span>
</span><span id="line-1355"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int) -&gt; String -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; String
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack String
</span><a href="#local-6989586621679389475"><span class="hs-identifier hs-var">ch</span></a></span><span>
</span><span id="line-1356"></span><span>                      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">complIndex :: (Int, Int)
</span><a href="XMonad.Prompt.html#complIndex"><span class="hs-identifier hs-var">complIndex</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1357"></span><span>  </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var">updateWindows</span></a></span><span>
</span><span id="line-1358"></span><span>  </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#updateHighlightedCompl"><span class="hs-identifier hs-var">updateHighlightedCompl</span></a></span><span>
</span><span id="line-1359"></span><span>
</span><span id="line-1360"></span><span class="hs-comment">-- | Move the cursor in the given direction to the first instance of the first</span><span>
</span><span id="line-1361"></span><span class="hs-comment">-- character of the given string, assuming the string is not empty. The</span><span>
</span><span id="line-1362"></span><span class="hs-comment">-- starting cursor character is not considered, and the cursor is placed over</span><span>
</span><span id="line-1363"></span><span class="hs-comment">-- the matching character.</span><span>
</span><span id="line-1364"></span><span class="annot"><a href="XMonad.Prompt.html#toHeadChar"><span class="hs-identifier hs-type">toHeadChar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction1D"><span class="hs-identifier hs-type">Direction1D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1365"></span><span id="toHeadChar"><span class="annot"><span class="annottext">toHeadChar :: Direction1D -&gt; String -&gt; XP ()
</span><a href="XMonad.Prompt.html#toHeadChar"><span class="hs-identifier hs-var hs-var">toHeadChar</span></a></span></span><span> </span><span id="local-6989586621679389474"><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389474"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679389473"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389473"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389473"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1366"></span><span>    </span><span id="local-6989586621679389472"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389472"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String) -&gt; XP String
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span>
</span><span id="line-1367"></span><span>    </span><span id="local-6989586621679389471"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389471"><span class="hs-identifier hs-var">off</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Int) -&gt; XP Int
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span>
</span><span id="line-1368"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389470"><span class="annot"><span class="annottext">c :: Char
</span><a href="#local-6989586621679389470"><span class="hs-identifier hs-var hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389473"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1369"></span><span>        </span><span id="local-6989586621679389469"><span class="annot"><span class="annottext">off' :: Int
</span><a href="#local-6989586621679389469"><span class="hs-identifier hs-var hs-var">off'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="#local-6989586621679389474"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Direction1D -&gt; Direction1D -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Direction1D
</span><a href="XMonad.Util.Types.html#Prev"><span class="hs-identifier hs-var">Prev</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">negate</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int) -&gt; ((Int, Int) -&gt; Int) -&gt; (Int, Int) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-1370"></span><span>             </span><span class="annot"><span class="annottext">((Int, Int) -&gt; Int)
-&gt; ((String, String) -&gt; (Int, Int)) -&gt; (String, String) -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">((String -&gt; Int)
 -&gt; (String -&gt; Int) -&gt; (String, String) -&gt; (Int, Int))
-&gt; (String -&gt; Int) -&gt; (String, String) -&gt; (Int, Int)
forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Int)
-&gt; (String -&gt; Int) -&gt; (String, String) -&gt; (Int, Int)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">(***)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; (String -&gt; Maybe Int) -&gt; String -&gt; Int
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679389470"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1371"></span><span>             </span><span class="annot"><span class="annottext">((String, String) -&gt; (Int, Int))
-&gt; ((String, String) -&gt; (String, String))
-&gt; (String, String)
-&gt; (Int, Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String)
-&gt; (String -&gt; String) -&gt; (String, String) -&gt; (String, String)
forall (a :: * -&gt; * -&gt; *) b c b' c'.
Arrow a =&gt;
a b c -&gt; a b' c' -&gt; a (b, b') (c, c')
</span><span class="hs-operator hs-var">***</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1372"></span><span>             </span><span class="annot"><span class="annottext">((String, String) -&gt; Int) -&gt; (String, String) -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389471"><span class="hs-identifier hs-var">off</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389472"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-1373"></span><span>    </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389466"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389466"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389466"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389466"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389469"><span class="hs-identifier hs-var">off'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1374"></span><span>
</span><span id="line-1375"></span><span class="annot"><a href="XMonad.Prompt.html#updateHighlightedCompl"><span class="hs-identifier hs-type">updateHighlightedCompl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1376"></span><span id="updateHighlightedCompl"><span class="annot"><span class="annottext">updateHighlightedCompl :: XP ()
</span><a href="XMonad.Prompt.html#updateHighlightedCompl"><span class="hs-identifier hs-var hs-var">updateHighlightedCompl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1377"></span><span>  </span><span id="local-6989586621679389465"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389465"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1378"></span><span>  </span><span id="local-6989586621679389464"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389464"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var">getCompletions</span></a></span><span>
</span><span id="line-1379"></span><span>  </span><span id="local-6989586621679389463"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389463"><span class="hs-identifier hs-var">alwaysHighlight'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; Bool) -&gt; StateT XPState IO Bool)
-&gt; (XPState -&gt; Bool) -&gt; StateT XPState IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Bool
</span><a href="XMonad.Prompt.html#alwaysHighlight"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">(XPConfig -&gt; Bool) -&gt; (XPState -&gt; XPConfig) -&gt; XPState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span>
</span><span id="line-1380"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; XP () -&gt; XP ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389463"><span class="hs-identifier hs-var">alwaysHighlight'</span></a></span><span> </span><span class="annot"><span class="annottext">(XP () -&gt; XP ()) -&gt; XP () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389462"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389462"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389462"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">highlightedCompl :: Maybe String
</span><a href="XMonad.Prompt.html#highlightedCompl"><span class="hs-identifier hs-var">highlightedCompl</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; [String] -&gt; Maybe String
</span><a href="XMonad.Prompt.html#highlightedItem"><span class="hs-identifier hs-var">highlightedItem</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389465"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389464"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-1381"></span><span>
</span><span id="line-1382"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-1383"></span><span class="hs-comment">-- X Stuff</span><span>
</span><span id="line-1384"></span><span>
</span><span id="line-1385"></span><span class="hs-comment">-- | The completion windows in its entirety.</span><span>
</span><span id="line-1386"></span><span class="hs-keyword">data</span><span> </span><span id="ComplWindowDim"><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-var">ComplWindowDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ComplWindowDim"><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-var">ComplWindowDim</span></a></span></span><span>
</span><span id="line-1387"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="cwX"><span class="annot"><span class="annottext">ComplWindowDim -&gt; Position
</span><a href="XMonad.Prompt.html#cwX"><span class="hs-identifier hs-var hs-var">cwX</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>    </span><span class="hs-comment">-- ^ Starting x position</span><span>
</span><span id="line-1388"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cwY"><span class="annot"><span class="annottext">ComplWindowDim -&gt; Position
</span><a href="XMonad.Prompt.html#cwY"><span class="hs-identifier hs-var hs-var">cwY</span></a></span></span><span>         </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>    </span><span class="hs-comment">-- ^ Starting y position</span><span>
</span><span id="line-1389"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cwWidth"><span class="annot"><span class="annottext">ComplWindowDim -&gt; Dimension
</span><a href="XMonad.Prompt.html#cwWidth"><span class="hs-identifier hs-var hs-var">cwWidth</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>   </span><span class="hs-comment">-- ^ Width of the entire prompt</span><span>
</span><span id="line-1390"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cwRowHeight"><span class="annot"><span class="annottext">ComplWindowDim -&gt; Dimension
</span><a href="XMonad.Prompt.html#cwRowHeight"><span class="hs-identifier hs-var hs-var">cwRowHeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>   </span><span class="hs-comment">-- ^ Height of a single row</span><span>
</span><span id="line-1391"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cwCols"><span class="annot"><span class="annottext">ComplWindowDim -&gt; [Position]
</span><a href="XMonad.Prompt.html#cwCols"><span class="hs-identifier hs-var hs-var">cwCols</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Starting position of all columns</span><span>
</span><span id="line-1392"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="cwRows"><span class="annot"><span class="annottext">ComplWindowDim -&gt; [Position]
</span><a href="XMonad.Prompt.html#cwRows"><span class="hs-identifier hs-var hs-var">cwRows</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Starting positions of all rows</span><span>
</span><span id="line-1393"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-1394"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389454"><span id="local-6989586621679389456"><span class="annot"><span class="annottext">ComplWindowDim -&gt; ComplWindowDim -&gt; Bool
(ComplWindowDim -&gt; ComplWindowDim -&gt; Bool)
-&gt; (ComplWindowDim -&gt; ComplWindowDim -&gt; Bool) -&gt; Eq ComplWindowDim
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ComplWindowDim -&gt; ComplWindowDim -&gt; Bool
$c/= :: ComplWindowDim -&gt; ComplWindowDim -&gt; Bool
== :: ComplWindowDim -&gt; ComplWindowDim -&gt; Bool
$c== :: ComplWindowDim -&gt; ComplWindowDim -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-1395"></span><span>
</span><span id="line-1396"></span><span class="hs-comment">-- | Create the prompt window.</span><span>
</span><span id="line-1397"></span><span class="annot"><a href="XMonad.Prompt.html#createPromptWin"><span class="hs-identifier hs-type">createPromptWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-1398"></span><span id="createPromptWin"><span class="annot"><span class="annottext">createPromptWin :: Display
-&gt; Window -&gt; XPConfig -&gt; Rectangle -&gt; Dimension -&gt; IO Window
</span><a href="XMonad.Prompt.html#createPromptWin"><span class="hs-identifier hs-var hs-var">createPromptWin</span></a></span></span><span> </span><span id="local-6989586621679389452"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389452"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span id="local-6989586621679389451"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389451"><span class="hs-identifier hs-var">rootw</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPC"><span class="hs-identifier hs-type">XPC</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389450"><span class="annot"><span class="annottext">XPPosition
position :: XPPosition
position :: XPConfig -&gt; XPPosition
</span><a href="#local-6989586621679389450"><span class="hs-identifier hs-var hs-var">position</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389449"><span class="annot"><span class="annottext">Dimension
height :: Dimension
height :: XPConfig -&gt; Dimension
</span><a href="#local-6989586621679389449"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679389448"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389448"><span class="hs-identifier hs-var">scn</span></a></span></span><span> </span><span id="local-6989586621679389447"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389447"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1399"></span><span>  </span><span id="local-6989586621679389446"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389446"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Screen
-&gt; Window
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO Window
</span><a href="XMonad.Prompt.html#mkUnmanagedWindow"><span class="hs-identifier hs-var">mkUnmanagedWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389452"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Screen
</span><span class="hs-identifier hs-var">defaultScreenOfDisplay</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389452"><span class="hs-identifier hs-var">dpy</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389451"><span class="hs-identifier hs-var">rootw</span></a></span><span>
</span><span id="line-1400"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389448"><span class="hs-identifier hs-var">scn</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389443"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389448"><span class="hs-identifier hs-var">scn</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389441"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389447"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389449"><span class="hs-identifier hs-var">height</span></a></span><span>
</span><span id="line-1401"></span><span>  </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; ClassHint -&gt; IO ()
</span><span class="hs-identifier hs-var">setClassHint</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389452"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389446"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; ClassHint
</span><span class="hs-identifier hs-var">ClassHint</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xmonad-prompt&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xmonad&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-1402"></span><span>  </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">mapWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389452"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389446"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1403"></span><span>  </span><span class="annot"><span class="annottext">Window -&gt; IO Window
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389446"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1404"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1405"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679389443"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389443"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389441"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389441"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Position)
-&gt; (Position, Dimension) -&gt; (Position, Position)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPPosition
</span><a href="#local-6989586621679389450"><span class="hs-identifier hs-var">position</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1406"></span><span>    </span><span class="annot"><span class="annottext">XPPosition
</span><a href="XMonad.Prompt.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-1407"></span><span>    </span><span class="annot"><span class="annottext">XPPosition
</span><a href="XMonad.Prompt.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389448"><span class="hs-identifier hs-var">scn</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389449"><span class="hs-identifier hs-var">height</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1408"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#CenteredAt"><span class="hs-identifier hs-type">CenteredAt</span></a></span><span> </span><span id="local-6989586621679389436"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389436"><span class="hs-identifier hs-var">py</span></a></span></span><span> </span><span id="local-6989586621679389435"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389435"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1409"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Position
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Position) -&gt; Rational -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389448"><span class="hs-identifier hs-var">scn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389435"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-1410"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Dimension
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Dimension) -&gt; Rational -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389436"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389448"><span class="hs-identifier hs-var">scn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389449"><span class="hs-identifier hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-1411"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1412"></span><span>
</span><span id="line-1413"></span><span class="hs-comment">-- | Update the state of the completion window.</span><span>
</span><span id="line-1414"></span><span class="annot"><a href="XMonad.Prompt.html#updateComplWin"><span class="hs-identifier hs-type">updateComplWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1415"></span><span id="updateComplWin"><span class="annot"><span class="annottext">updateComplWin :: Maybe Window -&gt; Maybe ComplWindowDim -&gt; XP ()
</span><a href="XMonad.Prompt.html#updateComplWin"><span class="hs-identifier hs-var hs-var">updateComplWin</span></a></span></span><span> </span><span id="local-6989586621679389432"><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679389432"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679389431"><span class="annot"><span class="annottext">Maybe ComplWindowDim
</span><a href="#local-6989586621679389431"><span class="hs-identifier hs-var">winDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1416"></span><span>  </span><span id="local-6989586621679389430"><span class="annot"><span class="annottext">IORef (Maybe Window)
</span><a href="#local-6989586621679389430"><span class="hs-identifier hs-var">cwr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; IORef (Maybe Window))
-&gt; StateT XPState IO (IORef (Maybe Window))
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; IORef (Maybe Window)
</span><a href="XMonad.Prompt.html#complWin"><span class="hs-identifier hs-var hs-var">complWin</span></a></span><span>
</span><span id="line-1417"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Window) -&gt; Maybe Window -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Window)
</span><a href="#local-6989586621679389430"><span class="hs-identifier hs-var">cwr</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679389432"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-1418"></span><span>  </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389428"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389428"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389428"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">complWinDim :: Maybe ComplWindowDim
</span><a href="XMonad.Prompt.html#complWinDim"><span class="hs-identifier hs-var">complWinDim</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
</span><a href="#local-6989586621679389431"><span class="hs-identifier hs-var">winDim</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-1419"></span><span>
</span><span id="line-1420"></span><span class="hs-comment">--- | Update all prompt windows.</span><span>
</span><span id="line-1421"></span><span class="annot"><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-type">updateWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1422"></span><span id="updateWindows"><span class="annot"><span class="annottext">updateWindows :: XP ()
</span><a href="XMonad.Prompt.html#updateWindows"><span class="hs-identifier hs-var hs-var">updateWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XP () -&gt; [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#redrawWindows"><span class="hs-identifier hs-var">redrawWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XP () -&gt; XP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#destroyComplWin"><span class="hs-identifier hs-var">destroyComplWin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; XP ()) -&gt; StateT XPState IO [String] -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var">getCompletions</span></a></span><span>
</span><span id="line-1423"></span><span>
</span><span id="line-1424"></span><span class="hs-comment">-- | Draw the main prompt window and, if necessary, redraw the</span><span>
</span><span id="line-1425"></span><span class="hs-comment">-- completion window.</span><span>
</span><span id="line-1426"></span><span class="annot"><a href="XMonad.Prompt.html#redrawWindows"><span class="hs-identifier hs-type">redrawWindows</span></a></span><span>
</span><span id="line-1427"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ What to do if the completions are empty</span><span>
</span><span id="line-1428"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Given completions</span><span>
</span><span id="line-1429"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1430"></span><span id="redrawWindows"><span class="annot"><span class="annottext">redrawWindows :: XP () -&gt; [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#redrawWindows"><span class="hs-identifier hs-var hs-var">redrawWindows</span></a></span></span><span> </span><span id="local-6989586621679389426"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389426"><span class="hs-identifier hs-var">emptyAction</span></a></span></span><span> </span><span id="local-6989586621679389425"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389425"><span class="hs-identifier hs-var">compls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1431"></span><span>  </span><span id="local-6989586621679389424"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389424"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Display) -&gt; StateT XPState IO Display
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Display
</span><a href="XMonad.Prompt.html#dpy"><span class="hs-identifier hs-var hs-var">dpy</span></a></span><span>
</span><span id="line-1432"></span><span>  </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389423"><span class="hs-identifier hs-var">drawWin</span></a></span><span>
</span><span id="line-1433"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389425"><span class="hs-identifier hs-var">compls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1434"></span><span>    </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389426"><span class="hs-identifier hs-var">emptyAction</span></a></span><span>
</span><span id="line-1435"></span><span>    </span><span id="local-6989586621679389422"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389422"><span class="hs-identifier hs-var">l</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#redrawComplWin"><span class="hs-identifier hs-var">redrawComplWin</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389422"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1436"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">sync</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389424"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-1437"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1438"></span><span>  </span><span class="hs-comment">-- | Draw the main prompt window.</span><span>
</span><span id="line-1439"></span><span>  </span><span id="local-6989586621679389423"><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389423"><span class="hs-identifier hs-var">drawWin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1440"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389420"><span class="annot"><span class="annottext">XPColor
color :: XPColor
color :: XPState -&gt; XPColor
</span><a href="#local-6989586621679389420"><span class="hs-identifier hs-var hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389419"><span class="annot"><span class="annottext">Display
dpy :: Display
dpy :: XPState -&gt; Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389418"><span class="annot"><span class="annottext">Window
win :: Window
win :: XPState -&gt; Window
</span><a href="#local-6989586621679389418"><span class="hs-identifier hs-var hs-var">win</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389417"><span class="annot"><span class="annottext">GC
gcon :: GC
gcon :: XPState -&gt; GC
</span><a href="#local-6989586621679389417"><span class="hs-identifier hs-var hs-var">gcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389416"><span class="annot"><span class="annottext">Dimension
winWidth :: Dimension
winWidth :: XPState -&gt; Dimension
</span><a href="#local-6989586621679389416"><span class="hs-identifier hs-var hs-var">winWidth</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1441"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#XPC"><span class="hs-identifier hs-type">XPC</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389415"><span class="annot"><span class="annottext">Dimension
height :: Dimension
height :: XPConfig -&gt; Dimension
</span><a href="#local-6989586621679389415"><span class="hs-identifier hs-var hs-var">height</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389414"><span class="annot"><span class="annottext">Dimension
promptBorderWidth :: Dimension
promptBorderWidth :: XPConfig -&gt; Dimension
</span><a href="#local-6989586621679389414"><span class="hs-identifier hs-var hs-var">promptBorderWidth</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; XPConfig) -&gt; StateT XPState IO XPConfig
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var hs-var">config</span></a></span><span>
</span><span id="line-1442"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389413"><span class="annot"><span class="annottext">scr :: Screen
</span><a href="#local-6989586621679389413"><span class="hs-identifier hs-var hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display -&gt; Screen
</span><span class="hs-identifier hs-var">defaultScreenOfDisplay</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span>
</span><span id="line-1443"></span><span>        </span><span id="local-6989586621679389412"><span class="annot"><span class="annottext">ht :: Dimension
</span><a href="#local-6989586621679389412"><span class="hs-identifier hs-var hs-var">ht</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389415"><span class="hs-identifier hs-var">height</span></a></span><span>            </span><span class="hs-comment">-- height of a single row</span><span>
</span><span id="line-1444"></span><span>        </span><span id="local-6989586621679389411"><span class="annot"><span class="annottext">bw :: Dimension
</span><a href="#local-6989586621679389411"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389414"><span class="hs-identifier hs-var">promptBorderWidth</span></a></span><span>
</span><span id="line-1445"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389410"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389410"><span class="hs-identifier hs-var">bgcolor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window))
-&gt; IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; String -&gt; IO (Maybe Window)
</span><span class="hs-identifier hs-var">initColor</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389420"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1446"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389408"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389408"><span class="hs-identifier hs-var">borderC</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window))
-&gt; IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; String -&gt; IO (Maybe Window)
</span><span class="hs-identifier hs-var">initColor</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var hs-var">border</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389420"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1447"></span><span>    </span><span id="local-6989586621679389407"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389407"><span class="hs-identifier hs-var">pm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Window -&gt; StateT XPState IO Window
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO Window -&gt; StateT XPState IO Window)
-&gt; IO Window -&gt; StateT XPState IO Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window -&gt; Dimension -&gt; Dimension -&gt; GrabStatus -&gt; IO Window
</span><span class="hs-identifier hs-var">createPixmap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389418"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389416"><span class="hs-identifier hs-var">winWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389412"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; GrabStatus
</span><span class="hs-identifier hs-var">defaultDepthOfScreen</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679389413"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1448"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; Window
-&gt; Window
-&gt; Dimension
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><a href="XMonad.Prompt.html#fillDrawable"><span class="hs-identifier hs-var">fillDrawable</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389407"><span class="hs-identifier hs-var">pm</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389417"><span class="hs-identifier hs-var">gcon</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389408"><span class="hs-identifier hs-var">borderC</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389410"><span class="hs-identifier hs-var">bgcolor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Dimension
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389411"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389416"><span class="hs-identifier hs-var">winWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389412"><span class="hs-identifier hs-var">ht</span></a></span><span>
</span><span id="line-1449"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; XP ()
</span><a href="XMonad.Prompt.html#printPrompt"><span class="hs-identifier hs-var">printPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389407"><span class="hs-identifier hs-var">pm</span></a></span><span>
</span><span id="line-1450"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; Position
-&gt; Position
-&gt; IO ()
</span><span class="hs-identifier hs-var">copyArea</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389407"><span class="hs-identifier hs-var">pm</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389418"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389417"><span class="hs-identifier hs-var">gcon</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389416"><span class="hs-identifier hs-var">winWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389412"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1451"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">freePixmap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389419"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389407"><span class="hs-identifier hs-var">pm</span></a></span><span>
</span><span id="line-1452"></span><span>
</span><span id="line-1453"></span><span class="hs-comment">-- | Redraw the completion window, if necessary.</span><span>
</span><span id="line-1454"></span><span class="annot"><a href="XMonad.Prompt.html#redrawComplWin"><span class="hs-identifier hs-type">redrawComplWin</span></a></span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1455"></span><span id="redrawComplWin"><span class="annot"><span class="annottext">redrawComplWin :: [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#redrawComplWin"><span class="hs-identifier hs-var hs-var">redrawComplWin</span></a></span></span><span> </span><span id="local-6989586621679389401"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389401"><span class="hs-identifier hs-var">compl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1456"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389400"><span class="annot"><span class="annottext">Bool
showComplWin :: Bool
showComplWin :: XPState -&gt; Bool
</span><a href="#local-6989586621679389400"><span class="hs-identifier hs-var hs-var">showComplWin</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389399"><span class="annot"><span class="annottext">Maybe ComplWindowDim
complWinDim :: Maybe ComplWindowDim
complWinDim :: XPState -&gt; Maybe ComplWindowDim
</span><a href="#local-6989586621679389399"><span class="hs-identifier hs-var hs-var">complWinDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389398"><span class="annot"><span class="annottext">IORef (Maybe Window)
complWin :: IORef (Maybe Window)
complWin :: XPState -&gt; IORef (Maybe Window)
</span><a href="#local-6989586621679389398"><span class="hs-identifier hs-var hs-var">complWin</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1457"></span><span>  </span><span id="local-6989586621679389397"><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389397"><span class="hs-identifier hs-var">nwi</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ComplWindowDim
</span><a href="XMonad.Prompt.html#getComplWinDim"><span class="hs-identifier hs-var">getComplWinDim</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389401"><span class="hs-identifier hs-var">compl</span></a></span><span>
</span><span id="line-1458"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389395"><span class="annot"><span class="annottext">recreate :: XP ()
</span><a href="#local-6989586621679389395"><span class="hs-identifier hs-var hs-var">recreate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#destroyComplWin"><span class="hs-identifier hs-var">destroyComplWin</span></a></span><span>
</span><span id="line-1459"></span><span>                    </span><span id="local-6989586621679389394"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389394"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ComplWindowDim -&gt; StateT XPState IO Window
</span><a href="#local-6989586621679389393"><span class="hs-identifier hs-var">createComplWin</span></a></span><span> </span><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389397"><span class="hs-identifier hs-var">nwi</span></a></span><span>
</span><span id="line-1460"></span><span>                    </span><span class="annot"><span class="annottext">Window -&gt; [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#drawComplWin"><span class="hs-identifier hs-var">drawComplWin</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389394"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389401"><span class="hs-identifier hs-var">compl</span></a></span><span>
</span><span id="line-1461"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389401"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389400"><span class="hs-identifier hs-var">showComplWin</span></a></span><span>
</span><span id="line-1462"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IORef (Maybe Window) -&gt; IO (Maybe Window)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Window)
</span><a href="#local-6989586621679389398"><span class="hs-identifier hs-var">complWin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO (Maybe Window)
-&gt; (Maybe Window -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1463"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389391"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389391"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
</span><a href="#local-6989586621679389399"><span class="hs-identifier hs-var">complWinDim</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1464"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389390"><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389390"><span class="hs-identifier hs-var">wi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389397"><span class="hs-identifier hs-var">nwi</span></a></span><span> </span><span class="annot"><span class="annottext">ComplWindowDim -&gt; ComplWindowDim -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389390"><span class="hs-identifier hs-var">wi</span></a></span><span> </span><span class="hs-comment">-- complWinDim did not change</span><span>
</span><span id="line-1465"></span><span>                                   </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Window -&gt; [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#drawComplWin"><span class="hs-identifier hs-var">drawComplWin</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389391"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389401"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="hs-comment">-- so update</span><span>
</span><span id="line-1466"></span><span>                                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389395"><span class="hs-identifier hs-var">recreate</span></a></span><span>
</span><span id="line-1467"></span><span>                        </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389395"><span class="hs-identifier hs-var">recreate</span></a></span><span>
</span><span id="line-1468"></span><span>            </span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="#local-6989586621679389395"><span class="hs-identifier hs-var">recreate</span></a></span><span>
</span><span id="line-1469"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">XP ()
</span><a href="XMonad.Prompt.html#destroyComplWin"><span class="hs-identifier hs-var">destroyComplWin</span></a></span><span>
</span><span id="line-1470"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1471"></span><span>  </span><span class="annot"><a href="#local-6989586621679389393"><span class="hs-identifier hs-type">createComplWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-1472"></span><span>  </span><span id="local-6989586621679389393"><span class="annot"><span class="annottext">createComplWin :: ComplWindowDim -&gt; StateT XPState IO Window
</span><a href="#local-6989586621679389393"><span class="hs-identifier hs-var hs-var">createComplWin</span></a></span></span><span> </span><span id="local-6989586621679389389"><span class="annot"><span class="annottext">wi :: ComplWindowDim
</span><a href="#local-6989586621679389389"><span class="hs-identifier hs-var">wi</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389388"><span class="annot"><span class="annottext">Position
cwX :: Position
cwX :: ComplWindowDim -&gt; Position
</span><a href="#local-6989586621679389388"><span class="hs-identifier hs-var hs-var">cwX</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389387"><span class="annot"><span class="annottext">Position
cwY :: Position
cwY :: ComplWindowDim -&gt; Position
</span><a href="#local-6989586621679389387"><span class="hs-identifier hs-var hs-var">cwY</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389386"><span class="annot"><span class="annottext">Dimension
cwWidth :: Dimension
cwWidth :: ComplWindowDim -&gt; Dimension
</span><a href="#local-6989586621679389386"><span class="hs-identifier hs-var hs-var">cwWidth</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389385"><span class="annot"><span class="annottext">Dimension
cwRowHeight :: Dimension
cwRowHeight :: ComplWindowDim -&gt; Dimension
</span><a href="#local-6989586621679389385"><span class="hs-identifier hs-var hs-var">cwRowHeight</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1473"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389384"><span class="annot"><span class="annottext">Display
dpy :: Display
dpy :: XPState -&gt; Display
</span><a href="#local-6989586621679389384"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389383"><span class="annot"><span class="annottext">Window
rootw :: Window
rootw :: XPState -&gt; Window
</span><a href="#local-6989586621679389383"><span class="hs-identifier hs-var hs-var">rootw</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1474"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389382"><span class="annot"><span class="annottext">scr :: Screen
</span><a href="#local-6989586621679389382"><span class="hs-identifier hs-var hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display -&gt; Screen
</span><span class="hs-identifier hs-var">defaultScreenOfDisplay</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389384"><span class="hs-identifier hs-var">dpy</span></a></span><span>
</span><span id="line-1475"></span><span>    </span><span id="local-6989586621679389381"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389381"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Window -&gt; StateT XPState IO Window
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO Window -&gt; StateT XPState IO Window)
-&gt; IO Window -&gt; StateT XPState IO Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Screen
-&gt; Window
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO Window
</span><a href="XMonad.Prompt.html#mkUnmanagedWindow"><span class="hs-identifier hs-var">mkUnmanagedWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389384"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679389382"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389383"><span class="hs-identifier hs-var">rootw</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389388"><span class="hs-identifier hs-var">cwX</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389387"><span class="hs-identifier hs-var">cwY</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389386"><span class="hs-identifier hs-var">cwWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389385"><span class="hs-identifier hs-var">cwRowHeight</span></a></span><span>
</span><span id="line-1476"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">mapWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389384"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389381"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1477"></span><span>    </span><span class="annot"><span class="annottext">Maybe Window -&gt; Maybe ComplWindowDim -&gt; XP ()
</span><a href="XMonad.Prompt.html#updateComplWin"><span class="hs-identifier hs-var">updateComplWin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; Maybe Window
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389381"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ComplWindowDim -&gt; Maybe ComplWindowDim
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389389"><span class="hs-identifier hs-var">wi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1478"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; StateT XPState IO Window
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389381"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1479"></span><span>
</span><span id="line-1480"></span><span class="hs-comment">-- | Print the main part of the prompt: the prompter, as well as the</span><span>
</span><span id="line-1481"></span><span class="hs-comment">-- command line (including the current input) and the cursor.</span><span>
</span><span id="line-1482"></span><span class="annot"><a href="XMonad.Prompt.html#printPrompt"><span class="hs-identifier hs-type">printPrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Drawable</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1483"></span><span id="printPrompt"><span class="annot"><span class="annottext">printPrompt :: Window -&gt; XP ()
</span><a href="XMonad.Prompt.html#printPrompt"><span class="hs-identifier hs-var hs-var">printPrompt</span></a></span></span><span> </span><span id="local-6989586621679389379"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389379"><span class="hs-identifier hs-var">drw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1484"></span><span>  </span><span id="local-6989586621679389378"><span class="annot"><span class="annottext">st :: XPState
</span><a href="#local-6989586621679389378"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389377"><span class="annot"><span class="annottext">String -&gt; String
prompter :: String -&gt; String
prompter :: XPState -&gt; String -&gt; String
</span><a href="#local-6989586621679389377"><span class="hs-identifier hs-var hs-var">prompter</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389376"><span class="annot"><span class="annottext">XPColor
color :: XPColor
color :: XPState -&gt; XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389375"><span class="annot"><span class="annottext">GC
gcon :: GC
gcon :: XPState -&gt; GC
</span><a href="#local-6989586621679389375"><span class="hs-identifier hs-var hs-var">gcon</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389374"><span class="annot"><span class="annottext">XPConfig
config :: XPConfig
config :: XPState -&gt; XPConfig
</span><a href="#local-6989586621679389374"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389373"><span class="annot"><span class="annottext">Display
dpy :: Display
dpy :: XPState -&gt; Display
</span><a href="#local-6989586621679389373"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389372"><span class="annot"><span class="annottext">XMonadFont
fontS :: XMonadFont
fontS :: XPState -&gt; XMonadFont
</span><a href="#local-6989586621679389372"><span class="hs-identifier hs-var hs-var">fontS</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389371"><span class="annot"><span class="annottext">Int
offset :: Int
offset :: XPState -&gt; Int
</span><a href="#local-6989586621679389371"><span class="hs-identifier hs-var hs-var">offset</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1485"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- (prompt-specific text before the command, the entered command)</span><span>
</span><span id="line-1486"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679389370"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389370"><span class="hs-identifier hs-var">prt</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389369"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389369"><span class="hs-identifier hs-var">com</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679389377"><span class="hs-identifier hs-var">prompter</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (XPState -&gt; String) -&gt; XPState -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(XPType -&gt; String) -&gt; (XPState -&gt; XPType) -&gt; XPState -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var">currentXPMode</span></a></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; String)
-&gt; (XPState -&gt; String) -&gt; XPState -&gt; (String, String)
forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389378"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1487"></span><span>      </span><span id="local-6989586621679389368"><span class="annot"><span class="annottext">str :: String
</span><a href="#local-6989586621679389368"><span class="hs-identifier hs-var hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389370"><span class="hs-identifier hs-var">prt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389369"><span class="hs-identifier hs-var">com</span></a></span><span>
</span><span id="line-1488"></span><span>      </span><span class="hs-comment">-- break the string in 3 parts: till the cursor, the cursor and the rest</span><span>
</span><span id="line-1489"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679389367"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389367"><span class="hs-identifier hs-var">preCursor</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389366"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389366"><span class="hs-identifier hs-var">cursor</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389365"><span class="hs-identifier hs-var">postCursor</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389371"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389369"><span class="hs-identifier hs-var">com</span></a></span><span>
</span><span id="line-1490"></span><span>                 </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389368"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- add a space: it will be our cursor ;-)</span><span>
</span><span id="line-1491"></span><span>                 </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389364"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389364"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389363"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389363"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; (String, String)
forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389371"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389369"><span class="hs-identifier hs-var">com</span></a></span><span>
</span><span id="line-1492"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389370"><span class="hs-identifier hs-var">prt</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389364"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389363"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389363"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1493"></span><span>
</span><span id="line-1494"></span><span>  </span><span class="hs-comment">-- vertical and horizontal text alignment</span><span>
</span><span id="line-1495"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679389362"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389362"><span class="hs-identifier hs-var">asc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389361"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389361"><span class="hs-identifier hs-var">desc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Position, Position) -&gt; StateT XPState IO (Position, Position)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Position, Position) -&gt; StateT XPState IO (Position, Position))
-&gt; IO (Position, Position)
-&gt; StateT XPState IO (Position, Position)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XMonadFont -&gt; String -&gt; IO (Position, Position)
forall (m :: * -&gt; *).
MonadIO m =&gt;
XMonadFont -&gt; String -&gt; m (Position, Position)
</span><a href="XMonad.Util.Font.html#textExtentsXMF"><span class="hs-identifier hs-var">textExtentsXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389372"><span class="hs-identifier hs-var">fontS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389368"><span class="hs-identifier hs-var">str</span></a></span><span>  </span><span class="hs-comment">-- font ascent and descent</span><span>
</span><span id="line-1496"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389359"><span class="annot"><span class="annottext">y :: Position
</span><a href="#local-6989586621679389359"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Dimension
</span><a href="XMonad.Prompt.html#height"><span class="hs-identifier hs-var hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389374"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Dimension
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389362"><span class="hs-identifier hs-var">asc</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389361"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389362"><span class="hs-identifier hs-var">asc</span></a></span><span>
</span><span id="line-1497"></span><span>      </span><span id="local-6989586621679389357"><span class="annot"><span class="annottext">x :: Position
</span><a href="#local-6989586621679389357"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389362"><span class="hs-identifier hs-var">asc</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389361"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span>
</span><span id="line-1498"></span><span>
</span><span id="line-1499"></span><span>  </span><span id="local-6989586621679389356"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389356"><span class="hs-identifier hs-var">pcFont</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; XP Int
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; XP Int) -&gt; IO Int -&gt; XP Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; XMonadFont -&gt; String -&gt; IO Int
forall (m :: * -&gt; *).
MonadIO m =&gt;
Display -&gt; XMonadFont -&gt; String -&gt; m Int
</span><a href="XMonad.Util.Font.html#textWidthXMF"><span class="hs-identifier hs-var">textWidthXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389373"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389372"><span class="hs-identifier hs-var">fontS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389367"><span class="hs-identifier hs-var">preCursor</span></a></span><span>
</span><span id="line-1500"></span><span>  </span><span id="local-6989586621679389354"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389354"><span class="hs-identifier hs-var">cFont</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Int -&gt; XP Int
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO Int -&gt; XP Int) -&gt; IO Int -&gt; XP Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; XMonadFont -&gt; String -&gt; IO Int
forall (m :: * -&gt; *).
MonadIO m =&gt;
Display -&gt; XMonadFont -&gt; String -&gt; m Int
</span><a href="XMonad.Util.Font.html#textWidthXMF"><span class="hs-identifier hs-var">textWidthXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389373"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389372"><span class="hs-identifier hs-var">fontS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389366"><span class="hs-identifier hs-var">cursor</span></a></span><span>
</span><span id="line-1501"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389353"><span class="annot"><span class="annottext">draw :: String -&gt; String -&gt; Position -&gt; Position -&gt; String -&gt; XP ()
</span><a href="#local-6989586621679389353"><span class="hs-identifier hs-var hs-var">draw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; XMonadFont
-&gt; GC
-&gt; String
-&gt; String
-&gt; Position
-&gt; Position
-&gt; String
-&gt; XP ()
forall (m :: * -&gt; *).
(Functor m, MonadIO m) =&gt;
Display
-&gt; Window
-&gt; XMonadFont
-&gt; GC
-&gt; String
-&gt; String
-&gt; Position
-&gt; Position
-&gt; String
-&gt; m ()
</span><a href="XMonad.Util.Font.html#printStringXMF"><span class="hs-identifier hs-var">printStringXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389373"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389379"><span class="hs-identifier hs-var">drw</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389372"><span class="hs-identifier hs-var">fontS</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389375"><span class="hs-identifier hs-var">gcon</span></a></span><span>
</span><span id="line-1502"></span><span>  </span><span class="hs-comment">-- print the first part</span><span>
</span><span id="line-1503"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Position -&gt; Position -&gt; String -&gt; XP ()
</span><a href="#local-6989586621679389353"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var hs-var">fgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389359"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389367"><span class="hs-identifier hs-var">preCursor</span></a></span><span>
</span><span id="line-1504"></span><span>  </span><span class="hs-comment">-- reverse the colors and print the &quot;cursor&quot; ;-)</span><span>
</span><span id="line-1505"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Position -&gt; Position -&gt; String -&gt; XP ()
</span><a href="#local-6989586621679389353"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var hs-var">fgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389356"><span class="hs-identifier hs-var">pcFont</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389359"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389366"><span class="hs-identifier hs-var">cursor</span></a></span><span>
</span><span id="line-1506"></span><span>  </span><span class="hs-comment">-- flip back to the original colors and print the rest of the string</span><span>
</span><span id="line-1507"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Position -&gt; Position -&gt; String -&gt; XP ()
</span><a href="#local-6989586621679389353"><span class="hs-identifier hs-var">draw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var hs-var">fgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389376"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389357"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389356"><span class="hs-identifier hs-var">pcFont</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389354"><span class="hs-identifier hs-var">cFont</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389359"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389365"><span class="hs-identifier hs-var">postCursor</span></a></span><span>
</span><span id="line-1508"></span><span>
</span><span id="line-1509"></span><span class="hs-comment">-- | Get all available completions for the current input.</span><span>
</span><span id="line-1510"></span><span class="annot"><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-type">getCompletions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-1511"></span><span id="getCompletions"><span class="annot"><span class="annottext">getCompletions :: StateT XPState IO [String]
</span><a href="XMonad.Prompt.html#getCompletions"><span class="hs-identifier hs-var hs-var">getCompletions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1512"></span><span>  </span><span id="local-6989586621679389351"><span class="annot"><span class="annottext">st :: XPState
</span><a href="#local-6989586621679389351"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389350"><span class="annot"><span class="annottext">XPConfig
config :: XPConfig
config :: XPState -&gt; XPConfig
</span><a href="#local-6989586621679389350"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1513"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389349"><span class="annot"><span class="annottext">cmd :: String
</span><a href="#local-6989586621679389349"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-var">commandToComplete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var">currentXPMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389351"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389351"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1514"></span><span>      </span><span id="local-6989586621679389348"><span class="annot"><span class="annottext">compl :: ComplFunction
</span><a href="#local-6989586621679389348"><span class="hs-identifier hs-var hs-var">compl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; ComplFunction
</span><a href="#local-6989586621679389347"><span class="hs-identifier hs-var">getCompletionFunction</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389351"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-1515"></span><span>      </span><span id="local-6989586621679389346"><span class="annot"><span class="annottext">srt :: String -&gt; [String] -&gt; [String]
</span><a href="#local-6989586621679389346"><span class="hs-identifier hs-var hs-var">srt</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#sorter"><span class="hs-identifier hs-var hs-var">sorter</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389350"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-1516"></span><span>  </span><span class="annot"><span class="annottext">IO [String] -&gt; StateT XPState IO [String]
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO [String] -&gt; StateT XPState IO [String])
-&gt; IO [String] -&gt; StateT XPState IO [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
</span><a href="#local-6989586621679389346"><span class="hs-identifier hs-var">srt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389349"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; IO [String] -&gt; IO [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389348"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389349"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO [String] -&gt; (SomeException -&gt; IO [String]) -&gt; IO [String]
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1517"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1518"></span><span>  </span><span class="hs-comment">-- | Get the current completion function depending on the active mode.</span><span>
</span><span id="line-1519"></span><span>  </span><span class="annot"><a href="#local-6989586621679389347"><span class="hs-identifier hs-type">getCompletionFunction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPState"><span class="hs-identifier hs-type">XPState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span>
</span><span id="line-1520"></span><span>  </span><span id="local-6989586621679389347"><span class="annot"><span class="annottext">getCompletionFunction :: XPState -&gt; ComplFunction
</span><a href="#local-6989586621679389347"><span class="hs-identifier hs-var hs-var">getCompletionFunction</span></a></span></span><span> </span><span id="local-6989586621679389343"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389343"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPState -&gt; XPOperationMode
</span><a href="XMonad.Prompt.html#operationMode"><span class="hs-identifier hs-var hs-var">operationMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389343"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1521"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#XPSingleMode"><span class="hs-identifier hs-type">XPSingleMode</span></a></span><span> </span><span id="local-6989586621679389342"><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389342"><span class="hs-identifier hs-var">compl</span></a></span></span><span> </span><span class="annot"><span class="annottext">XPType
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ComplFunction
</span><a href="#local-6989586621679389342"><span class="hs-identifier hs-var">compl</span></a></span><span>
</span><span id="line-1522"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.html#XPMultipleModes"><span class="hs-identifier hs-type">XPMultipleModes</span></a></span><span> </span><span id="local-6989586621679389341"><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389341"><span class="hs-identifier hs-var">modes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPType -&gt; ComplFunction
forall t. XPrompt t =&gt; t -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#completionFunction"><span class="hs-identifier hs-var">completionFunction</span></a></span><span> </span><span class="annot"><span class="annottext">(XPType -&gt; ComplFunction) -&gt; XPType -&gt; ComplFunction
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType -&gt; XPType
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack XPType
</span><a href="#local-6989586621679389341"><span class="hs-identifier hs-var">modes</span></a></span><span>
</span><span id="line-1523"></span><span>
</span><span id="line-1524"></span><span class="hs-comment">-- | Destroy the currently drawn completion window, if there is one.</span><span>
</span><span id="line-1525"></span><span class="annot"><a href="XMonad.Prompt.html#destroyComplWin"><span class="hs-identifier hs-type">destroyComplWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1526"></span><span id="destroyComplWin"><span class="annot"><span class="annottext">destroyComplWin :: XP ()
</span><a href="XMonad.Prompt.html#destroyComplWin"><span class="hs-identifier hs-var hs-var">destroyComplWin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1527"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389340"><span class="annot"><span class="annottext">Display
dpy :: Display
dpy :: XPState -&gt; Display
</span><a href="#local-6989586621679389340"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389339"><span class="annot"><span class="annottext">IORef (Maybe Window)
complWin :: IORef (Maybe Window)
complWin :: XPState -&gt; IORef (Maybe Window)
</span><a href="#local-6989586621679389339"><span class="hs-identifier hs-var hs-var">complWin</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1528"></span><span>  </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IORef (Maybe Window) -&gt; IO (Maybe Window)
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef (Maybe Window)
</span><a href="#local-6989586621679389339"><span class="hs-identifier hs-var">complWin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO (Maybe Window)
-&gt; (Maybe Window -&gt; XP ()) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-1529"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389338"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389338"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">destroyWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389340"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389338"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-1530"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Window -&gt; Maybe ComplWindowDim -&gt; XP ()
</span><a href="XMonad.Prompt.html#updateComplWin"><span class="hs-identifier hs-var">updateComplWin</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe ComplWindowDim
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1531"></span><span>    </span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; XP ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1532"></span><span>
</span><span id="line-1533"></span><span class="hs-comment">-- | Given the completions that we would like to show, calculate the</span><span>
</span><span id="line-1534"></span><span class="hs-comment">-- required dimensions for the completion windows.</span><span>
</span><span id="line-1535"></span><span class="annot"><a href="XMonad.Prompt.html#getComplWinDim"><span class="hs-identifier hs-type">getComplWinDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span>
</span><span id="line-1536"></span><span id="getComplWinDim"><span class="annot"><span class="annottext">getComplWinDim :: [String] -&gt; XP ComplWindowDim
</span><a href="XMonad.Prompt.html#getComplWinDim"><span class="hs-identifier hs-var hs-var">getComplWinDim</span></a></span></span><span> </span><span id="local-6989586621679389337"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389337"><span class="hs-identifier hs-var">compl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1537"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">config :: XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389336"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389336"><span class="hs-identifier hs-var">cfg</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">screen :: XPState -&gt; Rectangle
</span><a href="XMonad.Prompt.html#screen"><span class="hs-identifier hs-var">screen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389335"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">fontS :: XPState -&gt; XMonadFont
</span><a href="XMonad.Prompt.html#fontS"><span class="hs-identifier hs-var">fontS</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679389334"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389334"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389333"><span class="annot"><span class="annottext">Display
dpy :: Display
dpy :: XPState -&gt; Display
</span><a href="#local-6989586621679389333"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389332"><span class="annot"><span class="annottext">Dimension
winWidth :: Dimension
winWidth :: XPState -&gt; Dimension
</span><a href="#local-6989586621679389332"><span class="hs-identifier hs-var hs-var">winWidth</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1538"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Height of a single completion row</span><span>
</span><span id="line-1539"></span><span>      </span><span id="local-6989586621679389331"><span class="annot"><span class="annottext">ht :: Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var hs-var">ht</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Dimension
</span><a href="XMonad.Prompt.html#height"><span class="hs-identifier hs-var hs-var">height</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389336"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-1540"></span><span>      </span><span id="local-6989586621679389330"><span class="annot"><span class="annottext">bw :: Dimension
</span><a href="#local-6989586621679389330"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Dimension
</span><a href="XMonad.Prompt.html#promptBorderWidth"><span class="hs-identifier hs-var hs-var">promptBorderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389336"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-1541"></span><span>
</span><span id="line-1542"></span><span>  </span><span id="local-6989586621679389329"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679389329"><span class="hs-identifier hs-var">tws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(String -&gt; XP Int) -&gt; [String] -&gt; StateT XPState IO [Int]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; XMonadFont -&gt; String -&gt; XP Int
forall (m :: * -&gt; *).
MonadIO m =&gt;
Display -&gt; XMonadFont -&gt; String -&gt; m Int
</span><a href="XMonad.Util.Font.html#textWidthXMF"><span class="hs-identifier hs-var">textWidthXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389333"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389334"><span class="hs-identifier hs-var">fs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389337"><span class="hs-identifier hs-var">compl</span></a></span><span>
</span><span id="line-1543"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-comment">-- Length of widest completion we will print</span><span>
</span><span id="line-1544"></span><span>      </span><span id="local-6989586621679389327"><span class="annot"><span class="annottext">maxComplLen :: Int
</span><a href="#local-6989586621679389327"><span class="hs-identifier hs-var hs-var">maxComplLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall (t :: * -&gt; *) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">maximum</span></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679389329"><span class="hs-identifier hs-var">tws</span></a></span><span>
</span><span id="line-1545"></span><span>      </span><span class="hs-comment">-- Height of the screen rectangle _without_ the prompt window</span><span>
</span><span id="line-1546"></span><span>      </span><span id="local-6989586621679389325"><span class="annot"><span class="annottext">remHeight :: Dimension
</span><a href="#local-6989586621679389325"><span class="hs-identifier hs-var hs-var">remHeight</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span>
</span><span id="line-1547"></span><span>
</span><span id="line-1548"></span><span>      </span><span id="local-6989586621679389324"><span class="annot"><span class="annottext">maxColumns :: Dimension -&gt; Dimension
</span><a href="#local-6989586621679389324"><span class="hs-identifier hs-var hs-var">maxColumns</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension)
-&gt; (Dimension -&gt; Dimension -&gt; Dimension)
-&gt; Maybe Dimension
-&gt; Dimension
-&gt; Dimension
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Maybe Dimension
</span><a href="XMonad.Prompt.html#maxComplColumns"><span class="hs-identifier hs-var hs-var">maxComplColumns</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389336"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1549"></span><span>      </span><span id="local-6989586621679389323"><span class="annot"><span class="annottext">columns :: Dimension
</span><a href="#local-6989586621679389323"><span class="hs-identifier hs-var hs-var">columns</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension)
-&gt; (Dimension -&gt; Dimension) -&gt; Dimension -&gt; Dimension
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension
</span><a href="#local-6989586621679389324"><span class="hs-identifier hs-var">maxColumns</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension) -&gt; Dimension -&gt; Dimension
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389332"><span class="hs-identifier hs-var">winWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Dimension
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389327"><span class="hs-identifier hs-var">maxComplLen</span></a></span><span>
</span><span id="line-1550"></span><span>      </span><span id="local-6989586621679389322"><span class="annot"><span class="annottext">columnWidth :: Dimension
</span><a href="#local-6989586621679389322"><span class="hs-identifier hs-var hs-var">columnWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389332"><span class="hs-identifier hs-var">winWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389323"><span class="hs-identifier hs-var">columns</span></a></span><span>
</span><span id="line-1551"></span><span>
</span><span id="line-1552"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679389321"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389321"><span class="hs-identifier hs-var">fullRows</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389320"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389320"><span class="hs-identifier hs-var">lastRow</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389337"><span class="hs-identifier hs-var">compl</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`divMod`</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389323"><span class="hs-identifier hs-var">columns</span></a></span><span>
</span><span id="line-1553"></span><span>      </span><span id="local-6989586621679389318"><span class="annot"><span class="annottext">allRows :: Int
</span><a href="#local-6989586621679389318"><span class="hs-identifier hs-var hs-var">allRows</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389321"><span class="hs-identifier hs-var">fullRows</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389320"><span class="hs-identifier hs-var">lastRow</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-1554"></span><span>      </span><span class="hs-comment">-- Maximum number of rows allowed by the config and the screen dimensions</span><span>
</span><span id="line-1555"></span><span>      </span><span id="local-6989586621679389317"><span class="annot"><span class="annottext">maxRows :: Dimension
</span><a href="#local-6989586621679389317"><span class="hs-identifier hs-var hs-var">maxRows</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Dimension)
-&gt; (Dimension -&gt; Dimension -&gt; Dimension)
-&gt; Maybe Dimension
-&gt; Dimension
-&gt; Dimension
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; Maybe Dimension
</span><a href="XMonad.Prompt.html#maxComplRows"><span class="hs-identifier hs-var hs-var">maxComplRows</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389336"><span class="hs-identifier hs-var">cfg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389325"><span class="hs-identifier hs-var">remHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1556"></span><span>      </span><span class="hs-comment">-- Actual number of rows to be drawn</span><span>
</span><span id="line-1557"></span><span>      </span><span id="local-6989586621679389316"><span class="annot"><span class="annottext">rows :: Dimension
</span><a href="#local-6989586621679389316"><span class="hs-identifier hs-var hs-var">rows</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389317"><span class="hs-identifier hs-var">maxRows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Dimension
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389318"><span class="hs-identifier hs-var">allRows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1558"></span><span>      </span><span id="local-6989586621679389315"><span class="annot"><span class="annottext">rowHeight :: Dimension
</span><a href="#local-6989586621679389315"><span class="hs-identifier hs-var hs-var">rowHeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389316"><span class="hs-identifier hs-var">rows</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span>
</span><span id="line-1559"></span><span>
</span><span id="line-1560"></span><span>      </span><span class="hs-comment">-- Starting x and y position of the completion windows.</span><span>
</span><span id="line-1561"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679389314"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389314"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389313"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389313"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Position)
-&gt; (Dimension -&gt; Position)
-&gt; (Position, Dimension)
-&gt; (Position, Position)
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Position -&gt; Position)
-&gt; (Dimension -&gt; Position) -&gt; Dimension -&gt; Position
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Position, Dimension) -&gt; (Position, Position))
-&gt; (Position, Dimension) -&gt; (Position, Position)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; XPPosition
</span><a href="XMonad.Prompt.html#position"><span class="hs-identifier hs-var hs-var">position</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389336"><span class="hs-identifier hs-var">cfg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1562"></span><span>        </span><span class="annot"><span class="annottext">XPPosition
</span><a href="XMonad.Prompt.html#Top"><span class="hs-identifier hs-var">Top</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389330"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1563"></span><span>        </span><span class="annot"><span class="annottext">XPPosition
</span><a href="XMonad.Prompt.html#Bottom"><span class="hs-identifier hs-var">Bottom</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389325"><span class="hs-identifier hs-var">remHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389315"><span class="hs-identifier hs-var">rowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389330"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1564"></span><span>        </span><span class="annot"><a href="XMonad.Prompt.html#CenteredAt"><span class="hs-identifier hs-type">CenteredAt</span></a></span><span> </span><span id="local-6989586621679389312"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389312"><span class="hs-identifier hs-var">py</span></a></span></span><span> </span><span id="local-6989586621679389311"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389311"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-1565"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389312"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1566"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Position
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Position) -&gt; Rational -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389311"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-1567"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Dimension
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389312"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389330"><span class="hs-identifier hs-var">bw</span></a></span><span>
</span><span id="line-1568"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-1569"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1570"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Position
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; Position) -&gt; Rational -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389311"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-1571"></span><span>              </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Dimension
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679389312"><span class="hs-identifier hs-var">py</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679389335"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Rational
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389315"><span class="hs-identifier hs-var">rowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389330"><span class="hs-identifier hs-var">bw</span></a></span><span>
</span><span id="line-1572"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-1573"></span><span>
</span><span id="line-1574"></span><span>  </span><span class="hs-comment">-- Get font ascent and descent.  Coherence condition: we will print</span><span>
</span><span id="line-1575"></span><span>  </span><span class="hs-comment">-- everything using the same font.</span><span>
</span><span id="line-1576"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679389310"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389310"><span class="hs-identifier hs-var">asc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389309"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389309"><span class="hs-identifier hs-var">desc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Position, Position) -&gt; StateT XPState IO (Position, Position)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Position, Position) -&gt; StateT XPState IO (Position, Position))
-&gt; IO (Position, Position)
-&gt; StateT XPState IO (Position, Position)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XMonadFont -&gt; String -&gt; IO (Position, Position)
forall (m :: * -&gt; *).
MonadIO m =&gt;
XMonadFont -&gt; String -&gt; m (Position, Position)
</span><a href="XMonad.Util.Font.html#textExtentsXMF"><span class="hs-identifier hs-var">textExtentsXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679389334"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO (Position, Position))
-&gt; String -&gt; IO (Position, Position)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389337"><span class="hs-identifier hs-var">compl</span></a></span><span>
</span><span id="line-1577"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389308"><span class="annot"><span class="annottext">yp :: Position
</span><a href="#local-6989586621679389308"><span class="hs-identifier hs-var hs-var">yp</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">(Dimension -&gt; Position) -&gt; Dimension -&gt; Position
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Dimension
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389310"><span class="hs-identifier hs-var">asc</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389309"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">2</span></span><span> </span><span class="hs-comment">-- y position of the first row</span><span>
</span><span id="line-1578"></span><span>      </span><span id="local-6989586621679389307"><span class="annot"><span class="annottext">yRows :: [Position]
</span><a href="#local-6989586621679389307"><span class="hs-identifier hs-var hs-var">yRows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Position] -&gt; [Position]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389316"><span class="hs-identifier hs-var">rows</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389308"><span class="hs-identifier hs-var">yp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389308"><span class="hs-identifier hs-var">yp</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389331"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- y positions of all rows</span><span>
</span><span id="line-1579"></span><span>
</span><span id="line-1580"></span><span>      </span><span id="local-6989586621679389306"><span class="annot"><span class="annottext">xp :: Position
</span><a href="#local-6989586621679389306"><span class="hs-identifier hs-var hs-var">xp</span></a></span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389310"><span class="hs-identifier hs-var">asc</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389309"><span class="hs-identifier hs-var">desc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span>                           </span><span class="hs-comment">-- x position of the first column</span><span>
</span><span id="line-1581"></span><span>      </span><span id="local-6989586621679389305"><span class="annot"><span class="annottext">xCols :: [Position]
</span><a href="#local-6989586621679389305"><span class="hs-identifier hs-var hs-var">xCols</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Position] -&gt; [Position]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389323"><span class="hs-identifier hs-var">columns</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389306"><span class="hs-identifier hs-var">xp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389306"><span class="hs-identifier hs-var">xp</span></a></span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Position
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389322"><span class="hs-identifier hs-var">columnWidth</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- x positions of all columns</span><span>
</span><span id="line-1582"></span><span>
</span><span id="line-1583"></span><span>  </span><span class="annot"><span class="annottext">ComplWindowDim -&gt; XP ComplWindowDim
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ComplWindowDim -&gt; XP ComplWindowDim)
-&gt; ComplWindowDim -&gt; XP ComplWindowDim
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; [Position]
-&gt; [Position]
-&gt; ComplWindowDim
</span><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-var">ComplWindowDim</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389314"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389313"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389332"><span class="hs-identifier hs-var">winWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389315"><span class="hs-identifier hs-var">rowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389305"><span class="hs-identifier hs-var">xCols</span></a></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389307"><span class="hs-identifier hs-var">yRows</span></a></span><span>
</span><span id="line-1584"></span><span>
</span><span id="line-1585"></span><span class="hs-comment">-- | Draw the completion window.</span><span>
</span><span id="line-1586"></span><span class="annot"><a href="XMonad.Prompt.html#drawComplWin"><span class="hs-identifier hs-type">drawComplWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1587"></span><span id="drawComplWin"><span class="annot"><span class="annottext">drawComplWin :: Window -&gt; [String] -&gt; XP ()
</span><a href="XMonad.Prompt.html#drawComplWin"><span class="hs-identifier hs-var hs-var">drawComplWin</span></a></span></span><span> </span><span id="local-6989586621679389304"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389304"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679389303"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389303"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1588"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389302"><span class="annot"><span class="annottext">XPConfig
config :: XPConfig
config :: XPState -&gt; XPConfig
</span><a href="#local-6989586621679389302"><span class="hs-identifier hs-var hs-var">config</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389301"><span class="annot"><span class="annottext">XPColor
color :: XPColor
color :: XPState -&gt; XPColor
</span><a href="#local-6989586621679389301"><span class="hs-identifier hs-var hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389300"><span class="annot"><span class="annottext">Display
dpy :: Display
dpy :: XPState -&gt; Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var hs-var">dpy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389299"><span class="annot"><span class="annottext">GC
gcon :: GC
gcon :: XPState -&gt; GC
</span><a href="#local-6989586621679389299"><span class="hs-identifier hs-var hs-var">gcon</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1589"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389298"><span class="annot"><span class="annottext">scr :: Screen
</span><a href="#local-6989586621679389298"><span class="hs-identifier hs-var hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display -&gt; Screen
</span><span class="hs-identifier hs-var">defaultScreenOfDisplay</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span>
</span><span id="line-1590"></span><span>      </span><span id="local-6989586621679389297"><span class="annot"><span class="annottext">bw :: Dimension
</span><a href="#local-6989586621679389297"><span class="hs-identifier hs-var hs-var">bw</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; Dimension
</span><a href="XMonad.Prompt.html#promptBorderWidth"><span class="hs-identifier hs-var hs-var">promptBorderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389302"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-1591"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389296"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389296"><span class="hs-identifier hs-var">bgcolor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window))
-&gt; IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; String -&gt; IO (Maybe Window)
</span><span class="hs-identifier hs-var">initColor</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389301"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1592"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389295"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389295"><span class="hs-identifier hs-var">borderC</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window))
-&gt; IO (Maybe Window) -&gt; StateT XPState IO (Maybe Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; String -&gt; IO (Maybe Window)
</span><span class="hs-identifier hs-var">initColor</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#border"><span class="hs-identifier hs-var hs-var">border</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389301"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1593"></span><span>  </span><span id="local-6989586621679389294"><span class="annot"><span class="annottext">cwd :: ComplWindowDim
</span><a href="#local-6989586621679389294"><span class="hs-identifier hs-var">cwd</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389293"><span class="annot"><span class="annottext">Dimension
cwWidth :: Dimension
cwWidth :: ComplWindowDim -&gt; Dimension
</span><a href="#local-6989586621679389293"><span class="hs-identifier hs-var hs-var">cwWidth</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389292"><span class="annot"><span class="annottext">Dimension
cwRowHeight :: Dimension
cwRowHeight :: ComplWindowDim -&gt; Dimension
</span><a href="#local-6989586621679389292"><span class="hs-identifier hs-var hs-var">cwRowHeight</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; XP ComplWindowDim
</span><a href="XMonad.Prompt.html#getComplWinDim"><span class="hs-identifier hs-var">getComplWinDim</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389303"><span class="hs-identifier hs-var">entries</span></a></span><span>
</span><span id="line-1594"></span><span>
</span><span id="line-1595"></span><span>  </span><span id="local-6989586621679389291"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389291"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Window -&gt; StateT XPState IO Window
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO Window -&gt; StateT XPState IO Window)
-&gt; IO Window -&gt; StateT XPState IO Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window -&gt; Dimension -&gt; Dimension -&gt; GrabStatus -&gt; IO Window
</span><span class="hs-identifier hs-var">createPixmap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389304"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389293"><span class="hs-identifier hs-var">cwWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389292"><span class="hs-identifier hs-var">cwRowHeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; GrabStatus
</span><span class="hs-identifier hs-var">defaultDepthOfScreen</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679389298"><span class="hs-identifier hs-var">scr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1596"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; Window
-&gt; Window
-&gt; Dimension
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><a href="XMonad.Prompt.html#fillDrawable"><span class="hs-identifier hs-var">fillDrawable</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389291"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389299"><span class="hs-identifier hs-var">gcon</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389295"><span class="hs-identifier hs-var">borderC</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389296"><span class="hs-identifier hs-var">bgcolor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Dimension
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389297"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389293"><span class="hs-identifier hs-var">cwWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389292"><span class="hs-identifier hs-var">cwRowHeight</span></a></span><span>
</span><span id="line-1597"></span><span>  </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; String
-&gt; String
-&gt; [String]
-&gt; ComplWindowDim
-&gt; XP ()
</span><a href="XMonad.Prompt.html#printComplEntries"><span class="hs-identifier hs-var">printComplEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389291"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389299"><span class="hs-identifier hs-var">gcon</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgNormal"><span class="hs-identifier hs-var hs-var">fgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389301"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgNormal"><span class="hs-identifier hs-var hs-var">bgNormal</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389301"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389303"><span class="hs-identifier hs-var">entries</span></a></span><span> </span><span class="annot"><span class="annottext">ComplWindowDim
</span><a href="#local-6989586621679389294"><span class="hs-identifier hs-var">cwd</span></a></span><span>
</span><span id="line-1598"></span><span>  </span><span class="hs-comment">--lift $ spawn $ &quot;xmessage &quot; ++ &quot; ac: &quot; ++ show ac  ++ &quot; xx: &quot; ++ show xx ++ &quot; length xx: &quot; ++ show (length xx) ++ &quot; yy: &quot; ++ show (length yy)</span><span>
</span><span id="line-1599"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; Position
-&gt; Position
-&gt; IO ()
</span><span class="hs-identifier hs-var">copyArea</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389291"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389304"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389299"><span class="hs-identifier hs-var">gcon</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389293"><span class="hs-identifier hs-var">cwWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389292"><span class="hs-identifier hs-var">cwRowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1600"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">freePixmap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389300"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389291"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-1601"></span><span>
</span><span id="line-1602"></span><span class="hs-comment">-- | Print all of the completion entries.</span><span>
</span><span id="line-1603"></span><span class="annot"><a href="XMonad.Prompt.html#printComplEntries"><span class="hs-identifier hs-type">printComplEntries</span></a></span><span>
</span><span id="line-1604"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span>
</span><span id="line-1605"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Drawable</span></span><span>
</span><span id="line-1606"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span>
</span><span id="line-1607"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>         </span><span class="hs-comment">-- ^ Default foreground color</span><span>
</span><span id="line-1608"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>         </span><span class="hs-comment">-- ^ Default background color</span><span>
</span><span id="line-1609"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>       </span><span class="hs-comment">-- ^ Entries to be printed...</span><span>
</span><span id="line-1610"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span> </span><span class="hs-comment">-- ^ ...into a window of this size</span><span>
</span><span id="line-1611"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1612"></span><span id="printComplEntries"><span class="annot"><span class="annottext">printComplEntries :: Display
-&gt; Window
-&gt; GC
-&gt; String
-&gt; String
-&gt; [String]
-&gt; ComplWindowDim
-&gt; XP ()
</span><a href="XMonad.Prompt.html#printComplEntries"><span class="hs-identifier hs-var hs-var">printComplEntries</span></a></span></span><span> </span><span id="local-6989586621679389289"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389289"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span id="local-6989586621679389288"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389288"><span class="hs-identifier hs-var">drw</span></a></span></span><span> </span><span id="local-6989586621679389287"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389287"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span id="local-6989586621679389286"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389286"><span class="hs-identifier hs-var">fc</span></a></span></span><span> </span><span id="local-6989586621679389285"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389285"><span class="hs-identifier hs-var">bc</span></a></span></span><span> </span><span id="local-6989586621679389284"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389284"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplWindowDim"><span class="hs-identifier hs-type">ComplWindowDim</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389283"><span class="annot"><span class="annottext">[Position]
cwCols :: [Position]
cwCols :: ComplWindowDim -&gt; [Position]
</span><a href="#local-6989586621679389283"><span class="hs-identifier hs-var hs-var">cwCols</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389282"><span class="annot"><span class="annottext">[Position]
cwRows :: [Position]
cwRows :: ComplWindowDim -&gt; [Position]
</span><a href="#local-6989586621679389282"><span class="hs-identifier hs-var hs-var">cwRows</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1613"></span><span>  </span><span id="local-6989586621679389281"><span class="annot"><span class="annottext">st :: XPState
</span><a href="#local-6989586621679389281"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Prompt.html#XPS"><span class="hs-identifier hs-type">XPS</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389280"><span class="annot"><span class="annottext">XPColor
color :: XPColor
color :: XPState -&gt; XPColor
</span><a href="#local-6989586621679389280"><span class="hs-identifier hs-var hs-var">color</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389279"><span class="annot"><span class="annottext">(Int, Int)
complIndex :: (Int, Int)
complIndex :: XPState -&gt; (Int, Int)
</span><a href="#local-6989586621679389279"><span class="hs-identifier hs-var hs-var">complIndex</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">config :: XPState -&gt; XPConfig
</span><a href="XMonad.Prompt.html#config"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPC"><span class="hs-identifier hs-type">XPC</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679389278"><span class="annot"><span class="annottext">Bool
alwaysHighlight :: Bool
alwaysHighlight :: XPConfig -&gt; Bool
</span><a href="#local-6989586621679389278"><span class="hs-identifier hs-var hs-var">alwaysHighlight</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT XPState IO XPState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-1614"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679389277"><span class="hs-identifier hs-type">printItemAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1615"></span><span>      </span><span id="local-6989586621679389277"><span class="annot"><span class="annottext">printItemAt :: Position -&gt; Position -&gt; String -&gt; XP ()
</span><a href="#local-6989586621679389277"><span class="hs-identifier hs-var hs-var">printItemAt</span></a></span></span><span> </span><span id="local-6989586621679389276"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389276"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679389275"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389275"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679389274"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389274"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1616"></span><span>        </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; XMonadFont
-&gt; GC
-&gt; String
-&gt; String
-&gt; Position
-&gt; Position
-&gt; String
-&gt; XP ()
forall (m :: * -&gt; *).
(Functor m, MonadIO m) =&gt;
Display
-&gt; Window
-&gt; XMonadFont
-&gt; GC
-&gt; String
-&gt; String
-&gt; Position
-&gt; Position
-&gt; String
-&gt; m ()
</span><a href="XMonad.Util.Font.html#printStringXMF"><span class="hs-identifier hs-var">printStringXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389289"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389288"><span class="hs-identifier hs-var">drw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XMonadFont
</span><a href="XMonad.Prompt.html#fontS"><span class="hs-identifier hs-var hs-var">fontS</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389287"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389273"><span class="hs-identifier hs-var">fgCol</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389272"><span class="hs-identifier hs-var">bgCol</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389276"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389275"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389274"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1617"></span><span>       </span><span class="hs-keyword">where</span><span>
</span><span id="line-1618"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679389273"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389273"><span class="hs-identifier hs-var">fgCol</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389272"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389272"><span class="hs-identifier hs-var">bgCol</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-1619"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- default to the first item, the one in (0, 0)</span><span>
</span><span id="line-1620"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679389278"><span class="hs-identifier hs-var">alwaysHighlight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Int)
</span><a href="#local-6989586621679389279"><span class="hs-identifier hs-var">complIndex</span></a></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (Int, Int)
</span><a href="#local-6989586621679389271"><span class="hs-identifier hs-var">findComplIndex</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389274"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-1621"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgHighlight"><span class="hs-identifier hs-var hs-var">fgHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389280"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgHighlight"><span class="hs-identifier hs-var hs-var">bgHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389280"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1622"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- compare item with buffer's value</span><span>
</span><span id="line-1623"></span><span>            </span><span class="annot"><span class="annottext">XPType -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-var">completionToCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var">currentXPMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389274"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">XPType -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-var">commandToComplete</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; XPType
</span><a href="XMonad.Prompt.html#currentXPMode"><span class="hs-identifier hs-var">currentXPMode</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPState -&gt; String
</span><a href="XMonad.Prompt.html#command"><span class="hs-identifier hs-var">command</span></a></span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389281"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1624"></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#fgHighlight"><span class="hs-identifier hs-var hs-var">fgHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389280"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">XPColor -&gt; String
</span><a href="XMonad.Prompt.html#bgHighlight"><span class="hs-identifier hs-var hs-var">bgHighlight</span></a></span><span> </span><span class="annot"><span class="annottext">XPColor
</span><a href="#local-6989586621679389280"><span class="hs-identifier hs-var">color</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1625"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- if nothing matches, use default colors</span><span>
</span><span id="line-1626"></span><span>            </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389286"><span class="hs-identifier hs-var">fc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389285"><span class="hs-identifier hs-var">bc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1627"></span><span>  </span><span class="annot"><span class="annottext">(Position -&gt; [String] -&gt; XP ())
-&gt; [Position] -&gt; [[String]] -&gt; XP ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><span class="hs-identifier hs-var">zipWithM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389269"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389269"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Position -&gt; String -&gt; XP ()) -&gt; [Position] -&gt; [String] -&gt; XP ()
forall (m :: * -&gt; *) a b c.
Applicative m =&gt;
(a -&gt; b -&gt; m c) -&gt; [a] -&gt; [b] -&gt; m ()
</span><span class="hs-identifier hs-var">zipWithM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; String -&gt; XP ()
</span><a href="#local-6989586621679389277"><span class="hs-identifier hs-var">printItemAt</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389269"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389282"><span class="hs-identifier hs-var">cwRows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389283"><span class="hs-identifier hs-var">cwCols</span></a></span><span> </span><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679389268"><span class="hs-identifier hs-var">complMat</span></a></span><span>
</span><span id="line-1628"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1629"></span><span>  </span><span class="hs-comment">-- | Create the completion matrix to be printed.</span><span>
</span><span id="line-1630"></span><span>  </span><span id="local-6989586621679389268"><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679389268"><span class="hs-identifier hs-var">complMat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-1631"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [[String]]
forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="XMonad.Prelude.html#chunksOf"><span class="hs-identifier hs-var">chunksOf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389282"><span class="hs-identifier hs-var">cwRows</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [String] -&gt; [String]
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389283"><span class="hs-identifier hs-var">cwCols</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">[Position] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Position]
</span><a href="#local-6989586621679389282"><span class="hs-identifier hs-var">cwRows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389284"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1632"></span><span>
</span><span id="line-1633"></span><span>  </span><span class="hs-comment">-- | Find the column and row indexes in which a string appears.</span><span>
</span><span id="line-1634"></span><span>  </span><span class="hs-comment">-- If the string is not in the matrix, the indices default to @(0, 0)@.</span><span>
</span><span id="line-1635"></span><span>  </span><span class="annot"><a href="#local-6989586621679389271"><span class="hs-identifier hs-type">findComplIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-1636"></span><span>  </span><span id="local-6989586621679389271"><span class="annot"><span class="annottext">findComplIndex :: String -&gt; (Int, Int)
</span><a href="#local-6989586621679389271"><span class="hs-identifier hs-var hs-var">findComplIndex</span></a></span></span><span> </span><span id="local-6989586621679389267"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389267"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389266"><span class="hs-identifier hs-var">colIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389265"><span class="hs-identifier hs-var">rowIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1637"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-1638"></span><span>    </span><span id="local-6989586621679389266"><span class="annot"><span class="annottext">colIndex :: Int
</span><a href="#local-6989586621679389266"><span class="hs-identifier hs-var hs-var">colIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Bool) -&gt; [[String]] -&gt; Maybe Int
forall a. (a -&gt; Bool) -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">findIndex</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679389263"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389263"><span class="hs-identifier hs-var">cols</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389267"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389263"><span class="hs-identifier hs-var">cols</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679389268"><span class="hs-identifier hs-var">complMat</span></a></span><span>
</span><span id="line-1639"></span><span>    </span><span id="local-6989586621679389265"><span class="annot"><span class="annottext">rowIndex :: Int
</span><a href="#local-6989586621679389265"><span class="hs-identifier hs-var hs-var">rowIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Int -&gt; Int) -&gt; Maybe Int -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-identifier hs-var">elemIndex</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389267"><span class="hs-identifier hs-var">item</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Maybe Int) -&gt; Maybe [String] -&gt; Maybe Int
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679389268"><span class="hs-identifier hs-var">complMat</span></a></span><span> </span><span class="annot"><span class="annottext">[[String]] -&gt; Int -&gt; Maybe [String]
forall a. [a] -&gt; Int -&gt; Maybe a
</span><a href="XMonad.Prelude.html#%21%3F"><span class="hs-operator hs-var">!?</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389266"><span class="hs-identifier hs-var">colIndex</span></a></span><span>
</span><span id="line-1640"></span><span>
</span><span id="line-1641"></span><span class="hs-comment">-- History</span><span>
</span><span id="line-1642"></span><span>
</span><span id="line-1643"></span><span class="hs-keyword">type</span><span> </span><span id="History"><span class="annot"><a href="XMonad.Prompt.html#History"><span class="hs-identifier hs-var">History</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-1644"></span><span>
</span><span id="line-1645"></span><span class="annot"><a href="XMonad.Prompt.html#emptyHistory"><span class="hs-identifier hs-type">emptyHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#History"><span class="hs-identifier hs-type">History</span></a></span><span>
</span><span id="line-1646"></span><span id="emptyHistory"><span class="annot"><span class="annottext">emptyHistory :: History
</span><a href="XMonad.Prompt.html#emptyHistory"><span class="hs-identifier hs-var hs-var">emptyHistory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">History
forall k a. Map k a
</span><span class="hs-identifier hs-var">M.empty</span></span><span>
</span><span id="line-1647"></span><span>
</span><span id="line-1648"></span><span class="annot"><a href="XMonad.Prompt.html#getHistoryFile"><span class="hs-identifier hs-type">getHistoryFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-1649"></span><span id="getHistoryFile"><span class="annot"><span class="annottext">getHistoryFile :: String -&gt; String
</span><a href="XMonad.Prompt.html#getHistoryFile"><span class="hs-identifier hs-var hs-var">getHistoryFile</span></a></span></span><span> </span><span id="local-6989586621679389257"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389257"><span class="hs-identifier hs-var">cachedir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389257"><span class="hs-identifier hs-var">cachedir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/prompt-history&quot;</span></span><span>
</span><span id="line-1650"></span><span>
</span><span id="line-1651"></span><span class="annot"><a href="XMonad.Prompt.html#readHistory"><span class="hs-identifier hs-type">readHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#History"><span class="hs-identifier hs-type">History</span></a></span><span>
</span><span id="line-1652"></span><span id="readHistory"><span class="annot"><span class="annottext">readHistory :: String -&gt; IO History
</span><a href="XMonad.Prompt.html#readHistory"><span class="hs-identifier hs-var hs-var">readHistory</span></a></span></span><span> </span><span id="local-6989586621679389256"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389256"><span class="hs-identifier hs-var">cachedir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO History
</span><a href="#local-6989586621679389255"><span class="hs-identifier hs-var">readHist</span></a></span><span> </span><span class="annot"><span class="annottext">IO History -&gt; (SomeException -&gt; IO History) -&gt; IO History
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span class="annot"><span class="annottext">e
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">History -&gt; IO History
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">History
</span><a href="XMonad.Prompt.html#emptyHistory"><span class="hs-identifier hs-var">emptyHistory</span></a></span><span>
</span><span id="line-1653"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1654"></span><span>    </span><span id="local-6989586621679389255"><span class="annot"><span class="annottext">readHist :: IO History
</span><a href="#local-6989586621679389255"><span class="hs-identifier hs-var hs-var">readHist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1655"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389254"><span class="annot"><span class="annottext">path :: String
</span><a href="#local-6989586621679389254"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#getHistoryFile"><span class="hs-identifier hs-var">getHistoryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389256"><span class="hs-identifier hs-var">cachedir</span></a></span><span>
</span><span id="line-1656"></span><span>        </span><span id="local-6989586621679389253"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389253"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO String) -&gt; IO String
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389254"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">ReadMode</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetLine</span></span><span>
</span><span id="line-1657"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO History
forall a. Read a =&gt; String -&gt; IO a
</span><span class="hs-identifier hs-var">readIO</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389253"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-1658"></span><span>
</span><span id="line-1659"></span><span class="annot"><a href="XMonad.Prompt.html#writeHistory"><span class="hs-identifier hs-type">writeHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#History"><span class="hs-identifier hs-type">History</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1660"></span><span id="writeHistory"><span class="annot"><span class="annottext">writeHistory :: String -&gt; History -&gt; IO ()
</span><a href="XMonad.Prompt.html#writeHistory"><span class="hs-identifier hs-var hs-var">writeHistory</span></a></span></span><span> </span><span id="local-6989586621679389248"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389248"><span class="hs-identifier hs-var">cachedir</span></a></span></span><span> </span><span id="local-6989586621679389247"><span class="annot"><span class="annottext">History
</span><a href="#local-6989586621679389247"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1661"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389246"><span class="annot"><span class="annottext">path :: String
</span><a href="#local-6989586621679389246"><span class="hs-identifier hs-var hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#getHistoryFile"><span class="hs-identifier hs-var">getHistoryFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389248"><span class="hs-identifier hs-var">cachedir</span></a></span><span>
</span><span id="line-1662"></span><span>      </span><span id="local-6989586621679389245"><span class="annot"><span class="annottext">filtered :: History
</span><a href="#local-6989586621679389245"><span class="hs-identifier hs-var hs-var">filtered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; Bool) -&gt; History -&gt; History
forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; ([String] -&gt; Bool) -&gt; [String] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">History
</span><a href="#local-6989586621679389247"><span class="hs-identifier hs-var">hist</span></a></span><span>
</span><span id="line-1663"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">writeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389246"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">History -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">History
</span><a href="#local-6989586621679389245"><span class="hs-identifier hs-var">filtered</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; (SomeException -&gt; IO ()) -&gt; IO ()
forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeException</span></span><span> </span><span id="local-6989586621679389242"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679389242"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1664"></span><span>                          </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;error writing history: &quot;</span></span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">e -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679389242"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1665"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; FileMode -&gt; IO ()
</span><span class="hs-identifier hs-var">setFileMode</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389246"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">FileMode
</span><a href="#local-6989586621679389238"><span class="hs-identifier hs-var">mode</span></a></span><span>
</span><span id="line-1666"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389238"><span class="annot"><span class="annottext">mode :: FileMode
</span><a href="#local-6989586621679389238"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FileMode
</span><span class="hs-identifier hs-var">ownerReadMode</span></span><span> </span><span class="annot"><span class="annottext">FileMode -&gt; FileMode -&gt; FileMode
forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">FileMode
</span><span class="hs-identifier hs-var">ownerWriteMode</span></span><span>
</span><span id="line-1667"></span><span>
</span><span id="line-1668"></span><span class="hs-comment">-- $xutils</span><span>
</span><span id="line-1669"></span><span>
</span><span id="line-1670"></span><span class="hs-comment">-- | Fills a 'Drawable' with a rectangle and a border</span><span>
</span><span id="line-1671"></span><span class="annot"><a href="XMonad.Prompt.html#fillDrawable"><span class="hs-identifier hs-type">fillDrawable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Drawable</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span>
</span><span id="line-1672"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1673"></span><span id="fillDrawable"><span class="annot"><span class="annottext">fillDrawable :: Display
-&gt; Window
-&gt; GC
-&gt; Window
-&gt; Window
-&gt; Dimension
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><a href="XMonad.Prompt.html#fillDrawable"><span class="hs-identifier hs-var hs-var">fillDrawable</span></a></span></span><span> </span><span id="local-6989586621679389234"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389234"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679389233"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389233"><span class="hs-identifier hs-var">drw</span></a></span></span><span> </span><span id="local-6989586621679389232"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389232"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span id="local-6989586621679389231"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389231"><span class="hs-identifier hs-var">borderC</span></a></span></span><span> </span><span id="local-6989586621679389230"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389230"><span class="hs-identifier hs-var">bgcolor</span></a></span></span><span> </span><span id="local-6989586621679389229"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389229"><span class="hs-identifier hs-var">bw</span></a></span></span><span> </span><span id="local-6989586621679389228"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389228"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span id="local-6989586621679389227"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389227"><span class="hs-identifier hs-var">ht</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1674"></span><span>  </span><span class="hs-comment">-- we start with the border</span><span>
</span><span id="line-1675"></span><span>  </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389234"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389232"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389231"><span class="hs-identifier hs-var">borderC</span></a></span><span>
</span><span id="line-1676"></span><span>  </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><span class="hs-identifier hs-var">fillRectangle</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389234"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389233"><span class="hs-identifier hs-var">drw</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389232"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389228"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389227"><span class="hs-identifier hs-var">ht</span></a></span><span>
</span><span id="line-1677"></span><span>  </span><span class="hs-comment">-- here foreground means the background of the text</span><span>
</span><span id="line-1678"></span><span>  </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389234"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389232"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389230"><span class="hs-identifier hs-var">bgcolor</span></a></span><span>
</span><span id="line-1679"></span><span>  </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><span class="hs-identifier hs-var">fillRectangle</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389234"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389233"><span class="hs-identifier hs-var">drw</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679389232"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389229"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension -&gt; Position
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389229"><span class="hs-identifier hs-var">bw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389228"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389229"><span class="hs-identifier hs-var">bw</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389227"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389229"><span class="hs-identifier hs-var">bw</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Dimension
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1680"></span><span>
</span><span id="line-1681"></span><span class="hs-comment">-- | Creates a window with the attribute override_redirect set to True.</span><span>
</span><span id="line-1682"></span><span class="hs-comment">-- Windows Managers should not touch this kind of windows.</span><span>
</span><span id="line-1683"></span><span class="annot"><a href="XMonad.Prompt.html#mkUnmanagedWindow"><span class="hs-identifier hs-type">mkUnmanagedWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Screen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>
</span><span id="line-1684"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-1685"></span><span id="mkUnmanagedWindow"><span class="annot"><span class="annottext">mkUnmanagedWindow :: Display
-&gt; Screen
-&gt; Window
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO Window
</span><a href="XMonad.Prompt.html#mkUnmanagedWindow"><span class="hs-identifier hs-var hs-var">mkUnmanagedWindow</span></a></span></span><span> </span><span id="local-6989586621679389224"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389224"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679389223"><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679389223"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679389222"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389222"><span class="hs-identifier hs-var">rw</span></a></span></span><span> </span><span id="local-6989586621679389221"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389221"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679389220"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389220"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679389219"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389219"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679389218"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389218"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1686"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389217"><span class="annot"><span class="annottext">visual :: Visual
</span><a href="#local-6989586621679389217"><span class="hs-identifier hs-var hs-var">visual</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen -&gt; Visual
</span><span class="hs-identifier hs-var">defaultVisualOfScreen</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679389223"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1687"></span><span>      </span><span id="local-6989586621679389215"><span class="annot"><span class="annottext">attrmask :: Window
</span><a href="#local-6989586621679389215"><span class="hs-identifier hs-var hs-var">attrmask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">cWOverrideRedirect</span></span><span>
</span><span id="line-1688"></span><span>  </span><span class="annot"><span class="annottext">(Ptr SetWindowAttributes -&gt; IO Window) -&gt; IO Window
forall a. (Ptr SetWindowAttributes -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">allocaSetWindowAttributes</span></span><span> </span><span class="annot"><span class="annottext">((Ptr SetWindowAttributes -&gt; IO Window) -&gt; IO Window)
-&gt; (Ptr SetWindowAttributes -&gt; IO Window) -&gt; IO Window
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1689"></span><span>         </span><span class="hs-glyph">\</span><span id="local-6989586621679389212"><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679389212"><span class="hs-identifier hs-var">attributes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1690"></span><span>           </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">set_override_redirect</span></span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679389212"><span class="hs-identifier hs-var">attributes</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-1691"></span><span>           </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; GrabStatus
-&gt; GrabStatus
-&gt; GrabStatus
-&gt; Visual
-&gt; Window
-&gt; Ptr SetWindowAttributes
-&gt; IO Window
</span><span class="hs-identifier hs-var">createWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679389224"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389222"><span class="hs-identifier hs-var">rw</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389221"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679389220"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389219"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679389218"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; GrabStatus
</span><span class="hs-identifier hs-var">defaultDepthOfScreen</span></span><span> </span><span class="annot"><span class="annottext">Screen
</span><a href="#local-6989586621679389223"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1692"></span><span>                        </span><span class="annot"><span class="annottext">GrabStatus
</span><span class="hs-identifier hs-var">inputOutput</span></span><span> </span><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679389217"><span class="hs-identifier hs-var">visual</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679389215"><span class="hs-identifier hs-var">attrmask</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679389212"><span class="hs-identifier hs-var">attributes</span></a></span><span>
</span><span id="line-1693"></span><span>
</span><span id="line-1694"></span><span class="hs-comment">-- $utils</span><span>
</span><span id="line-1695"></span><span>
</span><span id="line-1696"></span><span class="hs-comment">-- | This function takes a list of possible completions and returns a</span><span>
</span><span id="line-1697"></span><span class="hs-comment">-- completions function to be used with 'mkXPrompt'</span><span>
</span><span id="line-1698"></span><span class="annot"><a href="XMonad.Prompt.html#mkComplFunFromList"><span class="hs-identifier hs-type">mkComplFunFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-1699"></span><span id="mkComplFunFromList"><span class="annot"><span class="annottext">mkComplFunFromList :: XPConfig -&gt; [String] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList"><span class="hs-identifier hs-var hs-var">mkComplFunFromList</span></a></span></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1700"></span><span class="annot"><a href="XMonad.Prompt.html#mkComplFunFromList"><span class="hs-identifier hs-var">mkComplFunFromList</span></a></span><span> </span><span id="local-6989586621679389208"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389208"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389207"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389207"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679389206"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389206"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1701"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; IO [String]) -&gt; [String] -&gt; IO [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; [String]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; String -&gt; Bool
</span><a href="XMonad.Prompt.html#searchPredicate"><span class="hs-identifier hs-var hs-var">searchPredicate</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389208"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389206"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389207"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1702"></span><span>
</span><span id="line-1703"></span><span class="hs-comment">-- | This function takes a list of possible completions and returns a</span><span>
</span><span id="line-1704"></span><span class="hs-comment">-- completions function to be used with 'mkXPrompt'. If the string is</span><span>
</span><span id="line-1705"></span><span class="hs-comment">-- null it will return all completions.</span><span>
</span><span id="line-1706"></span><span class="annot"><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-type">mkComplFunFromList'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-1707"></span><span id="mkComplFunFromList%27"><span class="annot"><span class="annottext">mkComplFunFromList' :: XPConfig -&gt; [String] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var hs-var">mkComplFunFromList'</span></a></span></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679389205"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389205"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389205"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1708"></span><span class="annot"><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span id="local-6989586621679389204"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389204"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389203"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389203"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679389202"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389202"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1709"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; IO [String]) -&gt; [String] -&gt; IO [String]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; [String]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; String -&gt; String -&gt; Bool
</span><a href="XMonad.Prompt.html#searchPredicate"><span class="hs-identifier hs-var hs-var">searchPredicate</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679389204"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389202"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389203"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-1710"></span><span>
</span><span id="line-1711"></span><span class="hs-comment">-- | Given the prompt type, the command line and the completion list,</span><span>
</span><span id="line-1712"></span><span class="hs-comment">-- return the next completion in the list for the last word of the</span><span>
</span><span id="line-1713"></span><span class="hs-comment">-- command line. This is the default 'nextCompletion' implementation.</span><span>
</span><span id="line-1714"></span><span id="local-6989586621679389201"><span class="annot"><a href="XMonad.Prompt.html#getNextOfLastWord"><span class="hs-identifier hs-type">getNextOfLastWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679389201"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679389201"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-1715"></span><span id="getNextOfLastWord"><span class="annot"><span class="annottext">getNextOfLastWord :: t -&gt; String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#getNextOfLastWord"><span class="hs-identifier hs-var hs-var">getNextOfLastWord</span></a></span></span><span> </span><span id="local-6989586621679389200"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679389200"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679389199"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389199"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389198"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389198"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Prompt.html#skipLastWord"><span class="hs-identifier hs-var">skipLastWord</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389199"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-var">completionToCommand</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679389200"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389198"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; String
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389197"><span class="hs-identifier hs-var">ni</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1716"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389197"><span class="annot"><span class="annottext">ni :: Int
</span><a href="#local-6989586621679389197"><span class="hs-identifier hs-var hs-var">ni</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">t -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#commandToComplete"><span class="hs-identifier hs-var">commandToComplete</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679389200"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389199"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-operator hs-var">`elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t -&gt; String -&gt; String
forall t. XPrompt t =&gt; t -&gt; String -&gt; String
</span><a href="XMonad.Prompt.html#completionToCommand"><span class="hs-identifier hs-var">completionToCommand</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679389200"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389198"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1717"></span><span>                 </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389196"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389196"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389196"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389198"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389196"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1718"></span><span>                 </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1719"></span><span>
</span><span id="line-1720"></span><span class="hs-comment">-- | An alternative 'nextCompletion' implementation: given a command</span><span>
</span><span id="line-1721"></span><span class="hs-comment">-- and a completion list, get the next completion in the list matching</span><span>
</span><span id="line-1722"></span><span class="hs-comment">-- the whole command line.</span><span>
</span><span id="line-1723"></span><span class="annot"><a href="XMonad.Prompt.html#getNextCompletion"><span class="hs-identifier hs-type">getNextCompletion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1724"></span><span id="getNextCompletion"><span class="annot"><span class="annottext">getNextCompletion :: String -&gt; [String] -&gt; String
</span><a href="XMonad.Prompt.html#getNextCompletion"><span class="hs-identifier hs-var hs-var">getNextCompletion</span></a></span></span><span> </span><span id="local-6989586621679389195"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389195"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679389194"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389194"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389194"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int -&gt; String
forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389193"><span class="hs-identifier hs-var">idx</span></a></span><span>
</span><span id="line-1725"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679389193"><span class="annot"><span class="annottext">idx :: Int
</span><a href="#local-6989586621679389193"><span class="hs-identifier hs-var hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389195"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Maybe Int
forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-operator hs-var">`elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389194"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1726"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389192"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389192"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389192"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389194"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679389192"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-1727"></span><span>                  </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1728"></span><span>
</span><span id="line-1729"></span><span class="hs-comment">-- | Given a maximum length, splits a list into sublists</span><span>
</span><span id="line-1730"></span><span id="local-6989586621679389191"><span class="annot"><a href="XMonad.Prompt.html#splitInSubListsAt"><span class="hs-identifier hs-type">splitInSubListsAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679389191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679389191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-1731"></span><span id="splitInSubListsAt"><span class="annot"><span class="annottext">splitInSubListsAt :: Int -&gt; [a] -&gt; [[a]]
</span><a href="XMonad.Prompt.html#splitInSubListsAt"><span class="hs-identifier hs-var hs-var">splitInSubListsAt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [a] -&gt; [[a]]
forall a. Int -&gt; [a] -&gt; [[a]]
</span><a href="XMonad.Prelude.html#chunksOf"><span class="hs-identifier hs-var">chunksOf</span></a></span><span>
</span><span id="line-1732"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">splitInSubListsAt</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Prelude.chunksOf instead.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-1733"></span><span>
</span><span id="line-1734"></span><span class="hs-comment">-- | Gets the last word of a string or the whole string if formed by</span><span>
</span><span id="line-1735"></span><span class="hs-comment">-- only one word</span><span>
</span><span id="line-1736"></span><span class="annot"><a href="XMonad.Prompt.html#getLastWord"><span class="hs-identifier hs-type">getLastWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1737"></span><span id="getLastWord"><span class="annot"><span class="annottext">getLastWord :: String -&gt; String
</span><a href="XMonad.Prompt.html#getLastWord"><span class="hs-identifier hs-var hs-var">getLastWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String)
-&gt; (String -&gt; (String, String)) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="XMonad.Prompt.html#breakAtSpace"><span class="hs-identifier hs-var">breakAtSpace</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, String))
-&gt; (String -&gt; String) -&gt; String -&gt; (String, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-1738"></span><span>
</span><span id="line-1739"></span><span class="hs-comment">-- | Skips the last word of the string, if the string is composed by</span><span>
</span><span id="line-1740"></span><span class="hs-comment">-- more then one word. Otherwise returns the string.</span><span>
</span><span id="line-1741"></span><span class="annot"><a href="XMonad.Prompt.html#skipLastWord"><span class="hs-identifier hs-type">skipLastWord</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1742"></span><span id="skipLastWord"><span class="annot"><span class="annottext">skipLastWord :: String -&gt; String
</span><a href="XMonad.Prompt.html#skipLastWord"><span class="hs-identifier hs-var hs-var">skipLastWord</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String, String) -&gt; String
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((String, String) -&gt; String)
-&gt; (String -&gt; (String, String)) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="XMonad.Prompt.html#breakAtSpace"><span class="hs-identifier hs-var">breakAtSpace</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, String))
-&gt; (String -&gt; String) -&gt; String -&gt; (String, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-1743"></span><span>
</span><span id="line-1744"></span><span class="annot"><a href="XMonad.Prompt.html#breakAtSpace"><span class="hs-identifier hs-type">breakAtSpace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-1745"></span><span id="breakAtSpace"><span class="annot"><span class="annottext">breakAtSpace :: String -&gt; (String, String)
</span><a href="XMonad.Prompt.html#breakAtSpace"><span class="hs-identifier hs-var hs-var">breakAtSpace</span></a></span></span><span> </span><span id="local-6989586621679389190"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389190"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-1746"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; \\&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389189"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389188"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389187"><span class="hs-identifier hs-var">s1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389186"><span class="hs-identifier hs-var">s2'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1747"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389188"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389189"><span class="hs-identifier hs-var">s2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1748"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679389188"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389188"><span class="hs-identifier hs-var">s1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679389189"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389189"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; (String, String)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isSpace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389190"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-1749"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679389187"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389187"><span class="hs-identifier hs-var">s1'</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389186"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389186"><span class="hs-identifier hs-var">s2'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String, String)
</span><a href="XMonad.Prompt.html#breakAtSpace"><span class="hs-identifier hs-var">breakAtSpace</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; (String, String)) -&gt; String -&gt; (String, String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389189"><span class="hs-identifier hs-var">s2</span></a></span><span>
</span><span id="line-1750"></span><span>
</span><span id="line-1751"></span><span class="hs-comment">-- | 'historyCompletion' provides a canned completion function much like</span><span>
</span><span id="line-1752"></span><span class="hs-comment">--   'getShellCompl'; you pass it to mkXPrompt, and it will make completions work</span><span>
</span><span id="line-1753"></span><span class="hs-comment">--   from the query history stored in the XMonad cache directory.</span><span>
</span><span id="line-1754"></span><span class="annot"><a href="XMonad.Prompt.html#historyCompletion"><span class="hs-identifier hs-type">historyCompletion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span>
</span><span id="line-1755"></span><span id="historyCompletion"><span class="annot"><span class="annottext">historyCompletion :: X ComplFunction
</span><a href="XMonad.Prompt.html#historyCompletion"><span class="hs-identifier hs-var hs-var">historyCompletion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; X ComplFunction
</span><a href="XMonad.Prompt.html#historyCompletionP"><span class="hs-identifier hs-var">historyCompletionP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-1756"></span><span>
</span><span id="line-1757"></span><span class="hs-comment">-- | Like 'historyCompletion' but only uses history data from Prompts whose</span><span>
</span><span id="line-1758"></span><span class="hs-comment">-- name satisfies the given predicate.</span><span>
</span><span id="line-1759"></span><span class="annot"><a href="XMonad.Prompt.html#historyCompletionP"><span class="hs-identifier hs-type">historyCompletionP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#ComplFunction"><span class="hs-identifier hs-type">ComplFunction</span></a></span><span>
</span><span id="line-1760"></span><span id="historyCompletionP"><span class="annot"><span class="annottext">historyCompletionP :: (String -&gt; Bool) -&gt; X ComplFunction
</span><a href="XMonad.Prompt.html#historyCompletionP"><span class="hs-identifier hs-var hs-var">historyCompletionP</span></a></span></span><span> </span><span id="local-6989586621679389184"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679389184"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1761"></span><span>    </span><span id="local-6989586621679389183"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389183"><span class="hs-identifier hs-var">cd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XConf -&gt; String) -&gt; X String
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Directories' String -&gt; String
forall a. Directories' a -&gt; a
</span><span class="hs-identifier hs-var hs-var">cacheDir</span></span><span> </span><span class="annot"><span class="annottext">(Directories' String -&gt; String)
-&gt; (XConf -&gt; Directories' String) -&gt; XConf -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Directories' String
</span><span class="hs-identifier hs-var hs-var">directories</span></span><span class="hs-special">)</span><span>
</span><span id="line-1762"></span><span>    </span><span class="annot"><span class="annottext">ComplFunction -&gt; X ComplFunction
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(ComplFunction -&gt; X ComplFunction)
-&gt; ComplFunction -&gt; X ComplFunction
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389182"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389182"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1763"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389181"><span class="annot"><span class="annottext">toComplList :: Map k [String] -&gt; [String]
</span><a href="#local-6989586621679389181"><span class="hs-identifier hs-var hs-var">toComplList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
</span><a href="XMonad.Prompt.html#deleteConsecutive"><span class="hs-identifier hs-var">deleteConsecutive</span></a></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; (Map k [String] -&gt; [String]) -&gt; Map k [String] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; [String]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isInfixOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389182"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; (Map k [String] -&gt; [String]) -&gt; Map k [String] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String] -&gt; [String])
-&gt; [String] -&gt; Map k [String] -&gt; [String]
forall a b k. (a -&gt; b -&gt; b) -&gt; b -&gt; Map k a -&gt; b
</span><span class="hs-identifier hs-var">M.foldr</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1764"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">History -&gt; [String]
forall k. Map k [String] -&gt; [String]
</span><a href="#local-6989586621679389181"><span class="hs-identifier hs-var">toComplList</span></a></span><span> </span><span class="annot"><span class="annottext">(History -&gt; [String])
-&gt; (History -&gt; History) -&gt; History -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; [String] -&gt; Bool) -&gt; History -&gt; History
forall k a. (k -&gt; a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.filterWithKey</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; [String] -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; [String] -&gt; Bool)
-&gt; (String -&gt; Bool) -&gt; String -&gt; [String] -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679389184"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(History -&gt; [String]) -&gt; IO History -&gt; IO [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO History
</span><a href="XMonad.Prompt.html#readHistory"><span class="hs-identifier hs-var">readHistory</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389183"><span class="hs-identifier hs-var">cd</span></a></span><span>
</span><span id="line-1765"></span><span>
</span><span id="line-1766"></span><span class="hs-comment">-- | Sort a list and remove duplicates. Like 'deleteAllDuplicates', but trades off</span><span>
</span><span id="line-1767"></span><span class="hs-comment">--   laziness and stability for efficiency.</span><span>
</span><span id="line-1768"></span><span id="local-6989586621679389177"><span class="annot"><a href="XMonad.Prompt.html#uniqSort"><span class="hs-identifier hs-type">uniqSort</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679389177"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679389177"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679389177"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1769"></span><span id="uniqSort"><span class="annot"><span class="annottext">uniqSort :: [a] -&gt; [a]
</span><a href="XMonad.Prompt.html#uniqSort"><span class="hs-identifier hs-var hs-var">uniqSort</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a]
forall a. Set a -&gt; [a]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">(Set a -&gt; [a]) -&gt; ([a] -&gt; Set a) -&gt; [a] -&gt; [a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Set a
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">fromList</span></span><span>
</span><span id="line-1770"></span><span>
</span><span id="line-1771"></span><span class="hs-comment">-- | Functions to be used with the 'historyFilter' setting.</span><span>
</span><span id="line-1772"></span><span class="hs-comment">-- 'deleteAllDuplicates' will remove all duplicate entries.</span><span>
</span><span id="line-1773"></span><span class="hs-comment">-- 'deleteConsecutive' will only remove duplicate elements</span><span>
</span><span id="line-1774"></span><span class="hs-comment">-- immediately next to each other.</span><span>
</span><span id="line-1775"></span><span class="annot"><a href="XMonad.Prompt.html#deleteAllDuplicates"><span class="hs-identifier hs-type">deleteAllDuplicates</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#deleteConsecutive"><span class="hs-identifier hs-type">deleteConsecutive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-1776"></span><span id="deleteAllDuplicates"><span class="annot"><span class="annottext">deleteAllDuplicates :: [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#deleteAllDuplicates"><span class="hs-identifier hs-var hs-var">deleteAllDuplicates</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [String]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span>
</span><span id="line-1777"></span><span id="deleteConsecutive"><span class="annot"><span class="annottext">deleteConsecutive :: [String] -&gt; [String]
</span><a href="XMonad.Prompt.html#deleteConsecutive"><span class="hs-identifier hs-var hs-var">deleteConsecutive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; [[String]] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([[String]] -&gt; [String])
-&gt; ([String] -&gt; [[String]]) -&gt; [String] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; [[String]]
forall a. Eq a =&gt; [a] -&gt; [[a]]
</span><span class="hs-identifier hs-var">group</span></span><span>
</span><span id="line-1778"></span><span>
</span><span id="line-1779"></span><span class="hs-keyword">newtype</span><span> </span><span id="HistoryMatches"><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-var">HistoryMatches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HistoryMatches"><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-var">HistoryMatches</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IORef</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1780"></span><span>
</span><span id="line-1781"></span><span class="hs-comment">-- | Initializes a new HistoryMatches structure to be passed</span><span>
</span><span id="line-1782"></span><span class="hs-comment">-- to historyUpMatching</span><span>
</span><span id="line-1783"></span><span id="local-6989586621679389173"><span class="annot"><a href="XMonad.Prompt.html#initMatches"><span class="hs-identifier hs-type">initMatches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679389173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679389173"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679389173"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-type">HistoryMatches</span></a></span></span><span>
</span><span id="line-1784"></span><span id="initMatches"><span class="annot"><span class="annottext">initMatches :: m HistoryMatches
</span><a href="XMonad.Prompt.html#initMatches"><span class="hs-identifier hs-var hs-var">initMatches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String)) -&gt; HistoryMatches
</span><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-var">HistoryMatches</span></a></span><span> </span><span class="annot"><span class="annottext">(IORef ([String], Maybe (Stack String)) -&gt; HistoryMatches)
-&gt; m (IORef ([String], Maybe (Stack String))) -&gt; m HistoryMatches
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (IORef ([String], Maybe (Stack String)))
-&gt; m (IORef ([String], Maybe (Stack String)))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([String], Maybe (Stack String))
-&gt; IO (IORef ([String], Maybe (Stack String)))
forall a. a -&gt; IO (IORef a)
</span><span class="hs-identifier hs-var">newIORef</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe (Stack String)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1785"></span><span>
</span><span id="line-1786"></span><span class="annot"><a href="XMonad.Prompt.html#historyNextMatching"><span class="hs-identifier hs-type">historyNextMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-type">HistoryMatches</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1787"></span><span id="historyNextMatching"><span class="annot"><span class="annottext">historyNextMatching :: HistoryMatches -&gt; (Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#historyNextMatching"><span class="hs-identifier hs-var hs-var">historyNextMatching</span></a></span></span><span> </span><span id="local-6989586621679389170"><span class="annot"><span class="annottext">hm :: HistoryMatches
</span><a href="#local-6989586621679389170"><span class="hs-identifier hs-var">hm</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-type">HistoryMatches</span></a></span><span> </span><span id="local-6989586621679389169"><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
</span><a href="#local-6989586621679389169"><span class="hs-identifier hs-var">ref</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679389168"><span class="annot"><span class="annottext">Stack String -&gt; Stack String
</span><a href="#local-6989586621679389168"><span class="hs-identifier hs-var">next</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1788"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679389167"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389167"><span class="hs-identifier hs-var">completed</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679389166"><span class="annot"><span class="annottext">Maybe (Stack String)
</span><a href="#local-6989586621679389166"><span class="hs-identifier hs-var">completions</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO ([String], Maybe (Stack String))
-&gt; StateT XPState IO ([String], Maybe (Stack String))
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO ([String], Maybe (Stack String))
 -&gt; StateT XPState IO ([String], Maybe (Stack String)))
-&gt; IO ([String], Maybe (Stack String))
-&gt; StateT XPState IO ([String], Maybe (Stack String))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
-&gt; IO ([String], Maybe (Stack String))
forall a. IORef a -&gt; IO a
</span><span class="hs-identifier hs-var">readIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
</span><a href="#local-6989586621679389169"><span class="hs-identifier hs-var">ref</span></a></span><span>
</span><span id="line-1789"></span><span>  </span><span id="local-6989586621679389165"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389165"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">XP String
</span><a href="XMonad.Prompt.html#getInput"><span class="hs-identifier hs-var">getInput</span></a></span><span>
</span><span id="line-1790"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389165"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389167"><span class="hs-identifier hs-var">completed</span></a></span><span>
</span><span id="line-1791"></span><span>     </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack String)
</span><a href="#local-6989586621679389166"><span class="hs-identifier hs-var">completions</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-1792"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679389164"><span class="annot"><span class="annottext">Stack String
</span><a href="#local-6989586621679389164"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1793"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679389163"><span class="annot"><span class="annottext">cmd :: String
</span><a href="#local-6989586621679389163"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; String
forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack String
</span><a href="#local-6989586621679389164"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-1794"></span><span>                </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; XPState -&gt; XPState
</span><a href="XMonad.Prompt.html#setCommand"><span class="hs-identifier hs-var">setCommand</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389163"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-1795"></span><span>                </span><span class="annot"><span class="annottext">(XPState -&gt; XPState) -&gt; XP ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((XPState -&gt; XPState) -&gt; XP ()) -&gt; (XPState -&gt; XPState) -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679389162"><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389162"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XPState
</span><a href="#local-6989586621679389162"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">offset :: Int
</span><a href="XMonad.Prompt.html#offset"><span class="hs-identifier hs-var">offset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389163"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-1796"></span><span>                </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ()) -&gt; IO () -&gt; XP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
-&gt; ([String], Maybe (Stack String)) -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
</span><a href="#local-6989586621679389169"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389163"><span class="hs-identifier hs-var">cmd</span></a></span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679389167"><span class="hs-identifier hs-var">completed</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Stack String -&gt; Maybe (Stack String)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Maybe (Stack String))
-&gt; Stack String -&gt; Maybe (Stack String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
</span><a href="#local-6989586621679389168"><span class="hs-identifier hs-var">next</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String
</span><a href="#local-6989586621679389164"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1797"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Stack String)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; XP ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1798"></span><span>     </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-comment">-- the user typed something new, recompute completions</span><span>
</span><span id="line-1799"></span><span>       </span><span class="annot"><span class="annottext">IO () -&gt; XP ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; XP ())
-&gt; (Stack String -&gt; IO ()) -&gt; Stack String -&gt; XP ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
-&gt; ([String], Maybe (Stack String)) -&gt; IO ()
forall a. IORef a -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">writeIORef</span></span><span> </span><span class="annot"><span class="annottext">IORef ([String], Maybe (Stack String))
</span><a href="#local-6989586621679389169"><span class="hs-identifier hs-var">ref</span></a></span><span> </span><span class="annot"><span class="annottext">(([String], Maybe (Stack String)) -&gt; IO ())
-&gt; (Stack String -&gt; ([String], Maybe (Stack String)))
-&gt; Stack String
-&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389165"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack String) -&gt; ([String], Maybe (Stack String)))
-&gt; (Stack String -&gt; Maybe (Stack String))
-&gt; Stack String
-&gt; ([String], Maybe (Stack String))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Stack String -&gt; Maybe (Stack String)
</span><a href="#local-6989586621679389161"><span class="hs-identifier hs-var">filterMatching</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389165"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; XP ())
-&gt; StateT XPState IO (Stack String) -&gt; XP ()
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">(XPState -&gt; Stack String) -&gt; StateT XPState IO (Stack String)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XPState -&gt; Stack String
</span><a href="XMonad.Prompt.html#commandHistory"><span class="hs-identifier hs-var hs-var">commandHistory</span></a></span><span>
</span><span id="line-1800"></span><span>       </span><span class="annot"><span class="annottext">HistoryMatches -&gt; (Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#historyNextMatching"><span class="hs-identifier hs-var">historyNextMatching</span></a></span><span> </span><span class="annot"><span class="annottext">HistoryMatches
</span><a href="#local-6989586621679389170"><span class="hs-identifier hs-var">hm</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
</span><a href="#local-6989586621679389168"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-1801"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span class="annot"><a href="#local-6989586621679389161"><span class="hs-identifier hs-type">filterMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-1802"></span><span>          </span><span id="local-6989586621679389161"><span class="annot"><span class="annottext">filterMatching :: String -&gt; Stack String -&gt; Maybe (Stack String)
</span><a href="#local-6989586621679389161"><span class="hs-identifier hs-var hs-var">filterMatching</span></a></span></span><span> </span><span id="local-6989586621679389160"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389160"><span class="hs-identifier hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; Stack String -&gt; Maybe (Stack String)
forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679389160"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Stack String -&gt; Maybe (Stack String))
-&gt; (Stack String -&gt; Stack String)
-&gt; Stack String
-&gt; Maybe (Stack String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
</span><a href="#local-6989586621679389168"><span class="hs-identifier hs-var">next</span></a></span><span>
</span><span id="line-1803"></span><span>
</span><span id="line-1804"></span><span class="hs-comment">-- | Retrieve the next history element that starts with</span><span>
</span><span id="line-1805"></span><span class="hs-comment">-- the current input. Pass it the result of initMatches</span><span>
</span><span id="line-1806"></span><span class="hs-comment">-- when creating the prompt. Example:</span><span>
</span><span id="line-1807"></span><span class="hs-comment">--</span><span>
</span><span id="line-1808"></span><span class="hs-comment">-- &gt; ..</span><span>
</span><span id="line-1809"></span><span class="hs-comment">-- &gt; ((modMask,xK_p), shellPrompt . myPrompt =&lt;&lt; initMatches)</span><span>
</span><span id="line-1810"></span><span class="hs-comment">-- &gt; ..</span><span>
</span><span id="line-1811"></span><span class="hs-comment">-- &gt; myPrompt ref = def</span><span>
</span><span id="line-1812"></span><span class="hs-comment">-- &gt;   { promptKeymap = M.union [((0,xK_Up), historyUpMatching ref)</span><span>
</span><span id="line-1813"></span><span class="hs-comment">-- &gt;                            ,((0,xK_Down), historyDownMatching ref)]</span><span>
</span><span id="line-1814"></span><span class="hs-comment">-- &gt;                            (promptKeymap def)</span><span>
</span><span id="line-1815"></span><span class="hs-comment">-- &gt;   , .. }</span><span>
</span><span id="line-1816"></span><span class="hs-comment">--</span><span>
</span><span id="line-1817"></span><span class="annot"><a href="XMonad.Prompt.html#historyUpMatching"><span class="hs-identifier hs-type">historyUpMatching</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#historyDownMatching"><span class="hs-identifier hs-type">historyDownMatching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#HistoryMatches"><span class="hs-identifier hs-type">HistoryMatches</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XP"><span class="hs-identifier hs-type">XP</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1818"></span><span id="historyUpMatching"><span class="annot"><span class="annottext">historyUpMatching :: HistoryMatches -&gt; XP ()
</span><a href="XMonad.Prompt.html#historyUpMatching"><span class="hs-identifier hs-var hs-var">historyUpMatching</span></a></span></span><span> </span><span id="local-6989586621679389158"><span class="annot"><span class="annottext">HistoryMatches
</span><a href="#local-6989586621679389158"><span class="hs-identifier hs-var">hm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HistoryMatches -&gt; (Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#historyNextMatching"><span class="hs-identifier hs-var">historyNextMatching</span></a></span><span> </span><span class="annot"><span class="annottext">HistoryMatches
</span><a href="#local-6989586621679389158"><span class="hs-identifier hs-var">hm</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span>
</span><span id="line-1819"></span><span id="historyDownMatching"><span class="annot"><span class="annottext">historyDownMatching :: HistoryMatches -&gt; XP ()
</span><a href="XMonad.Prompt.html#historyDownMatching"><span class="hs-identifier hs-var hs-var">historyDownMatching</span></a></span></span><span> </span><span id="local-6989586621679389157"><span class="annot"><span class="annottext">HistoryMatches
</span><a href="#local-6989586621679389157"><span class="hs-identifier hs-var">hm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HistoryMatches -&gt; (Stack String -&gt; Stack String) -&gt; XP ()
</span><a href="XMonad.Prompt.html#historyNextMatching"><span class="hs-identifier hs-var">historyNextMatching</span></a></span><span> </span><span class="annot"><span class="annottext">HistoryMatches
</span><a href="#local-6989586621679389157"><span class="hs-identifier hs-var">hm</span></a></span><span> </span><span class="annot"><span class="annottext">Stack String -&gt; Stack String
forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span>
</span><span id="line-1820"></span></pre></body></html>