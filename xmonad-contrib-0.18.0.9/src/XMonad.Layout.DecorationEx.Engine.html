<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, ViewPatterns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE DefaultSignatures #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Module      :  XMonad.Layout.DecorationEx.Engine</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Description :  Type class and its default implementation for window decoration engines.</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Copyright   :  (c) 2007 Andrea Rossato, 2009 Jan Vornberger, 2023 Ilya Portnov</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- License     :  BSD-style (see xmonad/LICENSE)</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Maintainer  :  portnov84@rambler.ru</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- This module defines @DecorationEngine@ type class, and default implementation for it.</span><span>
</span><span id="line-23"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Layout.DecorationEx.Engine</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * DecorationEngine class</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier">DecorationEngine</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Auxiliary data types</span></span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier">DrawData</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier">DecorationLayoutState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Re-exports from X.L.Decoration</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier">Shrinker</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#shrinkText"><span class="hs-identifier">shrinkText</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utility functions</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#mkDrawData"><span class="hs-identifier">mkDrawData</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#paintDecorationSimple"><span class="hs-identifier">paintDecorationSimple</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign.C.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CInt</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html"><span class="hs-identifier">XMonad.Layout.Decoration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier">Shrinker</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#shrinkWhile"><span class="hs-identifier">shrinkWhile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#shrinkText"><span class="hs-identifier">shrinkText</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.DraggingVisualizer.html"><span class="hs-identifier">XMonad.Layout.DraggingVisualizer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DraggingVisualizer.html#DraggingVisualizerMsg"><span class="hs-identifier">DraggingVisualizerMsg</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationAddons.html"><span class="hs-identifier">XMonad.Layout.DecorationAddons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationAddons.html#handleScreenCrossing"><span class="hs-identifier">handleScreenCrossing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html"><span class="hs-identifier">XMonad.Util.Font</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.NamedWindows.html"><span class="hs-identifier">XMonad.Util.NamedWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedWindows.html#getName"><span class="hs-identifier">getName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html"><span class="hs-identifier">XMonad.Layout.DecorationEx.Common</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Auxiliary type for data which are passed from</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- decoration layout modifier to decoration engine.</span><span>
</span><span id="line-55"></span><span class="hs-keyword">data</span><span> </span><span id="DrawData"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-var">DrawData</span></a></span></span><span> </span><span id="local-6989586621679501243"><span class="annot"><a href="#local-6989586621679501243"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679501242"><span class="annot"><a href="#local-6989586621679501242"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DrawData"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-var">DrawData</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-56"></span><span>    </span><span id="ddEngineState"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; DecorationEngineState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddEngineState"><span class="hs-identifier hs-var hs-var">ddEngineState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501243"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- ^ Decoration engine state</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ddStyle"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Style (Theme engine widget)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddStyle"><span class="hs-identifier hs-var hs-var">ddStyle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501243"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501242"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Graphics style of the decoration. This defines colors, fonts etc</span><span>
</span><span id="line-58"></span><span>                                                        </span><span class="hs-comment">-- which are to be used for this particular window in it's current state.</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ddOrigWindow"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddOrigWindow"><span class="hs-identifier hs-var hs-var">ddOrigWindow</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>                             </span><span class="hs-comment">-- ^ Original window to be decorated</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ddWindowTitle"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; String
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWindowTitle"><span class="hs-identifier hs-var hs-var">ddWindowTitle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                            </span><span class="hs-comment">-- ^ Original window title (not shrinked yet)</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ddDecoRect"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var hs-var">ddDecoRect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>                            </span><span class="hs-comment">-- ^ Decoration rectangle</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ddWidgets"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgets"><span class="hs-identifier hs-var hs-var">ddWidgets</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-type">WidgetLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501242"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- ^ Widgets to be placed on decoration</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="ddWidgetPlaces"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; WidgetLayout WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgetPlaces"><span class="hs-identifier hs-var hs-var">ddWidgetPlaces</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-type">WidgetLayout</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ Places where widgets must be shown</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | State of decoration engine</span><span>
</span><span id="line-67"></span><span class="hs-keyword">data</span><span> </span><span id="DecorationLayoutState"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-var">DecorationLayoutState</span></a></span></span><span> </span><span id="local-6989586621679501220"><span class="annot"><a href="#local-6989586621679501220"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DecorationLayoutState"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-var">DecorationLayoutState</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-68"></span><span>    </span><span id="dsStyleState"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; DecorationEngineState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsStyleState"><span class="hs-identifier hs-var hs-var">dsStyleState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501220"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Engine-specific state</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="dsDecorations"><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var hs-var">dsDecorations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span>            </span><span class="hs-comment">-- ^ Mapping between decoration windows and original windows</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Decoration engines type class.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Decoration engine is responsible for drawing something inside decoration rectangle.</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- It is also responsible for handling X11 events (such as clicks) which happen</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- within decoration rectangle.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Decoration rectangles are defined by DecorationGeometry implementation.</span><span>
</span><span id="line-77"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>       </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>       </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#DecorationWidget"><span class="hs-identifier hs-type">DecorationWidget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>       </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#HasWidgets"><span class="hs-identifier hs-type">HasWidgets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>       </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#ClickHandler"><span class="hs-identifier hs-type">ClickHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>       </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#ThemeAttributes"><span class="hs-identifier hs-type">ThemeAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span id="DecorationEngine"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-var">DecorationEngine</span></a></span></span><span> </span><span id="local-6989586621679501215"><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679501214"><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span id="local-6989586621679501213"><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- | Type of themes used by decoration engine.</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">-- This type must be parameterized over a widget type,</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-comment">-- because a theme will contain a list of widgets.</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="Theme"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-var">Theme</span></a></span></span><span> </span><span id="local-6989586621679501215"><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>           </span><span>
</span><span id="line-89"></span><span>                                          </span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">-- | Type of data used by engine as a context during painting;</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-comment">-- for plain X11-based implementation this is Display, Pixmap</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-comment">-- and GC.</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="DecorationPaintingContext"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationPaintingContext"><span class="hs-identifier hs-var">DecorationPaintingContext</span></a></span></span><span> </span><span id="local-6989586621679501215"><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span>
</span><span id="line-94"></span><span> </span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-comment">-- | Type of state used by the decoration engine.</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-comment">-- This can contain some resources that should be initialized</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- and released at time, such as X11 fonts.</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="DecorationEngineState"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-var">DecorationEngineState</span></a></span></span><span> </span><span id="local-6989586621679501215"><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span></span><span>     </span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-comment">-- | Give a name to decoration engine.</span><span>
</span><span id="line-101"></span><span>    </span><span id="describeEngine"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#describeEngine"><span class="hs-identifier hs-type">describeEngine</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-comment">-- | Initialize state of the engine.</span><span>
</span><span id="line-104"></span><span>    </span><span id="initializeState"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#initializeState"><span class="hs-identifier hs-type">initializeState</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679500980"><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>       </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-105"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679500980"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>                </span><span class="hs-comment">-- ^ Decoration geometry instance</span><span>
</span><span id="line-106"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>   </span><span class="hs-comment">-- ^ Theme to be used</span><span>
</span><span id="line-107"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- | Release resources held in engine state.</span><span>
</span><span id="line-110"></span><span>    </span><span id="releaseStateResources"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#releaseStateResources"><span class="hs-identifier hs-type">releaseStateResources</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-111"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-comment">-- ^ Engine state</span><span>
</span><span id="line-112"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">-- | Calculate place which will be occupied by one widget.</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-comment">-- NB: X coordinate of the returned rectangle will be ignored, because</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-comment">-- the rectangle will be moved to the right or to the left for proper alignment</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-comment">-- of widgets.</span><span>
</span><span id="line-118"></span><span>    </span><span id="calcWidgetPlace"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#calcWidgetPlace"><span class="hs-identifier hs-type">calcWidgetPlace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>         </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-119"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>  </span><span class="hs-comment">-- ^ Information about window and decoration</span><span>
</span><span id="line-120"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>                  </span><span class="hs-comment">-- ^ Widget to be placed</span><span>
</span><span id="line-121"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-comment">-- | Place widgets along the decoration bar.</span><span>
</span><span id="line-124"></span><span>    </span><span id="placeWidgets"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#placeWidgets"><span class="hs-identifier hs-type">placeWidgets</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679501207"><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501207"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-125"></span><span>                 </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-126"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>          </span><span class="hs-comment">-- ^ Theme to be used</span><span>
</span><span id="line-127"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501207"><span class="hs-identifier hs-type">shrinker</span></a></span><span>                     </span><span class="hs-comment">-- ^ Strings shrinker</span><span>
</span><span id="line-128"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-comment">-- ^ Current state of the engine</span><span>
</span><span id="line-129"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>                    </span><span class="hs-comment">-- ^ Decoration rectangle</span><span>
</span><span id="line-130"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>                       </span><span class="hs-comment">-- ^ Original window to be decorated</span><span>
</span><span id="line-131"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-type">WidgetLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>          </span><span class="hs-comment">-- ^ Widgets layout</span><span>
</span><span id="line-132"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-type">WidgetLayout</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679500975"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#placeWidgets"><span class="hs-identifier hs-var hs-var">placeWidgets</span></a></span><span> </span><span id="local-6989586621679500942"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500942"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679500941"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500941"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679500940"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679500940"><span class="hs-identifier hs-var">decoStyle</span></a></span></span><span> </span><span id="local-6989586621679500939"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500939"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span> </span><span id="local-6989586621679500938"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500938"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span id="local-6989586621679500937"><span class="annot"><span class="annottext">WidgetLayout widget
</span><a href="#local-6989586621679500937"><span class="hs-identifier hs-var">wlayout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-134"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500936"><span class="annot"><span class="annottext">leftWidgets :: [widget]
</span><a href="#local-6989586621679500936"><span class="hs-identifier hs-var hs-var">leftWidgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. WidgetLayout a -&gt; [a]
</span><a href="XMonad.Layout.DecorationEx.Common.html#wlLeft"><span class="hs-identifier hs-var">wlLeft</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetLayout widget
</span><a href="#local-6989586621679500937"><span class="hs-identifier hs-var">wlayout</span></a></span><span>
</span><span id="line-135"></span><span>            </span><span id="local-6989586621679500934"><span class="annot"><span class="annottext">rightWidgets :: [widget]
</span><a href="#local-6989586621679500934"><span class="hs-identifier hs-var hs-var">rightWidgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. WidgetLayout a -&gt; [a]
</span><a href="XMonad.Layout.DecorationEx.Common.html#wlRight"><span class="hs-identifier hs-var">wlRight</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetLayout widget
</span><a href="#local-6989586621679500937"><span class="hs-identifier hs-var">wlayout</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span id="local-6989586621679500932"><span class="annot"><span class="annottext">centerWidgets :: [widget]
</span><a href="#local-6989586621679500932"><span class="hs-identifier hs-var hs-var">centerWidgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. WidgetLayout a -&gt; [a]
</span><a href="XMonad.Layout.DecorationEx.Common.html#wlCenter"><span class="hs-identifier hs-var">wlCenter</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetLayout widget
</span><a href="#local-6989586621679500937"><span class="hs-identifier hs-var">wlayout</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>        </span><span id="local-6989586621679500930"><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500930"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
(DecorationEngine engine widget a,
 ThemeAttributes (Theme engine widget),
 HasWidgets (Theme engine) widget) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; Window
-&gt; Rectangle
-&gt; X (DrawData engine widget)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#mkDrawData"><span class="hs-identifier hs-var">mkDrawData</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500942"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500941"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679500940"><span class="hs-identifier hs-var">decoStyle</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500938"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500939"><span class="hs-identifier hs-var">decoRect</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500929"><span class="annot"><span class="annottext">paddedDecoRect :: Rectangle
</span><a href="#local-6989586621679500929"><span class="hs-identifier hs-var hs-var">paddedDecoRect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension -&gt; Rectangle -&gt; Rectangle
</span><a href="#local-6989586621679500928"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall theme.
ThemeAttributes theme =&gt;
theme -&gt; BoxBorders Dimension
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetsPadding"><span class="hs-identifier hs-var">widgetsPadding</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500941"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500930"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>            </span><span id="local-6989586621679500926"><span class="annot"><span class="annottext">paddedDd :: DrawData engine widget
</span><a href="#local-6989586621679500926"><span class="hs-identifier hs-var hs-var">paddedDd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500930"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ddDecoRect :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500929"><span class="hs-identifier hs-var">paddedDecoRect</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-141"></span><span>        </span><span id="local-6989586621679500925"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500925"><span class="hs-identifier hs-var">rightRects</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignRight"><span class="hs-identifier hs-var">alignRight</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500942"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500926"><span class="hs-identifier hs-var">paddedDd</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500934"><span class="hs-identifier hs-var">rightWidgets</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span id="local-6989586621679500923"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500923"><span class="hs-identifier hs-var">leftRects</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignLeft"><span class="hs-identifier hs-var">alignLeft</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500942"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500926"><span class="hs-identifier hs-var">paddedDd</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500936"><span class="hs-identifier hs-var">leftWidgets</span></a></span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500921"><span class="annot"><span class="annottext">wantedLeftWidgetsWidth :: Dimension
</span><a href="#local-6989586621679500921"><span class="hs-identifier hs-var hs-var">wantedLeftWidgetsWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500923"><span class="hs-identifier hs-var">leftRects</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span id="local-6989586621679500916"><span class="annot"><span class="annottext">wantedRightWidgetsWidth :: Dimension
</span><a href="#local-6989586621679500916"><span class="hs-identifier hs-var hs-var">wantedRightWidgetsWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500925"><span class="hs-identifier hs-var">rightRects</span></a></span><span>
</span><span id="line-145"></span><span>            </span><span id="local-6989586621679500915"><span class="annot"><span class="annottext">hasShrinkableOnLeft :: Bool
</span><a href="#local-6989586621679500915"><span class="hs-identifier hs-var hs-var">hasShrinkableOnLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">forall widget. DecorationWidget widget =&gt; widget -&gt; Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#isShrinkable"><span class="hs-identifier hs-var">isShrinkable</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500936"><span class="hs-identifier hs-var">leftWidgets</span></a></span><span>
</span><span id="line-146"></span><span>            </span><span id="local-6989586621679500912"><span class="annot"><span class="annottext">hasShrinkableOnRight :: Bool
</span><a href="#local-6989586621679500912"><span class="hs-identifier hs-var hs-var">hasShrinkableOnRight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">forall widget. DecorationWidget widget =&gt; widget -&gt; Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#isShrinkable"><span class="hs-identifier hs-var">isShrinkable</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500934"><span class="hs-identifier hs-var">rightWidgets</span></a></span><span>
</span><span id="line-147"></span><span>            </span><span id="local-6989586621679500911"><span class="annot"><span class="annottext">decoWidth :: Dimension
</span><a href="#local-6989586621679500911"><span class="hs-identifier hs-var hs-var">decoWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500939"><span class="hs-identifier hs-var">decoRect</span></a></span><span>
</span><span id="line-148"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679500910"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500910"><span class="hs-identifier hs-var">leftWidgetsWidth</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500909"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500909"><span class="hs-identifier hs-var">rightWidgetsWidth</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500915"><span class="hs-identifier hs-var">hasShrinkableOnLeft</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-150"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500911"><span class="hs-identifier hs-var">decoWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500916"><span class="hs-identifier hs-var">wantedRightWidgetsWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500921"><span class="hs-identifier hs-var">wantedLeftWidgetsWidth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-151"></span><span>                      </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500916"><span class="hs-identifier hs-var">wantedRightWidgetsWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500912"><span class="hs-identifier hs-var">hasShrinkableOnRight</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-153"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500921"><span class="hs-identifier hs-var">wantedLeftWidgetsWidth</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>                      </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500911"><span class="hs-identifier hs-var">decoWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500921"><span class="hs-identifier hs-var">wantedLeftWidgetsWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500916"><span class="hs-identifier hs-var">wantedRightWidgetsWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500921"><span class="hs-identifier hs-var">wantedLeftWidgetsWidth</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500916"><span class="hs-identifier hs-var">wantedRightWidgetsWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>            </span><span id="local-6989586621679500907"><span class="annot"><span class="annottext">ddForCenter :: DrawData engine widget
</span><a href="#local-6989586621679500907"><span class="hs-identifier hs-var hs-var">ddForCenter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500926"><span class="hs-identifier hs-var">paddedDd</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ddDecoRect :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; Dimension -&gt; Rectangle -&gt; Rectangle
</span><a href="#local-6989586621679500906"><span class="hs-identifier hs-var">padCenter</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500910"><span class="hs-identifier hs-var">leftWidgetsWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500909"><span class="hs-identifier hs-var">rightWidgetsWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500929"><span class="hs-identifier hs-var">paddedDecoRect</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>        </span><span id="local-6989586621679500905"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500905"><span class="hs-identifier hs-var">centerRects</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignCenter"><span class="hs-identifier hs-var">alignCenter</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500942"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500907"><span class="hs-identifier hs-var">ddForCenter</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500932"><span class="hs-identifier hs-var">centerWidgets</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500903"><span class="annot"><span class="annottext">shrinkedLeftRects :: [WidgetPlace]
</span><a href="#local-6989586621679500903"><span class="hs-identifier hs-var hs-var">shrinkedLeftRects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packLeft"><span class="hs-identifier hs-var">packLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500929"><span class="hs-identifier hs-var">paddedDecoRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [(WidgetPlace, Bool)] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500900"><span class="hs-identifier hs-var">shrinkPlaces</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500910"><span class="hs-identifier hs-var">leftWidgetsWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500923"><span class="hs-identifier hs-var">leftRects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall widget. DecorationWidget widget =&gt; widget -&gt; Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#isShrinkable"><span class="hs-identifier hs-var">isShrinkable</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500936"><span class="hs-identifier hs-var">leftWidgets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>            </span><span id="local-6989586621679500899"><span class="annot"><span class="annottext">shrinkedRightRects :: [WidgetPlace]
</span><a href="#local-6989586621679500899"><span class="hs-identifier hs-var hs-var">shrinkedRightRects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packRight"><span class="hs-identifier hs-var">packRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500929"><span class="hs-identifier hs-var">paddedDecoRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [(WidgetPlace, Bool)] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500900"><span class="hs-identifier hs-var">shrinkPlaces</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500909"><span class="hs-identifier hs-var">rightWidgetsWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500925"><span class="hs-identifier hs-var">rightRects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall widget. DecorationWidget widget =&gt; widget -&gt; Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#isShrinkable"><span class="hs-identifier hs-var">isShrinkable</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500934"><span class="hs-identifier hs-var">rightWidgets</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a] -&gt; WidgetLayout a
</span><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-var">WidgetLayout</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500903"><span class="hs-identifier hs-var">shrinkedLeftRects</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500905"><span class="hs-identifier hs-var">centerRects</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500899"><span class="hs-identifier hs-var">shrinkedRightRects</span></a></span><span>
</span><span id="line-161"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>        </span><span id="local-6989586621679500900"><span class="annot"><span class="annottext">shrinkPlaces :: Dimension -&gt; [(WidgetPlace, Bool)] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500900"><span class="hs-identifier hs-var hs-var">shrinkPlaces</span></a></span></span><span> </span><span id="local-6989586621679500888"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500888"><span class="hs-identifier hs-var">targetWidth</span></a></span></span><span> </span><span id="local-6989586621679500887"><span class="annot"><span class="annottext">[(WidgetPlace, Bool)]
</span><a href="#local-6989586621679500887"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500886"><span class="annot"><span class="annottext">nShrinkable :: Int
</span><a href="#local-6989586621679500886"><span class="hs-identifier hs-var hs-var">nShrinkable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(WidgetPlace, Bool)]
</span><a href="#local-6989586621679500887"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>              </span><span id="local-6989586621679500884"><span class="annot"><span class="annottext">totalUnshrinkedWidth :: Dimension
</span><a href="#local-6989586621679500884"><span class="hs-identifier hs-var hs-var">totalUnshrinkedWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(WidgetPlace, Bool)]
</span><a href="#local-6989586621679500887"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-165"></span><span>              </span><span id="local-6989586621679500882"><span class="annot"><span class="annottext">shrinkedWidth :: Dimension
</span><a href="#local-6989586621679500882"><span class="hs-identifier hs-var hs-var">shrinkedWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500888"><span class="hs-identifier hs-var">targetWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500884"><span class="hs-identifier hs-var">totalUnshrinkedWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500886"><span class="hs-identifier hs-var">nShrinkable</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span>              </span><span id="local-6989586621679500878"><span class="annot"><span class="annottext">resetX :: WidgetPlace -&gt; WidgetPlace
</span><a href="#local-6989586621679500878"><span class="hs-identifier hs-var hs-var">resetX</span></a></span></span><span> </span><span id="local-6989586621679500877"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500877"><span class="hs-identifier hs-var">place</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500877"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500877"><span class="hs-identifier hs-var">place</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>              </span><span id="local-6989586621679500876"><span class="annot"><span class="annottext">adjust :: (WidgetPlace, Bool) -&gt; WidgetPlace
</span><a href="#local-6989586621679500876"><span class="hs-identifier hs-var hs-var">adjust</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500875"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500875"><span class="hs-identifier hs-var">place</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; WidgetPlace
</span><a href="#local-6989586621679500878"><span class="hs-identifier hs-var">resetX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500875"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500875"><span class="hs-identifier hs-var">place</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_width :: Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500882"><span class="hs-identifier hs-var">shrinkedWidth</span></a></span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-170"></span><span>              </span><span class="annot"><a href="#local-6989586621679500876"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500874"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500874"><span class="hs-identifier hs-var">place</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; WidgetPlace
</span><a href="#local-6989586621679500878"><span class="hs-identifier hs-var">resetX</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500874"><span class="hs-identifier hs-var">place</span></a></span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(WidgetPlace, Bool) -&gt; WidgetPlace
</span><a href="#local-6989586621679500876"><span class="hs-identifier hs-var">adjust</span></a></span><span> </span><span class="annot"><span class="annottext">[(WidgetPlace, Bool)]
</span><a href="#local-6989586621679500887"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span>        </span><span id="local-6989586621679500928"><span class="annot"><span class="annottext">pad :: BoxBorders Dimension -&gt; Rectangle -&gt; Rectangle
</span><a href="#local-6989586621679500928"><span class="hs-identifier hs-var hs-var">pad</span></a></span></span><span> </span><span id="local-6989586621679500865"><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679500863"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500863"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679500862"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500862"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>          </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Dimension -&gt; Dimension -&gt; Rectangle
</span><span class="hs-identifier hs-var">Rectangle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxLeft"><span class="hs-identifier hs-var">bxLeft</span></a></span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxTop"><span class="hs-identifier hs-var">bxTop</span></a></span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500863"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxLeft"><span class="hs-identifier hs-var">bxLeft</span></a></span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxRight"><span class="hs-identifier hs-var">bxRight</span></a></span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500862"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxTop"><span class="hs-identifier hs-var">bxTop</span></a></span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxBottom"><span class="hs-identifier hs-var">bxBottom</span></a></span><span> </span><span class="annot"><span class="annottext">BoxBorders Dimension
</span><a href="#local-6989586621679500865"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>      </span><span>
</span><span id="line-178"></span><span>        </span><span id="local-6989586621679500906"><span class="annot"><span class="annottext">padCenter :: Dimension -&gt; Dimension -&gt; Rectangle -&gt; Rectangle
</span><a href="#local-6989586621679500906"><span class="hs-identifier hs-var hs-var">padCenter</span></a></span></span><span> </span><span id="local-6989586621679500852"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500852"><span class="hs-identifier hs-var">left</span></a></span></span><span> </span><span id="local-6989586621679500851"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500851"><span class="hs-identifier hs-var">right</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span id="local-6989586621679500850"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500850"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679500849"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500849"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679500848"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500848"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679500847"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500847"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>          </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Dimension -&gt; Dimension -&gt; Rectangle
</span><span class="hs-identifier hs-var">Rectangle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500850"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500852"><span class="hs-identifier hs-var">left</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500849"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-180"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500848"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500852"><span class="hs-identifier hs-var">left</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500851"><span class="hs-identifier hs-var">right</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500847"><span class="hs-identifier hs-var">h</span></a></span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- | Shrink window title so that it would fit in decoration.</span><span>
</span><span id="line-183"></span><span>    </span><span id="getShrinkedWindowName"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#getShrinkedWindowName"><span class="hs-identifier hs-type">getShrinkedWindowName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679500844"><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500844"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-184"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-185"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679500844"><span class="hs-identifier hs-type">shrinker</span></a></span><span>                     </span><span class="hs-comment">-- ^ Strings shrinker</span><span>
</span><span id="line-186"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-comment">-- ^ State of decoration engine</span><span>
</span><span id="line-187"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                       </span><span class="hs-comment">-- ^ Original window title</span><span>
</span><span id="line-188"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>                    </span><span class="hs-comment">-- ^ Width of rectangle in which the title should fit</span><span>
</span><span id="line-189"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>                    </span><span class="hs-comment">-- ^ Height of rectangle in which the title should fit</span><span>
</span><span id="line-190"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-keyword">default</span><span> </span><span id="getShrinkedWindowName"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#getShrinkedWindowName"><span class="hs-identifier hs-type">getShrinkedWindowName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679501166"><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501166"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>                                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501166"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679500843"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#getShrinkedWindowName"><span class="hs-identifier hs-var hs-var">getShrinkedWindowName</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679500826"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679500826"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679500825"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679500825"><span class="hs-identifier hs-var">font</span></a></span></span><span> </span><span id="local-6989586621679500824"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500824"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679500823"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500823"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500822"><span class="annot"><span class="annottext">s :: String -&gt; [String]
</span><a href="#local-6989586621679500822"><span class="hs-identifier hs-var hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Shrinker s =&gt; s -&gt; String -&gt; [String]
</span><a href="XMonad.Layout.Decoration.html#shrinkIt"><span class="hs-identifier hs-var">shrinkIt</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679500826"><span class="hs-identifier hs-var">shrinker</span></a></span><span>
</span><span id="line-196"></span><span>      </span><span id="local-6989586621679500820"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500820"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Display
</span><span class="hs-identifier hs-var">display</span></span><span>
</span><span id="line-197"></span><span>      </span><span class="annot"><span class="annottext">(String -&gt; [String]) -&gt; (String -&gt; X Bool) -&gt; String -&gt; X String
</span><a href="XMonad.Layout.Decoration.html#shrinkWhile"><span class="hs-identifier hs-var">shrinkWhile</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><a href="#local-6989586621679500822"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679500817"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500817"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679500816"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500816"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
Display -&gt; XMonadFont -&gt; String -&gt; m Int
</span><a href="XMonad.Util.Font.html#textWidthXMF"><span class="hs-identifier hs-var">textWidthXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500820"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679500825"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500817"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-198"></span><span>                              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500816"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500823"><span class="hs-identifier hs-var">wh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500824"><span class="hs-identifier hs-var">name</span></a></span></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- | Mask of X11 events on which the decoration engine should do something.</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- @exposureMask@ should be included here so that decoration engine could</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- repaint decorations when they are shown on screen.</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- @buttonPressMask@ should be included so that decoration engine could</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">-- response to mouse clicks.</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- Other events can be added to custom implementations of DecorationEngine.</span><span>
</span><span id="line-206"></span><span>    </span><span id="decorationXEventMask"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationXEventMask"><span class="hs-identifier hs-type">decorationXEventMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">EventMask</span></span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679500810"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationXEventMask"><span class="hs-identifier hs-var hs-var">decorationXEventMask</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">exposureMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">buttonPressMask</span></span></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- | List of X11 window property atoms of original (client) windows,</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- change of which should trigger repainting of decoration.</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- For example, if @WM_NAME@ changes it means that we have to redraw</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- window title.</span><span>
</span><span id="line-213"></span><span>    </span><span id="propsToRepaintDecoration"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#propsToRepaintDecoration"><span class="hs-identifier hs-type">propsToRepaintDecoration</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Atom</span></span><span class="hs-special">]</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621679500802"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#propsToRepaintDecoration"><span class="hs-identifier hs-var hs-var">propsToRepaintDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; X Window
</span><span class="hs-identifier hs-var">getAtom</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WM_NAME&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_NAME&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WM_STATE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WM_HINTS&quot;</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-comment">-- | Generic event handler, which recieves X11 events on decoration</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-comment">-- window.</span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- Default implementation handles mouse clicks and drags.</span><span>
</span><span id="line-220"></span><span>    </span><span id="decorationEventHookEx"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationEventHookEx"><span class="hs-identifier hs-type">decorationEventHookEx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679501149"><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501149"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-221"></span><span>                          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-222"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>
</span><span id="line-223"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span>
</span><span id="line-224"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501149"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-225"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span>
</span><span id="line-226"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621679500795"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationEventHookEx"><span class="hs-identifier hs-var hs-var">decorationEventHookEx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; DecorationLayoutState engine
-&gt; shrinker
-&gt; Event
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#handleMouseFocusDrag"><span class="hs-identifier hs-var">handleMouseFocusDrag</span></a></span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- | Event handler for clicks on decoration window.</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- This is called from default implementation of &quot;decorationEventHookEx&quot;.</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- This should return True, if the click was handled (something happened</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- because of that click). If this returns False, the click can be considered</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-comment">-- as a beginning of mouse drag.</span><span>
</span><span id="line-234"></span><span>    </span><span id="handleDecorationClick"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#handleDecorationClick"><span class="hs-identifier hs-type">handleDecorationClick</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>      </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-235"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>  </span><span class="hs-comment">-- ^ Decoration theme</span><span>
</span><span id="line-236"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>            </span><span class="hs-comment">-- ^ Decoration rectangle</span><span>
</span><span id="line-237"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- ^ Rectangles where widgets are placed</span><span>
</span><span id="line-238"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>               </span><span class="hs-comment">-- ^ Original (client) window</span><span>
</span><span id="line-239"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                  </span><span class="hs-comment">-- ^ Mouse click X coordinate</span><span>
</span><span id="line-240"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                  </span><span class="hs-comment">-- ^ Mouse click Y coordinate</span><span>
</span><span id="line-241"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                  </span><span class="hs-comment">-- ^ Mouse button number</span><span>
</span><span id="line-242"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-243"></span><span>    </span><span id="local-6989586621679500789"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#handleDecorationClick"><span class="hs-identifier hs-var hs-var">handleDecorationClick</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
(DecorationEngine engine widget a,
 ClickHandler (Theme engine) widget) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; Rectangle
-&gt; [Rectangle]
-&gt; Window
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; X Bool
</span><a href="XMonad.Layout.DecorationEx.Engine.html#decorationHandler"><span class="hs-identifier hs-var">decorationHandler</span></a></span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-comment">-- | Event handler which is called during mouse dragging.</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-comment">-- This is called from default implementation of &quot;decorationEventHookEx&quot;.</span><span>
</span><span id="line-247"></span><span>    </span><span id="decorationWhileDraggingHook"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationWhileDraggingHook"><span class="hs-identifier hs-type">decorationWhileDraggingHook</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>      </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-248"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>                 </span><span class="hs-comment">-- ^ Event X coordinate</span><span>
</span><span id="line-249"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span>                 </span><span class="hs-comment">-- ^ Event Y coordinate</span><span>
</span><span id="line-250"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Original window and it's rectangle</span><span>
</span><span id="line-251"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>             </span><span class="hs-comment">-- ^ X coordinate of new pointer position during dragging</span><span>
</span><span id="line-252"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>             </span><span class="hs-comment">-- ^ Y coordinate of new pointer position during dragging</span><span>
</span><span id="line-253"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621679500783"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationWhileDraggingHook"><span class="hs-identifier hs-var hs-var">decorationWhileDraggingHook</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CInt -&gt; CInt -&gt; (Window, Rectangle) -&gt; Position -&gt; Position -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#handleDraggingInProgress"><span class="hs-identifier hs-var">handleDraggingInProgress</span></a></span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">-- | This hoook is called after a window has been dragged using the decoration.</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- This is called from default implementation of &quot;decorationEventHookEx&quot;.</span><span>
</span><span id="line-258"></span><span>    </span><span id="decorationAfterDraggingHook"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationAfterDraggingHook"><span class="hs-identifier hs-type">decorationAfterDraggingHook</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>     </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-259"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Original window and its rectangle</span><span>
</span><span id="line-260"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>              </span><span class="hs-comment">-- ^ Decoration window</span><span>
</span><span id="line-261"></span><span>                                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621679500780"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationAfterDraggingHook"><span class="hs-identifier hs-var hs-var">decorationAfterDraggingHook</span></a></span><span> </span><span id="local-6989586621679500774"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500774"><span class="hs-identifier hs-var">_ds</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500773"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500773"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500772"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500772"><span class="hs-identifier hs-var">_r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679500771"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500771"><span class="hs-identifier hs-var">decoWin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500773"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621679500769"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500769"><span class="hs-identifier hs-var">hasCrossed</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X Bool
</span><a href="XMonad.Layout.DecorationAddons.html#handleScreenCrossing"><span class="hs-identifier hs-var">handleScreenCrossing</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500773"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500771"><span class="hs-identifier hs-var">decoWin</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500769"><span class="hs-identifier hs-var">hasCrossed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">DraggingVisualizerMsg
</span><a href="XMonad.Layout.DraggingVisualizer.html#DraggingStopped"><span class="hs-identifier hs-var">DraggingStopped</span></a></span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#performWindowSwitching"><span class="hs-identifier hs-var">performWindowSwitching</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500773"><span class="hs-identifier hs-var">w</span></a></span></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span>    </span><span class="hs-comment">-- | Draw everything required on the decoration window.</span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- This method should draw background (flat or gradient or whatever),</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- borders, and call @paintWidget@ method to draw window widgets</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- (buttons and title).</span><span>
</span><span id="line-273"></span><span>    </span><span id="paintDecoration"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#paintDecoration"><span class="hs-identifier hs-type">paintDecoration</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679500763"><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500763"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-274"></span><span>                    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>         </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-275"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>                       </span><span class="hs-comment">-- ^ Decoration window</span><span>
</span><span id="line-276"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>               </span><span class="hs-comment">-- ^ Decoration window width</span><span>
</span><span id="line-277"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>               </span><span class="hs-comment">-- ^ Decoration window height</span><span>
</span><span id="line-278"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679500763"><span class="hs-identifier hs-type">shrinker</span></a></span><span>                </span><span class="hs-comment">-- ^ Strings shrinker instance</span><span>
</span><span id="line-279"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>  </span><span class="hs-comment">-- ^ Details about what to draw</span><span>
</span><span id="line-280"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                    </span><span class="hs-comment">-- ^ True when this method is called during Expose event</span><span>
</span><span id="line-281"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-comment">-- | Paint one widget on the decoration window.</span><span>
</span><span id="line-284"></span><span>    </span><span id="paintWidget"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#paintWidget"><span class="hs-identifier hs-type">paintWidget</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679501053"><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501053"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-285"></span><span>                </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501213"><span class="hs-identifier hs-type">a</span></a></span><span>                  </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-286"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationPaintingContext"><span class="hs-identifier hs-type">DecorationPaintingContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-comment">-- ^ Decoration painting context</span><span>
</span><span id="line-287"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span>                      </span><span class="hs-comment">-- ^ Place (rectangle) where the widget should be drawn</span><span>
</span><span id="line-288"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501053"><span class="hs-identifier hs-type">shrinker</span></a></span><span>                         </span><span class="hs-comment">-- ^ Strings shrinker instance</span><span>
</span><span id="line-289"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501215"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>           </span><span class="hs-comment">-- ^ Details about window decoration</span><span>
</span><span id="line-290"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501214"><span class="hs-identifier hs-type">widget</span></a></span><span>                           </span><span class="hs-comment">-- ^ Widget to be drawn</span><span>
</span><span id="line-291"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>                             </span><span class="hs-comment">-- ^ True when this method is called during Expose event</span><span>
</span><span id="line-292"></span><span>                </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#handleDraggingInProgress"><span class="hs-identifier hs-type">handleDraggingInProgress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CInt</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span id="handleDraggingInProgress"><span class="annot"><span class="annottext">handleDraggingInProgress :: CInt -&gt; CInt -&gt; (Window, Rectangle) -&gt; Position -&gt; Position -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#handleDraggingInProgress"><span class="hs-identifier hs-var hs-var">handleDraggingInProgress</span></a></span></span><span> </span><span id="local-6989586621679500761"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500761"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span id="local-6989586621679500760"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500760"><span class="hs-identifier hs-var">ey</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500759"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500759"><span class="hs-identifier hs-var">mainw</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500758"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500758"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679500757"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500757"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679500756"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500756"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500755"><span class="annot"><span class="annottext">rect :: Rectangle
</span><a href="#local-6989586621679500755"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Dimension -&gt; Dimension -&gt; Rectangle
</span><span class="hs-identifier hs-var">Rectangle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500757"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500761"><span class="hs-identifier hs-var">ex</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500758"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500756"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500760"><span class="hs-identifier hs-var">ey</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500758"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span>  </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500758"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>                         </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500758"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Rectangle -&gt; DraggingVisualizerMsg
</span><a href="XMonad.Layout.DraggingVisualizer.html#DraggingWindow"><span class="hs-identifier hs-var">DraggingWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500759"><span class="hs-identifier hs-var">mainw</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500755"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#performWindowSwitching"><span class="hs-identifier hs-type">performWindowSwitching</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span id="performWindowSwitching"><span class="annot"><span class="annottext">performWindowSwitching :: Window -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#performWindowSwitching"><span class="hs-identifier hs-var hs-var">performWindowSwitching</span></a></span></span><span> </span><span id="local-6989586621679500751"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500751"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><span class="annottext">forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679500749"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500749"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>       </span><span id="local-6989586621679500748"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500748"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Window
</span><span class="hs-identifier hs-var">theRoot</span></span><span>
</span><span id="line-306"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500746"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500746"><span class="hs-identifier hs-var">selWin</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Modifier
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; IO (Bool, Window, Window, CInt, CInt, CInt, CInt, Modifier)
</span><span class="hs-identifier hs-var">queryPointer</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500749"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500748"><span class="hs-identifier hs-var">root</span></a></span><span>
</span><span id="line-307"></span><span>       </span><span id="local-6989586621679500744"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679500744"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-308"></span><span>       </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500741"><span class="annot"><span class="annottext">allWindows :: [Window]
</span><a href="#local-6989586621679500741"><span class="hs-identifier hs-var hs-var">allWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.index</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679500744"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-309"></span><span>       </span><span class="hs-comment">-- do a little double check to be sure</span><span>
</span><span id="line-310"></span><span>       </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500751"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500741"><span class="hs-identifier hs-var">allWindows</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500746"><span class="hs-identifier hs-var">selWin</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500741"><span class="hs-identifier hs-var">allWindows</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500736"><span class="annot"><span class="annottext">allWindowsSwitched :: [Window]
</span><a href="#local-6989586621679500736"><span class="hs-identifier hs-var hs-var">allWindowsSwitched</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Eq a =&gt; a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679500735"><span class="hs-identifier hs-var">switchEntries</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500751"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500746"><span class="hs-identifier hs-var">selWin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500741"><span class="hs-identifier hs-var">allWindows</span></a></span><span>
</span><span id="line-312"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500734"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500734"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><a href="XMonad.Prelude.html#notEmpty"><span class="hs-identifier hs-var">notEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679500732"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500732"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679500731"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500731"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500751"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500736"><span class="hs-identifier hs-var">allWindowsSwitched</span></a></span><span>
</span><span id="line-313"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500729"><span class="annot"><span class="annottext">newStack :: Stack Window
</span><a href="#local-6989586621679500729"><span class="hs-identifier hs-var hs-var">newStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500732"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500734"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679500731"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-314"></span><span>                </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679500729"><span class="hs-identifier hs-var">newStack</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-316"></span><span>        </span><span id="local-6989586621679500735"><span class="annot"><span class="annottext">switchEntries :: a -&gt; a -&gt; a -&gt; a
</span><a href="#local-6989586621679500735"><span class="hs-identifier hs-var hs-var">switchEntries</span></a></span></span><span> </span><span id="local-6989586621679500720"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500720"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679500719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500719"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679500718"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500718"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500720"><span class="hs-identifier hs-var">a</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500719"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500719"><span class="hs-identifier hs-var">b</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500720"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-319"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500718"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#ignoreX"><span class="hs-identifier hs-type">ignoreX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span>
</span><span id="line-322"></span><span id="ignoreX"><span class="annot"><span class="annottext">ignoreX :: WidgetPlace -&gt; WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ignoreX"><span class="hs-identifier hs-var hs-var">ignoreX</span></a></span></span><span> </span><span id="local-6989586621679500716"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500716"><span class="hs-identifier hs-var">place</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500716"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500716"><span class="hs-identifier hs-var">place</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#alignLeft"><span class="hs-identifier hs-type">alignLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679500715"><span class="annot"><a href="#local-6989586621679500715"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679500714"><span class="annot"><a href="#local-6989586621679500714"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span id="local-6989586621679500713"><span class="annot"><a href="#local-6989586621679500713"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500715"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500714"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500713"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679500715"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500714"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500713"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500715"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500714"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679500714"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span id="alignLeft"><span class="annot"><span class="annottext">alignLeft :: forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignLeft"><span class="hs-identifier hs-var hs-var">alignLeft</span></a></span></span><span> </span><span id="local-6989586621679500706"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500706"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679500705"><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500705"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span id="local-6989586621679500704"><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500704"><span class="hs-identifier hs-var">widgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-326"></span><span>    </span><span id="local-6989586621679500703"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500703"><span class="hs-identifier hs-var">places</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; widget -&gt; X WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#calcWidgetPlace"><span class="hs-identifier hs-var">calcWidgetPlace</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500706"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500705"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500704"><span class="hs-identifier hs-var">widgets</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packLeft"><span class="hs-identifier hs-var">packLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500705"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ignoreX"><span class="hs-identifier hs-var">ignoreX</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500703"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#packLeft"><span class="hs-identifier hs-type">packLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-330"></span><span id="packLeft"><span class="annot"><span class="annottext">packLeft :: Position -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packLeft"><span class="hs-identifier hs-var hs-var">packLeft</span></a></span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-331"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#packLeft"><span class="hs-identifier hs-var">packLeft</span></a></span><span> </span><span id="local-6989586621679500702"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500702"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500701"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500701"><span class="hs-identifier hs-var">place</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679500700"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500700"><span class="hs-identifier hs-var">places</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500699"><span class="annot"><span class="annottext">rect :: Rectangle
</span><a href="#local-6989586621679500699"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500701"><span class="hs-identifier hs-var">place</span></a></span><span>
</span><span id="line-333"></span><span>      </span><span id="local-6989586621679500698"><span class="annot"><span class="annottext">x' :: Position
</span><a href="#local-6989586621679500698"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500702"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500699"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span id="local-6989586621679500697"><span class="annot"><span class="annottext">rect' :: Rectangle
</span><a href="#local-6989586621679500697"><span class="hs-identifier hs-var hs-var">rect'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500699"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500698"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-335"></span><span>      </span><span id="local-6989586621679500696"><span class="annot"><span class="annottext">place' :: WidgetPlace
</span><a href="#local-6989586621679500696"><span class="hs-identifier hs-var hs-var">place'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500701"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500697"><span class="hs-identifier hs-var">rect'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500696"><span class="hs-identifier hs-var">place'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packLeft"><span class="hs-identifier hs-var">packLeft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500698"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500699"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500700"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#alignRight"><span class="hs-identifier hs-type">alignRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679501198"><span class="annot"><a href="#local-6989586621679501198"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679501197"><span class="annot"><a href="#local-6989586621679501197"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span id="local-6989586621679501196"><span class="annot"><a href="#local-6989586621679501196"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501198"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501197"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501198"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501197"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501198"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501197"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679501197"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-339"></span><span id="alignRight"><span class="annot"><span class="annottext">alignRight :: forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignRight"><span class="hs-identifier hs-var hs-var">alignRight</span></a></span></span><span> </span><span id="local-6989586621679500689"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500689"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679500688"><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500688"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span id="local-6989586621679500687"><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500687"><span class="hs-identifier hs-var">widgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>    </span><span id="local-6989586621679500686"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500686"><span class="hs-identifier hs-var">places</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; widget -&gt; X WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#calcWidgetPlace"><span class="hs-identifier hs-var">calcWidgetPlace</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500689"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500688"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500687"><span class="hs-identifier hs-var">widgets</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packRight"><span class="hs-identifier hs-var">packRight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500688"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ignoreX"><span class="hs-identifier hs-var">ignoreX</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500686"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#packRight"><span class="hs-identifier hs-type">packRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span id="packRight"><span class="annot"><span class="annottext">packRight :: Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#packRight"><span class="hs-identifier hs-var hs-var">packRight</span></a></span></span><span> </span><span id="local-6989586621679500685"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500685"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679500684"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500684"><span class="hs-identifier hs-var">places</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500683"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500685"><span class="hs-identifier hs-var">x0</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500684"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679500683"><span class="annot"><span class="annottext">go :: Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500683"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><a href="#local-6989586621679500683"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679500679"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500679"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500678"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500678"><span class="hs-identifier hs-var">place</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679500677"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500677"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><span id="line-348"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500676"><span class="annot"><span class="annottext">rect :: Rectangle
</span><a href="#local-6989586621679500676"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500678"><span class="hs-identifier hs-var">place</span></a></span><span>
</span><span id="line-349"></span><span>          </span><span id="local-6989586621679500675"><span class="annot"><span class="annottext">x' :: Dimension
</span><a href="#local-6989586621679500675"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500679"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500676"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-350"></span><span>          </span><span id="local-6989586621679500674"><span class="annot"><span class="annottext">rect' :: Rectangle
</span><a href="#local-6989586621679500674"><span class="hs-identifier hs-var hs-var">rect'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500676"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500675"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-351"></span><span>          </span><span id="local-6989586621679500673"><span class="annot"><span class="annottext">place' :: WidgetPlace
</span><a href="#local-6989586621679500673"><span class="hs-identifier hs-var hs-var">place'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500678"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500674"><span class="hs-identifier hs-var">rect'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-352"></span><span>      </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500673"><span class="hs-identifier hs-var">place'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500683"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500675"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500677"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#alignCenter"><span class="hs-identifier hs-type">alignCenter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679500672"><span class="annot"><a href="#local-6989586621679500672"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679500671"><span class="annot"><a href="#local-6989586621679500671"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span id="local-6989586621679500670"><span class="annot"><a href="#local-6989586621679500670"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500672"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500671"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500670"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679500672"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500671"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500670"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500672"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679500671"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679500671"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WidgetPlace"><span class="hs-identifier hs-type">WidgetPlace</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-355"></span><span id="alignCenter"><span class="annot"><span class="annottext">alignCenter :: forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignCenter"><span class="hs-identifier hs-var hs-var">alignCenter</span></a></span></span><span> </span><span id="local-6989586621679500649"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500649"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679500648"><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500648"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span id="local-6989586621679500647"><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500647"><span class="hs-identifier hs-var">widgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-356"></span><span>    </span><span id="local-6989586621679500646"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500646"><span class="hs-identifier hs-var">places</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; DrawData engine widget -&gt; [widget] -&gt; X [WidgetPlace]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#alignLeft"><span class="hs-identifier hs-var">alignLeft</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500649"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500648"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500647"><span class="hs-identifier hs-var">widgets</span></a></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500645"><span class="annot"><span class="annottext">totalWidth :: Dimension
</span><a href="#local-6989586621679500645"><span class="hs-identifier hs-var hs-var">totalWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500646"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span id="local-6989586621679500644"><span class="annot"><span class="annottext">availableWidth :: Position
</span><a href="#local-6989586621679500644"><span class="hs-identifier hs-var hs-var">availableWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500648"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>
</span><span id="line-359"></span><span>        </span><span id="local-6989586621679500643"><span class="annot"><span class="annottext">x0 :: Position
</span><a href="#local-6989586621679500643"><span class="hs-identifier hs-var hs-var">x0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500644"><span class="hs-identifier hs-var">availableWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500645"><span class="hs-identifier hs-var">totalWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621679500641"><span class="annot"><span class="annottext">places' :: [WidgetPlace]
</span><a href="#local-6989586621679500641"><span class="hs-identifier hs-var hs-var">places'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Integral a =&gt; a -&gt; WidgetPlace -&gt; WidgetPlace
</span><a href="#local-6989586621679500640"><span class="hs-identifier hs-var">shift</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500643"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500646"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500639"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500644"><span class="hs-identifier hs-var">availableWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500641"><span class="hs-identifier hs-var">places'</span></a></span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>    </span><span id="local-6989586621679500640"><span class="annot"><span class="annottext">shift :: a -&gt; WidgetPlace -&gt; WidgetPlace
</span><a href="#local-6989586621679500640"><span class="hs-identifier hs-var hs-var">shift</span></a></span></span><span> </span><span id="local-6989586621679500634"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500634"><span class="hs-identifier hs-var">x0</span></a></span></span><span> </span><span id="local-6989586621679500633"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500633"><span class="hs-identifier hs-var">place</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-364"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500632"><span class="annot"><span class="annottext">rect :: Rectangle
</span><a href="#local-6989586621679500632"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500633"><span class="hs-identifier hs-var">place</span></a></span><span>
</span><span id="line-365"></span><span>          </span><span id="local-6989586621679500631"><span class="annot"><span class="annottext">rect' :: Rectangle
</span><a href="#local-6989586621679500631"><span class="hs-identifier hs-var hs-var">rect'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500632"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500632"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679500634"><span class="hs-identifier hs-var">x0</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-366"></span><span>      </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500633"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500631"><span class="hs-identifier hs-var">rect'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-367"></span><span>    </span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621679500639"><span class="annot"><span class="annottext">pack :: Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500639"><span class="hs-identifier hs-var hs-var">pack</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-369"></span><span>    </span><span class="annot"><a href="#local-6989586621679500639"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span id="local-6989586621679500628"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500628"><span class="hs-identifier hs-var">available</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679500627"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500627"><span class="hs-identifier hs-var">place</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679500626"><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500626"><span class="hs-identifier hs-var">places</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-370"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500625"><span class="annot"><span class="annottext">rect :: Rectangle
</span><a href="#local-6989586621679500625"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500627"><span class="hs-identifier hs-var">place</span></a></span><span>
</span><span id="line-371"></span><span>          </span><span id="local-6989586621679500624"><span class="annot"><span class="annottext">placeWidth :: Dimension
</span><a href="#local-6989586621679500624"><span class="hs-identifier hs-var hs-var">placeWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500625"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-372"></span><span>          </span><span id="local-6989586621679500623"><span class="annot"><span class="annottext">widthToUse :: Dimension
</span><a href="#local-6989586621679500623"><span class="hs-identifier hs-var hs-var">widthToUse</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500628"><span class="hs-identifier hs-var">available</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500624"><span class="hs-identifier hs-var">placeWidth</span></a></span><span>
</span><span id="line-373"></span><span>          </span><span id="local-6989586621679500622"><span class="annot"><span class="annottext">remaining :: Dimension
</span><a href="#local-6989586621679500622"><span class="hs-identifier hs-var hs-var">remaining</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500628"><span class="hs-identifier hs-var">available</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500623"><span class="hs-identifier hs-var">widthToUse</span></a></span><span>
</span><span id="line-374"></span><span>          </span><span id="local-6989586621679500621"><span class="annot"><span class="annottext">rect' :: Rectangle
</span><a href="#local-6989586621679500621"><span class="hs-identifier hs-var hs-var">rect'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500625"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">rect_width :: Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500623"><span class="hs-identifier hs-var">widthToUse</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-375"></span><span>          </span><span id="local-6989586621679500620"><span class="annot"><span class="annottext">place' :: WidgetPlace
</span><a href="#local-6989586621679500620"><span class="hs-identifier hs-var hs-var">place'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500627"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">wpRectangle :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500621"><span class="hs-identifier hs-var">rect'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500620"><span class="hs-identifier hs-var">place'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Dimension -&gt; [WidgetPlace] -&gt; [WidgetPlace]
</span><a href="#local-6989586621679500639"><span class="hs-identifier hs-var">pack</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500622"><span class="hs-identifier hs-var">remaining</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500626"><span class="hs-identifier hs-var">places</span></a></span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Build an instance of 'DrawData' type.</span><span>
</span><span id="line-379"></span><span id="local-6989586621679501201"><span id="local-6989586621679501202"><span id="local-6989586621679501203"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#mkDrawData"><span class="hs-identifier hs-type">mkDrawData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501202"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#ThemeAttributes"><span class="hs-identifier hs-type">ThemeAttributes</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501202"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#HasWidgets"><span class="hs-identifier hs-type">HasWidgets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679501202"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>           </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501202"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501201"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-381"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501202"><span class="hs-identifier hs-type">widget</span></a></span><span>            </span><span class="hs-comment">-- ^ Decoration theme</span><span>
</span><span id="line-382"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span>   </span><span class="hs-comment">-- ^ State of decoration engine</span><span>
</span><span id="line-383"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>                         </span><span class="hs-comment">-- ^ Original window (to be decorated)</span><span>
</span><span id="line-384"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>                      </span><span class="hs-comment">-- ^ Decoration rectangle</span><span>
</span><span id="line-385"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501203"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501202"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-386"></span><span id="mkDrawData"><span class="annot"><span class="annottext">mkDrawData :: forall (engine :: * -&gt; * -&gt; *) widget a.
(DecorationEngine engine widget a,
 ThemeAttributes (Theme engine widget),
 HasWidgets (Theme engine) widget) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; Window
-&gt; Rectangle
-&gt; X (DrawData engine widget)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#mkDrawData"><span class="hs-identifier hs-var hs-var">mkDrawData</span></a></span></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679500605"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500605"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679500604"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679500604"><span class="hs-identifier hs-var">decoState</span></a></span></span><span> </span><span id="local-6989586621679500603"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500603"><span class="hs-identifier hs-var">origWindow</span></a></span></span><span> </span><span id="local-6989586621679500602"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500602"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-comment">-- xmonad-contrib #809</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-comment">-- qutebrowser will happily shovel a 389K multiline string into @_NET_WM_NAME@</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-comment">-- and the 'defaultShrinker' (a) doesn't handle multiline strings well (b) is</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-comment">-- quadratic due to using 'init'</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679500601"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500601"><span class="hs-identifier hs-var">name</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2048</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\n'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X NamedWindow
</span><a href="XMonad.Util.NamedWindows.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500603"><span class="hs-identifier hs-var">origWindow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679500596"><span class="annot"><span class="annottext">Style (Theme engine widget)
</span><a href="#local-6989586621679500596"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall theme.
ThemeAttributes theme =&gt;
theme -&gt; Window -&gt; X (Style theme)
</span><a href="XMonad.Layout.DecorationEx.Common.html#selectWindowStyle"><span class="hs-identifier hs-var">selectWindowStyle</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500605"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500603"><span class="hs-identifier hs-var">origWindow</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-394"></span><span>                   </span><span class="annot"><span class="annottext">ddEngineState :: DecorationEngineState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddEngineState"><span class="hs-identifier hs-var">ddEngineState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679500604"><span class="hs-identifier hs-var">decoState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-395"></span><span>                   </span><span class="annot"><span class="annottext">ddStyle :: Style (Theme engine widget)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddStyle"><span class="hs-identifier hs-var">ddStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Style (Theme engine widget)
</span><a href="#local-6989586621679500596"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-396"></span><span>                   </span><span class="annot"><span class="annottext">ddOrigWindow :: Window
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddOrigWindow"><span class="hs-identifier hs-var">ddOrigWindow</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500603"><span class="hs-identifier hs-var">origWindow</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-397"></span><span>                   </span><span class="annot"><span class="annottext">ddWindowTitle :: String
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWindowTitle"><span class="hs-identifier hs-var">ddWindowTitle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500601"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-398"></span><span>                   </span><span class="annot"><span class="annottext">ddDecoRect :: Rectangle
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddDecoRect"><span class="hs-identifier hs-var">ddDecoRect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500602"><span class="hs-identifier hs-var">decoRect</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-399"></span><span>                   </span><span class="annot"><span class="annottext">ddWidgets :: WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgets"><span class="hs-identifier hs-var">ddWidgets</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
HasWidgets theme widget =&gt;
theme widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Common.html#themeWidgets"><span class="hs-identifier hs-var">themeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500605"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>                   </span><span class="annot"><span class="annottext">ddWidgetPlaces :: WidgetLayout WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgetPlaces"><span class="hs-identifier hs-var">ddWidgetPlaces</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a] -&gt; WidgetLayout a
</span><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-var">WidgetLayout</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-401"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="hs-comment">-- | Mouse focus and mouse drag are handled by the same function, this</span><span>
</span><span id="line-404"></span><span class="hs-comment">-- way we can start dragging unfocused windows too.</span><span>
</span><span id="line-405"></span><span id="local-6989586621679501143"><span id="local-6989586621679501144"><span id="local-6989586621679501145"><span id="local-6989586621679501146"><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#handleMouseFocusDrag"><span class="hs-identifier hs-type">handleMouseFocusDrag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501146"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501145"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501144"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501143"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501146"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501145"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501144"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501146"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501145"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501146"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501143"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-406"></span><span id="handleMouseFocusDrag"><span class="annot"><span class="annottext">handleMouseFocusDrag :: forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; DecorationLayoutState engine
-&gt; shrinker
-&gt; Event
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#handleMouseFocusDrag"><span class="hs-identifier hs-var hs-var">handleMouseFocusDrag</span></a></span></span><span> </span><span id="local-6989586621679500564"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500564"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679500563"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500563"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679500562"><span class="annot"><span class="annottext">[WindowDecoration]
dsDecorations :: [WindowDecoration]
dsDecorations :: forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="#local-6989586621679500562"><span class="hs-identifier hs-var hs-var">dsDecorations</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">shrinker
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonEvent</span></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679500560"><span class="annot"><span class="annottext">Window
ev_window :: Event -&gt; Window
ev_window :: Window
</span><span class="hs-identifier hs-var hs-var">ev_window</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500558"><span class="annot"><span class="annottext">CInt
ev_x_root :: Event -&gt; CInt
ev_x_root :: CInt
</span><span class="hs-identifier hs-var hs-var">ev_x_root</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500556"><span class="annot"><span class="annottext">CInt
ev_y_root :: Event -&gt; CInt
ev_y_root :: CInt
</span><span class="hs-identifier hs-var hs-var">ev_y_root</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500554"><span class="annot"><span class="annottext">Dimension
ev_event_type :: Event -&gt; Dimension
ev_event_type :: Dimension
</span><span class="hs-identifier hs-var hs-var">ev_event_type</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500552"><span class="annot"><span class="annottext">Dimension
ev_button :: Event -&gt; Dimension
ev_button :: Dimension
</span><span class="hs-identifier hs-var hs-var">ev_button</span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500554"><span class="hs-identifier hs-var">ev_event_type</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">buttonPress</span></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679500544"><span id="local-6989586621679500545"><span id="local-6989586621679500546"><span id="local-6989586621679500547"><span id="local-6989586621679500548"><span class="annot"><span class="annottext">[WidgetPlace]
Maybe Window
Maybe Rectangle
Window
Rectangle
wdWidgets :: WindowDecoration -&gt; [WidgetPlace]
wdDecoRect :: WindowDecoration -&gt; Maybe Rectangle
wdDecoWindow :: WindowDecoration -&gt; Maybe Window
wdOrigWinRect :: WindowDecoration -&gt; Rectangle
wdOrigWindow :: WindowDecoration -&gt; Window
wdWidgets :: [WidgetPlace]
wdDecoRect :: Maybe Rectangle
wdDecoWindow :: Maybe Window
wdOrigWinRect :: Rectangle
wdOrigWindow :: Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdWidgets"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; [WindowDecoration] -&gt; Maybe WindowDecoration
</span><a href="XMonad.Layout.DecorationEx.Engine.html#findDecoDataByDecoWindow"><span class="hs-identifier hs-var">findDecoDataByDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500560"><span class="hs-identifier hs-var">ev_window</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679500562"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500537"><span class="annot"><span class="annottext">decoRect :: Rectangle
</span><a href="#local-6989586621679500537"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span id="local-6989586621679500536"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500536"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span id="local-6989586621679500535"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500535"><span class="hs-identifier hs-var">dy</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679500545"><span class="hs-identifier hs-var">wdDecoRect</span></a></span><span>
</span><span id="line-410"></span><span>            </span><span id="local-6989586621679500533"><span class="annot"><span class="annottext">x :: Int
</span><a href="#local-6989586621679500533"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500558"><span class="hs-identifier hs-var">ev_x_root</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500536"><span class="hs-identifier hs-var">dx</span></a></span><span>
</span><span id="line-411"></span><span>            </span><span id="local-6989586621679500532"><span class="annot"><span class="annottext">y :: Int
</span><a href="#local-6989586621679500532"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500556"><span class="hs-identifier hs-var">ev_y_root</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500535"><span class="hs-identifier hs-var">dy</span></a></span><span>
</span><span id="line-412"></span><span>            </span><span id="local-6989586621679500531"><span class="annot"><span class="annottext">button :: Int
</span><a href="#local-6989586621679500531"><span class="hs-identifier hs-var hs-var">button</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500552"><span class="hs-identifier hs-var">ev_button</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span id="local-6989586621679500530"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500530"><span class="hs-identifier hs-var">dealtWith</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; Rectangle
-&gt; [Rectangle]
-&gt; Window
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; X Bool
</span><a href="XMonad.Layout.DecorationEx.Engine.html#handleDecorationClick"><span class="hs-identifier hs-var">handleDecorationClick</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500564"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500563"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500537"><span class="hs-identifier hs-var">decoRect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WidgetPlace -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wpRectangle"><span class="hs-identifier hs-var">wpRectangle</span></a></span><span> </span><span class="annot"><span class="annottext">[WidgetPlace]
</span><a href="#local-6989586621679500544"><span class="hs-identifier hs-var">wdWidgets</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500548"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500533"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500532"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500531"><span class="hs-identifier hs-var">button</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500530"><span class="hs-identifier hs-var">dealtWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
ClickHandler theme widget =&gt;
theme widget -&gt; Int -&gt; Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#isDraggingEnabled"><span class="hs-identifier hs-var">isDraggingEnabled</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500563"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500531"><span class="hs-identifier hs-var">button</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-415"></span><span>            </span><span class="annot"><span class="annottext">(Position -&gt; Position -&gt; X ()) -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">mouseDrag</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679500527"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500527"><span class="hs-identifier hs-var">dragX</span></a></span></span><span> </span><span id="local-6989586621679500526"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500526"><span class="hs-identifier hs-var">dragY</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500548"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; CInt
-&gt; CInt
-&gt; (Window, Rectangle)
-&gt; Position
-&gt; Position
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#decorationWhileDraggingHook"><span class="hs-identifier hs-var">decorationWhileDraggingHook</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500564"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500558"><span class="hs-identifier hs-var">ev_x_root</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679500556"><span class="hs-identifier hs-var">ev_y_root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500548"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500547"><span class="hs-identifier hs-var">wdOrigWinRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500527"><span class="hs-identifier hs-var">dragX</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500526"><span class="hs-identifier hs-var">dragY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a -&gt; (Window, Rectangle) -&gt; Window -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#decorationAfterDraggingHook"><span class="hs-identifier hs-var">decorationAfterDraggingHook</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679500564"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500548"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500547"><span class="hs-identifier hs-var">wdOrigWinRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500560"><span class="hs-identifier hs-var">ev_window</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#handleMouseFocusDrag"><span class="hs-identifier hs-var">handleMouseFocusDrag</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span class="hs-comment">-- | Given a window and the state, if a matching decoration is in the</span><span>
</span><span id="line-420"></span><span class="hs-comment">-- state return it with its ('Maybe') 'Rectangle'.</span><span>
</span><span id="line-421"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#findDecoDataByDecoWindow"><span class="hs-identifier hs-type">findDecoDataByDecoWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span>
</span><span id="line-422"></span><span id="findDecoDataByDecoWindow"><span class="annot"><span class="annottext">findDecoDataByDecoWindow :: Window -&gt; [WindowDecoration] -&gt; Maybe WindowDecoration
</span><a href="XMonad.Layout.DecorationEx.Engine.html#findDecoDataByDecoWindow"><span class="hs-identifier hs-var hs-var">findDecoDataByDecoWindow</span></a></span></span><span> </span><span id="local-6989586621679500525"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500525"><span class="hs-identifier hs-var">decoWin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679500523"><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679500523"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679500523"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500525"><span class="hs-identifier hs-var">decoWin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#decorationHandler"><span class="hs-identifier hs-type">decorationHandler</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679501142"><span class="annot"><a href="#local-6989586621679501142"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679501141"><span class="annot"><a href="#local-6989586621679501141"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span id="local-6989586621679501140"><span class="annot"><a href="#local-6989586621679501140"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-425"></span><span>                     </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501142"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501141"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501140"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-426"></span><span>                      </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#ClickHandler"><span class="hs-identifier hs-type">ClickHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501142"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679501141"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>                  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501142"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501141"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501140"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-428"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501142"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501141"><span class="hs-identifier hs-type">widget</span></a></span><span>
</span><span id="line-429"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-430"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">]</span><span>
</span><span id="line-431"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-432"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-433"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-434"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-435"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-436"></span><span id="decorationHandler"><span class="annot"><span class="annottext">decorationHandler :: forall (engine :: * -&gt; * -&gt; *) widget a.
(DecorationEngine engine widget a,
 ClickHandler (Theme engine) widget) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; Rectangle
-&gt; [Rectangle]
-&gt; Window
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; X Bool
</span><a href="XMonad.Layout.DecorationEx.Engine.html#decorationHandler"><span class="hs-identifier hs-var hs-var">decorationHandler</span></a></span></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679500503"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500503"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679500502"><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679500502"><span class="hs-identifier hs-var">widgetPlaces</span></a></span></span><span> </span><span id="local-6989586621679500501"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500501"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span id="local-6989586621679500500"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500500"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679500499"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500499"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679500498"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500498"><span class="hs-identifier hs-var">button</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679500497"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500497"><span class="hs-identifier hs-var">widgetDone</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(widget, Rectangle)] -&gt; X Bool
</span><a href="#local-6989586621679500496"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. WidgetLayout a -&gt; [a]
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetLayout"><span class="hs-identifier hs-var">widgetLayout</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
HasWidgets theme widget =&gt;
theme widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Common.html#themeWidgets"><span class="hs-identifier hs-var">themeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500503"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679500502"><span class="hs-identifier hs-var">widgetPlaces</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500497"><span class="hs-identifier hs-var">widgetDone</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
ClickHandler theme widget =&gt;
theme widget -&gt; Int -&gt; Maybe (WidgetCommand widget)
</span><a href="XMonad.Layout.DecorationEx.Common.html#onDecorationClick"><span class="hs-identifier hs-var">onDecorationClick</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679500503"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500498"><span class="hs-identifier hs-var">button</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-441"></span><span>             </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679500493"><span class="annot"><span class="annottext">WidgetCommand widget
</span><a href="#local-6989586621679500493"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-442"></span><span>               </span><span class="annot"><span class="annottext">forall cmd. WindowCommand cmd =&gt; cmd -&gt; Window -&gt; X Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#executeWindowCommand"><span class="hs-identifier hs-var">executeWindowCommand</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetCommand widget
</span><a href="#local-6989586621679500493"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500501"><span class="hs-identifier hs-var">window</span></a></span><span>
</span><span id="line-443"></span><span>             </span><span class="annot"><span class="annottext">Maybe (WidgetCommand widget)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-444"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>    </span><span class="annot"><a href="#local-6989586621679500496"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679501141"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-446"></span><span>    </span><span id="local-6989586621679500496"><span class="annot"><span class="annottext">go :: [(widget, Rectangle)] -&gt; X Bool
</span><a href="#local-6989586621679500496"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-447"></span><span>    </span><span class="annot"><a href="#local-6989586621679500496"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679500491"><span class="annot"><span class="annottext">widget
</span><a href="#local-6989586621679500491"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500490"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500490"><span class="hs-identifier hs-var">rect</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679500489"><span class="annot"><span class="annottext">[(widget, Rectangle)]
</span><a href="#local-6989586621679500489"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-448"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; Rectangle -&gt; Bool
</span><span class="hs-identifier hs-var">pointWithin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500500"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500499"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679500490"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-449"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-450"></span><span>          </span><span class="annot"><span class="annottext">forall cmd. WindowCommand cmd =&gt; cmd -&gt; Window -&gt; X Bool
</span><a href="XMonad.Layout.DecorationEx.Common.html#executeWindowCommand"><span class="hs-identifier hs-var">executeWindowCommand</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall widget.
DecorationWidget widget =&gt;
widget -&gt; Int -&gt; WidgetCommand widget
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetCommand"><span class="hs-identifier hs-var">widgetCommand</span></a></span><span> </span><span class="annot"><span class="annottext">widget
</span><a href="#local-6989586621679500491"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679500498"><span class="hs-identifier hs-var">button</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500501"><span class="hs-identifier hs-var">window</span></a></span><span>
</span><span id="line-451"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">[(widget, Rectangle)] -&gt; X Bool
</span><a href="#local-6989586621679500496"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[(widget, Rectangle)]
</span><a href="#local-6989586621679500489"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Simple implementation of @paintDecoration@ method.</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- This is used by @TextEngine@ and can be re-used by other decoration</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- engines.</span><span>
</span><span id="line-456"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#paintDecorationSimple"><span class="hs-identifier hs-type">paintDecorationSimple</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679501071"><span class="annot"><a href="#local-6989586621679501071"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679501067"><span class="annot"><a href="#local-6989586621679501067"><span class="hs-identifier hs-type">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501070"><span class="annot"><a href="#local-6989586621679501070"><span class="hs-identifier hs-type">widget</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-457"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501071"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501070"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span>
</span><span id="line-458"></span><span>                           </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationPaintingContext"><span class="hs-identifier hs-type">DecorationPaintingContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501071"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#XPaintingContext"><span class="hs-identifier hs-type">XPaintingContext</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-459"></span><span>                           </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501067"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-460"></span><span>                           </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501071"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501070"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#SimpleStyle"><span class="hs-identifier hs-type">SimpleStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>                       </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501071"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501070"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-462"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-463"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>
</span><span id="line-464"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dimension</span></span><span>
</span><span id="line-465"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679501067"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-466"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DrawData"><span class="hs-identifier hs-type">DrawData</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501071"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679501070"><span class="hs-identifier hs-type">widget</span></a></span><span>
</span><span id="line-467"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-468"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span id="paintDecorationSimple"><span class="annot"><span class="annottext">paintDecorationSimple :: forall (engine :: * -&gt; * -&gt; *) shrinker widget.
(DecorationEngine engine widget Window,
 DecorationPaintingContext engine ~ XPaintingContext,
 Shrinker shrinker, Style (Theme engine widget) ~ SimpleStyle) =&gt;
engine widget Window
-&gt; Window
-&gt; Dimension
-&gt; Dimension
-&gt; shrinker
-&gt; DrawData engine widget
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#paintDecorationSimple"><span class="hs-identifier hs-var hs-var">paintDecorationSimple</span></a></span></span><span> </span><span id="local-6989586621679500418"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679500418"><span class="hs-identifier hs-var">deco</span></a></span></span><span> </span><span id="local-6989586621679500417"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500417"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679500416"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span></span><span> </span><span id="local-6989586621679500415"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span></span><span> </span><span id="local-6989586621679500414"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679500414"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679500413"><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500413"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span id="local-6989586621679500412"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500412"><span class="hs-identifier hs-var">isExpose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-470"></span><span>    </span><span id="local-6989586621679500411"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Display
</span><span class="hs-identifier hs-var">display</span></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500410"><span class="annot"><span class="annottext">widgets :: [widget]
</span><a href="#local-6989586621679500410"><span class="hs-identifier hs-var hs-var">widgets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. WidgetLayout a -&gt; [a]
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetLayout"><span class="hs-identifier hs-var">widgetLayout</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgets"><span class="hs-identifier hs-var">ddWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500413"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-472"></span><span>        </span><span id="local-6989586621679500409"><span class="annot"><span class="annottext">style :: Style (Theme engine widget)
</span><a href="#local-6989586621679500409"><span class="hs-identifier hs-var hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; Style (Theme engine widget)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddStyle"><span class="hs-identifier hs-var">ddStyle</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500413"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-473"></span><span>    </span><span id="local-6989586621679500408"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; Dimension -&gt; Dimension -&gt; CInt -&gt; IO Window
</span><span class="hs-identifier hs-var">createPixmap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500417"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen -&gt; CInt
</span><span class="hs-identifier hs-var">defaultDepthOfScreen</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Screen
</span><span class="hs-identifier hs-var">defaultScreenOfDisplay</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>    </span><span id="local-6989586621679500404"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO GC
</span><span class="hs-identifier hs-var">createGC</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-comment">-- draw</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">setGraphicsExposures</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621679500401"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500401"><span class="hs-identifier hs-var">bgColor</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(Functor m, MonadIO m) =&gt;
Display -&gt; String -&gt; m Window
</span><a href="XMonad.Util.Font.html#stringToPixel"><span class="hs-identifier hs-var">stringToPixel</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SimpleStyle -&gt; String
</span><a href="XMonad.Layout.DecorationEx.Common.html#sBgColor"><span class="hs-identifier hs-var">sBgColor</span></a></span><span> </span><span class="annot"><span class="annottext">Style (Theme engine widget)
</span><a href="#local-6989586621679500409"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-comment">-- we start with the border</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679500398"><span class="annot"><span class="annottext">borderWidth :: Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var hs-var">borderWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleStyle -&gt; Dimension
</span><a href="XMonad.Layout.DecorationEx.Common.html#sDecoBorderWidth"><span class="hs-identifier hs-var">sDecoBorderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Style (Theme engine widget)
</span><a href="#local-6989586621679500409"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-480"></span><span>        </span><span id="local-6989586621679500396"><span class="annot"><span class="annottext">borderColors :: BorderColors
</span><a href="#local-6989586621679500396"><span class="hs-identifier hs-var hs-var">borderColors</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SimpleStyle -&gt; BorderColors
</span><a href="XMonad.Layout.DecorationEx.Common.html#sDecorationBorders"><span class="hs-identifier hs-var">sDecorationBorders</span></a></span><span> </span><span class="annot"><span class="annottext">Style (Theme engine widget)
</span><a href="#local-6989586621679500409"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
MonadIO m =&gt;
Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; String
-&gt; m ()
</span><a href="#local-6989586621679500394"><span class="hs-identifier hs-var">drawLineWith</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxTop"><span class="hs-identifier hs-var">bxTop</span></a></span><span> </span><span class="annot"><span class="annottext">BorderColors
</span><a href="#local-6989586621679500396"><span class="hs-identifier hs-var">borderColors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
MonadIO m =&gt;
Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; String
-&gt; m ()
</span><a href="#local-6989586621679500394"><span class="hs-identifier hs-var">drawLineWith</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxLeft"><span class="hs-identifier hs-var">bxLeft</span></a></span><span> </span><span class="annot"><span class="annottext">BorderColors
</span><a href="#local-6989586621679500396"><span class="hs-identifier hs-var">borderColors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
MonadIO m =&gt;
Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; String
-&gt; m ()
</span><a href="#local-6989586621679500394"><span class="hs-identifier hs-var">drawLineWith</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxBottom"><span class="hs-identifier hs-var">bxBottom</span></a></span><span> </span><span class="annot"><span class="annottext">BorderColors
</span><a href="#local-6989586621679500396"><span class="hs-identifier hs-var">borderColors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>      </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}.
MonadIO m =&gt;
Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; String
-&gt; m ()
</span><a href="#local-6989586621679500394"><span class="hs-identifier hs-var">drawLineWith</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. BoxBorders a -&gt; a
</span><a href="XMonad.Layout.DecorationEx.Common.html#bxRight"><span class="hs-identifier hs-var">bxRight</span></a></span><span> </span><span class="annot"><span class="annottext">BorderColors
</span><a href="#local-6989586621679500396"><span class="hs-identifier hs-var">borderColors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-comment">-- and now again</span><span>
</span><span id="line-488"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500401"><span class="hs-identifier hs-var">bgColor</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><span class="hs-identifier hs-var">fillRectangle</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500398"><span class="hs-identifier hs-var">borderWidth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-comment">-- paint strings</span><span>
</span><span id="line-492"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[widget]
</span><a href="#local-6989586621679500410"><span class="hs-identifier hs-var">widgets</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. WidgetLayout a -&gt; [a]
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetLayout"><span class="hs-identifier hs-var">widgetLayout</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DrawData engine widget -&gt; WidgetLayout WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgetPlaces"><span class="hs-identifier hs-var">ddWidgetPlaces</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500413"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679500389"><span class="annot"><span class="annottext">widget
</span><a href="#local-6989586621679500389"><span class="hs-identifier hs-var">widget</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679500388"><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500388"><span class="hs-identifier hs-var">place</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-493"></span><span>        </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; DecorationPaintingContext engine
-&gt; WidgetPlace
-&gt; shrinker
-&gt; DrawData engine widget
-&gt; widget
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#paintWidget"><span class="hs-identifier hs-var">paintWidget</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679500418"><span class="hs-identifier hs-var">deco</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WidgetPlace
</span><a href="#local-6989586621679500388"><span class="hs-identifier hs-var">place</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679500414"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679500413"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">widget
</span><a href="#local-6989586621679500389"><span class="hs-identifier hs-var">widget</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679500412"><span class="hs-identifier hs-var">isExpose</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span>    </span><span class="hs-comment">-- debug</span><span>
</span><span id="line-496"></span><span>    </span><span class="hs-comment">-- black &lt;- stringToPixel dpy &quot;black&quot;</span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-comment">-- io $ setForeground dpy gc black</span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-comment">-- forM_ (ddWidgetPlaces dd) $ \(WidgetPlace {wpRectangle = Rectangle x y w h}) -&gt;</span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-comment">--   io $ drawRectangle dpy pixmap gc x y w h</span><span>
</span><span id="line-500"></span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-comment">-- copy the pixmap over the window</span><span>
</span><span id="line-502"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; Position
-&gt; Position
-&gt; IO ()
</span><span class="hs-identifier hs-var">copyArea</span></span><span>      </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500417"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500416"><span class="hs-identifier hs-var">windowWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500415"><span class="hs-identifier hs-var">windowHeight</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-comment">-- free the pixmap and GC</span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">freePixmap</span></span><span>    </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500408"><span class="hs-identifier hs-var">pixmap</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; IO ()
</span><span class="hs-identifier hs-var">freeGC</span></span><span>        </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500411"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500404"><span class="hs-identifier hs-var">gc</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621679500394"><span class="annot"><span class="annottext">drawLineWith :: Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; String
-&gt; m ()
</span><a href="#local-6989586621679500394"><span class="hs-identifier hs-var hs-var">drawLineWith</span></a></span></span><span> </span><span id="local-6989586621679500371"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500371"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span id="local-6989586621679500370"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500370"><span class="hs-identifier hs-var">pixmap</span></a></span></span><span> </span><span id="local-6989586621679500369"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500369"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span id="local-6989586621679500368"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500368"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679500367"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500367"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679500366"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500366"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679500365"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500365"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679500364"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500364"><span class="hs-identifier hs-var">colorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-508"></span><span>      </span><span id="local-6989586621679500363"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500363"><span class="hs-identifier hs-var">color</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(Functor m, MonadIO m) =&gt;
Display -&gt; String -&gt; m Window
</span><a href="XMonad.Util.Font.html#stringToPixel"><span class="hs-identifier hs-var">stringToPixel</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500371"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679500364"><span class="hs-identifier hs-var">colorName</span></a></span><span>
</span><span id="line-509"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500371"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500369"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500363"><span class="hs-identifier hs-var">color</span></a></span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><span class="hs-identifier hs-var">fillRectangle</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679500371"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679500370"><span class="hs-identifier hs-var">pixmap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679500369"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500368"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679500367"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500366"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679500365"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span></pre></body></html>