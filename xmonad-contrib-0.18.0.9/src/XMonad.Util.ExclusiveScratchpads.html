<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  XMonad.Util.ExclusiveScratchpads</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Description :  Named scratchpads that can be mutually exclusive.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  Bruce Forte (2017)</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  :  Bruce Forte</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Named scratchpads that can be mutually exclusive.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Util.ExclusiveScratchpads</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">&quot;Use the exclusive scratchpad functionality of \&quot;XMonad.Util.NamedScratchpad\&quot; insead.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#mkXScratchpads"><span class="hs-identifier">mkXScratchpads</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#xScratchpadsManageHook"><span class="hs-identifier">xScratchpadsManageHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Keyboard related</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#scratchpadAction"><span class="hs-identifier">scratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#hideAll"><span class="hs-identifier">hideAll</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#resetExclusiveSp"><span class="hs-identifier">resetExclusiveSp</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Mouse related</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#setNoexclusive"><span class="hs-identifier">setNoexclusive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#resizeNoexclusive"><span class="hs-identifier">resizeNoexclusive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#floatMoveNoexclusive"><span class="hs-identifier">floatMoveNoexclusive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpad"><span class="hs-identifier">ExclusiveScratchpad</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier">ExclusiveScratchpads</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Hooks</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#nonFloating"><span class="hs-identifier">nonFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#defaultFloating"><span class="hs-identifier">defaultFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#customFloating"><span class="hs-identifier">customFloating</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.Minimize.html"><span class="hs-identifier">XMonad.Actions.Minimize</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.TagWindows.html"><span class="hs-identifier">XMonad.Actions.TagWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TagWindows.html#addTag"><span class="hs-identifier">addTag</span></a></span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Actions.TagWindows.html#delTag"><span class="hs-identifier">delTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html"><span class="hs-identifier">XMonad.Hooks.ManageHelpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier">doRectFloat</span></a></span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier">isInProperty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- For this module to work properly, you need to use &quot;XMonad.Layout.BoringWindows&quot; and</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- &quot;XMonad.Layout.Minimize&quot;, please refer to the documentation of these modules for more</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- information on how to configure them.</span><span>
</span><span id="line-56"></span><span class="hs-comment">--</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- To use this module, put the following in your @xmonad.hs@:</span><span>
</span><span id="line-58"></span><span class="hs-comment">--</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- &gt; import XMonad.Utils.ExclusiveScratchpads</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- &gt; import XMonad.ManageHook (title,appName)</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt; import qualified XMonad.StackSet as W</span><span>
</span><span id="line-62"></span><span class="hs-comment">--</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- Add exclusive scratchpads, for example:</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt; exclusiveSps = mkXScratchpads [ (&quot;htop&quot;,   &quot;urxvt -name htop -e htop&quot;, title =? &quot;htop&quot;)</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &gt;                               , (&quot;xclock&quot;, &quot;xclock&quot;, appName =? &quot;xclock&quot;)</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- &gt;                               ] $ customFloating $ W.RationalRect (1/4) (1/4) (1/2) (1/2)</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- The scratchpads don\'t have to be exclusive, you can create them like this (see 'ExclusiveScratchpad'):</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt; regularSps   = [ XSP &quot;term&quot; &quot;urxvt -name scratchpad&quot; (appName =? &quot;scratchpad&quot;) defaultFloating [] ]</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Create a list that contains all your scratchpads like this:</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- &gt; scratchpads = exclusiveSps ++ regularSps</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Add the hooks to your managehook (see &quot;XMonad.Doc.Extending#Editing_the_manage_hook&quot; or</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &lt;https://xmonad.org/TUTORIAL.html#final-touches the tutorial&gt;); e.g.,</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- &gt; manageHook = myManageHook &lt;&gt; xScratchpadsManageHook scratchpads</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- And finally add some keybindings (see &lt;https://xmonad.org/TUTORIAL.html#customizing-xmonad the tutorial&gt;):</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- &gt; , ((modMask, xK_h), scratchpadAction scratchpads &quot;htop&quot;)</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- &gt; , ((modMask, xK_c), scratchpadAction scratchpads &quot;xclock&quot;)</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt; , ((modMask, xK_t), scratchpadAction scratchpads &quot;term&quot;)</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt; , ((modMask, xK_h), hideAll scratchpads)</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- Now you can get your scratchpads by pressing the corresponding keys, if you</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- have the @htop@ scratchpad on your current screen and you fetch the @xclock@</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- scratchpad then @htop@ gets hidden.</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- If you move a scratchpad it still gets hidden when you fetch a scratchpad of</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- the same family, to change that behaviour and make windows not exclusive</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- anymore when they get resized or moved add these mouse bindings</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- (see &quot;XMonad.Doc.Extending#Editing_mouse_bindings&quot;):</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- &gt;     , ((mod4Mask, button1), floatMoveNoexclusive scratchpads)</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt;     , ((mod4Mask, button3), resizeNoexclusive scratchpads)</span><span>
</span><span id="line-100"></span><span class="hs-comment">--</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- To reset a moved scratchpad to the original position that you set with its hook,</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- call @resetExclusiveSp@ when it is in focus. For example if you want to extend</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Mod-Return to reset the placement when a scratchpad is in focus but keep the</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- default behaviour for tiled windows, set these key bindings:</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- &gt; , ((modMask, xK_Return), windows W.swapMaster &gt;&gt; resetExclusiveSp scratchpads)</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- __Note:__ This is just an example, in general you can add more than two</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- exclusive scratchpads and multiple families of such.</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-keyword">data</span><span> </span><span id="ExclusiveScratchpad"><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpad"><span class="hs-identifier hs-var">ExclusiveScratchpad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XSP"><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#XSP"><span class="hs-identifier hs-var">XSP</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="name"><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Name of the scratchpad</span><span>
</span><span id="line-112"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="cmd"><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#cmd"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>       </span><span class="hs-comment">-- ^ Command to spawn the scratchpad</span><span>
</span><span id="line-113"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="query"><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>   </span><span class="hs-comment">-- ^ Query to match the scratchpad</span><span>
</span><span id="line-114"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="hook"><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hook"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>   </span><span class="hs-comment">-- ^ Hook to specify the placement policy</span><span>
</span><span id="line-115"></span><span>                               </span><span class="hs-special">,</span><span> </span><span id="exclusive"><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; [String]
</span><a href="XMonad.Util.ExclusiveScratchpads.html#exclusive"><span class="hs-identifier hs-var hs-var">exclusive</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Names of exclusive scratchpads</span><span>
</span><span id="line-116"></span><span>                               </span><span class="hs-special">}</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-keyword">type</span><span> </span><span id="ExclusiveScratchpads"><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-var">ExclusiveScratchpads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpad"><span class="hs-identifier hs-type">ExclusiveScratchpad</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- -----------------------------------------------------------------------------------</span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="hs-comment">-- | Create 'ExclusiveScratchpads' from @[(name,cmd,query)]@ with a common @hook@</span><span>
</span><span id="line-123"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#mkXScratchpads"><span class="hs-identifier hs-type">mkXScratchpads</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ List of @(name,cmd,query)@ of the</span><span>
</span><span id="line-124"></span><span>                                                </span><span class="hs-comment">--   exclusive scratchpads</span><span>
</span><span id="line-125"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>                    </span><span class="hs-comment">-- ^ The common @hook@ that they use</span><span>
</span><span id="line-126"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>
</span><span id="line-127"></span><span id="mkXScratchpads"><span class="annot"><span class="annottext">mkXScratchpads :: [(String, String, Query Bool)]
-&gt; ManageHook -&gt; ExclusiveScratchpads
</span><a href="XMonad.Util.ExclusiveScratchpads.html#mkXScratchpads"><span class="hs-identifier hs-var hs-var">mkXScratchpads</span></a></span></span><span> </span><span id="local-6989586621679477362"><span class="annot"><span class="annottext">[(String, String, Query Bool)]
</span><a href="#local-6989586621679477362"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477361"><span class="annot"><span class="annottext">ManageHook
</span><a href="#local-6989586621679477361"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
-&gt; (String, String, Query Bool) -&gt; ExclusiveScratchpads
</span><a href="#local-6989586621679477359"><span class="hs-identifier hs-var">accumulate</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[(String, String, Query Bool)]
</span><a href="#local-6989586621679477362"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>    </span><span id="local-6989586621679477359"><span class="annot"><span class="annottext">accumulate :: ExclusiveScratchpads
-&gt; (String, String, Query Bool) -&gt; ExclusiveScratchpads
</span><a href="#local-6989586621679477359"><span class="hs-identifier hs-var hs-var">accumulate</span></a></span></span><span> </span><span id="local-6989586621679477356"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477356"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679477355"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477355"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679477354"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477354"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679477353"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477353"><span class="hs-identifier hs-var">q</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; Query Bool
-&gt; ManageHook
-&gt; [String]
-&gt; ExclusiveScratchpad
</span><a href="XMonad.Util.ExclusiveScratchpads.html#XSP"><span class="hs-identifier hs-var">XSP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477355"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477354"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477353"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">ManageHook
</span><a href="#local-6989586621679477361"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477355"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679477351"><span class="hs-identifier hs-var">names</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477356"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-130"></span><span>    </span><span id="local-6989586621679477351"><span class="annot"><span class="annottext">names :: [String]
</span><a href="#local-6989586621679477351"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679477350"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477350"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Query Bool
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477350"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(String, String, Query Bool)]
</span><a href="#local-6989586621679477362"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-comment">-- | Create 'ManageHook' from 'ExclusiveScratchpads'</span><span>
</span><span id="line-133"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#xScratchpadsManageHook"><span class="hs-identifier hs-type">xScratchpadsManageHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>  </span><span class="hs-comment">-- ^ List of exclusive scratchpads from</span><span>
</span><span id="line-134"></span><span>                                                </span><span class="hs-comment">--   which a 'ManageHook' should be generated</span><span>
</span><span id="line-135"></span><span>                       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-136"></span><span id="xScratchpadsManageHook"><span class="annot"><span class="annottext">xScratchpadsManageHook :: ExclusiveScratchpads -&gt; ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#xScratchpadsManageHook"><span class="hs-identifier hs-var hs-var">xScratchpadsManageHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall m. Monoid m =&gt; [m] -&gt; m
</span><span class="hs-identifier hs-var">composeAll</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679477347"><span class="annot"><span class="annottext">ExclusiveScratchpad
</span><a href="#local-6989586621679477347"><span class="hs-identifier hs-var">sp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad
</span><a href="#local-6989586621679477347"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. (Monad m, Monoid a) =&gt; m Bool -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">--&gt;</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hook"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad
</span><a href="#local-6989586621679477347"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Pop up/hide the scratchpad by name and possibly hide its exclusive</span><span>
</span><span id="line-139"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#scratchpadAction"><span class="hs-identifier hs-type">scratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>  </span><span class="hs-comment">-- ^ List of exclusive scratchpads</span><span>
</span><span id="line-140"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                </span><span class="hs-comment">-- ^ Name of the scratchpad to toggle</span><span>
</span><span id="line-141"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span id="scratchpadAction"><span class="annot"><span class="annottext">scratchpadAction :: ExclusiveScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#scratchpadAction"><span class="hs-identifier hs-var hs-var">scratchpadAction</span></a></span></span><span> </span><span id="local-6989586621679477345"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477345"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477344"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477344"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679477341"><span class="annot"><span class="annottext">ys :: ExclusiveScratchpads
</span><a href="#local-6989586621679477341"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477344"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#name"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477345"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477341"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>             </span><span class="hs-special">(</span><span id="local-6989586621679477340"><span class="annot"><span class="annottext">ExclusiveScratchpad
</span><a href="#local-6989586621679477340"><span class="hs-identifier hs-var">sp</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679477339"><span class="annot"><span class="annottext">q :: Query Bool
</span><a href="#local-6989586621679477339"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad
</span><a href="#local-6989586621679477340"><span class="hs-identifier hs-var">sp</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679477337"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679477337"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>                       </span><span id="local-6989586621679477336"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679477336"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477339"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a i l s sd. Eq a =&gt; StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.allWindows</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679477337"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span>                       </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679477336"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ()
</span><span class="hs-identifier hs-var">spawn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad
</span><a href="#local-6989586621679477340"><span class="hs-identifier hs-var">sp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>                                              </span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hideOthers"><span class="hs-identifier hs-var">hideOthers</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477345"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477344"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-151"></span><span>                                              </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftMaster</span></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span>                                  </span><span class="hs-special">(</span><span id="local-6989586621679477328"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477328"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679477327"><span class="hs-identifier hs-var">toggleWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477328"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-154"></span><span>                                              </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isExclusive"><span class="hs-identifier hs-var">isExclusive</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477328"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hideOthers"><span class="hs-identifier hs-var">hideOthers</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477345"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477344"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>    </span><span id="local-6989586621679477327"><span class="annot"><span class="annottext">toggleWindow :: Window -&gt; X ()
</span><a href="#local-6989586621679477327"><span class="hs-identifier hs-var hs-var">toggleWindow</span></a></span></span><span> </span><span id="local-6989586621679477312"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">(&amp;&amp;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isMaximized"><span class="hs-identifier hs-var">isMaximized</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X Bool
</span><a href="#local-6989586621679477308"><span class="hs-identifier hs-var">onCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X Bool
</span><a href="#local-6989586621679477308"><span class="hs-identifier hs-var">onCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Actions.Minimize.html#minimizeWindow"><span class="hs-identifier hs-var">minimizeWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                  </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Actions.Minimize.html#maximizeWindowAndFocus"><span class="hs-identifier hs-var">maximizeWindowAndFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477312"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-160"></span><span>                  </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftMaster</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>    </span><span id="local-6989586621679477308"><span class="annot"><span class="annottext">onCurrentScreen :: Window -&gt; X Bool
</span><a href="#local-6989586621679477308"><span class="hs-identifier hs-var hs-var">onCurrentScreen</span></a></span></span><span> </span><span id="local-6989586621679477298"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477298"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477298"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [a]
</span><a href="XMonad.Util.ExclusiveScratchpads.html#currentWindows"><span class="hs-identifier hs-var">currentWindows</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Hide all 'ExclusiveScratchpads' on the current screen</span><span>
</span><span id="line-165"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#hideAll"><span class="hs-identifier hs-type">hideAll</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>  </span><span class="hs-comment">-- ^ List of exclusive scratchpads</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span id="hideAll"><span class="annot"><span class="annottext">hideAll :: ExclusiveScratchpads -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hideAll"><span class="hs-identifier hs-var hs-var">hideAll</span></a></span></span><span> </span><span id="local-6989586621679477295"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477295"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Bool -&gt; (Window -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#mapWithCurrentScreen"><span class="hs-identifier hs-var">mapWithCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477293"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Actions.Minimize.html#minimizeWindow"><span class="hs-identifier hs-var">minimizeWindow</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679477293"><span class="annot"><span class="annottext">q :: Query Bool
</span><a href="#local-6989586621679477293"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Query Bool] -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#joinQueries"><span class="hs-identifier hs-var">joinQueries</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477295"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isExclusive"><span class="hs-identifier hs-var">isExclusive</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isMaximized"><span class="hs-identifier hs-var">isMaximized</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | If the focused window is a scratchpad, the scratchpad gets reset to the original</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- placement specified with the hook and becomes exclusive again</span><span>
</span><span id="line-172"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#resetExclusiveSp"><span class="hs-identifier hs-type">resetExclusiveSp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span> </span><span class="hs-comment">-- ^ List of exclusive scratchpads</span><span>
</span><span id="line-173"></span><span>                 </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span id="resetExclusiveSp"><span class="annot"><span class="annottext">resetExclusiveSp :: ExclusiveScratchpads -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#resetExclusiveSp"><span class="hs-identifier hs-var hs-var">resetExclusiveSp</span></a></span></span><span> </span><span id="local-6989586621679477288"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477288"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679477286"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477286"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; Window -&gt; X Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isScratchpad"><span class="hs-identifier hs-var">isScratchpad</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477288"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477286"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679477283"><span class="annot"><span class="annottext">ys :: X ExclusiveScratchpads
</span><a href="#local-6989586621679477283"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477286"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477288"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><a href="#local-6989586621679477282"><span class="hs-identifier hs-var">unlessX</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ExclusiveScratchpads
</span><a href="#local-6989586621679477283"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679477279"><span class="annot"><span class="annottext">ManageHook
</span><a href="#local-6989586621679477279"><span class="hs-identifier hs-var">mh</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NE.head</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><a href="XMonad.Prelude.html#notEmpty"><span class="hs-identifier hs-var">notEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hook"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ExclusiveScratchpads
</span><a href="#local-6989586621679477283"><span class="hs-identifier hs-var">ys</span></a></span><span>  </span><span class="hs-comment">-- ys /= [], so `head` is fine</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679477276"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477276"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NE.head</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><a href="XMonad.Prelude.html#notEmpty"><span class="hs-identifier hs-var">notEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ExclusiveScratchpads
</span><a href="#local-6989586621679477283"><span class="hs-identifier hs-var">ys</span></a></span><span>  </span><span class="hs-comment">-- same</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">ManageHook
</span><a href="#local-6989586621679477279"><span class="hs-identifier hs-var">mh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477286"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hideOthers"><span class="hs-identifier hs-var">hideOthers</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477288"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477276"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X ()
</span><a href="XMonad.Actions.TagWindows.html#delTag"><span class="hs-identifier hs-var">delTag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_XSP_NOEXCLUSIVE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477286"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679477282"><span class="annot"><span class="annottext">unlessX :: X Bool -&gt; X () -&gt; X ()
</span><a href="#local-6989586621679477282"><span class="hs-identifier hs-var hs-var">unlessX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- -----------------------------------------------------------------------------------</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Hide the scratchpad of the same family by name if it's on the focused workspace</span><span>
</span><span id="line-190"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#hideOthers"><span class="hs-identifier hs-type">hideOthers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span id="hideOthers"><span class="annot"><span class="annottext">hideOthers :: ExclusiveScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#hideOthers"><span class="hs-identifier hs-var hs-var">hideOthers</span></a></span></span><span> </span><span id="local-6989586621679477271"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477271"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477270"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679477266"><span class="annot"><span class="annottext">ys :: [String]
</span><a href="#local-6989586621679477266"><span class="hs-identifier hs-var hs-var">ys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; [String]
</span><a href="XMonad.Util.ExclusiveScratchpads.html#exclusive"><span class="hs-identifier hs-var">exclusive</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679477270"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#name"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477271"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span id="local-6989586621679477261"><span class="annot"><span class="annottext">qs :: [Query Bool]
</span><a href="#local-6989586621679477261"><span class="hs-identifier hs-var hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679477266"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; String
</span><a href="XMonad.Util.ExclusiveScratchpads.html#name"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477271"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span id="local-6989586621679477258"><span class="annot"><span class="annottext">q :: Query Bool
</span><a href="#local-6989586621679477258"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Query Bool] -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#joinQueries"><span class="hs-identifier hs-var">joinQueries</span></a></span><span> </span><span class="annot"><span class="annottext">[Query Bool]
</span><a href="#local-6989586621679477261"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isExclusive"><span class="hs-identifier hs-var">isExclusive</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isMaximized"><span class="hs-identifier hs-var">isMaximized</span></a></span><span> </span><span class="hs-keyword">in</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">Query Bool -&gt; (Window -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#mapWithCurrentScreen"><span class="hs-identifier hs-var">mapWithCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477258"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Actions.Minimize.html#minimizeWindow"><span class="hs-identifier hs-var">minimizeWindow</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Conditionally map a function on all windows of the current screen</span><span>
</span><span id="line-199"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#mapWithCurrentScreen"><span class="hs-identifier hs-type">mapWithCurrentScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span id="mapWithCurrentScreen"><span class="annot"><span class="annottext">mapWithCurrentScreen :: Query Bool -&gt; (Window -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#mapWithCurrentScreen"><span class="hs-identifier hs-var hs-var">mapWithCurrentScreen</span></a></span></span><span> </span><span id="local-6989586621679477257"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477257"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679477256"><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679477256"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679477255"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679477255"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679477254"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679477254"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477257"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [a]
</span><a href="XMonad.Util.ExclusiveScratchpads.html#currentWindows"><span class="hs-identifier hs-var">currentWindows</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679477255"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679477256"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679477254"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Extract all windows on the current screen from a StackSet</span><span>
</span><span id="line-205"></span><span id="local-6989586621679477497"><span id="local-6989586621679477498"><span id="local-6989586621679477499"><span id="local-6989586621679477500"><span id="local-6989586621679477501"><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#currentWindows"><span class="hs-identifier hs-type">currentWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.StackSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679477501"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679477500"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679477499"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679477498"><span class="hs-identifier hs-type">sid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679477497"><span class="hs-identifier hs-type">sd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679477499"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-206"></span><span id="currentWindows"><span class="annot"><span class="annottext">currentWindows :: forall i l a sid sd. StackSet i l a sid sd -&gt; [a]
</span><a href="XMonad.Util.ExclusiveScratchpads.html#currentWindows"><span class="hs-identifier hs-var hs-var">currentWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Check if given window is a scratchpad</span><span>
</span><span id="line-209"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#isScratchpad"><span class="hs-identifier hs-type">isScratchpad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-210"></span><span id="isScratchpad"><span class="annot"><span class="annottext">isScratchpad :: ExclusiveScratchpads -&gt; Window -&gt; X Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isScratchpad"><span class="hs-identifier hs-var hs-var">isScratchpad</span></a></span></span><span> </span><span id="local-6989586621679477248"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477248"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477247"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477247"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679477246"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679477246"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679477245"><span class="annot"><span class="annottext">q :: Query Bool
</span><a href="#local-6989586621679477245"><span class="hs-identifier hs-var hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Query Bool] -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#joinQueries"><span class="hs-identifier hs-var">joinQueries</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477248"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span>  </span><span id="local-6989586621679477244"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679477244"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679477245"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a i l s sd. Eq a =&gt; StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.allWindows</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679477246"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">elem</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477247"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679477244"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Build a disjunction from a list of clauses</span><span>
</span><span id="line-217"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#joinQueries"><span class="hs-identifier hs-type">joinQueries</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-218"></span><span id="joinQueries"><span class="annot"><span class="annottext">joinQueries :: [Query Bool] -&gt; Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#joinQueries"><span class="hs-identifier hs-var hs-var">joinQueries</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">(&lt;||&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | Useful queries</span><span>
</span><span id="line-221"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#isExclusive"><span class="hs-identifier hs-type">isExclusive</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#isMaximized"><span class="hs-identifier hs-type">isMaximized</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-222"></span><span id="isExclusive"><span class="annot"><span class="annottext">isExclusive :: Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isExclusive"><span class="hs-identifier hs-var hs-var">isExclusive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">notElem</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_XSP_NOEXCLUSIVE&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Query String
</span><span class="hs-identifier hs-var">stringProperty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_XMONAD_TAGS&quot;</span></span><span>
</span><span id="line-223"></span><span id="isMaximized"><span class="annot"><span class="annottext">isMaximized :: Query Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isMaximized"><span class="hs-identifier hs-var hs-var">isMaximized</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier hs-var">isInProperty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_STATE&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_STATE_HIDDEN&quot;</span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- -----------------------------------------------------------------------------------</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- | Make a window not exclusive anymore</span><span>
</span><span id="line-228"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#setNoexclusive"><span class="hs-identifier hs-type">setNoexclusive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>  </span><span class="hs-comment">-- ^ List of exclusive scratchpads</span><span>
</span><span id="line-229"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>                </span><span class="hs-comment">-- ^ Window which should be made not</span><span>
</span><span id="line-230"></span><span>                                        </span><span class="hs-comment">--   exclusive anymore</span><span>
</span><span id="line-231"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span id="setNoexclusive"><span class="annot"><span class="annottext">setNoexclusive :: ExclusiveScratchpads -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#setNoexclusive"><span class="hs-identifier hs-var hs-var">setNoexclusive</span></a></span></span><span> </span><span id="local-6989586621679477238"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477238"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477237"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477237"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; Window -&gt; X Bool
</span><a href="XMonad.Util.ExclusiveScratchpads.html#isScratchpad"><span class="hs-identifier hs-var">isScratchpad</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477238"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477237"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X ()
</span><a href="XMonad.Actions.TagWindows.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_XSP_NOEXCLUSIVE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477237"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-comment">-- | Float and drag the window, make it not exclusive anymore</span><span>
</span><span id="line-235"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#floatMoveNoexclusive"><span class="hs-identifier hs-type">floatMoveNoexclusive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>  </span><span class="hs-comment">-- ^ List of exclusive scratchpads</span><span>
</span><span id="line-236"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>                </span><span class="hs-comment">-- ^ Window which should be moved</span><span>
</span><span id="line-237"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span id="floatMoveNoexclusive"><span class="annot"><span class="annottext">floatMoveNoexclusive :: ExclusiveScratchpads -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#floatMoveNoexclusive"><span class="hs-identifier hs-var hs-var">floatMoveNoexclusive</span></a></span></span><span> </span><span id="local-6989586621679477236"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477236"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477235"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477235"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#setNoexclusive"><span class="hs-identifier hs-var">setNoexclusive</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477236"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477235"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477235"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">mouseMoveWindow</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477235"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftMaster</span></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Resize window, make it not exclusive anymore</span><span>
</span><span id="line-244"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#resizeNoexclusive"><span class="hs-identifier hs-type">resizeNoexclusive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#ExclusiveScratchpads"><span class="hs-identifier hs-type">ExclusiveScratchpads</span></a></span><span>  </span><span class="hs-comment">-- ^ List of exclusive scratchpads</span><span>
</span><span id="line-245"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>                </span><span class="hs-comment">-- ^ Window which should be resized</span><span>
</span><span id="line-246"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span id="resizeNoexclusive"><span class="annot"><span class="annottext">resizeNoexclusive :: ExclusiveScratchpads -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#resizeNoexclusive"><span class="hs-identifier hs-var hs-var">resizeNoexclusive</span></a></span></span><span> </span><span id="local-6989586621679477232"><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477232"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679477231"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477231"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.ExclusiveScratchpads.html#setNoexclusive"><span class="hs-identifier hs-var">setNoexclusive</span></a></span><span> </span><span class="annot"><span class="annottext">ExclusiveScratchpads
</span><a href="#local-6989586621679477232"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477231"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477231"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">mouseResizeWindow</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679477231"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftMaster</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- -----------------------------------------------------------------------------------</span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Manage hook that makes the window non-floating</span><span>
</span><span id="line-255"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#nonFloating"><span class="hs-identifier hs-type">nonFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-256"></span><span id="nonFloating"><span class="annot"><span class="annottext">nonFloating :: ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#nonFloating"><span class="hs-identifier hs-var hs-var">nonFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall m. Monoid m =&gt; m
</span><span class="hs-identifier hs-var">idHook</span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Manage hook that makes the window floating with the default placement</span><span>
</span><span id="line-259"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#defaultFloating"><span class="hs-identifier hs-type">defaultFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-260"></span><span id="defaultFloating"><span class="annot"><span class="annottext">defaultFloating :: ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#defaultFloating"><span class="hs-identifier hs-var hs-var">defaultFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManageHook
</span><span class="hs-identifier hs-var">doFloat</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Manage hook that makes the window floating with custom placement</span><span>
</span><span id="line-263"></span><span class="annot"><a href="XMonad.Util.ExclusiveScratchpads.html#customFloating"><span class="hs-identifier hs-type">customFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span>  </span><span class="hs-comment">-- ^ @RationalRect x y w h@ that specifies relative position,</span><span>
</span><span id="line-264"></span><span>                                  </span><span class="hs-comment">--   height and width (see &quot;XMonad.StackSet#RationalRect&quot;)</span><span>
</span><span id="line-265"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-266"></span><span id="customFloating"><span class="annot"><span class="annottext">customFloating :: RationalRect -&gt; ManageHook
</span><a href="XMonad.Util.ExclusiveScratchpads.html#customFloating"><span class="hs-identifier hs-var hs-var">customFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; ManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier hs-var">doRectFloat</span></a></span><span>
</span><span id="line-267"></span></pre></body></html>