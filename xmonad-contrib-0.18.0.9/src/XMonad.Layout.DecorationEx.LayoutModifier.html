<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Module      :  XMonad.Layout.DecorationEx.LayoutModifier</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Description :  Layout modifier which adds decorations to windows.</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Copyright   :  (c) 2007 Andrea Rossato, 2009 Jan Vornberger, 2023 Ilya Portnov</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- License     :  BSD-style (see xmonad/LICENSE)</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Maintainer  :  portnov84@rambler.ru</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-19"></span><span class="hs-comment">--</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Layout modifier, which is responsible for creation of decoration rectangles</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- (windows), updating and removing them when needed. It is parameterized by</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- @DecorationGeometry@, which says where decorations should be placed, and by</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- @DecorationEngine@, which says how decorations should look.</span><span>
</span><span id="line-24"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Layout.DecorationEx.LayoutModifier</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#decorationEx"><span class="hs-identifier">decorationEx</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier">DecorationEx</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html"><span class="hs-identifier">XMonad.Layout.LayoutModifier</span></a></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.WindowArranger.html"><span class="hs-identifier">XMonad.Layout.WindowArranger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.WindowArranger.html#diff"><span class="hs-identifier">diff</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.WindowArranger.html#listFromList"><span class="hs-identifier">listFromList</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Invisible.html"><span class="hs-identifier">XMonad.Util.Invisible</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.XUtils.html"><span class="hs-identifier">XMonad.Util.XUtils</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.XUtils.html#paintTextAndIcons"><span class="hs-identifier">paintTextAndIcons</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html"><span class="hs-identifier">XMonad.Layout.DecorationEx.Common</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html"><span class="hs-identifier">XMonad.Layout.DecorationEx.Engine</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Geometry.html"><span class="hs-identifier">XMonad.Layout.DecorationEx.Geometry</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- This module exports @decorationEx@ function, which is a generic function for</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- adding decorations to your layouts. It can be used to use different</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- decoration geometries and engines in any combination.</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- For most used combinations, there are convenience functions in</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- &quot;XMonad.Layout.DecorationEx.TextEngine&quot;, &quot;XMonad.Layout.DecorationEx.TabbedGeometry&quot;,</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- and &quot;XMonad.Layout.DecorationEx.DwmGeometry&quot;.</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- You can use this module with the following in your</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- @xmonad.hs@:</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt; import XMonad.Layout.DecorationEx.LayoutModifier</span><span>
</span><span id="line-59"></span><span class="hs-comment">-- Then edit your @layoutHook@ by adding the DwmStyle decoration to</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- your layout:</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt; myL = decorationEx shrinkText myTheme myEngine myGeometry (layoutHook def)</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt;         where</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &gt;           myGeometry = DefaultGeometry -- or another geometry type</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;           myEngine = TextDecoration    -- or another decoration engine</span><span>
</span><span id="line-66"></span><span class="hs-comment">-- &gt;           myTheme = GenericTheme {...} -- theme type should correspond to selected engine type</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- &gt; main = xmonad def { layoutHook = myL }</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- For more detailed instructions on editing the layoutHook see:</span><span>
</span><span id="line-71"></span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#Editing_the_layout_hook&quot;</span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | The 'DecorationEx' 'LayoutModifier'. This data type is an instance</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- of the 'LayoutModifier' class. This data type will be passed,</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- together with a layout, to the 'ModifiedLayout' type constructor</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- to modify the layout by adding decorations according to a</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- 'DecorationEngine'.</span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="DecorationEx"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-var">DecorationEx</span></a></span></span><span> </span><span id="local-6989586621679502294"><span class="annot"><a href="#local-6989586621679502294"><span class="hs-identifier hs-type">engine</span></a></span></span><span> </span><span id="local-6989586621679502292"><span class="annot"><a href="#local-6989586621679502292"><span class="hs-identifier hs-type">widget</span></a></span></span><span> </span><span id="local-6989586621679502290"><span class="annot"><a href="#local-6989586621679502290"><span class="hs-identifier hs-type">geom</span></a></span></span><span> </span><span id="local-6989586621679502293"><span class="annot"><a href="#local-6989586621679502293"><span class="hs-identifier hs-type">shrinker</span></a></span></span><span> </span><span id="local-6989586621679502291"><span class="annot"><a href="#local-6989586621679502291"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>    </span><span id="DecorationEx"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-var">DecorationEx</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Invisible.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502294"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679502293"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502294"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502292"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679502294"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502292"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502291"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679502290"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502291"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span id="local-6989586621679502093"><span id="local-6989586621679502095"><span id="local-6989586621679502106"><span id="local-6989586621679502334"><span id="local-6989586621679502335"><span id="local-6989586621679502336"><span id="local-6989586621679502337"><span id="local-6989586621679502338"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502338"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502337"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679502336"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679502338"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502337"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679502334"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502338"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502337"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502334"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502336"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502335"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-84"></span><span id="local-6989586621679502065"><span id="local-6989586621679502084"><span id="local-6989586621679502087"><span id="local-6989586621679502089"><span id="local-6989586621679502324"><span id="local-6989586621679502325"><span id="local-6989586621679502326"><span id="local-6989586621679502327"><span id="local-6989586621679502328"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502328"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502327"><span class="hs-identifier hs-type">widget</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679502326"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679502328"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502327"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679502324"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502328"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502327"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502324"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502326"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502325"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | The long 'LayoutModifier' instance for the 'DecorationEx' type.</span><span>
</span><span id="line-87"></span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- In 'redoLayout' we check the state: if there is no state we</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- initialize it.</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- The state is @diff@ed against the list of windows produced by the</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- underlying layout: removed windows get deleted and new ones</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- decorated by 'createDecos', which will call 'decorate' to decide if</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- a window must be given a 'Rectangle', in which case a decoration</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- window will be created.</span><span>
</span><span id="line-96"></span><span class="hs-comment">--</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- After that we resync the updated state with the windows' list and</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- then we process the resynced stated (as we do with a new state).</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- First we map the decoration windows, we update each decoration to</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- reflect any decorated window's change, and we insert, in the list</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- of windows and rectangles returned by the underlying layout, the</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- decoration for each window. This way xmonad will restack the</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- decorations and their windows accordingly. At the end we remove</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- invisible\/stacked windows.</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- Message handling is quite simple: when needed we release the state</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- component of the 'DecorationEx' 'LayoutModifier'. Otherwise we call</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- 'handleEvent', which will call the appropriate 'DecorationEngine'</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- methods to perform its tasks.</span><span>
</span><span id="line-111"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679502038"><span id="local-6989586621679502041"><span id="local-6989586621679502043"><span id="local-6989586621679502045"><span id="local-6989586621679502048"><span id="local-6989586621679502050"><span id="local-6989586621679502053"><span id="local-6989586621679502055"><span id="local-6989586621679502303"><span id="local-6989586621679502304"><span id="local-6989586621679502305"><span id="local-6989586621679502306"><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502306"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502305"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Geometry.html#DecorationGeometry"><span class="hs-identifier hs-type">DecorationGeometry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502304"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502303"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#LayoutModifier"><span class="hs-identifier hs-type">LayoutModifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502306"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502305"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502304"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502303"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679501991"><span class="annot"><span class="annottext">redoLayout :: DecorationEx engine widget geom shrinker Window
-&gt; Rectangle
-&gt; Maybe (Stack Window)
-&gt; [(Window, Rectangle)]
-&gt; X ([(Window, Rectangle)],
      Maybe (DecorationEx engine widget geom shrinker Window))
</span><a href="XMonad.Layout.LayoutModifier.html#redoLayout"><span class="hs-identifier hs-var hs-var hs-var hs-var">redoLayout</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501988"><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501988"><span class="hs-identifier hs-var">decoState</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679501987"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501987"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501986"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501986"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501985"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501985"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501984"><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501984"><span class="hs-identifier hs-var">geom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DecorationEngine engine widget Window =&gt;
engine widget Window -&gt; DecorationLayoutState engine -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#releaseResources"><span class="hs-identifier hs-var">releaseResources</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501985"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501988"><span class="hs-identifier hs-var">decoState</span></a></span><span>
</span><span id="line-114"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker a.
Invisible Maybe (DecorationLayoutState engine)
-&gt; shrinker
-&gt; Theme engine widget
-&gt; engine widget a
-&gt; geom a
-&gt; DecorationEx engine widget geom shrinker a
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-var">DecorationEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501987"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501986"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501985"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501984"><span class="hs-identifier hs-var">geom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#redoLayout"><span class="hs-identifier hs-var">redoLayout</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEx engine widget geom shrinker Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#redoLayout"><span class="hs-identifier hs-var">redoLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span id="local-6989586621679501982"><span class="annot"><span class="annottext">Invisible Maybe (DecorationLayoutState engine)
</span><a href="#local-6989586621679501982"><span class="hs-identifier hs-var">invState</span></a></span></span><span> </span><span id="local-6989586621679501981"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501981"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501980"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501979"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501979"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501978"><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501978"><span class="hs-identifier hs-var">geom</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679501977"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501977"><span class="hs-identifier hs-var">screenRect</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501976"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501976"><span class="hs-identifier hs-var">stack</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679501975"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501975"><span class="hs-identifier hs-var">srcPairs</span></a></span></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (DecorationLayoutState engine)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Invisible Maybe (DecorationLayoutState engine)
</span><a href="#local-6989586621679501982"><span class="hs-identifier hs-var">invState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker.
(DecorationEngine engine widget Window,
 DecorationGeometry geom Window, Shrinker shrinker) =&gt;
Theme engine widget
-&gt; engine widget Window
-&gt; geom Window
-&gt; shrinker
-&gt; Rectangle
-&gt; Stack Window
-&gt; [(Window, Rectangle)]
-&gt; X (DecorationLayoutState engine)
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#initState"><span class="hs-identifier hs-var">initState</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501979"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501978"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501981"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501977"><span class="hs-identifier hs-var">screenRect</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501976"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501975"><span class="hs-identifier hs-var">srcPairs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
-&gt; X ([(Window, Rectangle)],
      Maybe (DecorationEx engine widget geom shrinker Window))
</span><a href="#local-6989586621679501973"><span class="hs-identifier hs-var">processState</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501972"><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501972"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Invisible Maybe (DecorationLayoutState engine)
</span><a href="#local-6989586621679501982"><span class="hs-identifier hs-var">invState</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-120"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501971"><span class="annot"><span class="annottext">decorations :: [WindowDecoration]
</span><a href="#local-6989586621679501971"><span class="hs-identifier hs-var hs-var">decorations</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501972"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-121"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679501969"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501969"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679501968"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501968"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. ((a, b) -&gt; c) -&gt; a -&gt; b -&gt; c
</span><span class="hs-identifier hs-var">curry</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; ([a], [a]) -&gt; ([a], [a])
</span><a href="XMonad.Layout.WindowArranger.html#diff"><span class="hs-identifier hs-var">diff</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; [Window]
</span><a href="#local-6989586621679501966"><span class="hs-identifier hs-var">getOrigWindows</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501971"><span class="hs-identifier hs-var">decorations</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501965"><span class="hs-identifier hs-var">srcWindows</span></a></span><span>
</span><span id="line-122"></span><span>                </span><span id="local-6989586621679501964"><span class="annot"><span class="annottext">toDel :: [WindowDecoration]
</span><a href="#local-6989586621679501964"><span class="hs-identifier hs-var hs-var">toDel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [WindowDecoration] -&gt; [WindowDecoration]
</span><a href="#local-6989586621679501963"><span class="hs-identifier hs-var">todel</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501969"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501971"><span class="hs-identifier hs-var">decorations</span></a></span><span>
</span><span id="line-123"></span><span>                </span><span id="local-6989586621679501962"><span class="annot"><span class="annottext">toAdd :: [(Window, Rectangle)]
</span><a href="#local-6989586621679501962"><span class="hs-identifier hs-var hs-var">toAdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501961"><span class="hs-identifier hs-var">toadd</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501968"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501975"><span class="hs-identifier hs-var">srcPairs</span></a></span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#deleteDecos"><span class="hs-identifier hs-var">deleteDecos</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501964"><span class="hs-identifier hs-var">toDel</span></a></span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501959"><span class="annot"><span class="annottext">decosToBeAdded :: [WindowDecoration]
</span><a href="#local-6989586621679501959"><span class="hs-identifier hs-var hs-var">decosToBeAdded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Window
-&gt; Rectangle
-&gt; Maybe Window
-&gt; Maybe Rectangle
-&gt; [WidgetPlace]
-&gt; WindowDecoration
</span><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-var">WindowDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501957"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501956"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679501957"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501957"><span class="hs-identifier hs-var">win</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679501956"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501956"><span class="hs-identifier hs-var">rect</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501962"><span class="hs-identifier hs-var">toAdd</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-126"></span><span>            </span><span id="local-6989586621679501955"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501955"><span class="hs-identifier hs-var">newDecorations</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
-&gt; [WindowDecoration]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="#local-6989586621679501954"><span class="hs-identifier hs-var">resync</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; DecorationEngineState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsStyleState"><span class="hs-identifier hs-var">dsStyleState</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501972"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501959"><span class="hs-identifier hs-var">decosToBeAdded</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [WindowDecoration] -&gt; [WindowDecoration]
</span><a href="#local-6989586621679501952"><span class="hs-identifier hs-var">del_dwrs</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501969"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501971"><span class="hs-identifier hs-var">decorations</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501975"><span class="hs-identifier hs-var">srcPairs</span></a></span><span>
</span><span id="line-127"></span><span>            </span><span class="annot"><span class="annottext">DecorationLayoutState engine
-&gt; X ([(Window, Rectangle)],
      Maybe (DecorationEx engine widget geom shrinker Window))
</span><a href="#local-6989586621679501973"><span class="hs-identifier hs-var">processState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501972"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">dsDecorations :: [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501955"><span class="hs-identifier hs-var">newDecorations</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>          </span><span id="local-6989586621679501965"><span class="annot"><span class="annottext">srcWindows :: [Window]
</span><a href="#local-6989586621679501965"><span class="hs-identifier hs-var hs-var">srcWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501975"><span class="hs-identifier hs-var">srcPairs</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span>          </span><span class="annot"><a href="#local-6989586621679501966"><span class="hs-identifier hs-type">getOrigWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span>
</span><span id="line-133"></span><span>          </span><span id="local-6989586621679501966"><span class="annot"><span class="annottext">getOrigWindows :: [WindowDecoration] -&gt; [Window]
</span><a href="#local-6989586621679501966"><span class="hs-identifier hs-var hs-var">getOrigWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span>          </span><span class="annot"><a href="#local-6989586621679501952"><span class="hs-identifier hs-type">del_dwrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-136"></span><span>          </span><span id="local-6989586621679501952"><span class="annot"><span class="annottext">del_dwrs :: [Window] -&gt; [WindowDecoration] -&gt; [WindowDecoration]
</span><a href="#local-6989586621679501952"><span class="hs-identifier hs-var hs-var">del_dwrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (c -&gt; [a] -&gt; Bool) -&gt; [a] -&gt; [b] -&gt; [b]
</span><a href="XMonad.Layout.WindowArranger.html#listFromList"><span class="hs-identifier hs-var">listFromList</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">notElem</span></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><a href="#local-6989586621679501949"><span class="hs-identifier hs-type">findDecoWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-139"></span><span>          </span><span id="local-6989586621679501949"><span class="annot"><span class="annottext">findDecoWindow :: Int -&gt; [WindowDecoration] -&gt; Maybe Window
</span><a href="#local-6989586621679501949"><span class="hs-identifier hs-var hs-var">findDecoWindow</span></a></span></span><span> </span><span id="local-6989586621679501948"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501948"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679501947"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501947"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501947"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501948"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span>          </span><span class="annot"><a href="#local-6989586621679501963"><span class="hs-identifier hs-type">todel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span>          </span><span id="local-6989586621679501963"><span class="annot"><span class="annottext">todel :: [Window] -&gt; [WindowDecoration] -&gt; [WindowDecoration]
</span><a href="#local-6989586621679501963"><span class="hs-identifier hs-var hs-var">todel</span></a></span></span><span> </span><span id="local-6989586621679501944"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501944"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679501943"><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501943"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501943"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501944"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span>          </span><span class="annot"><a href="#local-6989586621679501961"><span class="hs-identifier hs-type">toadd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-145"></span><span>          </span><span id="local-6989586621679501961"><span class="annot"><span class="annottext">toadd :: [Window] -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501961"><span class="hs-identifier hs-var hs-var">toadd</span></a></span></span><span> </span><span id="local-6989586621679501941"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501941"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679501940"><span class="annot"><span class="annottext">(Window, Rectangle)
</span><a href="#local-6989586621679501940"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Window, Rectangle)
</span><a href="#local-6989586621679501940"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501941"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span>          </span><span class="annot"><a href="#local-6989586621679501939"><span class="hs-identifier hs-type">createDecoWindowIfNeeded</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>          </span><span id="local-6989586621679501939"><span class="annot"><span class="annottext">createDecoWindowIfNeeded :: Maybe Window -&gt; Maybe Rectangle -&gt; X (Maybe Window)
</span><a href="#local-6989586621679501939"><span class="hs-identifier hs-var hs-var">createDecoWindowIfNeeded</span></a></span></span><span> </span><span id="local-6989586621679501938"><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679501938"><span class="hs-identifier hs-var">mbDecoWindow</span></a></span></span><span> </span><span id="local-6989586621679501937"><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501937"><span class="hs-identifier hs-var">mbDecoRect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679501938"><span class="hs-identifier hs-var">mbDecoWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501937"><span class="hs-identifier hs-var">mbDecoRect</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-150"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Window
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501936"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501936"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>                </span><span id="local-6989586621679501935"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501935"><span class="hs-identifier hs-var">decoWindow</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DecorationEngine engine widget Window =&gt;
engine widget Window
-&gt; Theme engine widget -&gt; Rectangle -&gt; X Window
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecoWindow"><span class="hs-identifier hs-var">createDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501979"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501936"><span class="hs-identifier hs-var">decoRect</span></a></span><span>
</span><span id="line-152"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501935"><span class="hs-identifier hs-var">decoWindow</span></a></span><span>
</span><span id="line-153"></span><span>              </span><span class="annot"><span class="annottext">(Maybe Window, Maybe Rectangle)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679501938"><span class="hs-identifier hs-var">mbDecoWindow</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span>          </span><span class="annot"><a href="#local-6989586621679501954"><span class="hs-identifier hs-type">resync</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502306"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-156"></span><span>          </span><span id="local-6989586621679501954"><span class="annot"><span class="annottext">resync :: DecorationEngineState engine
-&gt; [WindowDecoration]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="#local-6989586621679501954"><span class="hs-identifier hs-var hs-var">resync</span></a></span></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-157"></span><span>          </span><span class="annot"><a href="#local-6989586621679501954"><span class="hs-identifier hs-var">resync</span></a></span><span> </span><span id="local-6989586621679501933"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501933"><span class="hs-identifier hs-var">decoState</span></a></span></span><span> </span><span id="local-6989586621679501932"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501932"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679501931"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501931"><span class="hs-identifier hs-var">window</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679501930"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501930"><span class="hs-identifier hs-var">rect</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679501929"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501929"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-158"></span><span>            </span><span class="hs-keyword">case</span><span>  </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501931"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-operator hs-var">`elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; [Window]
</span><a href="#local-6989586621679501966"><span class="hs-identifier hs-var">getOrigWindows</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501932"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-159"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501927"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501927"><span class="hs-identifier hs-var">i</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>                </span><span id="local-6989586621679501926"><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501926"><span class="hs-identifier hs-var">mbDecoRect</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (geom :: * -&gt; *) a.
DecorationGeometry geom a =&gt;
geom a
-&gt; Rectangle
-&gt; Stack a
-&gt; [(a, Rectangle)]
-&gt; (a, Rectangle)
-&gt; X (Maybe Rectangle)
</span><a href="XMonad.Layout.DecorationEx.Geometry.html#decorateWindow"><span class="hs-identifier hs-var">decorateWindow</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501978"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501977"><span class="hs-identifier hs-var">screenRect</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501976"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501975"><span class="hs-identifier hs-var">srcPairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501931"><span class="hs-identifier hs-var">window</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501930"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>                </span><span id="local-6989586621679501924"><span class="annot"><span class="annottext">WidgetLayout WidgetPlace
</span><a href="#local-6989586621679501924"><span class="hs-identifier hs-var">widgetPlaces</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501926"><span class="hs-identifier hs-var">mbDecoRect</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>                                  </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a] -&gt; WidgetLayout a
</span><a href="XMonad.Layout.DecorationEx.Common.html#WidgetLayout"><span class="hs-identifier hs-var">WidgetLayout</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-163"></span><span>                                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501922"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501922"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Window
-&gt; WidgetLayout widget
-&gt; X (WidgetLayout WidgetPlace)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#placeWidgets"><span class="hs-identifier hs-var">placeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501979"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501981"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501933"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501922"><span class="hs-identifier hs-var">decoRect</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501931"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
HasWidgets theme widget =&gt;
theme widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Common.html#themeWidgets"><span class="hs-identifier hs-var">themeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>                </span><span id="local-6989586621679501919"><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679501919"><span class="hs-identifier hs-var">mbDecoWindow</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe Window -&gt; Maybe Rectangle -&gt; X (Maybe Window)
</span><a href="#local-6989586621679501939"><span class="hs-identifier hs-var">createDecoWindowIfNeeded</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [WindowDecoration] -&gt; Maybe Window
</span><a href="#local-6989586621679501949"><span class="hs-identifier hs-var">findDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501927"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501932"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501926"><span class="hs-identifier hs-var">mbDecoRect</span></a></span><span>
</span><span id="line-165"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501918"><span class="annot"><span class="annottext">newDd :: WindowDecoration
</span><a href="#local-6989586621679501918"><span class="hs-identifier hs-var hs-var">newDd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
-&gt; Rectangle
-&gt; Maybe Window
-&gt; Maybe Rectangle
-&gt; [WidgetPlace]
-&gt; WindowDecoration
</span><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-var">WindowDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501931"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501930"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679501919"><span class="hs-identifier hs-var">mbDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501926"><span class="hs-identifier hs-var">mbDecoRect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall widget. WidgetLayout widget -&gt; [widget]
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetLayout"><span class="hs-identifier hs-var">widgetLayout</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetLayout WidgetPlace
</span><a href="#local-6989586621679501924"><span class="hs-identifier hs-var">widgetPlaces</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>                </span><span id="local-6989586621679501916"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501916"><span class="hs-identifier hs-var">restDd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
-&gt; [WindowDecoration]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="#local-6989586621679501954"><span class="hs-identifier hs-var">resync</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501933"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501932"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501929"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-167"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501918"><span class="hs-identifier hs-var">newDd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501916"><span class="hs-identifier hs-var">restDd</span></a></span><span>
</span><span id="line-168"></span><span>              </span><span class="annot"><span class="annottext">Maybe Int
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
-&gt; [WindowDecoration]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="#local-6989586621679501954"><span class="hs-identifier hs-var">resync</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501933"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501932"><span class="hs-identifier hs-var">dd</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501929"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-comment">-- We drop any windows that are *precisely* stacked underneath</span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-comment">-- another window: these must be intended to be tabbed!</span><span>
</span><span id="line-172"></span><span>          </span><span class="annot"><a href="#local-6989586621679501915"><span class="hs-identifier hs-type">removeTabbed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-173"></span><span>          </span><span id="local-6989586621679501915"><span class="annot"><span class="annottext">removeTabbed :: [Rectangle] -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501915"><span class="hs-identifier hs-var hs-var">removeTabbed</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Rectangle]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>          </span><span class="annot"><a href="#local-6989586621679501915"><span class="hs-identifier hs-var">removeTabbed</span></a></span><span> </span><span id="local-6989586621679501914"><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679501914"><span class="hs-identifier hs-var">rs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679501913"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501913"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679501912"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501912"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679501911"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501911"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501912"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679501914"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Rectangle] -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501915"><span class="hs-identifier hs-var">removeTabbed</span></a></span><span> </span><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679501914"><span class="hs-identifier hs-var">rs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501911"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-176"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501913"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501912"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Rectangle] -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501915"><span class="hs-identifier hs-var">removeTabbed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501912"><span class="hs-identifier hs-var">r</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Rectangle]
</span><a href="#local-6989586621679501914"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501911"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>          </span><span class="annot"><a href="#local-6989586621679501910"><span class="hs-identifier hs-type">insertDwr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>          </span><span id="local-6989586621679501910"><span class="annot"><span class="annottext">insertDwr :: WindowDecoration -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501910"><span class="hs-identifier hs-var hs-var">insertDwr</span></a></span></span><span> </span><span id="local-6989586621679501909"><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span id="local-6989586621679501908"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501908"><span class="hs-identifier hs-var">wrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoRect"><span class="hs-identifier hs-var">wdDecoRect</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-181"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501906"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501906"><span class="hs-identifier hs-var">decoWindow</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501905"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501905"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501906"><span class="hs-identifier hs-var">decoWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501905"><span class="hs-identifier hs-var">decoRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall (geom :: * -&gt; *) a.
DecorationGeometry geom a =&gt;
geom a -&gt; Rectangle -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Geometry.html#shrinkWindow"><span class="hs-identifier hs-var">shrinkWindow</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501978"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501905"><span class="hs-identifier hs-var">decoRect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowDecoration -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWinRect"><span class="hs-identifier hs-var">wdOrigWinRect</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501908"><span class="hs-identifier hs-var">wrs</span></a></span><span>
</span><span id="line-182"></span><span>              </span><span class="annot"><span class="annottext">(Maybe Window, Maybe Rectangle)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWinRect"><span class="hs-identifier hs-var">wdOrigWinRect</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501909"><span class="hs-identifier hs-var">dd</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501908"><span class="hs-identifier hs-var">wrs</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span>          </span><span class="annot"><a href="#local-6989586621679501902"><span class="hs-identifier hs-type">dwrs_to_wrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>          </span><span id="local-6989586621679501902"><span class="annot"><span class="annottext">dwrs_to_wrs :: [WindowDecoration] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501902"><span class="hs-identifier hs-var hs-var">dwrs_to_wrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Rectangle] -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501915"><span class="hs-identifier hs-var">removeTabbed</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; [(Window, Rectangle)] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501910"><span class="hs-identifier hs-var">insertDwr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span>          </span><span class="annot"><a href="#local-6989586621679501973"><span class="hs-identifier hs-type">processState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502306"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502306"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502305"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502304"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502303"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>          </span><span id="local-6989586621679501973"><span class="annot"><span class="annottext">processState :: DecorationLayoutState engine
-&gt; X ([(Window, Rectangle)],
      Maybe (DecorationEx engine widget geom shrinker Window))
</span><a href="#local-6989586621679501973"><span class="hs-identifier hs-var hs-var">processState</span></a></span></span><span> </span><span id="local-6989586621679501899"><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501899"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501898"><span class="annot"><span class="annottext">decorations :: [WindowDecoration]
</span><a href="#local-6989586621679501898"><span class="hs-identifier hs-var hs-var">decorations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501899"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-190"></span><span>            </span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#showDecos"><span class="hs-identifier hs-var">showDecos</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501898"><span class="hs-identifier hs-var">decorations</span></a></span><span>
</span><span id="line-191"></span><span>            </span><span class="annot"><span class="annottext">forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; [WindowDecoration]
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDecos"><span class="hs-identifier hs-var">updateDecos</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501979"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501981"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; DecorationEngineState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsStyleState"><span class="hs-identifier hs-var">dsStyleState</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501899"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501898"><span class="hs-identifier hs-var">decorations</span></a></span><span>
</span><span id="line-192"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; [(Window, Rectangle)]
</span><a href="#local-6989586621679501902"><span class="hs-identifier hs-var">dwrs_to_wrs</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501898"><span class="hs-identifier hs-var">decorations</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker a.
Invisible Maybe (DecorationLayoutState engine)
-&gt; shrinker
-&gt; Theme engine widget
-&gt; engine widget a
-&gt; geom a
-&gt; DecorationEx engine widget geom shrinker a
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-var">DecorationEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501899"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">dsDecorations :: [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501898"><span class="hs-identifier hs-var">decorations</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501981"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501980"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501979"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501978"><span class="hs-identifier hs-var">geom</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span>    </span><span id="local-6989586621679501877"><span class="annot"><span class="annottext">handleMess :: DecorationEx engine widget geom shrinker Window
-&gt; SomeMessage
-&gt; X (Maybe (DecorationEx engine widget geom shrinker Window))
</span><a href="XMonad.Layout.LayoutModifier.html#handleMess"><span class="hs-identifier hs-var hs-var hs-var hs-var">handleMess</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501875"><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501875"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679501874"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501874"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501873"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501873"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501872"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501872"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501871"><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501871"><span class="hs-identifier hs-var">geom</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679501870"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679501870"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">LayoutMessages
</span><span class="hs-identifier hs-var">Hide</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679501870"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#hideDecos"><span class="hs-identifier hs-var">hideDecos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501875"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-197"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span class="hs-comment">--         | Just (SetTheme nt) &lt;- fromMessage m = do</span><span>
</span><span id="line-199"></span><span class="hs-comment">--             releaseResources engine st</span><span>
</span><span id="line-200"></span><span class="hs-comment">--             let t' = themeEx nt</span><span>
</span><span id="line-201"></span><span class="hs-comment">--             return $ Just $ DecorationEx (I Nothing) shrinker t' engine</span><span>
</span><span id="line-202"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">LayoutMessages
</span><span class="hs-identifier hs-var">ReleaseResources</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679501870"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>            </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DecorationEngine engine widget Window =&gt;
engine widget Window -&gt; DecorationLayoutState engine -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#releaseResources"><span class="hs-identifier hs-var">releaseResources</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501872"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501875"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-204"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker a.
Invisible Maybe (DecorationLayoutState engine)
-&gt; shrinker
-&gt; Theme engine widget
-&gt; engine widget a
-&gt; geom a
-&gt; DecorationEx engine widget geom shrinker a
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-var">DecorationEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501874"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501873"><span class="hs-identifier hs-var">theme</span></a></span><span>  </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501872"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501871"><span class="hs-identifier hs-var">geom</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501865"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679501865"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679501870"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-206"></span><span>            </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; DecorationLayoutState engine
-&gt; shrinker
-&gt; Event
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#decorationEventHookEx"><span class="hs-identifier hs-var">decorationEventHookEx</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501872"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501873"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501875"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501874"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679501865"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-207"></span><span>            </span><span class="annot"><span class="annottext">forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationLayoutState engine
-&gt; Event
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#handleEvent"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501872"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501874"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501873"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501875"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679501865"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-208"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#handleMess"><span class="hs-identifier hs-var">handleMess</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEx engine widget geom shrinker Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679501860"><span class="annot"><span class="annottext">modifierDescription :: DecorationEx engine widget geom shrinker Window -&gt; String
</span><a href="XMonad.Layout.LayoutModifier.html#modifierDescription"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifierDescription</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="annot"><span class="annottext">Invisible Maybe (DecorationLayoutState engine)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679501858"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501858"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501857"><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501857"><span class="hs-identifier hs-var">geom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a -&gt; String
</span><a href="XMonad.Layout.DecorationEx.Engine.html#describeEngine"><span class="hs-identifier hs-var">describeEngine</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501858"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (geom :: * -&gt; *) a.
DecorationGeometry geom a =&gt;
geom a -&gt; String
</span><a href="XMonad.Layout.DecorationEx.Geometry.html#describeGeometry"><span class="hs-identifier hs-var">describeGeometry</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501857"><span class="hs-identifier hs-var">geom</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | By default 'DecorationEx' handles 'PropertyEvent' and 'ExposeEvent'</span><span>
</span><span id="line-214"></span><span class="hs-comment">-- only.</span><span>
</span><span id="line-215"></span><span id="local-6989586621679502235"><span id="local-6989586621679502236"><span id="local-6989586621679502237"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#handleEvent"><span class="hs-identifier hs-type">handleEvent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502237"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502236"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502235"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502236"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502235"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502237"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502236"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502235"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502236"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-216"></span><span id="handleEvent"><span class="annot"><span class="annottext">handleEvent :: forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationLayoutState engine
-&gt; Event
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#handleEvent"><span class="hs-identifier hs-var hs-var">handleEvent</span></a></span></span><span> </span><span id="local-6989586621679501837"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501837"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501836"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501836"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501835"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501835"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679501832"><span id="local-6989586621679501833"><span class="annot"><span class="annottext">[WindowDecoration]
DecorationEngineState engine
dsDecorations :: [WindowDecoration]
dsStyleState :: DecorationEngineState engine
dsStyleState :: forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; DecorationEngineState engine
dsDecorations :: forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="#local-6989586621679501832"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679501831"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679501831"><span class="hs-identifier hs-var">e</span></a></span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PropertyEvent</span></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_window :: Event -&gt; Window
</span><span class="hs-identifier hs-var">ev_window</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679501828"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501828"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_atom :: Event -&gt; Window
</span><span class="hs-identifier hs-var">ev_atom</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679501826"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501826"><span class="hs-identifier hs-var">atom</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679501831"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501825"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501825"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501828"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-operator hs-var">`elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501832"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>        </span><span id="local-6989586621679501824"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501824"><span class="hs-identifier hs-var">supportedAtoms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a -&gt; X [Window]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#propsToRepaintDecoration"><span class="hs-identifier hs-var">propsToRepaintDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501837"><span class="hs-identifier hs-var">engine</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501826"><span class="hs-identifier hs-var">atom</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679501824"><span class="hs-identifier hs-var">supportedAtoms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>          </span><span class="hs-comment">-- io $ putStrLn $ &quot;property event on &quot; ++ show w -- ++ &quot;: &quot; ++ fromMaybe &quot;&lt;?&gt;&quot; atomName</span><span>
</span><span id="line-222"></span><span>          </span><span class="annot"><span class="annottext">forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; WindowDecoration
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDeco"><span class="hs-identifier hs-var">updateDeco</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501837"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501836"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501835"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501833"><span class="hs-identifier hs-var">dsStyleState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501832"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501825"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExposeEvent</span></span><span>   </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ev_window :: Event -&gt; Window
</span><span class="hs-identifier hs-var">ev_window</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679501819"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501819"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679501831"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501818"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501818"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501819"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; [a] -&gt; Maybe Int
</span><span class="hs-operator hs-var">`elemIndex`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501832"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>        </span><span class="hs-comment">-- io $ putStrLn $ &quot;expose event on &quot; ++ show w</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><span class="annottext">forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; WindowDecoration
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDeco"><span class="hs-identifier hs-var">updateDeco</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501837"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501836"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501835"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501833"><span class="hs-identifier hs-var">dsStyleState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501832"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679501818"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-227"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#handleEvent"><span class="hs-identifier hs-var">handleEvent</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">-- | Initialize the 'DecorationState' by initializing the font</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- structure and by creating the needed decorations.</span><span>
</span><span id="line-231"></span><span id="local-6989586621679502284"><span id="local-6989586621679502285"><span id="local-6989586621679502286"><span id="local-6989586621679502287"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#initState"><span class="hs-identifier hs-type">initState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502287"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502286"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Geometry.html#DecorationGeometry"><span class="hs-identifier hs-type">DecorationGeometry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502285"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502284"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502287"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502286"><span class="hs-identifier hs-type">widget</span></a></span><span>
</span><span id="line-233"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502287"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502286"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-234"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502285"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502284"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-237"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-238"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502287"><span class="hs-identifier hs-type">engine</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-239"></span><span id="initState"><span class="annot"><span class="annottext">initState :: forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker.
(DecorationEngine engine widget Window,
 DecorationGeometry geom Window, Shrinker shrinker) =&gt;
Theme engine widget
-&gt; engine widget Window
-&gt; geom Window
-&gt; shrinker
-&gt; Rectangle
-&gt; Stack Window
-&gt; [(Window, Rectangle)]
-&gt; X (DecorationLayoutState engine)
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#initState"><span class="hs-identifier hs-var hs-var">initState</span></a></span></span><span> </span><span id="local-6989586621679501806"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501806"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501805"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501805"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501804"><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501804"><span class="hs-identifier hs-var">geom</span></a></span></span><span> </span><span id="local-6989586621679501803"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501803"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501802"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501802"><span class="hs-identifier hs-var">screenRect</span></a></span></span><span> </span><span id="local-6989586621679501801"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501801"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span id="local-6989586621679501800"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501800"><span class="hs-identifier hs-var">wrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679501799"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501799"><span class="hs-identifier hs-var">styleState</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a (geom :: * -&gt; *).
DecorationEngine engine widget a =&gt;
engine widget a
-&gt; geom a
-&gt; Theme engine widget
-&gt; X (DecorationEngineState engine)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#initializeState"><span class="hs-identifier hs-var">initializeState</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501805"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501804"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501806"><span class="hs-identifier hs-var">theme</span></a></span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679501797"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501797"><span class="hs-identifier hs-var">decorations</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker.
(DecorationEngine engine widget Window,
 DecorationGeometry geom Window, Shrinker shrinker) =&gt;
Theme engine widget
-&gt; engine widget Window
-&gt; geom Window
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Stack Window
-&gt; [(Window, Rectangle)]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecos"><span class="hs-identifier hs-var">createDecos</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501806"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501805"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501804"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501803"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501799"><span class="hs-identifier hs-var">styleState</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501802"><span class="hs-identifier hs-var">screenRect</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501801"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501800"><span class="hs-identifier hs-var">wrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501800"><span class="hs-identifier hs-var">wrs</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationEngineState engine
-&gt; [WindowDecoration] -&gt; DecorationLayoutState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-var">DecorationLayoutState</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501799"><span class="hs-identifier hs-var">styleState</span></a></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501797"><span class="hs-identifier hs-var">decorations</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Delete windows stored in the state and release the font structure.</span><span>
</span><span id="line-245"></span><span id="local-6989586621679502301"><span id="local-6989586621679502302"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#releaseResources"><span class="hs-identifier hs-type">releaseResources</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502302"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502301"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502302"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502301"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationLayoutState"><span class="hs-identifier hs-type">DecorationLayoutState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502302"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-246"></span><span id="releaseResources"><span class="annot"><span class="annottext">releaseResources :: forall (engine :: * -&gt; * -&gt; *) widget.
DecorationEngine engine widget Window =&gt;
engine widget Window -&gt; DecorationLayoutState engine -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#releaseResources"><span class="hs-identifier hs-var hs-var">releaseResources</span></a></span></span><span> </span><span id="local-6989586621679501792"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501792"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501791"><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501791"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><span class="annottext">[WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#deleteDecos"><span class="hs-identifier hs-var">deleteDecos</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsDecorations"><span class="hs-identifier hs-var">dsDecorations</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501791"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a -&gt; DecorationEngineState engine -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#releaseStateResources"><span class="hs-identifier hs-var">releaseStateResources</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501792"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *).
DecorationLayoutState engine -&gt; DecorationEngineState engine
</span><a href="XMonad.Layout.DecorationEx.Engine.html#dsStyleState"><span class="hs-identifier hs-var">dsStyleState</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationLayoutState engine
</span><a href="#local-6989586621679501791"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Create the decoration windows of a list of windows and their</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- rectangles, by calling the 'decorate' method of the</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- 'DecorationStyle' received.</span><span>
</span><span id="line-253"></span><span id="local-6989586621679502217"><span id="local-6989586621679502218"><span id="local-6989586621679502219"><span id="local-6989586621679502220"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecos"><span class="hs-identifier hs-type">createDecos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502220"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502219"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Geometry.html#DecorationGeometry"><span class="hs-identifier hs-type">DecorationGeometry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502218"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502217"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502220"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502219"><span class="hs-identifier hs-type">widget</span></a></span><span>
</span><span id="line-255"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502220"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502219"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-256"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502218"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-257"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502217"><span class="hs-identifier hs-type">shrinker</span></a></span><span>
</span><span id="line-258"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502220"><span class="hs-identifier hs-type">engine</span></a></span><span>
</span><span id="line-259"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-260"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-261"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-262"></span><span id="createDecos"><span class="annot"><span class="annottext">createDecos :: forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker.
(DecorationEngine engine widget Window,
 DecorationGeometry geom Window, Shrinker shrinker) =&gt;
Theme engine widget
-&gt; engine widget Window
-&gt; geom Window
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Stack Window
-&gt; [(Window, Rectangle)]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecos"><span class="hs-identifier hs-var hs-var">createDecos</span></a></span></span><span> </span><span id="local-6989586621679501766"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501766"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501765"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501765"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501764"><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501764"><span class="hs-identifier hs-var">geom</span></a></span></span><span> </span><span id="local-6989586621679501763"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501763"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501762"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501762"><span class="hs-identifier hs-var">decoState</span></a></span></span><span> </span><span id="local-6989586621679501761"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501761"><span class="hs-identifier hs-var">screenRect</span></a></span></span><span> </span><span id="local-6989586621679501760"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501760"><span class="hs-identifier hs-var">stack</span></a></span></span><span> </span><span id="local-6989586621679501759"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501759"><span class="hs-identifier hs-var">wrs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679501758"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501758"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679501757"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501757"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679501756"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501756"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>  </span><span id="local-6989586621679501755"><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501755"><span class="hs-identifier hs-var">mbDecoRect</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (geom :: * -&gt; *) a.
DecorationGeometry geom a =&gt;
geom a
-&gt; Rectangle
-&gt; Stack a
-&gt; [(a, Rectangle)]
-&gt; (a, Rectangle)
-&gt; X (Maybe Rectangle)
</span><a href="XMonad.Layout.DecorationEx.Geometry.html#decorateWindow"><span class="hs-identifier hs-var">decorateWindow</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501764"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501761"><span class="hs-identifier hs-var">screenRect</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501760"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501759"><span class="hs-identifier hs-var">wrs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501758"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501757"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><a href="#local-6989586621679501755"><span class="hs-identifier hs-var">mbDecoRect</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501754"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501754"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679501753"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501753"><span class="hs-identifier hs-var">decoWindow</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget.
DecorationEngine engine widget Window =&gt;
engine widget Window
-&gt; Theme engine widget -&gt; Rectangle -&gt; X Window
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecoWindow"><span class="hs-identifier hs-var">createDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501765"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501766"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501754"><span class="hs-identifier hs-var">decoRect</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span id="local-6989586621679501752"><span class="annot"><span class="annottext">WidgetLayout WidgetPlace
</span><a href="#local-6989586621679501752"><span class="hs-identifier hs-var">widgetPlaces</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Window
-&gt; WidgetLayout widget
-&gt; X (WidgetLayout WidgetPlace)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#placeWidgets"><span class="hs-identifier hs-var">placeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501765"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501766"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501763"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501762"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501754"><span class="hs-identifier hs-var">decoRect</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501758"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
HasWidgets theme widget =&gt;
theme widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Common.html#themeWidgets"><span class="hs-identifier hs-var">themeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501766"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>      </span><span id="local-6989586621679501751"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501751"><span class="hs-identifier hs-var">restDd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker.
(DecorationEngine engine widget Window,
 DecorationGeometry geom Window, Shrinker shrinker) =&gt;
Theme engine widget
-&gt; engine widget Window
-&gt; geom Window
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Stack Window
-&gt; [(Window, Rectangle)]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecos"><span class="hs-identifier hs-var">createDecos</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501766"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501765"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501764"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501763"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501762"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501761"><span class="hs-identifier hs-var">screenRect</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501760"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501759"><span class="hs-identifier hs-var">wrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501756"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501750"><span class="annot"><span class="annottext">newDd :: WindowDecoration
</span><a href="#local-6989586621679501750"><span class="hs-identifier hs-var hs-var">newDd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
-&gt; Rectangle
-&gt; Maybe Window
-&gt; Maybe Rectangle
-&gt; [WidgetPlace]
-&gt; WindowDecoration
</span><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-var">WindowDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501758"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501757"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501753"><span class="hs-identifier hs-var">decoWindow</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501754"><span class="hs-identifier hs-var">decoRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall widget. WidgetLayout widget -&gt; [widget]
</span><a href="XMonad.Layout.DecorationEx.Common.html#widgetLayout"><span class="hs-identifier hs-var">widgetLayout</span></a></span><span> </span><span class="annot"><span class="annottext">WidgetLayout WidgetPlace
</span><a href="#local-6989586621679501752"><span class="hs-identifier hs-var">widgetPlaces</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501750"><span class="hs-identifier hs-var">newDd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501751"><span class="hs-identifier hs-var">restDd</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>      </span><span id="local-6989586621679501749"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501749"><span class="hs-identifier hs-var">restDd</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker.
(DecorationEngine engine widget Window,
 DecorationGeometry geom Window, Shrinker shrinker) =&gt;
Theme engine widget
-&gt; engine widget Window
-&gt; geom Window
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Stack Window
-&gt; [(Window, Rectangle)]
-&gt; [(Window, Rectangle)]
-&gt; X [WindowDecoration]
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecos"><span class="hs-identifier hs-var">createDecos</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501766"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501765"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><a href="#local-6989586621679501764"><span class="hs-identifier hs-var">geom</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501763"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501762"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501761"><span class="hs-identifier hs-var">screenRect</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679501760"><span class="hs-identifier hs-var">stack</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501759"><span class="hs-identifier hs-var">wrs</span></a></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679501756"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-273"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501748"><span class="annot"><span class="annottext">newDd :: WindowDecoration
</span><a href="#local-6989586621679501748"><span class="hs-identifier hs-var hs-var">newDd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
-&gt; Rectangle
-&gt; Maybe Window
-&gt; Maybe Rectangle
-&gt; [WidgetPlace]
-&gt; WindowDecoration
</span><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-var">WindowDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501758"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501757"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501748"><span class="hs-identifier hs-var">newDd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501749"><span class="hs-identifier hs-var">restDd</span></a></span><span>
</span><span id="line-275"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecos"><span class="hs-identifier hs-var">createDecos</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">geom Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span id="local-6989586621679502258"><span id="local-6989586621679502259"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecoWindow"><span class="hs-identifier hs-type">createDecoWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502259"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502258"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502259"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502258"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502259"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502258"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span></span></span><span>
</span><span id="line-278"></span><span id="createDecoWindow"><span class="annot"><span class="annottext">createDecoWindow :: forall (engine :: * -&gt; * -&gt; *) widget.
DecorationEngine engine widget Window =&gt;
engine widget Window
-&gt; Theme engine widget -&gt; Rectangle -&gt; X Window
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#createDecoWindow"><span class="hs-identifier hs-var hs-var">createDecoWindow</span></a></span></span><span> </span><span id="local-6989586621679501735"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501735"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501734"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501734"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501733"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501733"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501732"><span class="annot"><span class="annottext">mask :: Maybe Window
</span><a href="#local-6989586621679501732"><span class="hs-identifier hs-var hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
DecorationEngine engine widget a =&gt;
engine widget a -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Engine.html#decorationXEventMask"><span class="hs-identifier hs-var">decorationXEventMask</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501735"><span class="hs-identifier hs-var">engine</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679501730"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501730"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Maybe Window -&gt; String -&gt; Bool -&gt; X Window
</span><a href="XMonad.Util.XUtils.html#createNewWindow"><span class="hs-identifier hs-var">createNewWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501733"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679501732"><span class="hs-identifier hs-var">mask</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall theme. ThemeAttributes theme =&gt; theme -&gt; String
</span><a href="XMonad.Layout.DecorationEx.Common.html#defaultBgColor"><span class="hs-identifier hs-var">defaultBgColor</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501734"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679501727"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679501727"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Display
</span><span class="hs-identifier hs-var">display</span></span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; ClassHint -&gt; IO ()
</span><span class="hs-identifier hs-var">setClassHint</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679501727"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501730"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; ClassHint
</span><span class="hs-identifier hs-var">ClassHint</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xmonad-decoration&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;xmonad&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501730"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#showDecos"><span class="hs-identifier hs-type">showDecos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span id="showDecos"><span class="annot"><span class="annottext">showDecos :: [WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#showDecos"><span class="hs-identifier hs-var hs-var">showDecos</span></a></span></span><span> </span><span id="local-6989586621679501721"><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501721"><span class="hs-identifier hs-var">dd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><span class="annottext">[Window] -&gt; X ()
</span><a href="XMonad.Util.XUtils.html#showWindows"><span class="hs-identifier hs-var">showWindows</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoRect"><span class="hs-identifier hs-var">wdDecoRect</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WindowDecoration]
</span><a href="#local-6989586621679501721"><span class="hs-identifier hs-var">dd</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#hideDecos"><span class="hs-identifier hs-type">hideDecos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span id="hideDecos"><span class="annot"><span class="annottext">hideDecos :: [WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#hideDecos"><span class="hs-identifier hs-var hs-var">hideDecos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; X ()
</span><a href="XMonad.Util.XUtils.html#hideWindows"><span class="hs-identifier hs-var">hideWindows</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#deleteDecos"><span class="hs-identifier hs-type">deleteDecos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span id="deleteDecos"><span class="annot"><span class="annottext">deleteDecos :: [WindowDecoration] -&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#deleteDecos"><span class="hs-identifier hs-var hs-var">deleteDecos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; X ()
</span><a href="XMonad.Util.XUtils.html#deleteWindows"><span class="hs-identifier hs-var">deleteWindows</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span id="local-6989586621679502243"><span id="local-6989586621679502244"><span id="local-6989586621679502245"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDecos"><span class="hs-identifier hs-type">updateDecos</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502245"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502244"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502243"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502244"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502243"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502245"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502244"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502243"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502244"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-297"></span><span id="updateDecos"><span class="annot"><span class="annottext">updateDecos :: forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; [WindowDecoration]
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDecos"><span class="hs-identifier hs-var hs-var">updateDecos</span></a></span></span><span> </span><span id="local-6989586621679501710"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501710"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501709"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501709"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501708"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501708"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501707"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501707"><span class="hs-identifier hs-var">decoState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679501705"><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501705"><span class="hs-identifier hs-var">wd</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; WindowDecoration
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDeco"><span class="hs-identifier hs-var">updateDeco</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501710"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501709"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501708"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501707"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501705"><span class="hs-identifier hs-var">wd</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | Update a decoration window given a shrinker, a theme, the font</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- structure and the needed 'Rectangle's</span><span>
</span><span id="line-301"></span><span id="local-6989586621679502228"><span id="local-6989586621679502229"><span id="local-6989586621679502230"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDeco"><span class="hs-identifier hs-type">updateDeco</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502230"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502229"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502228"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502229"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502228"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502230"><span class="hs-identifier hs-type">shrinker</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502229"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502228"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngineState"><span class="hs-identifier hs-type">DecorationEngineState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502229"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Common.html#WindowDecoration"><span class="hs-identifier hs-type">WindowDecoration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-302"></span><span id="updateDeco"><span class="annot"><span class="annottext">updateDeco :: forall shrinker (engine :: * -&gt; * -&gt; *) widget.
(Shrinker shrinker, DecorationEngine engine widget Window) =&gt;
engine widget Window
-&gt; shrinker
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; WindowDecoration
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#updateDeco"><span class="hs-identifier hs-var hs-var">updateDeco</span></a></span></span><span> </span><span id="local-6989586621679501689"><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501689"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501688"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501688"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501687"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501687"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501686"><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501686"><span class="hs-identifier hs-var">decoState</span></a></span></span><span> </span><span id="local-6989586621679501685"><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501685"><span class="hs-identifier hs-var">wd</span></a></span></span><span> </span><span id="local-6989586621679501684"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679501684"><span class="hs-identifier hs-var">isExpose</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoWindow"><span class="hs-identifier hs-var">wdDecoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501685"><span class="hs-identifier hs-var">wd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Maybe Rectangle
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdDecoRect"><span class="hs-identifier hs-var">wdDecoRect</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501685"><span class="hs-identifier hs-var">wd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501683"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501683"><span class="hs-identifier hs-var">decoWindow</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501682"><span class="annot"><span class="annottext">decoRect :: Rectangle
</span><a href="#local-6989586621679501682"><span class="hs-identifier hs-var">decoRect</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679501680"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679501680"><span class="hs-identifier hs-var">wh</span></a></span></span><span> </span><span id="local-6989586621679501679"><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679501679"><span class="hs-identifier hs-var">ht</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679501678"><span class="annot"><span class="annottext">origWin :: Window
</span><a href="#local-6989586621679501678"><span class="hs-identifier hs-var hs-var">origWin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501685"><span class="hs-identifier hs-var">wd</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span id="local-6989586621679501677"><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679501677"><span class="hs-identifier hs-var">drawData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a.
(DecorationEngine engine widget a,
 ThemeAttributes (Theme engine widget),
 HasWidgets (Theme engine) widget) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; DecorationEngineState engine
-&gt; Window
-&gt; Rectangle
-&gt; X (DrawData engine widget)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#mkDrawData"><span class="hs-identifier hs-var">mkDrawData</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501689"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501687"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501686"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501678"><span class="hs-identifier hs-var">origWin</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501682"><span class="hs-identifier hs-var">decoRect</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span id="local-6989586621679501675"><span class="annot"><span class="annottext">WidgetLayout WidgetPlace
</span><a href="#local-6989586621679501675"><span class="hs-identifier hs-var">widgetPlaces</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; Theme engine widget
-&gt; shrinker
-&gt; DecorationEngineState engine
-&gt; Rectangle
-&gt; Window
-&gt; WidgetLayout widget
-&gt; X (WidgetLayout WidgetPlace)
</span><a href="XMonad.Layout.DecorationEx.Engine.html#placeWidgets"><span class="hs-identifier hs-var">placeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501689"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501687"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501688"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">DecorationEngineState engine
</span><a href="#local-6989586621679501686"><span class="hs-identifier hs-var">decoState</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679501682"><span class="hs-identifier hs-var">decoRect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowDecoration -&gt; Window
</span><a href="XMonad.Layout.DecorationEx.Common.html#wdOrigWindow"><span class="hs-identifier hs-var">wdOrigWindow</span></a></span><span> </span><span class="annot"><span class="annottext">WindowDecoration
</span><a href="#local-6989586621679501685"><span class="hs-identifier hs-var">wd</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (theme :: * -&gt; *) widget.
HasWidgets theme widget =&gt;
theme widget -&gt; WidgetLayout widget
</span><a href="XMonad.Layout.DecorationEx.Common.html#themeWidgets"><span class="hs-identifier hs-var">themeWidgets</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501687"><span class="hs-identifier hs-var">theme</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>      </span><span class="hs-comment">-- io $ print widgetPlaces</span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget a shrinker.
(DecorationEngine engine widget a, Shrinker shrinker) =&gt;
engine widget a
-&gt; a
-&gt; Dimension
-&gt; Dimension
-&gt; shrinker
-&gt; DrawData engine widget
-&gt; Bool
-&gt; X ()
</span><a href="XMonad.Layout.DecorationEx.Engine.html#paintDecoration"><span class="hs-identifier hs-var">paintDecoration</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget Window
</span><a href="#local-6989586621679501689"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501683"><span class="hs-identifier hs-var">decoWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679501680"><span class="hs-identifier hs-var">wh</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679501679"><span class="hs-identifier hs-var">ht</span></a></span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501688"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DrawData engine widget
</span><a href="#local-6989586621679501677"><span class="hs-identifier hs-var">drawData</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ddWidgetPlaces :: WidgetLayout WidgetPlace
</span><a href="XMonad.Layout.DecorationEx.Engine.html#ddWidgetPlaces"><span class="hs-identifier hs-var">ddWidgetPlaces</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WidgetLayout WidgetPlace
</span><a href="#local-6989586621679501675"><span class="hs-identifier hs-var">widgetPlaces</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679501684"><span class="hs-identifier hs-var">isExpose</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679501672"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501672"><span class="hs-identifier hs-var">decoWindow</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe Rectangle
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Util.XUtils.html#hideWindow"><span class="hs-identifier hs-var">hideWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679501672"><span class="hs-identifier hs-var">decoWindow</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">(Maybe Window, Maybe Rectangle)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | Apply a DecorationEx modifier to an underlying layout</span><span>
</span><span id="line-314"></span><span id="local-6989586621679502175"><span id="local-6989586621679502176"><span id="local-6989586621679502177"><span id="local-6989586621679502178"><span id="local-6989586621679502179"><span id="local-6989586621679502180"><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#decorationEx"><span class="hs-identifier hs-type">decorationEx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#DecorationEngine"><span class="hs-identifier hs-type">DecorationEngine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502180"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502179"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Geometry.html#DecorationGeometry"><span class="hs-identifier hs-type">DecorationGeometry</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502177"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#Shrinker"><span class="hs-identifier hs-type">Shrinker</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502176"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>             </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502176"><span class="hs-identifier hs-type">shrinker</span></a></span><span>             </span><span class="hs-comment">-- ^ Strings shrinker, for example @shrinkText@</span><span>
</span><span id="line-316"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.DecorationEx.Engine.html#Theme"><span class="hs-identifier hs-type">Theme</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502180"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502179"><span class="hs-identifier hs-type">widget</span></a></span><span>  </span><span class="hs-comment">-- ^ Decoration theme</span><span>
</span><span id="line-317"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502180"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502179"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502178"><span class="hs-identifier hs-type">a</span></a></span><span>      </span><span class="hs-comment">-- ^ Decoration engine instance</span><span>
</span><span id="line-318"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502177"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502178"><span class="hs-identifier hs-type">a</span></a></span><span>               </span><span class="hs-comment">-- ^ Decoration geometry instance</span><span>
</span><span id="line-319"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679502175"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502178"><span class="hs-identifier hs-type">a</span></a></span><span>                  </span><span class="hs-comment">-- ^ Underlying layout to be decorated</span><span>
</span><span id="line-320"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-type">ModifiedLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-type">DecorationEx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502180"><span class="hs-identifier hs-type">engine</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502179"><span class="hs-identifier hs-type">widget</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502177"><span class="hs-identifier hs-type">geom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502176"><span class="hs-identifier hs-type">shrinker</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679502175"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679502178"><span class="hs-identifier hs-type">a</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-321"></span><span id="decorationEx"><span class="annot"><span class="annottext">decorationEx :: forall (engine :: * -&gt; * -&gt; *) widget a (geom :: * -&gt; *) shrinker
       (l :: * -&gt; *).
(DecorationEngine engine widget a, DecorationGeometry geom a,
 Shrinker shrinker) =&gt;
shrinker
-&gt; Theme engine widget
-&gt; engine widget a
-&gt; geom a
-&gt; l a
-&gt; ModifiedLayout (DecorationEx engine widget geom shrinker) l a
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#decorationEx"><span class="hs-identifier hs-var hs-var">decorationEx</span></a></span></span><span> </span><span id="local-6989586621679501667"><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501667"><span class="hs-identifier hs-var">shrinker</span></a></span></span><span> </span><span id="local-6989586621679501666"><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501666"><span class="hs-identifier hs-var">theme</span></a></span></span><span> </span><span id="local-6989586621679501665"><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679501665"><span class="hs-identifier hs-var">engine</span></a></span></span><span> </span><span id="local-6989586621679501664"><span class="annot"><span class="annottext">geom a
</span><a href="#local-6989586621679501664"><span class="hs-identifier hs-var">geom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (l :: * -&gt; *) a.
m a -&gt; l a -&gt; ModifiedLayout m l a
</span><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-var">ModifiedLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (engine :: * -&gt; * -&gt; *) widget (geom :: * -&gt; *) shrinker a.
Invisible Maybe (DecorationLayoutState engine)
-&gt; shrinker
-&gt; Theme engine widget
-&gt; engine widget a
-&gt; geom a
-&gt; DecorationEx engine widget geom shrinker a
</span><a href="XMonad.Layout.DecorationEx.LayoutModifier.html#DecorationEx"><span class="hs-identifier hs-var">DecorationEx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">shrinker
</span><a href="#local-6989586621679501667"><span class="hs-identifier hs-var">shrinker</span></a></span><span> </span><span class="annot"><span class="annottext">Theme engine widget
</span><a href="#local-6989586621679501666"><span class="hs-identifier hs-var">theme</span></a></span><span> </span><span class="annot"><span class="annottext">engine widget a
</span><a href="#local-6989586621679501665"><span class="hs-identifier hs-var">engine</span></a></span><span> </span><span class="annot"><span class="annottext">geom a
</span><a href="#local-6989586621679501664"><span class="hs-identifier hs-var">geom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span></pre></body></html>