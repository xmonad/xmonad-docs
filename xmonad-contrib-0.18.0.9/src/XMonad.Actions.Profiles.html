<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingVia   #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Module      :  XMonad.Actions.Profiles</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Description :  Group your workspaces by similarity.</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Copyright   :  (c) Mislav Zanic</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Maintainer  :  Mislav Zanic &lt;mislavzanic3@gmail.com&gt;</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.Profiles</span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Overview</span></span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- $overview</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier">ProfileId</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier">Profile</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier">ProfileConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Hooks</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#addProfiles"><span class="hs-identifier">addProfiles</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#addProfilesWithHistory"><span class="hs-identifier">addProfilesWithHistory</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Switching profiles</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchToProfile"><span class="hs-identifier">switchToProfile</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Workspace navigation and keybindings</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#wsFilter"><span class="hs-identifier">wsFilter</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#bindOn"><span class="hs-identifier">bindOn</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Loggers and pretty printers</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#excludeWSPP"><span class="hs-identifier">excludeWSPP</span></a></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileLogger"><span class="hs-identifier">profileLogger</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Prompts</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchProfilePrompt"><span class="hs-identifier">switchProfilePrompt</span></a></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#addWSToProfilePrompt"><span class="hs-identifier">addWSToProfilePrompt</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#removeWSFromProfilePrompt"><span class="hs-identifier">removeWSFromProfilePrompt</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchProfileWSPrompt"><span class="hs-identifier">switchProfileWSPrompt</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#shiftProfileWSPrompt"><span class="hs-identifier">shiftProfileWSPrompt</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier">currentProfile</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileIds"><span class="hs-identifier">profileIds</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#previousProfile"><span class="hs-identifier">previousProfile</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileHistory"><span class="hs-identifier">profileHistory</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#allProfileWindows"><span class="hs-identifier">allProfileWindows</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier">profileWorkspaces</span></a></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">)</span><span class="hs-keyword">where</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWS.html"><span class="hs-identifier">XMonad.Actions.CycleWS</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html"><span class="hs-identifier">XMonad.Util.Loggers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier">Logger</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prompt.Window.html"><span class="hs-identifier">XMonad.Prompt.Window</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.Window.html#XWindowMap"><span class="hs-identifier">XWindowMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.WindowBringer.html"><span class="hs-identifier">XMonad.Actions.WindowBringer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.WindowBringer.html#WindowBringerConfig"><span class="hs-identifier">WindowBringerConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html"><span class="hs-identifier">XMonad.Actions.OnScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.OnScreen.html#greedyViewOnScreen"><span class="hs-identifier">greedyViewOnScreen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.Rescreen.html"><span class="hs-identifier">XMonad.Hooks.Rescreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.Rescreen.html#addAfterRescreenHook"><span class="hs-identifier">addAfterRescreenHook</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.DynamicLog.html"><span class="hs-identifier">XMonad.Hooks.DynamicLog</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier">PP</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#ppRename"><span class="hs-identifier">ppRename</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prompt.html"><span class="hs-identifier">XMonad.Prompt</span></a></span><span> </span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- $overview</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- This module allows you to group your workspaces into 'Profile's based on certain similarities.</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- The idea is to expand upon the philosophy set by &quot;XMonad.Actions.TopicSpace&quot;</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- which states that you can look at a topic/workspace as a</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- single unit of work instead of multiple related units of work.</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- This comes in handy if you have lots of workspaces with windows open and need only to</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- work with a few of them at a time. With 'Profile's, you can focus on those few workspaces that</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- require your attention by not displaying, or allowing you to switch to the rest of the workspaces.</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- The best example is having a profile for development and a profile for leisure activities.</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- To use @Profiles@ you need to add it to your XMonad configuration</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- and configure your profiles.</span><span>
</span><span id="line-98"></span><span class="hs-comment">--  </span><span>
</span><span id="line-99"></span><span class="hs-comment">-- First you'll need to handle the imports.</span><span>
</span><span id="line-100"></span><span class="hs-comment">--  </span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt; import XMonad.Actions.Profiles </span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt; import XMonad.Util.EZConfig -- for keybindings</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt; import qualified XMonad.StackSet as W</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt; import qualified XMonad.Actions.DynamicWorkspaceOrder as DO -- for workspace navigation</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Next you'll need to define your profiles.</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt; myStartingProfile :: ProfileId</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt; myStartingProfile = &quot;Work&quot;</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt; myProfiles :: [Profile]</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt; myProfiles =</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;  [ Profile { profileId = &quot;Home&quot;</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- &gt;            , profileWS = [ &quot;www&quot;</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- &gt;                          , &quot;rss&quot;</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &gt;                          , &quot;vid&quot;</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- &gt;                          , &quot;vms&quot;</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &gt;                          , &quot;writing&quot;</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &gt;                          , &quot;notes&quot;</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- &gt;                          ]</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;            }</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- &gt;  , Profile { profileId = &quot;Work&quot;</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- &gt;            , profileWS = [ &quot;www&quot;</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- &gt;                          , &quot;slack&quot;</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- &gt;                          , &quot;dev&quot;</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- &gt;                          , &quot;k8s&quot;</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;                          , &quot;notes&quot;</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- &gt;                          ]</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- &gt;            }</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- &gt;  ]</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- </span><span>
</span><span id="line-132"></span><span class="hs-comment">-- So, while using @Home@ 'Profile', you'll only be able to see, navigate to and </span><span>
</span><span id="line-133"></span><span class="hs-comment">-- do actions with @[&quot;www&quot;, &quot;rss&quot;, &quot;vid&quot;, &quot;vms&quot;, &quot;writing&quot;, &quot;notes&quot;]@ workspaces.</span><span>
</span><span id="line-134"></span><span class="hs-comment">--</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- You may also need to define some keybindings. Since @M-1@ .. @M-9@ are</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- sensible keybindings for switching workspaces, you'll need to use</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- 'bindOn' to have different keybindings per profile.</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- Here, we'll use &quot;XMonad.Util.EZConfig&quot; syntax:</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- </span><span>
</span><span id="line-140"></span><span class="hs-comment">-- &gt; myKeys :: [(String, X())]</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- &gt; myKeys = </span><span>
</span><span id="line-142"></span><span class="hs-comment">-- &gt;   [ (&quot;M-p&quot;,  switchProfilePrompt   xpConfig)</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- &gt;   , (&quot;M-g&quot;,  switchProfileWSPrompt xpConfig)</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- &gt;   , (&quot;M1-j&quot;, DO.moveTo Next wsFilter)</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- &gt;   , (&quot;M1-k&quot;, DO.moveTo Prev wsFilter)</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- &gt;   ]</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- &gt;   &lt;&gt;</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- &gt;   [ (&quot;M-&quot; ++ m ++ k, bindOn $ map (\x -&gt; (fst x, f $ snd x)) i)</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- &gt;   | (i, k) &lt;- map (\(x:xs) -&gt; (map fst (x:xs), snd x)) $ sortGroupBy snd tupleList</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- &gt;   , (f, m) &lt;- [(mby $ windows . W.greedyView, &quot;&quot;), (mby $ windows . W.shift, &quot;S-&quot;)]</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- &gt;   ]</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- &gt;   where</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt;     mby f wid = if wid == &quot;&quot; then return () else f wid</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- &gt;     sortGroupBy f = groupBy (\ x y -&gt; f x == f y) . sortBy (\x y -&gt; compare (f x) (f y))</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- &gt;     tupleList = concatMap (\p -&gt; zip (map (\wid -&gt; (profileId p, wid)) (profileWS p &lt;&gt; repeat &quot;&quot;)) (map show [1..9 :: Int])) myProfiles</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- </span><span>
</span><span id="line-157"></span><span class="hs-comment">-- After that, you'll need to hook @Profiles@ into your XMonad config:</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- </span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt; main = xmonad $ addProfiles def { profiles        = myProfiles</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- &gt;                                 , startingProfile = myStartingProfile</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;                                 }</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- &gt;               $ def `additionalKeysP` myKeys</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- </span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-166"></span><span class="hs-keyword">type</span><span> </span><span id="ProfileId"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-var">ProfileId</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-167"></span><span class="hs-keyword">type</span><span> </span><span id="ProfileMap"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-var">ProfileMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Profile representation.</span><span>
</span><span id="line-171"></span><span class="hs-keyword">data</span><span> </span><span id="Profile"><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Profile"><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="profileId"><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var hs-var">profileId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span>     </span><span class="hs-comment">-- ^ Profile name.</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="profileWS"><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var hs-var">profileWS</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A list of workspaces contained within a profile.</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- | Internal profile state.</span><span>
</span><span id="line-178"></span><span class="hs-keyword">data</span><span> </span><span id="ProfileState"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-var">ProfileState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProfileState"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-var">ProfileState</span></a></span></span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="profilesMap"><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var hs-var">profilesMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="current"><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var hs-var">current</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="previous"><span class="annot"><span class="annottext">ProfileState -&gt; Maybe WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#previous"><span class="hs-identifier hs-var hs-var">previous</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | User config for profiles.</span><span>
</span><span id="line-186"></span><span class="hs-keyword">data</span><span> </span><span id="ProfileConfig"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier hs-var">ProfileConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProfileConfig"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier hs-var">ProfileConfig</span></a></span></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="workspaceExcludes"><span class="annot"><span class="annottext">ProfileConfig -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#workspaceExcludes"><span class="hs-identifier hs-var hs-var">workspaceExcludes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ A list of workspaces to exclude from the @profileHistoryHook@.</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="profiles"><span class="annot"><span class="annottext">ProfileConfig -&gt; [Profile]
</span><a href="XMonad.Actions.Profiles.html#profiles"><span class="hs-identifier hs-var hs-var">profiles</span></a></span></span><span>          </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span class="hs-special">]</span><span>     </span><span class="hs-comment">-- ^ A list of user-defined profiles.</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="startingProfile"><span class="annot"><span class="annottext">ProfileConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#startingProfile"><span class="hs-identifier hs-var hs-var">startingProfile</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span>     </span><span class="hs-comment">-- ^ Profile shown on startup.</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-193"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier hs-type">ProfileConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>  </span><span id="local-6989586621679479726"><span class="annot"><span class="annottext">def :: ProfileConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier hs-type">ProfileConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">workspaceExcludes :: [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#workspaceExcludes"><span class="hs-identifier hs-var">workspaceExcludes</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">profiles :: [Profile]
</span><a href="XMonad.Actions.Profiles.html#profiles"><span class="hs-identifier hs-var">profiles</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">startingProfile :: WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#startingProfile"><span class="hs-identifier hs-var">startingProfile</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-197"></span><span>                                 </span><span class="hs-special">}</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679479720"><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="local-6989586621679479718"><span class="annot"><span class="annottext">initialValue :: ProfileState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileMap -&gt; Maybe Profile -&gt; Maybe WorkspaceId -&gt; ProfileState
</span><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-var">ProfileState</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- Internal type for history tracking.</span><span>
</span><span id="line-205"></span><span class="hs-comment">-- Main problem with @XMonad.Hooks.HistoryHook@ is that it isn't profile aware.</span><span>
</span><span id="line-206"></span><span class="hs-comment">-- Because of that, when switching to a previous workspace, you might switch to</span><span>
</span><span id="line-207"></span><span class="hs-comment">-- a workspace</span><span>
</span><span id="line-208"></span><span class="hs-keyword">newtype</span><span> </span><span id="ProfileHistory"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileHistory"><span class="hs-identifier hs-var">ProfileHistory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProfileHistory"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileHistory"><span class="hs-identifier hs-var">ProfileHistory</span></a></span></span><span>
</span><span id="line-209"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="history"><span class="annot"><span class="annottext">ProfileHistory -&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="XMonad.Actions.Profiles.html#history"><span class="hs-identifier hs-var hs-var">history</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679479695"><span id="local-6989586621679479707"><span id="local-6989586621679479710"><span id="local-6989586621679479712"><span class="annot"><span class="annottext">ReadPrec [ProfileHistory]
ReadPrec ProfileHistory
Int -&gt; ReadS ProfileHistory
ReadS [ProfileHistory]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [ProfileHistory]
$creadListPrec :: ReadPrec [ProfileHistory]
readPrec :: ReadPrec ProfileHistory
$creadPrec :: ReadPrec ProfileHistory
readList :: ReadS [ProfileHistory]
$creadList :: ReadS [ProfileHistory]
readsPrec :: Int -&gt; ReadS ProfileHistory
$creadsPrec :: Int -&gt; ReadS ProfileHistory
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679479674"><span id="local-6989586621679479676"><span id="local-6989586621679479684"><span class="annot"><span class="annottext">Int -&gt; ProfileHistory -&gt; ShowS
[ProfileHistory] -&gt; ShowS
ProfileHistory -&gt; WorkspaceId
forall a.
(Int -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceId) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProfileHistory] -&gt; ShowS
$cshowList :: [ProfileHistory] -&gt; ShowS
show :: ProfileHistory -&gt; WorkspaceId
$cshow :: ProfileHistory -&gt; WorkspaceId
showsPrec :: Int -&gt; ProfileHistory -&gt; ShowS
$cshowsPrec :: Int -&gt; ProfileHistory -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679479664"><span class="annot"><span class="annottext">ProfileHistory -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: ProfileHistory -&gt; ()
$crnf :: ProfileHistory -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span> </span><span class="hs-keyword">via</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileHistory"><span class="hs-identifier hs-type">ProfileHistory</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679479642"><span class="annot"><span class="annottext">extensionType :: ProfileHistory -&gt; StateExtension
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">extensionType</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Read a, Show a, ExtensionClass a) =&gt; a -&gt; StateExtension
</span><span class="hs-identifier hs-var">PersistentExtension</span></span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679479639"><span class="annot"><span class="annottext">initialValue :: ProfileHistory
</span><a href="#local-6989586621679479639"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)] -&gt; ProfileHistory
</span><a href="XMonad.Actions.Profiles.html#ProfileHistory"><span class="hs-identifier hs-var">ProfileHistory</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-220"></span><span class="hs-keyword">newtype</span><span> </span><span id="ProfilePrompt"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProfilePrompt"><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-223"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679479627"><span id="local-6989586621679479629"><span id="local-6989586621679479631"><span id="local-6989586621679479633"><span id="local-6989586621679479635"><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-type">ProfilePrompt</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679479625"><span class="annot"><span class="annottext">showXPrompt :: ProfilePrompt -&gt; WorkspaceId
</span><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-var hs-var hs-var hs-var">showXPrompt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-type">ProfilePrompt</span></a></span><span> </span><span id="local-6989586621679479623"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479623"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479623"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-227"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-type">defaultProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-228"></span><span id="defaultProfile"><span class="annot"><span class="annottext">defaultProfile :: Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var hs-var">defaultProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Returns current profile.</span><span>
</span><span id="line-232"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-type">currentProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span>
</span><span id="line-233"></span><span id="currentProfile"><span class="annot"><span class="annottext">currentProfile :: X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var hs-var">currentProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var">profileId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Returns previous profile.</span><span>
</span><span id="line-237"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#previousProfile"><span class="hs-identifier hs-type">previousProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span id="previousProfile"><span class="annot"><span class="annottext">previousProfile :: X (Maybe WorkspaceId)
</span><a href="XMonad.Actions.Profiles.html#previousProfile"><span class="hs-identifier hs-var hs-var">previousProfile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#previous"><span class="hs-identifier hs-var">previous</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Returns the history of viewed workspaces per profile.</span><span>
</span><span id="line-242"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileHistory"><span class="hs-identifier hs-type">profileHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span id="profileHistory"><span class="annot"><span class="annottext">profileHistory :: X (Map WorkspaceId [(ScreenId, WorkspaceId)])
</span><a href="XMonad.Actions.Profiles.html#profileHistory"><span class="hs-identifier hs-var hs-var">profileHistory</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileHistory -&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="XMonad.Actions.Profiles.html#history"><span class="hs-identifier hs-var">history</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-246"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileMap"><span class="hs-identifier hs-type">profileMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span>
</span><span id="line-247"></span><span id="profileMap"><span class="annot"><span class="annottext">profileMap :: X ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profileMap"><span class="hs-identifier hs-var hs-var">profileMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Returns ids of all profiles.</span><span>
</span><span id="line-251"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileIds"><span class="hs-identifier hs-type">profileIds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-252"></span><span id="profileIds"><span class="annot"><span class="annottext">profileIds :: X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileIds"><span class="hs-identifier hs-var hs-var">profileIds</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">Map.keys</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-255"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-type">currentProfileWorkspaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span>
</span><span id="line-256"></span><span id="currentProfileWorkspaces"><span class="annot"><span class="annottext">currentProfileWorkspaces :: X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var hs-var">currentProfileWorkspaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- | Hook profiles into XMonad. This function adds a startup hook that</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- sets up ProfileState. Also adds an afterRescreenHook for viewing correct</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- workspaces when adding new screens.</span><span>
</span><span id="line-262"></span><span id="local-6989586621679480111"><span class="annot"><a href="XMonad.Actions.Profiles.html#addProfiles"><span class="hs-identifier hs-type">addProfiles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier hs-type">ProfileConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679480111"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679480111"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-263"></span><span id="addProfiles"><span class="annot"><span class="annottext">addProfiles :: forall (a :: * -&gt; *). ProfileConfig -&gt; XConfig a -&gt; XConfig a
</span><a href="XMonad.Actions.Profiles.html#addProfiles"><span class="hs-identifier hs-var hs-var">addProfiles</span></a></span></span><span> </span><span id="local-6989586621679479608"><span class="annot"><span class="annottext">ProfileConfig
</span><a href="#local-6989586621679479608"><span class="hs-identifier hs-var">profConf</span></a></span></span><span> </span><span id="local-6989586621679479607"><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479607"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). X () -&gt; XConfig l -&gt; XConfig l
</span><a href="XMonad.Hooks.Rescreen.html#addAfterRescreenHook"><span class="hs-identifier hs-var">addAfterRescreenHook</span></a></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679479606"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479607"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">startupHook :: X ()
</span><span class="hs-identifier hs-var">startupHook</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679479604"><span class="hs-identifier hs-var">profileStartupHook'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; X ()
</span><span class="hs-identifier hs-var">startupHook</span></span><span> </span><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479607"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-266"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>   </span><span class="annot"><a href="#local-6989586621679479604"><span class="hs-identifier hs-type">profileStartupHook'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>   </span><span id="local-6989586621679479604"><span class="annot"><span class="annottext">profileStartupHook' :: X ()
</span><a href="#local-6989586621679479604"><span class="hs-identifier hs-var hs-var">profileStartupHook'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Profile] -&gt; WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#profilesStartupHook"><span class="hs-identifier hs-var">profilesStartupHook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProfileConfig -&gt; [Profile]
</span><a href="XMonad.Actions.Profiles.html#profiles"><span class="hs-identifier hs-var">profiles</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileConfig
</span><a href="#local-6989586621679479608"><span class="hs-identifier hs-var">profConf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProfileConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#startingProfile"><span class="hs-identifier hs-var">startingProfile</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileConfig
</span><a href="#local-6989586621679479608"><span class="hs-identifier hs-var">profConf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>   </span><span id="local-6989586621679479606"><span class="annot"><span class="annottext">hook :: X ()
</span><a href="#local-6989586621679479606"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchWSOnScreens"><span class="hs-identifier hs-var">switchWSOnScreens</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Hooks profiles into XMonad and enables Profile history logging.</span><span>
</span><span id="line-273"></span><span id="local-6989586621679479600"><span class="annot"><a href="XMonad.Actions.Profiles.html#addProfilesWithHistory"><span class="hs-identifier hs-type">addProfilesWithHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileConfig"><span class="hs-identifier hs-type">ProfileConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679479600"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679479600"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-274"></span><span id="addProfilesWithHistory"><span class="annot"><span class="annottext">addProfilesWithHistory :: forall (a :: * -&gt; *). ProfileConfig -&gt; XConfig a -&gt; XConfig a
</span><a href="XMonad.Actions.Profiles.html#addProfilesWithHistory"><span class="hs-identifier hs-var hs-var">addProfilesWithHistory</span></a></span></span><span> </span><span id="local-6989586621679479597"><span class="annot"><span class="annottext">ProfileConfig
</span><a href="#local-6989586621679479597"><span class="hs-identifier hs-var">profConf</span></a></span></span><span> </span><span id="local-6989586621679479596"><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479596"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479595"><span class="hs-identifier hs-var">conf'</span></a></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">logHook :: X ()
</span><span class="hs-identifier hs-var">logHook</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId] -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#profileHistoryHookExclude"><span class="hs-identifier hs-var">profileHistoryHookExclude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProfileConfig -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#workspaceExcludes"><span class="hs-identifier hs-var">workspaceExcludes</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileConfig
</span><a href="#local-6989586621679479597"><span class="hs-identifier hs-var">profConf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; X ()
</span><span class="hs-identifier hs-var">logHook</span></span><span> </span><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479596"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>   </span><span id="local-6989586621679479595"><span class="annot"><span class="annottext">conf' :: XConfig a
</span><a href="#local-6989586621679479595"><span class="hs-identifier hs-var hs-var">conf'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; *). ProfileConfig -&gt; XConfig a -&gt; XConfig a
</span><a href="XMonad.Actions.Profiles.html#addProfiles"><span class="hs-identifier hs-var">addProfiles</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileConfig
</span><a href="#local-6989586621679479597"><span class="hs-identifier hs-var">profConf</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig a
</span><a href="#local-6989586621679479596"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-281"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileHistoryHookExclude"><span class="hs-identifier hs-type">profileHistoryHookExclude</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span id="profileHistoryHookExclude"><span class="annot"><span class="annottext">profileHistoryHookExclude :: [WorkspaceId] -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#profileHistoryHookExclude"><span class="hs-identifier hs-var hs-var">profileHistoryHookExclude</span></a></span></span><span> </span><span id="local-6989586621679479592"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479592"><span class="hs-identifier hs-var">ews</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>  </span><span id="local-6989586621679479591"><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679479591"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679479587"><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679479587"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var">W.visible</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679479585"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479585"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var">currentProfileWorkspaces</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679479584"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479584"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [(ScreenId, WorkspaceId)] -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#updateHist"><span class="hs-identifier hs-var">updateHist</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479584"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {b} {l} {a} {sid} {sd}. [Screen b l a sid sd] -&gt; [(sid, b)]
</span><a href="#local-6989586621679479582"><span class="hs-identifier hs-var">workspaceScreenPairs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {l} {a} {sid} {sd}.
Foldable t =&gt;
t WorkspaceId
-&gt; [Screen WorkspaceId l a sid sd]
-&gt; [Screen WorkspaceId l a sid sd]
</span><a href="#local-6989586621679479581"><span class="hs-identifier hs-var">filterWS</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479585"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679479591"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679479587"><span class="hs-identifier hs-var">vis</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>    </span><span id="local-6989586621679479582"><span class="annot"><span class="annottext">workspaceScreenPairs :: [Screen b l a sid sd] -&gt; [(sid, b)]
</span><a href="#local-6989586621679479582"><span class="hs-identifier hs-var hs-var">workspaceScreenPairs</span></a></span></span><span> </span><span id="local-6989586621679479578"><span class="annot"><span class="annottext">[Screen b l a sid sd]
</span><a href="#local-6989586621679479578"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Screen b l a sid sd]
</span><a href="#local-6989586621679479578"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Screen b l a sid sd]
</span><a href="#local-6989586621679479578"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621679479581"><span class="annot"><span class="annottext">filterWS :: t WorkspaceId
-&gt; [Screen WorkspaceId l a sid sd]
-&gt; [Screen WorkspaceId l a sid sd]
</span><a href="#local-6989586621679479581"><span class="hs-identifier hs-var hs-var">filterWS</span></a></span></span><span> </span><span id="local-6989586621679479568"><span class="annot"><span class="annottext">t WorkspaceId
</span><a href="#local-6989586621679479568"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679479567"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479567"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479567"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">t WorkspaceId
</span><a href="#local-6989586621679479568"><span class="hs-identifier hs-var">pws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479567"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479592"><span class="hs-identifier hs-var">ews</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-294"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#updateHist"><span class="hs-identifier hs-type">updateHist</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span id="updateHist"><span class="annot"><span class="annottext">updateHist :: WorkspaceId -&gt; [(ScreenId, WorkspaceId)] -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#updateHist"><span class="hs-identifier hs-var hs-var">updateHist</span></a></span></span><span> </span><span id="local-6989586621679479563"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479563"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span id="local-6989586621679479562"><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479562"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier hs-var">profileWorkspaces</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479563"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify%27"><span class="hs-identifier hs-var">XS.modify'</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId] -&gt; ProfileHistory -&gt; ProfileHistory
</span><a href="#local-6989586621679479560"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679479560"><span class="annot"><span class="annottext">update :: [WorkspaceId] -&gt; ProfileHistory -&gt; ProfileHistory
</span><a href="#local-6989586621679479560"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679479558"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479558"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span id="local-6989586621679479557"><span class="annot"><span class="annottext">ProfileHistory
</span><a href="#local-6989586621679479557"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileHistory
</span><a href="#local-6989586621679479557"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">history :: Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="XMonad.Actions.Profiles.html#history"><span class="hs-identifier hs-var">history</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
-&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
-&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479555"><span class="hs-identifier hs-var">doUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479558"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileHistory -&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="XMonad.Actions.Profiles.html#history"><span class="hs-identifier hs-var">history</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileHistory
</span><a href="#local-6989586621679479557"><span class="hs-identifier hs-var">hs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>    </span><span id="local-6989586621679479555"><span class="annot"><span class="annottext">doUpdate :: [WorkspaceId]
-&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
-&gt; Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479555"><span class="hs-identifier hs-var hs-var">doUpdate</span></a></span></span><span> </span><span id="local-6989586621679479549"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479549"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span id="local-6989586621679479548"><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479548"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679479546"><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479546"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679479545"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679479545"><span class="hs-identifier hs-var">sid</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679479544"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479544"><span class="hs-identifier hs-var">wid</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a.
Ord k =&gt;
(Maybe a -&gt; Maybe a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.alter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {f :: * -&gt; *}.
Applicative f =&gt;
[WorkspaceId]
-&gt; ScreenId
-&gt; WorkspaceId
-&gt; Maybe [(ScreenId, WorkspaceId)]
-&gt; f [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479542"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479549"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679479545"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479544"><span class="hs-identifier hs-var">wid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479563"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479546"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479548"><span class="hs-identifier hs-var">hist</span></a></span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479562"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679479542"><span class="annot"><span class="annottext">f :: [WorkspaceId]
-&gt; ScreenId
-&gt; WorkspaceId
-&gt; Maybe [(ScreenId, WorkspaceId)]
-&gt; f [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479542"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679479538"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479538"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span id="local-6989586621679479537"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679479537"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679479536"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479536"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span id="local-6989586621679479535"><span class="annot"><span class="annottext">Maybe [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479535"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479535"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><span class="annottext">Maybe [(ScreenId, WorkspaceId)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679479537"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479536"><span class="hs-identifier hs-var">wid</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479534"><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479534"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679479533"><span class="annot"><span class="annottext">new :: (ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479533"><span class="hs-identifier hs-var hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679479537"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479536"><span class="hs-identifier hs-var">wid</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479533"><span class="hs-identifier hs-var">new</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[WorkspaceId]
-&gt; (ScreenId, WorkspaceId)
-&gt; [(ScreenId, WorkspaceId)]
-&gt; [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479532"><span class="hs-identifier hs-var">filterWS</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479538"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479533"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479534"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="#local-6989586621679479532"><span class="hs-identifier hs-type">filterWS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679479532"><span class="annot"><span class="annottext">filterWS :: [WorkspaceId]
-&gt; (ScreenId, WorkspaceId)
-&gt; [(ScreenId, WorkspaceId)]
-&gt; [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479532"><span class="hs-identifier hs-var hs-var">filterWS</span></a></span></span><span> </span><span id="local-6989586621679479531"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479531"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span id="local-6989586621679479530"><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479530"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679479529"><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479529"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479529"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479531"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479529"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">(ScreenId, WorkspaceId)
</span><a href="#local-6989586621679479530"><span class="hs-identifier hs-var">new</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | Adds profiles to ProfileState and sets current profile using .</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profilesStartupHook"><span class="hs-identifier hs-type">profilesStartupHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span id="profilesStartupHook"><span class="annot"><span class="annottext">profilesStartupHook :: [Profile] -&gt; WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#profilesStartupHook"><span class="hs-identifier hs-var hs-var">profilesStartupHook</span></a></span></span><span> </span><span id="local-6989586621679479527"><span class="annot"><span class="annottext">[Profile]
</span><a href="#local-6989586621679479527"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679479526"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479526"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479524"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchWSOnScreens"><span class="hs-identifier hs-var">switchWSOnScreens</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479526"><span class="hs-identifier hs-var">pid</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="#local-6989586621679479524"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679479524"><span class="annot"><span class="annottext">go :: ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479524"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679479523"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479523"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479523"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">profilesMap :: ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileMap -&gt; ProfileMap
</span><a href="#local-6989586621679479522"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479523"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">current :: Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileMap -&gt; Maybe Profile
</span><a href="#local-6989586621679479521"><span class="hs-identifier hs-var">setCurrentProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; (WorkspaceId, Profile)
</span><a href="#local-6989586621679479519"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">[Profile]
</span><a href="#local-6989586621679479527"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="#local-6989586621679479522"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span id="local-6989586621679479522"><span class="annot"><span class="annottext">update :: ProfileMap -&gt; ProfileMap
</span><a href="#local-6989586621679479522"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.union</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; (WorkspaceId, Profile)
</span><a href="#local-6989586621679479519"><span class="hs-identifier hs-var">entry</span></a></span><span> </span><span class="annot"><span class="annottext">[Profile]
</span><a href="#local-6989586621679479527"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><a href="#local-6989586621679479519"><span class="hs-identifier hs-type">entry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679479519"><span class="annot"><span class="annottext">entry :: Profile -&gt; (WorkspaceId, Profile)
</span><a href="#local-6989586621679479519"><span class="hs-identifier hs-var hs-var">entry</span></a></span></span><span> </span><span id="local-6989586621679479517"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479517"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var">profileId</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479517"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479517"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><a href="#local-6989586621679479521"><span class="hs-identifier hs-type">setCurrentProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679479521"><span class="annot"><span class="annottext">setCurrentProfile :: ProfileMap -&gt; Maybe Profile
</span><a href="#local-6989586621679479521"><span class="hs-identifier hs-var hs-var">setCurrentProfile</span></a></span></span><span> </span><span id="local-6989586621679479516"><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479516"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479526"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479516"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><span class="annottext">Maybe Profile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId] -&gt; Profile
</span><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479526"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479514"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479514"><span class="hs-identifier hs-var">pn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479514"><span class="hs-identifier hs-var">pn</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-329"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#setPrevious"><span class="hs-identifier hs-type">setPrevious</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span id="setPrevious"><span class="annot"><span class="annottext">setPrevious :: WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#setPrevious"><span class="hs-identifier hs-var hs-var">setPrevious</span></a></span></span><span> </span><span id="local-6989586621679479512"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479512"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479511"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621679479511"><span class="annot"><span class="annottext">update :: ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479511"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679479510"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479510"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479510"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">previous :: Maybe WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#previous"><span class="hs-identifier hs-var">previous</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe WorkspaceId
</span><a href="#local-6989586621679479509"><span class="hs-identifier hs-var">doUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479510"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-333"></span><span>    </span><span id="local-6989586621679479509"><span class="annot"><span class="annottext">doUpdate :: ProfileState -&gt; Maybe WorkspaceId
</span><a href="#local-6989586621679479509"><span class="hs-identifier hs-var hs-var">doUpdate</span></a></span></span><span> </span><span id="local-6989586621679479506"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479506"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479512"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479506"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><span class="annottext">Maybe Profile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#previous"><span class="hs-identifier hs-var">previous</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479506"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479505"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479505"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var">profileId</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479505"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-338"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#setProfile"><span class="hs-identifier hs-type">setProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span id="setProfile"><span class="annot"><span class="annottext">setProfile :: WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#setProfile"><span class="hs-identifier hs-var hs-var">setProfile</span></a></span></span><span> </span><span id="local-6989586621679479503"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479503"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#setPrevious"><span class="hs-identifier hs-var">setPrevious</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#setProfile%27"><span class="hs-identifier hs-var">setProfile'</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479503"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-342"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#setProfile%27"><span class="hs-identifier hs-type">setProfile'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span id="setProfile%27"><span class="annot"><span class="annottext">setProfile' :: WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#setProfile%27"><span class="hs-identifier hs-var hs-var">setProfile'</span></a></span></span><span> </span><span id="local-6989586621679479501"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479501"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479500"><span class="hs-identifier hs-var">update</span></a></span><span>
</span><span id="line-344"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-345"></span><span>    </span><span id="local-6989586621679479500"><span class="annot"><span class="annottext">update :: ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479500"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679479499"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479499"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479499"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">current :: Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="#local-6989586621679479498"><span class="hs-identifier hs-var">doUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479499"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679479498"><span class="annot"><span class="annottext">doUpdate :: ProfileState -&gt; Maybe Profile
</span><a href="#local-6989586621679479498"><span class="hs-identifier hs-var hs-var">doUpdate</span></a></span></span><span> </span><span id="local-6989586621679479495"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479495"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479501"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479495"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-347"></span><span>      </span><span class="annot"><span class="annottext">Maybe Profile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479495"><span class="hs-identifier hs-var">ps</span></a></span><span>
</span><span id="line-348"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479494"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479494"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479494"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Switch to a profile.</span><span>
</span><span id="line-352"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchToProfile"><span class="hs-identifier hs-type">switchToProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span id="switchToProfile"><span class="annot"><span class="annottext">switchToProfile :: WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchToProfile"><span class="hs-identifier hs-var hs-var">switchToProfile</span></a></span></span><span> </span><span id="local-6989586621679479493"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479493"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#setProfile"><span class="hs-identifier hs-var">setProfile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479493"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchWSOnScreens"><span class="hs-identifier hs-var">switchWSOnScreens</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479493"><span class="hs-identifier hs-var">pid</span></a></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Returns the workspace ids associated with a profile id.</span><span>
</span><span id="line-357"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier hs-type">profileWorkspaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span id="profileWorkspaces"><span class="annot"><span class="annottext">profileWorkspaces :: WorkspaceId -&gt; X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier hs-var hs-var">profileWorkspaces</span></a></span></span><span> </span><span id="local-6989586621679479492"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479492"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profileMap"><span class="hs-identifier hs-var">profileMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}. Monad m =&gt; ProfileMap -&gt; m [WorkspaceId]
</span><a href="#local-6989586621679479491"><span class="hs-identifier hs-var">findPWs</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-360"></span><span>    </span><span id="local-6989586621679479491"><span class="annot"><span class="annottext">findPWs :: ProfileMap -&gt; m [WorkspaceId]
</span><a href="#local-6989586621679479491"><span class="hs-identifier hs-var hs-var">findPWs</span></a></span></span><span> </span><span id="local-6989586621679479486"><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479486"><span class="hs-identifier hs-var">pm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479492"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479486"><span class="hs-identifier hs-var">pm</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Prompt for adding a workspace id to a profile.</span><span>
</span><span id="line-364"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#addWSToProfilePrompt"><span class="hs-identifier hs-type">addWSToProfilePrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span id="addWSToProfilePrompt"><span class="annot"><span class="annottext">addWSToProfilePrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#addWSToProfilePrompt"><span class="hs-identifier hs-var hs-var">addWSToProfilePrompt</span></a></span></span><span> </span><span id="local-6989586621679479485"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479485"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679479484"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479484"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileIds"><span class="hs-identifier hs-var">profileIds</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Add ws to profile:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479485"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479485"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479484"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479481"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-369"></span><span>   </span><span class="annot"><a href="#local-6989586621679479481"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>   </span><span id="local-6989586621679479481"><span class="annot"><span class="annottext">f :: WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479481"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679479480"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479480"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>     </span><span id="local-6989586621679479479"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479479"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var">W.visible</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-372"></span><span>     </span><span id="local-6989586621679479478"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479478"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-373"></span><span>     </span><span id="local-6989586621679479477"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479477"><span class="hs-identifier hs-var">hid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.hidden</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-374"></span><span>     </span><span class="hs-keyword">let</span><span>
</span><span id="line-375"></span><span>       </span><span id="local-6989586621679479473"><span class="annot"><span class="annottext">arr :: [WorkspaceId]
</span><a href="#local-6989586621679479473"><span class="hs-identifier hs-var hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479478"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479479"><span class="hs-identifier hs-var">vis</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479477"><span class="hs-identifier hs-var">hid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Ws to add to profile:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479485"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479485"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479473"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#addWSToProfile"><span class="hs-operator hs-var">`addWSToProfile`</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479480"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- | Prompt for switching profiles.</span><span>
</span><span id="line-380"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchProfilePrompt"><span class="hs-identifier hs-type">switchProfilePrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span id="switchProfilePrompt"><span class="annot"><span class="annottext">switchProfilePrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchProfilePrompt"><span class="hs-identifier hs-var hs-var">switchProfilePrompt</span></a></span></span><span> </span><span id="local-6989586621679479471"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479471"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-382"></span><span>  </span><span id="local-6989586621679479470"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479470"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileIds"><span class="hs-identifier hs-var">profileIds</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Profile: &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479471"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479471"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479470"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchToProfile"><span class="hs-identifier hs-var">switchToProfile</span></a></span><span>
</span><span id="line-384"></span><span>     </span><span>
</span><span id="line-385"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- | Prompt for switching workspaces.</span><span>
</span><span id="line-387"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchProfileWSPrompt"><span class="hs-identifier hs-type">switchProfileWSPrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span id="switchProfileWSPrompt"><span class="annot"><span class="annottext">switchProfileWSPrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchProfileWSPrompt"><span class="hs-identifier hs-var hs-var">switchProfileWSPrompt</span></a></span></span><span> </span><span id="local-6989586621679479469"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479469"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId] -&gt; X ()
</span><a href="#local-6989586621679479468"><span class="hs-identifier hs-var">mkPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var">currentProfileWorkspaces</span></a></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679479468"><span class="annot"><span class="annottext">mkPrompt :: [WorkspaceId] -&gt; X ()
</span><a href="#local-6989586621679479468"><span class="hs-identifier hs-var hs-var">mkPrompt</span></a></span></span><span> </span><span id="local-6989586621679479465"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479465"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Switch to workspace:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479469"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479469"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479465"><span class="hs-identifier hs-var">pws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479464"><span class="hs-identifier hs-var">mbygoto</span></a></span><span> </span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679479464"><span class="annot"><span class="annottext">mbygoto :: WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479464"><span class="hs-identifier hs-var hs-var">mbygoto</span></a></span></span><span> </span><span id="local-6989586621679479455"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479455"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-392"></span><span>      </span><span id="local-6989586621679479454"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479454"><span class="hs-identifier hs-var">pw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier hs-var">profileWorkspaces</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span>
</span><span id="line-393"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479455"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479454"><span class="hs-identifier hs-var">pw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.greedyView</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479455"><span class="hs-identifier hs-var">wid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-396"></span><span class="hs-comment">-- | Prompt for shifting windows to a different workspace.</span><span>
</span><span id="line-397"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#shiftProfileWSPrompt"><span class="hs-identifier hs-type">shiftProfileWSPrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span id="shiftProfileWSPrompt"><span class="annot"><span class="annottext">shiftProfileWSPrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#shiftProfileWSPrompt"><span class="hs-identifier hs-var hs-var">shiftProfileWSPrompt</span></a></span></span><span> </span><span id="local-6989586621679479450"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479450"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId] -&gt; X ()
</span><a href="#local-6989586621679479449"><span class="hs-identifier hs-var">mkPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var">currentProfileWorkspaces</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-400"></span><span>    </span><span id="local-6989586621679479449"><span class="annot"><span class="annottext">mkPrompt :: [WorkspaceId] -&gt; X ()
</span><a href="#local-6989586621679479449"><span class="hs-identifier hs-var hs-var">mkPrompt</span></a></span></span><span> </span><span id="local-6989586621679479447"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479447"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Send window to workspace:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479450"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479450"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479447"><span class="hs-identifier hs-var">pws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479446"><span class="hs-identifier hs-var">mbyshift</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span id="local-6989586621679479446"><span class="annot"><span class="annottext">mbyshift :: WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479446"><span class="hs-identifier hs-var hs-var">mbyshift</span></a></span></span><span> </span><span id="local-6989586621679479435"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479435"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>      </span><span id="local-6989586621679479434"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479434"><span class="hs-identifier hs-var">pw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier hs-var">profileWorkspaces</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479435"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479434"><span class="hs-identifier hs-var">pw</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shift</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479435"><span class="hs-identifier hs-var">wid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>
</span><span id="line-405"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-406"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#addWSToProfile"><span class="hs-identifier hs-type">addWSToProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span id="addWSToProfile"><span class="annot"><span class="annottext">addWSToProfile :: WorkspaceId -&gt; WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#addWSToProfile"><span class="hs-identifier hs-var hs-var">addWSToProfile</span></a></span></span><span> </span><span id="local-6989586621679479432"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479432"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span id="local-6989586621679479431"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479431"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479430"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>   </span><span class="annot"><a href="#local-6989586621679479430"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span><span>
</span><span id="line-410"></span><span>   </span><span id="local-6989586621679479430"><span class="annot"><span class="annottext">go :: ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479430"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679479429"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479429"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479429"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">profilesMap :: ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileMap -&gt; ProfileMap
</span><a href="#local-6989586621679479428"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479429"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">current :: Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Profile -&gt; Maybe Profile
</span><a href="#local-6989586621679479427"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479429"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span>   </span><span class="annot"><a href="#local-6989586621679479428"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span>
</span><span id="line-413"></span><span>   </span><span id="local-6989586621679479428"><span class="annot"><span class="annottext">update :: ProfileMap -&gt; ProfileMap
</span><a href="#local-6989586621679479428"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679479426"><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479426"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479431"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479426"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-414"></span><span>     </span><span class="annot"><span class="annottext">Maybe Profile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479426"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-415"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479425"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479425"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479432"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479425"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479426"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; Profile
</span><a href="#local-6989586621679479423"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479431"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479426"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span>   </span><span class="annot"><a href="#local-6989586621679479423"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-418"></span><span>   </span><span id="local-6989586621679479423"><span class="annot"><span class="annottext">f :: Profile -&gt; Profile
</span><a href="#local-6989586621679479423"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679479422"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479422"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId] -&gt; Profile
</span><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479431"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479432"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479422"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span>   </span><span class="annot"><a href="#local-6989586621679479427"><span class="hs-identifier hs-type">update'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-421"></span><span>   </span><span id="local-6989586621679479427"><span class="annot"><span class="annottext">update' :: Profile -&gt; Maybe Profile
</span><a href="#local-6989586621679479427"><span class="hs-identifier hs-var hs-var">update'</span></a></span></span><span> </span><span id="local-6989586621679479421"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479421"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var">profileId</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479421"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479431"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479432"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479421"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId] -&gt; Profile
</span><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479431"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479432"><span class="hs-identifier hs-var">wid</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479421"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479421"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- | Prompt for removing a workspace from a profile.</span><span>
</span><span id="line-425"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#removeWSFromProfilePrompt"><span class="hs-identifier hs-type">removeWSFromProfilePrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span id="removeWSFromProfilePrompt"><span class="annot"><span class="annottext">removeWSFromProfilePrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#removeWSFromProfilePrompt"><span class="hs-identifier hs-var hs-var">removeWSFromProfilePrompt</span></a></span></span><span> </span><span id="local-6989586621679479420"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479420"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>  </span><span id="local-6989586621679479419"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479419"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileIds"><span class="hs-identifier hs-var">profileIds</span></a></span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Remove ws from profile:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479420"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479420"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479419"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479418"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>   </span><span class="annot"><a href="#local-6989586621679479418"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>   </span><span id="local-6989586621679479418"><span class="annot"><span class="annottext">f :: WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479418"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679479417"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479417"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-432"></span><span>     </span><span id="local-6989586621679479416"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479416"><span class="hs-identifier hs-var">arr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWorkspaces"><span class="hs-identifier hs-var">profileWorkspaces</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479417"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-433"></span><span>     </span><span class="annot"><span class="annottext">forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; ProfilePrompt
</span><a href="XMonad.Actions.Profiles.html#ProfilePrompt"><span class="hs-identifier hs-var">ProfilePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Ws to remove from profile:&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479420"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XPConfig -&gt; [WorkspaceId] -&gt; ComplFunction
</span><a href="XMonad.Prompt.html#mkComplFunFromList%27"><span class="hs-identifier hs-var">mkComplFunFromList'</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679479420"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479416"><span class="hs-identifier hs-var">arr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-434"></span><span>       </span><span class="hs-glyph">\</span><span id="local-6989586621679479415"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479415"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-435"></span><span>         </span><span id="local-6989586621679479414"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479414"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span>
</span><span id="line-436"></span><span>         </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479415"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#removeWSFromProfile"><span class="hs-operator hs-var">`removeWSFromProfile`</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479417"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span>
</span><span id="line-437"></span><span>         </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479414"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479417"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchWSOnScreens"><span class="hs-identifier hs-var">switchWSOnScreens</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-440"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#removeWSFromProfile"><span class="hs-identifier hs-type">removeWSFromProfile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span id="removeWSFromProfile"><span class="annot"><span class="annottext">removeWSFromProfile :: WorkspaceId -&gt; WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#removeWSFromProfile"><span class="hs-identifier hs-var hs-var">removeWSFromProfile</span></a></span></span><span> </span><span id="local-6989586621679479411"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479411"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span id="local-6989586621679479410"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479410"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479409"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-443"></span><span>   </span><span class="annot"><a href="#local-6989586621679479409"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileState"><span class="hs-identifier hs-type">ProfileState</span></a></span><span>
</span><span id="line-444"></span><span>   </span><span id="local-6989586621679479409"><span class="annot"><span class="annottext">go :: ProfileState -&gt; ProfileState
</span><a href="#local-6989586621679479409"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679479408"><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479408"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479408"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">profilesMap :: ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProfileMap -&gt; ProfileMap
</span><a href="#local-6989586621679479407"><span class="hs-identifier hs-var">update</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profilesMap"><span class="hs-identifier hs-var">profilesMap</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479408"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">current :: Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Profile -&gt; Maybe Profile
</span><a href="#local-6989586621679479406"><span class="hs-identifier hs-var">update'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState
</span><a href="#local-6989586621679479408"><span class="hs-identifier hs-var">ps</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span>   </span><span class="annot"><a href="#local-6989586621679479407"><span class="hs-identifier hs-type">update</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileMap"><span class="hs-identifier hs-type">ProfileMap</span></a></span><span>
</span><span id="line-447"></span><span>   </span><span id="local-6989586621679479407"><span class="annot"><span class="annottext">update :: ProfileMap -&gt; ProfileMap
</span><a href="#local-6989586621679479407"><span class="hs-identifier hs-var hs-var">update</span></a></span></span><span> </span><span id="local-6989586621679479405"><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479405"><span class="hs-identifier hs-var">mp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479410"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479405"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-448"></span><span>     </span><span class="annot"><span class="annottext">Maybe Profile
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479405"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-449"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479404"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479404"><span class="hs-identifier hs-var">p</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479411"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479404"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a) -&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.adjust</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; Profile
</span><a href="#local-6989586621679479403"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479410"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479405"><span class="hs-identifier hs-var">mp</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ProfileMap
</span><a href="#local-6989586621679479405"><span class="hs-identifier hs-var">mp</span></a></span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span>   </span><span class="annot"><a href="#local-6989586621679479403"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-452"></span><span>   </span><span id="local-6989586621679479403"><span class="annot"><span class="annottext">f :: Profile -&gt; Profile
</span><a href="#local-6989586621679479403"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679479402"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479402"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId] -&gt; Profile
</span><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479410"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">delete</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479411"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479402"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span>   </span><span class="annot"><a href="#local-6989586621679479406"><span class="hs-identifier hs-type">update'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-type">Profile</span></a></span><span>
</span><span id="line-455"></span><span>   </span><span id="local-6989586621679479406"><span class="annot"><span class="annottext">update' :: Profile -&gt; Maybe Profile
</span><a href="#local-6989586621679479406"><span class="hs-identifier hs-var hs-var">update'</span></a></span></span><span> </span><span id="local-6989586621679479400"><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479400"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var">profileId</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479400"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479410"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479411"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479400"><span class="hs-identifier hs-var">cp</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId] -&gt; Profile
</span><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479410"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">delete</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479411"><span class="hs-identifier hs-var">wid</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479400"><span class="hs-identifier hs-var">cp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="#local-6989586621679479400"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- | Pretty printer for a bar. Prints workspace ids of current profile.</span><span>
</span><span id="line-459"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#excludeWSPP"><span class="hs-identifier hs-type">excludeWSPP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span>
</span><span id="line-460"></span><span id="excludeWSPP"><span class="annot"><span class="annottext">excludeWSPP :: PP -&gt; X PP
</span><a href="XMonad.Actions.Profiles.html#excludeWSPP"><span class="hs-identifier hs-var hs-var">excludeWSPP</span></a></span></span><span> </span><span id="local-6989586621679479399"><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679479399"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *}. Foldable t =&gt; t WorkspaceId -&gt; PP
</span><a href="#local-6989586621679479398"><span class="hs-identifier hs-var">modifyPP</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var">currentProfileWorkspaces</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679479398"><span class="annot"><span class="annottext">modifyPP :: t WorkspaceId -&gt; PP
</span><a href="#local-6989586621679479398"><span class="hs-identifier hs-var hs-var">modifyPP</span></a></span></span><span> </span><span id="local-6989586621679479395"><span class="annot"><span class="annottext">t WorkspaceId
</span><a href="#local-6989586621679479395"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679479399"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ppRename :: WorkspaceId
-&gt; Workspace WorkspaceId (Layout Window) Window -&gt; WorkspaceId
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppRename"><span class="hs-identifier hs-var">ppRename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PP
-&gt; WorkspaceId
-&gt; Workspace WorkspaceId (Layout Window) Window
-&gt; WorkspaceId
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppRename"><span class="hs-identifier hs-var">ppRename</span></a></span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679479399"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *}. Foldable t =&gt; t WorkspaceId -&gt; ShowS
</span><a href="#local-6989586621679479394"><span class="hs-identifier hs-var">printTag</span></a></span><span> </span><span class="annot"><span class="annottext">t WorkspaceId
</span><a href="#local-6989586621679479395"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-463"></span><span>    </span><span id="local-6989586621679479394"><span class="annot"><span class="annottext">printTag :: t WorkspaceId -&gt; ShowS
</span><a href="#local-6989586621679479394"><span class="hs-identifier hs-var hs-var">printTag</span></a></span></span><span> </span><span id="local-6989586621679479389"><span class="annot"><span class="annottext">t WorkspaceId
</span><a href="#local-6989586621679479389"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span id="local-6989586621679479388"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479388"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479388"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">t WorkspaceId
</span><a href="#local-6989586621679479389"><span class="hs-identifier hs-var">pws</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479388"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | For cycling through workspaces associated with the current.</span><span>
</span><span id="line-467"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#wsFilter"><span class="hs-identifier hs-type">wsFilter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.CycleWS.html#WSType"><span class="hs-identifier hs-type">WSType</span></a></span><span>
</span><span id="line-468"></span><span id="wsFilter"><span class="annot"><span class="annottext">wsFilter :: WSType
</span><a href="XMonad.Actions.Profiles.html#wsFilter"><span class="hs-identifier hs-var hs-var">wsFilter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X (Workspace WorkspaceId (Layout Window) Window -&gt; Bool) -&gt; WSType
</span><a href="XMonad.Actions.CycleWS.html#WSIs"><span class="hs-identifier hs-var">WSIs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var">currentProfileWorkspaces</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679479386"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479386"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479386"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span class="hs-special">)</span><span>
</span><span id="line-469"></span><span>
</span><span id="line-470"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-471"></span><span class="hs-comment">-- Takes care of placing correct workspaces on their respective screens.</span><span>
</span><span id="line-472"></span><span class="hs-comment">-- It does this by reducing the history of a Profile until it gets an array of length</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- equal to the number of screens with pairs that have unique workspace ids.</span><span>
</span><span id="line-474"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#switchWSOnScreens"><span class="hs-identifier hs-type">switchWSOnScreens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Profiles.html#ProfileId"><span class="hs-identifier hs-type">ProfileId</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span id="switchWSOnScreens"><span class="annot"><span class="annottext">switchWSOnScreens :: WorkspaceId -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#switchWSOnScreens"><span class="hs-identifier hs-var hs-var">switchWSOnScreens</span></a></span></span><span> </span><span id="local-6989586621679479385"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479385"><span class="hs-identifier hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621679479384"><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479384"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (Map WorkspaceId [(ScreenId, WorkspaceId)])
</span><a href="XMonad.Actions.Profiles.html#profileHistory"><span class="hs-identifier hs-var">profileHistory</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621679479383"><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679479383"><span class="hs-identifier hs-var">vis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var">W.visible</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-478"></span><span>  </span><span id="local-6989586621679479382"><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679479382"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-479"></span><span>  </span><span id="local-6989586621679479381"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479381"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X ProfileMap
</span><a href="XMonad.Actions.Profiles.html#profileMap"><span class="hs-identifier hs-var">profileMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Profile -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#profileWS"><span class="hs-identifier hs-var">profileWS</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId] -&gt; Profile
</span><a href="XMonad.Actions.Profiles.html#Profile"><span class="hs-identifier hs-var">Profile</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479385"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479385"><span class="hs-identifier hs-var">pid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479385"><span class="hs-identifier hs-var">pid</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479384"><span class="hs-identifier hs-var">hist</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><span class="annottext">Maybe [(ScreenId, WorkspaceId)]
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)] -&gt; X ()
</span><a href="#local-6989586621679479380"><span class="hs-identifier hs-var">switchScreens</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679479382"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679479383"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479381"><span class="hs-identifier hs-var">pws</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479379"><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479379"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {i} {l} {a} {sd}.
[(ScreenId, WorkspaceId)]
-&gt; [Screen i l a ScreenId sd] -&gt; [WorkspaceId] -&gt; X ()
</span><a href="#local-6989586621679479378"><span class="hs-identifier hs-var">compareAndSwitch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ScreenId]
-&gt; [(ScreenId, WorkspaceId)] -&gt; [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479377"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679479382"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679479383"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479379"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679479382"><span class="hs-identifier hs-var">cur</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679479383"><span class="hs-identifier hs-var">vis</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479381"><span class="hs-identifier hs-var">pws</span></a></span><span>
</span><span id="line-483"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><a href="#local-6989586621679479377"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-485"></span><span>    </span><span id="local-6989586621679479377"><span class="annot"><span class="annottext">f :: [ScreenId]
-&gt; [(ScreenId, WorkspaceId)] -&gt; [(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479377"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679479376"><span class="annot"><span class="annottext">[ScreenId]
</span><a href="#local-6989586621679479376"><span class="hs-identifier hs-var">sids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; [(v, k)]
</span><a href="#local-6989586621679479375"><span class="hs-identifier hs-var">reorderUniq</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; [(v, k)]
</span><a href="#local-6989586621679479375"><span class="hs-identifier hs-var">reorderUniq</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[ScreenId]
</span><a href="#local-6989586621679479376"><span class="hs-identifier hs-var">sids</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>    </span><span id="local-6989586621679479985"><span id="local-6989586621679479986"><span class="annot"><a href="#local-6989586621679479375"><span class="hs-identifier hs-type">reorderUniq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679479986"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679479985"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679479986"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679479985"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679479985"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679479986"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-488"></span><span>    </span><span id="local-6989586621679479375"><span class="annot"><span class="annottext">reorderUniq :: forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; [(v, k)]
</span><a href="#local-6989586621679479375"><span class="hs-identifier hs-var hs-var">reorderUniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679479369"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679479369"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679479368"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679479368"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679479368"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679479369"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679479367"><span class="hs-identifier hs-var">uniq</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span>    </span><span id="local-6989586621679479978"><span id="local-6989586621679479979"><span class="annot"><a href="#local-6989586621679479367"><span class="hs-identifier hs-type">uniq</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679479979"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679479978"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679479979"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679479978"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679479979"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679479978"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-491"></span><span>    </span><span id="local-6989586621679479367"><span class="annot"><span class="annottext">uniq :: forall k v. (Ord k, Ord v) =&gt; [(k, v)] -&gt; [(k, v)]
</span><a href="#local-6989586621679479367"><span class="hs-identifier hs-var hs-var">uniq</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span>    </span><span id="local-6989586621679479362"><span class="annot"><span class="annottext">viewWS :: (t -&gt; t -&gt; WindowSet -&gt; WindowSet) -&gt; t -&gt; t -&gt; X ()
</span><a href="#local-6989586621679479362"><span class="hs-identifier hs-var hs-var">viewWS</span></a></span></span><span> </span><span id="local-6989586621679479361"><span class="annot"><span class="annottext">t -&gt; t -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679479361"><span class="hs-identifier hs-var">fview</span></a></span></span><span> </span><span id="local-6989586621679479360"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679479360"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679479359"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679479359"><span class="hs-identifier hs-var">wid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679479361"><span class="hs-identifier hs-var">fview</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679479360"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679479359"><span class="hs-identifier hs-var">wid</span></a></span><span>
</span><span id="line-494"></span><span>
</span><span id="line-495"></span><span>    </span><span id="local-6989586621679479380"><span class="annot"><span class="annottext">switchScreens :: [(ScreenId, WorkspaceId)] -&gt; X ()
</span><a href="#local-6989586621679479380"><span class="hs-identifier hs-var hs-var">switchScreens</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t} {t}.
(t -&gt; t -&gt; WindowSet -&gt; WindowSet) -&gt; t -&gt; t -&gt; X ()
</span><a href="#local-6989586621679479362"><span class="hs-identifier hs-var">viewWS</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#greedyViewOnScreen"><span class="hs-identifier hs-var">greedyViewOnScreen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621679479378"><span class="annot"><span class="annottext">compareAndSwitch :: [(ScreenId, WorkspaceId)]
-&gt; [Screen i l a ScreenId sd] -&gt; [WorkspaceId] -&gt; X ()
</span><a href="#local-6989586621679479378"><span class="hs-identifier hs-var hs-var">compareAndSwitch</span></a></span></span><span> </span><span id="local-6989586621679479347"><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479347"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span id="local-6989586621679479346"><span class="annot"><span class="annottext">[Screen i l a ScreenId sd]
</span><a href="#local-6989586621679479346"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span id="local-6989586621679479345"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479345"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479347"><span class="hs-identifier hs-var">hist</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Screen i l a ScreenId sd]
</span><a href="#local-6989586621679479346"><span class="hs-identifier hs-var">wins</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)] -&gt; X ()
</span><a href="#local-6989586621679479380"><span class="hs-identifier hs-var">switchScreens</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479347"><span class="hs-identifier hs-var">hist</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {b} {i} {l} {a} {sd}.
(Eq a, Eq b) =&gt;
[(a, b)] -&gt; [Screen i l a a sd] -&gt; [b] -&gt; [(a, b)]
</span><a href="#local-6989586621679479342"><span class="hs-identifier hs-var">populateScreens</span></a></span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479347"><span class="hs-identifier hs-var">hist</span></a></span><span> </span><span class="annot"><span class="annottext">[Screen i l a ScreenId sd]
</span><a href="#local-6989586621679479346"><span class="hs-identifier hs-var">wins</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479345"><span class="hs-identifier hs-var">pws</span></a></span><span>
</span><span id="line-498"></span><span>                                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)] -&gt; X ()
</span><a href="#local-6989586621679479380"><span class="hs-identifier hs-var">switchScreens</span></a></span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479347"><span class="hs-identifier hs-var">hist</span></a></span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span>    </span><span id="local-6989586621679479342"><span class="annot"><span class="annottext">populateScreens :: [(a, b)] -&gt; [Screen i l a a sd] -&gt; [b] -&gt; [(a, b)]
</span><a href="#local-6989586621679479342"><span class="hs-identifier hs-var hs-var">populateScreens</span></a></span></span><span> </span><span id="local-6989586621679479334"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679479334"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span id="local-6989586621679479333"><span class="annot"><span class="annottext">[Screen i l a a sd]
</span><a href="#local-6989586621679479333"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span id="local-6989586621679479332"><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679479332"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679479334"><span class="hs-identifier hs-var">hist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Screen i l a a sd]
</span><a href="#local-6989586621679479333"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679479334"><span class="hs-identifier hs-var">hist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[b]
</span><a href="#local-6989586621679479332"><span class="hs-identifier hs-var">pws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-503"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#chooseAction"><span class="hs-identifier hs-type">chooseAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span id="chooseAction"><span class="annot"><span class="annottext">chooseAction :: (WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#chooseAction"><span class="hs-identifier hs-var hs-var">chooseAction</span></a></span></span><span> </span><span id="local-6989586621679479330"><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479330"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">ProfileState -&gt; Maybe Profile
</span><a href="XMonad.Actions.Profiles.html#current"><span class="hs-identifier hs-var">current</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Profile -&gt; WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#profileId"><span class="hs-identifier hs-var">profileId</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Profile
</span><a href="XMonad.Actions.Profiles.html#defaultProfile"><span class="hs-identifier hs-var">defaultProfile</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479330"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-505"></span><span>
</span><span id="line-506"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- | Create keybindings per profile.</span><span>
</span><span id="line-508"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#bindOn"><span class="hs-identifier hs-type">bindOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span id="bindOn"><span class="annot"><span class="annottext">bindOn :: [(WorkspaceId, X ())] -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#bindOn"><span class="hs-identifier hs-var hs-var">bindOn</span></a></span></span><span> </span><span id="local-6989586621679479329"><span class="annot"><span class="annottext">[(WorkspaceId, X ())]
</span><a href="#local-6989586621679479329"><span class="hs-identifier hs-var">bindings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WorkspaceId -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Actions.Profiles.html#chooseAction"><span class="hs-identifier hs-var">chooseAction</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479328"><span class="hs-identifier hs-var">chooser</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-511"></span><span>    </span><span id="local-6989586621679479328"><span class="annot"><span class="annottext">chooser :: WorkspaceId -&gt; X ()
</span><a href="#local-6989586621679479328"><span class="hs-identifier hs-var hs-var">chooser</span></a></span></span><span> </span><span id="local-6989586621679479323"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479323"><span class="hs-identifier hs-var">profile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479323"><span class="hs-identifier hs-var">profile</span></a></span><span> </span><span class="annot"><span class="annottext">[(WorkspaceId, X ())]
</span><a href="#local-6989586621679479329"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-512"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479321"><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679479321"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679479321"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-513"></span><span>        </span><span class="annot"><span class="annottext">Maybe (X ())
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a b. Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b
</span><span class="hs-identifier hs-var">lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">[(WorkspaceId, X ())]
</span><a href="#local-6989586621679479329"><span class="hs-identifier hs-var">bindings</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-514"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679479320"><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679479320"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679479320"><span class="hs-identifier hs-var">action</span></a></span><span>
</span><span id="line-515"></span><span>            </span><span class="annot"><span class="annottext">Maybe (X ())
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- | Loggs currentProfile and all profiles with hidden workspaces</span><span>
</span><span id="line-519"></span><span class="hs-comment">--   (workspaces that aren't shown on a screen but have windows).</span><span>
</span><span id="line-520"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#profileLogger"><span class="hs-identifier hs-type">profileLogger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-521"></span><span id="profileLogger"><span class="annot"><span class="annottext">profileLogger :: ShowS -&gt; ShowS -&gt; X (Maybe WorkspaceId)
</span><a href="XMonad.Actions.Profiles.html#profileLogger"><span class="hs-identifier hs-var hs-var">profileLogger</span></a></span></span><span> </span><span id="local-6989586621679479319"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679479319"><span class="hs-identifier hs-var">formatFocused</span></a></span></span><span> </span><span id="local-6989586621679479318"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679479318"><span class="hs-identifier hs-var">formatUnfocused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-522"></span><span>  </span><span id="local-6989586621679479317"><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Window) Window]
</span><a href="#local-6989586621679479317"><span class="hs-identifier hs-var">hws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.hidden</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-523"></span><span>  </span><span id="local-6989586621679479316"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479316"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceId
</span><a href="XMonad.Actions.Profiles.html#currentProfile"><span class="hs-identifier hs-var">currentProfile</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span id="local-6989586621679479315"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479315"><span class="hs-identifier hs-var">hm</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span>
</span><span id="line-525"></span><span>      </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679479314"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479314"><span class="hs-identifier hs-var">p'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679479313"><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479313"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall {b} {l} {a}. [Workspace b l a] -&gt; [b]
</span><a href="#local-6989586621679479311"><span class="hs-identifier hs-var">htags</span></a></span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Window) Window]
</span><a href="#local-6989586621679479317"><span class="hs-identifier hs-var">hws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(ScreenId, WorkspaceId)]
</span><a href="#local-6989586621679479313"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479314"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479316"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>      </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X (Map WorkspaceId [(ScreenId, WorkspaceId)])
</span><a href="XMonad.Actions.Profiles.html#profileHistory"><span class="hs-identifier hs-var">profileHistory</span></a></span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679479309"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479309"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679479308"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479308"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479309"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479308"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; ShowS
</span><a href="#local-6989586621679479307"><span class="hs-identifier hs-var">format</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479316"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479315"><span class="hs-identifier hs-var">hm</span></a></span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-529"></span><span>    </span><span id="local-6989586621679479307"><span class="annot"><span class="annottext">format :: WorkspaceId -&gt; ShowS
</span><a href="#local-6989586621679479307"><span class="hs-identifier hs-var hs-var">format</span></a></span></span><span> </span><span id="local-6989586621679479304"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479304"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679479303"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479303"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479303"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479304"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679479319"><span class="hs-identifier hs-var">formatFocused</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479303"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679479318"><span class="hs-identifier hs-var">formatUnfocused</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679479303"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span id="local-6989586621679479311"><span class="annot"><span class="annottext">htags :: [Workspace b l a] -&gt; [b]
</span><a href="#local-6989586621679479311"><span class="hs-identifier hs-var hs-var">htags</span></a></span></span><span> </span><span id="local-6989586621679479301"><span class="annot"><span class="annottext">[Workspace b l a]
</span><a href="#local-6989586621679479301"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Workspace b l a]
</span><a href="#local-6989586621679479301"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-531"></span><span>
</span><span id="line-532"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- | @XWindowMap@ of all windows contained in a profile.</span><span>
</span><span id="line-534"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#allProfileWindows"><span class="hs-identifier hs-type">allProfileWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.Window.html#XWindowMap"><span class="hs-identifier hs-type">XWindowMap</span></a></span><span>
</span><span id="line-535"></span><span id="allProfileWindows"><span class="annot"><span class="annottext">allProfileWindows :: XWindowMap
</span><a href="XMonad.Actions.Profiles.html#allProfileWindows"><span class="hs-identifier hs-var hs-var">allProfileWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowBringerConfig -&gt; XWindowMap
</span><a href="XMonad.Actions.Profiles.html#allProfileWindows%27"><span class="hs-identifier hs-var">allProfileWindows'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-536"></span><span>
</span><span id="line-537"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-538"></span><span class="annot"><a href="XMonad.Actions.Profiles.html#allProfileWindows%27"><span class="hs-identifier hs-type">allProfileWindows'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.WindowBringer.html#WindowBringerConfig"><span class="hs-identifier hs-type">WindowBringerConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.Window.html#XWindowMap"><span class="hs-identifier hs-type">XWindowMap</span></a></span><span>
</span><span id="line-539"></span><span id="allProfileWindows%27"><span class="annot"><span class="annottext">allProfileWindows' :: WindowBringerConfig -&gt; XWindowMap
</span><a href="XMonad.Actions.Profiles.html#allProfileWindows%27"><span class="hs-identifier hs-var hs-var">allProfileWindows'</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Actions.WindowBringer.html#WindowBringerConfig"><span class="hs-identifier hs-type">WindowBringerConfig</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">windowTitler :: WindowBringerConfig
-&gt; Workspace WorkspaceId (Layout Window) Window
-&gt; Window
-&gt; X WorkspaceId
</span><a href="XMonad.Actions.WindowBringer.html#windowTitler"><span class="hs-identifier hs-var">windowTitler</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679479295"><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
-&gt; Window -&gt; X WorkspaceId
</span><a href="#local-6989586621679479295"><span class="hs-identifier hs-var">titler</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">windowFilter :: WindowBringerConfig -&gt; Window -&gt; X Bool
</span><a href="XMonad.Actions.WindowBringer.html#windowFilter"><span class="hs-identifier hs-var">windowFilter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679479293"><span class="annot"><span class="annottext">Window -&gt; X Bool
</span><a href="#local-6989586621679479293"><span class="hs-identifier hs-var">include</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-540"></span><span>  </span><span id="local-6989586621679479292"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479292"><span class="hs-identifier hs-var">pws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Actions.Profiles.html#currentProfileWorkspaces"><span class="hs-identifier hs-var">currentProfileWorkspaces</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621679479291"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679479291"><span class="hs-identifier hs-var">windowSet</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-542"></span><span>  </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
-&gt; X [(WorkspaceId, Window)]
</span><a href="#local-6989586621679479288"><span class="hs-identifier hs-var">keyValuePairs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679479292"><span class="hs-identifier hs-var">pws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679479291"><span class="hs-identifier hs-var">windowSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679479288"><span class="annot"><span class="annottext">keyValuePairs :: Workspace WorkspaceId (Layout Window) Window
-&gt; X [(WorkspaceId, Window)]
</span><a href="#local-6989586621679479288"><span class="hs-identifier hs-var hs-var">keyValuePairs</span></a></span></span><span> </span><span id="local-6989586621679479282"><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679479282"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679479281"><span class="annot"><span class="annottext">wins :: [Window]
</span><a href="#local-6989586621679479281"><span class="hs-identifier hs-var hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679479282"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>                           </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
-&gt; Window -&gt; X (WorkspaceId, Window)
</span><a href="#local-6989586621679479279"><span class="hs-identifier hs-var">keyValuePair</span></a></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679479282"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X Bool
</span><a href="#local-6989586621679479293"><span class="hs-identifier hs-var">include</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679479281"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-545"></span><span>         </span><span id="local-6989586621679479279"><span class="annot"><span class="annottext">keyValuePair :: Workspace WorkspaceId (Layout Window) Window
-&gt; Window -&gt; X (WorkspaceId, Window)
</span><a href="#local-6989586621679479279"><span class="hs-identifier hs-var hs-var">keyValuePair</span></a></span></span><span> </span><span id="local-6989586621679479276"><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679479276"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621679479275"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679479275"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679479275"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
-&gt; Window -&gt; X WorkspaceId
</span><a href="#local-6989586621679479295"><span class="hs-identifier hs-var">titler</span></a></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679479276"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679479275"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-546"></span></pre></body></html>