<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      :  XMonad.Util.Loggers</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Description :  A collection of simple logger functions and formatting utilities.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   :  (c) Brent Yorgey, Wirt Wolff</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  :  &lt;byorgey@gmail.com&gt;</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- A collection of simple logger functions and formatting utilities</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- which can be used in the 'XMonad.Hooks.StatusBar.PP.ppExtras' field of</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- a pretty-printing status logger format. See &quot;XMonad.Hooks.StatusBar.PP&quot;</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- for more information.</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Util.Loggers</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>      </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier">Logger</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><span class="hs-comment">-- * System Loggers</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- $system</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#aumixVolume"><span class="hs-identifier">aumixVolume</span></a></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#battery"><span class="hs-identifier">battery</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#date"><span class="hs-identifier">date</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#loadAvg"><span class="hs-identifier">loadAvg</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#maildirNew"><span class="hs-identifier">maildirNew</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#maildirUnread"><span class="hs-identifier">maildirUnread</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logCmd"><span class="hs-identifier">logCmd</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logFileCount"><span class="hs-identifier">logFileCount</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><span class="hs-comment">-- * XMonad Loggers</span></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><span class="hs-comment">-- $xmonad</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logCurrent"><span class="hs-identifier">logCurrent</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logLayout"><span class="hs-identifier">logLayout</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitle"><span class="hs-identifier">logTitle</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitles"><span class="hs-identifier">logTitles</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitles%27"><span class="hs-identifier">logTitles'</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassname"><span class="hs-identifier">logClassname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnames"><span class="hs-identifier">logClassnames</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnames%27"><span class="hs-identifier">logClassnames'</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logConst"><span class="hs-identifier">logConst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logDefault"><span class="hs-identifier">logDefault</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#.%7C"><span class="hs-operator">(.|)</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- * XMonad: Screen-specific Loggers</span></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="hs-comment">-- $xmonad-screen</span></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logCurrentOnScreen"><span class="hs-identifier">logCurrentOnScreen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logLayoutOnScreen"><span class="hs-identifier">logLayoutOnScreen</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitleOnScreen"><span class="hs-identifier">logTitleOnScreen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnameOnScreen"><span class="hs-identifier">logClassnameOnScreen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logWhenActive"><span class="hs-identifier">logWhenActive</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitlesOnScreen"><span class="hs-identifier">logTitlesOnScreen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitlesOnScreen%27"><span class="hs-identifier">logTitlesOnScreen'</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnamesOnScreen"><span class="hs-identifier">logClassnamesOnScreen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnamesOnScreen%27"><span class="hs-identifier">logClassnamesOnScreen'</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier">TitlesFormat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier">ClassnamesFormat</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Formatting Utilities</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- $format</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier">onLogger</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#wrapL"><span class="hs-identifier">wrapL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#fixedWidthL"><span class="hs-identifier">fixedWidthL</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#logSp"><span class="hs-identifier">logSp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#padL"><span class="hs-identifier">padL</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#shortenL"><span class="hs-identifier">shortenL</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#dzenColorL"><span class="hs-identifier">dzenColorL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#xmobarColorL"><span class="hs-identifier">xmobarColorL</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Default</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftIO</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.Core</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html"><span class="hs-identifier">XMonad.Hooks.StatusBar.PP</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.UrgencyHook.html"><span class="hs-identifier">XMonad.Hooks.UrgencyHook</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.UrgencyHook.html#readUrgents"><span class="hs-identifier">readUrgents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html"><span class="hs-identifier">XMonad.Util.Font</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Font.html#Align"><span class="hs-identifier">Align</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.NamedWindows.html"><span class="hs-identifier">XMonad.Util.NamedWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedWindows.html#getName"><span class="hs-identifier">getName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.NamedWindows.html#getNameWMClass"><span class="hs-identifier">getNameWMClass</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">E</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPrefixOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isSuffixOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prelude.html#WindowScreen"><span class="hs-identifier">WindowScreen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">formatTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCurrentTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getDirectoryContents</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hGetLine</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">runInteractiveCommand</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span id="local-6989586621679458150"><span id="local-6989586621679458151"><span class="annot"><a href="XMonad.Util.Loggers.html#econst"><span class="hs-identifier hs-type">econst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679458151"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458150"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IOException</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458151"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458150"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-74"></span><span id="econst"><span class="annot"><span class="annottext">econst :: forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; IOException -&gt; m a
</span><a href="XMonad.Util.Loggers.html#econst"><span class="hs-identifier hs-var hs-var">econst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Use this module by importing it into your @xmonad.hs@:</span><span>
</span><span id="line-78"></span><span class="hs-comment">--</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &gt; import XMonad.Util.Loggers</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- Then, add one or more loggers to the</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- 'XMonad.Hooks.StatusBar.PP.ppExtras' field of your</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- &quot;XMonad.Hooks.StatusBar.PP&quot;, possibly with extra formatting .</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt; myPP = def {</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt;            ppExtras = [ padL loadAvg, logCmd &quot;fortune -n 40 -s&quot; ]</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt;         }</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt;   -- gives something like &quot; 3.27 3.52 3.26 Drive defensively.  Buy a tank.&quot;</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- See the formatting section below for another example using</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- a @where@ block to define some formatted loggers for a top-level</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- @myPP@.</span><span>
</span><span id="line-94"></span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Loggers are named either for their function, as in 'battery',</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- 'aumixVolume', and 'maildirNew', or are prefixed with \&quot;log\&quot; when</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- making use of other functions or by analogy with the pp* functions.</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- For example, the logger version of 'XMonad.Hooks.StatusBar.PP.ppTitle'</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- is 'logTitle', and 'logFileCount' loggerizes the result of file</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- counting code.</span><span>
</span><span id="line-101"></span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- Formatting utility names are generally as short as possible and</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- carry the suffix \&quot;L\&quot;. For example, the logger version of</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- 'XMonad.Hooks.StatusBar.PP.shorten' is 'shortenL'.</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- Of course, there is nothing really special about these so-called</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- \&quot;loggers\&quot;: they are just @X (Maybe String)@ actions.  So you can</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- use them anywhere you would use an @X (Maybe String)@, not just</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- with PP.</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- Additional loggers welcome!</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- | 'Logger' is just a convenient synonym for @X (Maybe String)@.</span><span>
</span><span id="line-116"></span><span class="hs-keyword">type</span><span> </span><span id="Logger"><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-var">Logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- $system</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Get the current volume with @aumix@. &lt;http://jpj.net/~trevor/aumix.html&gt;</span><span>
</span><span id="line-121"></span><span class="annot"><a href="XMonad.Util.Loggers.html#aumixVolume"><span class="hs-identifier hs-type">aumixVolume</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-122"></span><span id="aumixVolume"><span class="annot"><span class="annottext">aumixVolume :: Logger
</span><a href="XMonad.Util.Loggers.html#aumixVolume"><span class="hs-identifier hs-var hs-var">aumixVolume</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logCmd"><span class="hs-identifier hs-var">logCmd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;aumix -vq&quot;</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Get the battery status (percent charge and charging\/discharging</span><span>
</span><span id="line-125"></span><span class="hs-comment">--   status). This is an ugly hack and may not work for some people.</span><span>
</span><span id="line-126"></span><span class="hs-comment">--   At some point it would be nice to make this more general\/have</span><span>
</span><span id="line-127"></span><span class="hs-comment">--   fewer dependencies (assumes @acpi@ and @sed@ are installed.)</span><span>
</span><span id="line-128"></span><span class="annot"><a href="XMonad.Util.Loggers.html#battery"><span class="hs-identifier hs-type">battery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-129"></span><span id="battery"><span class="annot"><span class="annottext">battery :: Logger
</span><a href="XMonad.Util.Loggers.html#battery"><span class="hs-identifier hs-var hs-var">battery</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logCmd"><span class="hs-identifier hs-var">logCmd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;acpi | sed -r 's/.*?: (.*%).*/\\1/; s/[dD]ischarging, ([0-9]+%)/\\1-/; s/[cC]harging, ([0-9]+%)/\\1+/; s/[cC]harged, //'&quot;</span></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Get the current date and time, and format them via the</span><span>
</span><span id="line-132"></span><span class="hs-comment">--   given format string.  The format used is the same as that used</span><span>
</span><span id="line-133"></span><span class="hs-comment">--   by the C library function strftime; for example,</span><span>
</span><span id="line-134"></span><span class="hs-comment">--   @date \&quot;%a %b %d\&quot;@ might display something like @Tue Feb 19@.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--   For more information see something like</span><span>
</span><span id="line-136"></span><span class="hs-comment">--   &lt;http://www.cplusplus.com/reference/clibrary/ctime/strftime.html&gt;.</span><span>
</span><span id="line-137"></span><span class="annot"><a href="XMonad.Util.Loggers.html#date"><span class="hs-identifier hs-type">date</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-138"></span><span id="date"><span class="annot"><span class="annottext">date :: String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#date"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span id="local-6989586621679457885"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457885"><span class="hs-identifier hs-var">fmt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457885"><span class="hs-identifier hs-var">fmt</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- | Get the load average.  This assumes that you have a</span><span>
</span><span id="line-141"></span><span class="hs-comment">--   utility called @uptime@ and that you have @sed@</span><span>
</span><span id="line-142"></span><span class="hs-comment">--   installed; these are fairly common on GNU\/Linux systems but it</span><span>
</span><span id="line-143"></span><span class="hs-comment">--   would be nice to make this more general.</span><span>
</span><span id="line-144"></span><span class="annot"><a href="XMonad.Util.Loggers.html#loadAvg"><span class="hs-identifier hs-type">loadAvg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-145"></span><span id="loadAvg"><span class="annot"><span class="annottext">loadAvg :: Logger
</span><a href="XMonad.Util.Loggers.html#loadAvg"><span class="hs-identifier hs-var hs-var">loadAvg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logCmd"><span class="hs-identifier hs-var">logCmd</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;uptime | sed 's/.*: //; s/,//g'&quot;</span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Create a 'Logger' from an arbitrary shell command.</span><span>
</span><span id="line-148"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logCmd"><span class="hs-identifier hs-type">logCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-149"></span><span id="logCmd"><span class="annot"><span class="annottext">logCmd :: String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logCmd"><span class="hs-identifier hs-var hs-var">logCmd</span></a></span></span><span> </span><span id="local-6989586621679457882"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457882"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679457881"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679457881"><span class="hs-identifier hs-var">out</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Handle, Handle, Handle, ProcessHandle)
</span><span class="hs-identifier hs-var">runInteractiveCommand</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457882"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-150"></span><span>                   </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO String
</span><span class="hs-identifier hs-var">hGetLine</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679457881"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall e a. Exception e =&gt; IO a -&gt; (e -&gt; IO a) -&gt; IO a
</span><span class="hs-operator hs-var">`E.catch`</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; IOException -&gt; m a
</span><a href="XMonad.Util.Loggers.html#econst"><span class="hs-identifier hs-var">econst</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-151"></span><span>                   </span><span class="hs-comment">-- no need to waitForProcess, we ignore SIGCHLD</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- | Get a count of filtered files in a directory.</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- See 'maildirUnread' and 'maildirNew' source for usage examples.</span><span>
</span><span id="line-155"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logFileCount"><span class="hs-identifier hs-type">logFileCount</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>          </span><span class="hs-comment">-- ^ directory in which to count files</span><span>
</span><span id="line-156"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ predicate to match if file should be counted</span><span>
</span><span id="line-157"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-158"></span><span id="logFileCount"><span class="annot"><span class="annottext">logFileCount :: String -&gt; (String -&gt; Bool) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logFileCount"><span class="hs-identifier hs-var hs-var">logFileCount</span></a></span></span><span> </span><span id="local-6989586621679457878"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457878"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679457877"><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679457877"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>    </span><span id="local-6989586621679457876"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679457876"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO [String]
</span><span class="hs-identifier hs-var">getDirectoryContents</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457878"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679457874"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679457874"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">Prelude.filter</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
</span><a href="#local-6989586621679457877"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679457876"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457874"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-162"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-163"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457874"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Get a count of unread mails in a maildir. For maildir format</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- details, to write loggers for other classes of mail, see</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- &lt;http://cr.yp.to/proto/maildir.html&gt; and 'logFileCount'.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="XMonad.Util.Loggers.html#maildirUnread"><span class="hs-identifier hs-type">maildirUnread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-169"></span><span id="maildirUnread"><span class="annot"><span class="annottext">maildirUnread :: String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#maildirUnread"><span class="hs-identifier hs-var hs-var">maildirUnread</span></a></span></span><span> </span><span id="local-6989586621679457871"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457871"><span class="hs-identifier hs-var">mdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; Bool) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logFileCount"><span class="hs-identifier hs-var">logFileCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457871"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/cur/&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isSuffixOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;,&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Get a count of new mails in a maildir.</span><span>
</span><span id="line-172"></span><span class="annot"><a href="XMonad.Util.Loggers.html#maildirNew"><span class="hs-identifier hs-type">maildirNew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-173"></span><span id="maildirNew"><span class="annot"><span class="annottext">maildirNew :: String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#maildirNew"><span class="hs-identifier hs-var hs-var">maildirNew</span></a></span></span><span> </span><span id="local-6989586621679457870"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457870"><span class="hs-identifier hs-var">mdir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (String -&gt; Bool) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logFileCount"><span class="hs-identifier hs-var">logFileCount</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457870"><span class="hs-identifier hs-var">mdir</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;/new/&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- $xmonad</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- A very small sample of what you can log since you have access to X. For</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- example you can loggerize the number of windows on each workspace, or</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- titles on other workspaces, or the id of the previously focused workspace....</span><span>
</span><span id="line-180"></span><span>
</span><span id="line-181"></span><span class="hs-comment">-- | Internal function to get a wrapped title string from a window</span><span>
</span><span id="line-182"></span><span class="annot"><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-type">fetchWindowTitle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-183"></span><span id="fetchWindowTitle"><span class="annot"><span class="annottext">fetchWindowTitle :: Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var hs-var">fetchWindowTitle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X NamedWindow
</span><a href="XMonad.Util.NamedWindows.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- | Get the title (name) of the focused window.</span><span>
</span><span id="line-186"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitle"><span class="hs-identifier hs-type">logTitle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-187"></span><span id="logTitle"><span class="annot"><span class="annottext">logTitle :: Logger
</span><a href="XMonad.Util.Loggers.html#logTitle"><span class="hs-identifier hs-var hs-var">logTitle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindow"><span class="hs-identifier hs-var">logWindowInfoFocusedWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var">fetchWindowTitle</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Get the titles of all windows on the visible workspace of the given</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- screen and format them according to the given functions.</span><span>
</span><span id="line-191"></span><span class="hs-comment">--</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- ==== __Example__</span><span>
</span><span id="line-193"></span><span class="hs-comment">--</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- &gt; myXmobarPP :: X PP</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- &gt; myXmobarPP = pure $ def</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- &gt;   { ppOrder  = [ws, l, _, wins] -&gt; [ws, l, wins]</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- &gt;   , ppExtras = [logTitles formatFocused formatUnfocused]</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- &gt;   }</span><span>
</span><span id="line-199"></span><span class="hs-comment">-- &gt;  where</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- &gt;   formatFocused   = wrap &quot;[&quot; &quot;]&quot; . xmobarColor &quot;#ff79c6&quot; &quot;&quot; . shorten 50 . xmobarStrip</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- &gt;   formatUnfocused = wrap &quot;(&quot; &quot;)&quot; . xmobarColor &quot;#bd93f9&quot; &quot;&quot; . shorten 30 . xmobarStrip</span><span>
</span><span id="line-202"></span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitlesOnScreen"><span class="hs-identifier hs-type">logTitlesOnScreen</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>           </span><span class="hs-comment">-- ^ Screen to log the titles on</span><span>
</span><span id="line-205"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Formatting for the focused   window</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Formatting for the unfocused window</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-208"></span><span id="logTitlesOnScreen"><span class="annot"><span class="annottext">logTitlesOnScreen :: ScreenId -&gt; (String -&gt; String) -&gt; (String -&gt; String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logTitlesOnScreen"><span class="hs-identifier hs-var hs-var">logTitlesOnScreen</span></a></span></span><span> </span><span id="local-6989586621679457866"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457866"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679457865"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457865"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457864"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457864"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; ScreenId
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-var">logWindowInfoOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var">fetchWindowTitle</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457866"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457865"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457864"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457864"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Like 'logTitlesOnScreen' but with support for urgent windows.  To</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- be used with &quot;XMonad.Hooks.UrgencyHook&quot;.</span><span>
</span><span id="line-213"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitlesOnScreen%27"><span class="hs-identifier hs-type">logTitlesOnScreen'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-type">TitlesFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-214"></span><span id="logTitlesOnScreen%27"><span class="annot"><span class="annottext">logTitlesOnScreen' :: ScreenId -&gt; TitlesFormat -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logTitlesOnScreen%27"><span class="hs-identifier hs-var hs-var">logTitlesOnScreen'</span></a></span></span><span> </span><span id="local-6989586621679457862"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457862"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-type">TitlesFormat</span></a></span><span> </span><span id="local-6989586621679457860"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457860"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457859"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457859"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span id="local-6989586621679457858"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457858"><span class="hs-identifier hs-var">formatUrg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; ScreenId
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-var">logWindowInfoOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var">fetchWindowTitle</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457862"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457860"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457859"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457858"><span class="hs-identifier hs-var">formatUrg</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Like 'logTitlesOnScreen', but directly use the &quot;focused&quot; screen</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- (the one with the currently focused workspace).</span><span>
</span><span id="line-219"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitles"><span class="hs-identifier hs-type">logTitles</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-220"></span><span id="logTitles"><span class="annot"><span class="annottext">logTitles :: (String -&gt; String) -&gt; (String -&gt; String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logTitles"><span class="hs-identifier hs-var hs-var">logTitles</span></a></span></span><span> </span><span id="local-6989586621679457857"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457857"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457856"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457856"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedScreen"><span class="hs-identifier hs-var">logWindowInfoFocusedScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var">fetchWindowTitle</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457857"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457856"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457856"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Variant of 'logTitles', but with support for urgent windows.</span><span>
</span><span id="line-224"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitles%27"><span class="hs-identifier hs-type">logTitles'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-type">TitlesFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-225"></span><span id="logTitles%27"><span class="annot"><span class="annottext">logTitles' :: TitlesFormat -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logTitles%27"><span class="hs-identifier hs-var hs-var">logTitles'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-type">TitlesFormat</span></a></span><span> </span><span id="local-6989586621679457854"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457854"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457853"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457853"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span id="local-6989586621679457852"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457852"><span class="hs-identifier hs-var">formatUrg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedScreen"><span class="hs-identifier hs-var">logWindowInfoFocusedScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var">fetchWindowTitle</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457854"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457853"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457852"><span class="hs-identifier hs-var">formatUrg</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Formatting applied to the titles of certain windows.</span><span>
</span><span id="line-229"></span><span class="hs-keyword">data</span><span> </span><span id="TitlesFormat"><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-var">TitlesFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TitlesFormat"><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-var">TitlesFormat</span></a></span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="focusedFormat"><span class="annot"><span class="annottext">TitlesFormat -&gt; String -&gt; String
</span><a href="XMonad.Util.Loggers.html#focusedFormat"><span class="hs-identifier hs-var hs-var">focusedFormat</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Focused formatting.</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unfocusedFormat"><span class="annot"><span class="annottext">TitlesFormat -&gt; String -&gt; String
</span><a href="XMonad.Util.Loggers.html#unfocusedFormat"><span class="hs-identifier hs-var hs-var">unfocusedFormat</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Unfocused formatting.</span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="urgentFormat"><span class="annot"><span class="annottext">TitlesFormat -&gt; String -&gt; String
</span><a href="XMonad.Util.Loggers.html#urgentFormat"><span class="hs-identifier hs-var hs-var">urgentFormat</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Formatting when urgent.</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | How to format these titles by default when using 'logTitles'' and</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- 'logTitlesOnScreen''.</span><span>
</span><span id="line-237"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-type">TitlesFormat</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="local-6989586621679457845"><span class="annot"><span class="annottext">def :: TitlesFormat
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#TitlesFormat"><span class="hs-identifier hs-type">TitlesFormat</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focusedFormat :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#focusedFormat"><span class="hs-identifier hs-var">focusedFormat</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarFocusedFormat"><span class="hs-identifier hs-var">xmobarFocusedFormat</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unfocusedFormat :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#unfocusedFormat"><span class="hs-identifier hs-var">unfocusedFormat</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarWsFormat"><span class="hs-identifier hs-var">xmobarWsFormat</span></a></span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">urgentFormat :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#urgentFormat"><span class="hs-identifier hs-var">urgentFormat</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarUrgentFormat"><span class="hs-identifier hs-var">xmobarUrgentFormat</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Internal function to get a wrapped classname string from a window</span><span>
</span><span id="line-245"></span><span class="annot"><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-type">fetchWindowClassname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-246"></span><span id="fetchWindowClassname"><span class="annot"><span class="annottext">fetchWindowClassname :: Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var hs-var">fetchWindowClassname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X NamedWindow
</span><a href="XMonad.Util.NamedWindows.html#getNameWMClass"><span class="hs-identifier hs-var">getNameWMClass</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Get the classname of the focused window.</span><span>
</span><span id="line-249"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassname"><span class="hs-identifier hs-type">logClassname</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-250"></span><span id="logClassname"><span class="annot"><span class="annottext">logClassname :: Logger
</span><a href="XMonad.Util.Loggers.html#logClassname"><span class="hs-identifier hs-var hs-var">logClassname</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindow"><span class="hs-identifier hs-var">logWindowInfoFocusedWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var">fetchWindowClassname</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Get the classnames of all windows on the visible workspace of the given</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- screen and format them according to the given functions.</span><span>
</span><span id="line-254"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnamesOnScreen"><span class="hs-identifier hs-type">logClassnamesOnScreen</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>           </span><span class="hs-comment">-- ^ Screen to log the classnames on</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Formatting for the focused window</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Formatting for the unfocused window</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-259"></span><span id="logClassnamesOnScreen"><span class="annot"><span class="annottext">logClassnamesOnScreen :: ScreenId -&gt; (String -&gt; String) -&gt; (String -&gt; String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logClassnamesOnScreen"><span class="hs-identifier hs-var hs-var">logClassnamesOnScreen</span></a></span></span><span> </span><span id="local-6989586621679457839"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457839"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679457838"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457838"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457837"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457837"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; ScreenId
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-var">logWindowInfoOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var">fetchWindowClassname</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457839"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457838"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457837"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457837"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-comment">-- | Like 'logClassnamesOnScreen' but with support for urgent windows.  To</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- be used with &quot;XMonad.Hooks.UrgencyHook&quot;.</span><span>
</span><span id="line-264"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnamesOnScreen%27"><span class="hs-identifier hs-type">logClassnamesOnScreen'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-type">ClassnamesFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-265"></span><span id="logClassnamesOnScreen%27"><span class="annot"><span class="annottext">logClassnamesOnScreen' :: ScreenId -&gt; ClassnamesFormat -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logClassnamesOnScreen%27"><span class="hs-identifier hs-var hs-var">logClassnamesOnScreen'</span></a></span></span><span> </span><span id="local-6989586621679457836"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457836"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-type">ClassnamesFormat</span></a></span><span> </span><span id="local-6989586621679457834"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457834"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457833"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457833"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span id="local-6989586621679457832"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457832"><span class="hs-identifier hs-var">formatUrg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; ScreenId
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-var">logWindowInfoOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var">fetchWindowClassname</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457836"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457834"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457833"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457832"><span class="hs-identifier hs-var">formatUrg</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | Like 'logClassnamesOnScreen', but directly use the &quot;focused&quot; screen</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- (the one with the currently focused workspace).</span><span>
</span><span id="line-270"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnames"><span class="hs-identifier hs-type">logClassnames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-271"></span><span id="logClassnames"><span class="annot"><span class="annottext">logClassnames :: (String -&gt; String) -&gt; (String -&gt; String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logClassnames"><span class="hs-identifier hs-var hs-var">logClassnames</span></a></span></span><span> </span><span id="local-6989586621679457831"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457831"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457830"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457830"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedScreen"><span class="hs-identifier hs-var">logWindowInfoFocusedScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var">fetchWindowClassname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457831"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457830"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457830"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | Variant of 'logClassnames', but with support for urgent windows.</span><span>
</span><span id="line-275"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnames%27"><span class="hs-identifier hs-type">logClassnames'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-type">ClassnamesFormat</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-276"></span><span id="logClassnames%27"><span class="annot"><span class="annottext">logClassnames' :: ClassnamesFormat -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logClassnames%27"><span class="hs-identifier hs-var hs-var">logClassnames'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-type">ClassnamesFormat</span></a></span><span> </span><span id="local-6989586621679457829"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457829"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457828"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457828"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span id="local-6989586621679457827"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457827"><span class="hs-identifier hs-var">formatUrg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedScreen"><span class="hs-identifier hs-var">logWindowInfoFocusedScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var">fetchWindowClassname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457829"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457828"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457827"><span class="hs-identifier hs-var">formatUrg</span></a></span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | Formatting applied to the classnames of certain windows.</span><span>
</span><span id="line-280"></span><span class="hs-keyword">data</span><span> </span><span id="ClassnamesFormat"><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-var">ClassnamesFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ClassnamesFormat"><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-var">ClassnamesFormat</span></a></span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="focusedFormatClassname"><span class="annot"><span class="annottext">ClassnamesFormat -&gt; String -&gt; String
</span><a href="XMonad.Util.Loggers.html#focusedFormatClassname"><span class="hs-identifier hs-var hs-var">focusedFormatClassname</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Focused formatting.</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="unfocusedFormatClassname"><span class="annot"><span class="annottext">ClassnamesFormat -&gt; String -&gt; String
</span><a href="XMonad.Util.Loggers.html#unfocusedFormatClassname"><span class="hs-identifier hs-var hs-var">unfocusedFormatClassname</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Unfocused formatting.</span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="urgentFormatClassname"><span class="annot"><span class="annottext">ClassnamesFormat -&gt; String -&gt; String
</span><a href="XMonad.Util.Loggers.html#urgentFormatClassname"><span class="hs-identifier hs-var hs-var">urgentFormatClassname</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Formatting when urgent.</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-comment">-- | How to format these classnames by default when using 'logClassnames'' and</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- 'logClassnamesOnScreen''.</span><span>
</span><span id="line-288"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-type">ClassnamesFormat</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-289"></span><span>  </span><span id="local-6989586621679457821"><span class="annot"><span class="annottext">def :: ClassnamesFormat
</span><a href="#local-6989586621679457821"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#ClassnamesFormat"><span class="hs-identifier hs-type">ClassnamesFormat</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focusedFormatClassname :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#focusedFormatClassname"><span class="hs-identifier hs-var">focusedFormatClassname</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarFocusedFormat"><span class="hs-identifier hs-var">xmobarFocusedFormat</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">unfocusedFormatClassname :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#unfocusedFormatClassname"><span class="hs-identifier hs-var">unfocusedFormatClassname</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarWsFormat"><span class="hs-identifier hs-var">xmobarWsFormat</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">urgentFormatClassname :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#urgentFormatClassname"><span class="hs-identifier hs-var">urgentFormatClassname</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarUrgentFormat"><span class="hs-identifier hs-var">xmobarUrgentFormat</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Internal function to get the specified window information for all windows on</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- the visible workspace of the given screen and format them according to the</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- given functions.</span><span>
</span><span id="line-298"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-type">logWindowInfoOnScreen</span></a></span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-305"></span><span id="logWindowInfoOnScreen"><span class="annot"><span class="annottext">logWindowInfoOnScreen :: (Window -&gt; X String)
-&gt; ScreenId
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-var hs-var">logWindowInfoOnScreen</span></a></span></span><span> </span><span id="local-6989586621679457820"><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457820"><span class="hs-identifier hs-var">getWindowInfo</span></a></span></span><span> </span><span id="local-6989586621679457819"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457819"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679457818"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457818"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457817"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457817"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span id="local-6989586621679457816"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457816"><span class="hs-identifier hs-var">formatUrg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowScreen -&gt; Logger) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#withScreen"><span class="hs-operator hs-var">`withScreen`</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457819"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679457814"><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457814"><span class="hs-identifier hs-var">screen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679457812"><span class="annot"><span class="annottext">focWin :: Maybe Window
</span><a href="#local-6989586621679457812"><span class="hs-identifier hs-var hs-var">focWin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457814"><span class="hs-identifier hs-var">screen</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679457808"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679457808"><span class="hs-identifier hs-var">urgWins</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [Window]
</span><a href="XMonad.Hooks.UrgencyHook.html#readUrgents"><span class="hs-identifier hs-var">readUrgents</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; WindowScreen -&gt; (Window -&gt; String -&gt; String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreenWorker"><span class="hs-identifier hs-var">logWindowInfoOnScreenWorker</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457820"><span class="hs-identifier hs-var">getWindowInfo</span></a></span><span> </span><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457814"><span class="hs-identifier hs-var">screen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679457806"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679457806"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679457805"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457805"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679457806"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679457812"><span class="hs-identifier hs-var">focWin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457818"><span class="hs-identifier hs-var">formatFoc</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457805"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-311"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679457806"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679457808"><span class="hs-identifier hs-var">urgWins</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457816"><span class="hs-identifier hs-var">formatUrg</span></a></span><span>   </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457805"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-312"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457817"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457805"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Internal helper function for 'logWindowInfoOnScreen'.</span><span>
</span><span id="line-315"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreenWorker"><span class="hs-identifier hs-type">logWindowInfoOnScreenWorker</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prelude.html#WindowScreen"><span class="hs-identifier hs-type">WindowScreen</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-320"></span><span id="logWindowInfoOnScreenWorker"><span class="annot"><span class="annottext">logWindowInfoOnScreenWorker :: (Window -&gt; X String)
-&gt; WindowScreen -&gt; (Window -&gt; String -&gt; String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreenWorker"><span class="hs-identifier hs-var hs-var">logWindowInfoOnScreenWorker</span></a></span></span><span> </span><span id="local-6989586621679457803"><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457803"><span class="hs-identifier hs-var">getWindowInfo</span></a></span></span><span> </span><span id="local-6989586621679457802"><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457802"><span class="hs-identifier hs-var">screen</span></a></span></span><span> </span><span id="local-6989586621679457801"><span class="annot"><span class="annottext">Window -&gt; String -&gt; String
</span><a href="#local-6989586621679457801"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679457800"><span class="annot"><span class="annottext">wins :: [Window]
</span><a href="#local-6989586621679457800"><span class="hs-identifier hs-var hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457802"><span class="hs-identifier hs-var">screen</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679457797"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679457797"><span class="hs-identifier hs-var">winNames</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457803"><span class="hs-identifier hs-var">getWindowInfo</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679457800"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unwords</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; String -&gt; String
</span><a href="#local-6989586621679457801"><span class="hs-identifier hs-var">logger</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679457800"><span class="hs-identifier hs-var">wins</span></a></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679457797"><span class="hs-identifier hs-var">winNames</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- | Internal. Like 'logWindowInfoOnScreen', but directly use the &quot;focused&quot; screen</span><span>
</span><span id="line-326"></span><span class="hs-comment">-- (the one with the currently focused workspace).</span><span>
</span><span id="line-327"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedScreen"><span class="hs-identifier hs-type">logWindowInfoFocusedScreen</span></a></span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-333"></span><span id="logWindowInfoFocusedScreen"><span class="annot"><span class="annottext">logWindowInfoFocusedScreen :: (Window -&gt; X String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedScreen"><span class="hs-identifier hs-var hs-var">logWindowInfoFocusedScreen</span></a></span></span><span> </span><span id="local-6989586621679457793"><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457793"><span class="hs-identifier hs-var">getWindowInfo</span></a></span></span><span> </span><span id="local-6989586621679457792"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457792"><span class="hs-identifier hs-var">formatFoc</span></a></span></span><span> </span><span id="local-6989586621679457791"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457791"><span class="hs-identifier hs-var">formatUnfoc</span></a></span></span><span> </span><span id="local-6989586621679457790"><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457790"><span class="hs-identifier hs-var">formatUrg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>  </span><span id="local-6989586621679457789"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457789"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><span class="annottext">(Window -&gt; X String)
-&gt; ScreenId
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; (String -&gt; String)
-&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoOnScreen"><span class="hs-identifier hs-var">logWindowInfoOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457793"><span class="hs-identifier hs-var">getWindowInfo</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457789"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457792"><span class="hs-identifier hs-var">formatFoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457791"><span class="hs-identifier hs-var">formatUnfoc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="#local-6989586621679457790"><span class="hs-identifier hs-var">formatUrg</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="hs-comment">-- | Internal function to get the specified information for the currently focused window</span><span>
</span><span id="line-338"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindow"><span class="hs-identifier hs-type">logWindowInfoFocusedWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-339"></span><span id="logWindowInfoFocusedWindow"><span class="annot"><span class="annottext">logWindowInfoFocusedWindow :: (Window -&gt; X String) -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindow"><span class="hs-identifier hs-var hs-var">logWindowInfoFocusedWindow</span></a></span></span><span> </span><span id="local-6989586621679457785"><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457785"><span class="hs-identifier hs-var">getWindowInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457785"><span class="hs-identifier hs-var">getWindowInfo</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">W.peek</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Internal formatting helpers</span><span>
</span><span id="line-342"></span><span class="annot"><a href="XMonad.Util.Loggers.html#xmobarWsFormat"><span class="hs-identifier hs-type">xmobarWsFormat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#xmobarFocusedFormat"><span class="hs-identifier hs-type">xmobarFocusedFormat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#xmobarUrgentFormat"><span class="hs-identifier hs-type">xmobarUrgentFormat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-343"></span><span id="xmobarWsFormat"><span class="annot"><span class="annottext">xmobarWsFormat :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarWsFormat"><span class="hs-identifier hs-var hs-var">xmobarWsFormat</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#xmobarRaw"><span class="hs-identifier hs-var">xmobarRaw</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#shorten"><span class="hs-identifier hs-var">shorten</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#xmobarStrip"><span class="hs-identifier hs-var">xmobarStrip</span></a></span><span>
</span><span id="line-344"></span><span id="xmobarFocusedFormat"><span class="annot"><span class="annottext">xmobarFocusedFormat :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarFocusedFormat"><span class="hs-identifier hs-var hs-var">xmobarFocusedFormat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;[&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarWsFormat"><span class="hs-identifier hs-var">xmobarWsFormat</span></a></span><span>
</span><span id="line-345"></span><span id="xmobarUrgentFormat"><span class="annot"><span class="annottext">xmobarUrgentFormat :: String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarUrgentFormat"><span class="hs-identifier hs-var hs-var">xmobarUrgentFormat</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;!&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Util.Loggers.html#xmobarWsFormat"><span class="hs-identifier hs-var">xmobarWsFormat</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span class="hs-comment">-- | Get the name of the current layout.</span><span>
</span><span id="line-348"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logLayout"><span class="hs-identifier hs-type">logLayout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-349"></span><span id="logLayout"><span class="annot"><span class="annottext">logLayout :: Logger
</span><a href="XMonad.Util.Loggers.html#logLayout"><span class="hs-identifier hs-var hs-var">logLayout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall {i} {a} {sid} {sd}.
StackSet i (Layout Window) a sid sd -&gt; String
</span><a href="#local-6989586621679457778"><span class="hs-identifier hs-var">ld</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679457778"><span class="annot"><span class="annottext">ld :: StackSet i (Layout Window) a sid sd -&gt; String
</span><a href="#local-6989586621679457778"><span class="hs-identifier hs-var hs-var">ld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; String
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; l
</span><span class="hs-identifier hs-var">W.layout</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span class="hs-comment">-- | Get the name of the current workspace.</span><span>
</span><span id="line-353"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logCurrent"><span class="hs-identifier hs-type">logCurrent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-354"></span><span id="logCurrent"><span class="annot"><span class="annottext">logCurrent :: Logger
</span><a href="XMonad.Util.Loggers.html#logCurrent"><span class="hs-identifier hs-var hs-var">logCurrent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span>
</span><span id="line-355"></span><span>
</span><span id="line-356"></span><span class="hs-comment">-- | Log the given string, as is.</span><span>
</span><span id="line-357"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logConst"><span class="hs-identifier hs-type">logConst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-358"></span><span id="logConst"><span class="annot"><span class="annottext">logConst :: String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logConst"><span class="hs-identifier hs-var hs-var">logConst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | If the first logger returns @Nothing@, the default logger is used.</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- For example, to display a quote when no windows are on the screen,</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- you can do:</span><span>
</span><span id="line-363"></span><span class="hs-comment">--</span><span>
</span><span id="line-364"></span><span class="hs-comment">-- &gt; logDefault logTitle (logConst &quot;Hey, you, you're finally awake.&quot;)</span><span>
</span><span id="line-365"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logDefault"><span class="hs-identifier hs-type">logDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-366"></span><span id="logDefault"><span class="annot"><span class="annottext">logDefault :: Logger -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logDefault"><span class="hs-identifier hs-var hs-var">logDefault</span></a></span></span><span> </span><span id="local-6989586621679457773"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457773"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679457772"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457772"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457773"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457772"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logConst"><span class="hs-identifier hs-var">logConst</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | An infix operator for 'logDefault', which can be more convenient to</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- combine multiple loggers.</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- &gt; logTitle .| logWhenActive 0 (logConst &quot;*&quot;) .| logConst &quot;There's nothing here&quot;</span><span>
</span><span id="line-372"></span><span class="annot"><a href="XMonad.Util.Loggers.html#.%7C"><span class="hs-operator hs-type">(.|)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-373"></span><span id=".%7C"><span class="annot"><span class="annottext">.| :: Logger -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#.%7C"><span class="hs-operator hs-var hs-var">(.|)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Logger -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logDefault"><span class="hs-identifier hs-var">logDefault</span></a></span><span>
</span><span id="line-374"></span><span>
</span><span id="line-375"></span><span class="hs-comment">-- $xmonad-screen</span><span>
</span><span id="line-376"></span><span class="hs-comment">-- It is also possible to bind loggers like 'logTitle' to a specific screen. For</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- example, using @logTitleOnScreen 1@ will log the title of the focused window</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- on screen 1, even if screen 1 is not currently active.</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Only display the 'Logger' if the screen with the given 'ScreenId' is</span><span>
</span><span id="line-381"></span><span class="hs-comment">-- active.</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- For example, this can be used to create a marker that is only displayed</span><span>
</span><span id="line-383"></span><span class="hs-comment">-- when the primary screen is active.</span><span>
</span><span id="line-384"></span><span class="hs-comment">--</span><span>
</span><span id="line-385"></span><span class="hs-comment">-- &gt; logWhenActive 0 (logConst &quot;*&quot;)</span><span>
</span><span id="line-386"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logWhenActive"><span class="hs-identifier hs-type">logWhenActive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-387"></span><span id="logWhenActive"><span class="annot"><span class="annottext">logWhenActive :: ScreenId -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWhenActive"><span class="hs-identifier hs-var hs-var">logWhenActive</span></a></span></span><span> </span><span id="local-6989586621679457771"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457771"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679457770"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457770"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621679457769"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457769"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457771"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457769"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457770"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Get the title (name) of the focused window, on the given screen.</span><span>
</span><span id="line-392"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logTitleOnScreen"><span class="hs-identifier hs-type">logTitleOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-393"></span><span id="logTitleOnScreen"><span class="annot"><span class="annottext">logTitleOnScreen :: ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logTitleOnScreen"><span class="hs-identifier hs-var hs-var">logTitleOnScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X String) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindowOnScreen"><span class="hs-identifier hs-var">logWindowInfoFocusedWindowOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowTitle"><span class="hs-identifier hs-var">fetchWindowTitle</span></a></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="hs-comment">-- | Get the classname of the focused window, on the given screen.</span><span>
</span><span id="line-396"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logClassnameOnScreen"><span class="hs-identifier hs-type">logClassnameOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-397"></span><span id="logClassnameOnScreen"><span class="annot"><span class="annottext">logClassnameOnScreen :: ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logClassnameOnScreen"><span class="hs-identifier hs-var hs-var">logClassnameOnScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X String) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindowOnScreen"><span class="hs-identifier hs-var">logWindowInfoFocusedWindowOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="XMonad.Util.Loggers.html#fetchWindowClassname"><span class="hs-identifier hs-var">fetchWindowClassname</span></a></span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-comment">-- | Internal function to get the specified information for the focused window,</span><span>
</span><span id="line-400"></span><span class="hs-comment">-- on the given screen.</span><span>
</span><span id="line-401"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindowOnScreen"><span class="hs-identifier hs-type">logWindowInfoFocusedWindowOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-402"></span><span id="logWindowInfoFocusedWindowOnScreen"><span class="annot"><span class="annottext">logWindowInfoFocusedWindowOnScreen :: (Window -&gt; X String) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logWindowInfoFocusedWindowOnScreen"><span class="hs-identifier hs-var hs-var">logWindowInfoFocusedWindowOnScreen</span></a></span></span><span> </span><span id="local-6989586621679457767"><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457767"><span class="hs-identifier hs-var">getWindowInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-403"></span><span>  </span><span class="annot"><span class="annottext">(WindowScreen -&gt; Logger) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#withScreen"><span class="hs-identifier hs-var">withScreen</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X String
</span><a href="#local-6989586621679457767"><span class="hs-identifier hs-var">getWindowInfo</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">-- | Get the name of the visible workspace on the given screen.</span><span>
</span><span id="line-410"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logCurrentOnScreen"><span class="hs-identifier hs-type">logCurrentOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-411"></span><span id="logCurrentOnScreen"><span class="annot"><span class="annottext">logCurrentOnScreen :: ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logCurrentOnScreen"><span class="hs-identifier hs-var hs-var">logCurrentOnScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowScreen -&gt; Logger) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#withScreen"><span class="hs-identifier hs-var">withScreen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logConst"><span class="hs-identifier hs-var">logConst</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">-- | Get the name of the current layout on the given screen.</span><span>
</span><span id="line-414"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logLayoutOnScreen"><span class="hs-identifier hs-type">logLayoutOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-415"></span><span id="logLayoutOnScreen"><span class="annot"><span class="annottext">logLayoutOnScreen :: ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logLayoutOnScreen"><span class="hs-identifier hs-var hs-var">logLayoutOnScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>  </span><span class="annot"><span class="annottext">(WindowScreen -&gt; Logger) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#withScreen"><span class="hs-identifier hs-var">withScreen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logConst"><span class="hs-identifier hs-var">logConst</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; String
</span><span class="hs-identifier hs-var">description</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; l
</span><span class="hs-identifier hs-var">W.layout</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | A helper function to create screen-specific loggers.</span><span>
</span><span id="line-419"></span><span class="annot"><a href="XMonad.Util.Loggers.html#withScreen"><span class="hs-identifier hs-type">withScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prelude.html#WindowScreen"><span class="hs-identifier hs-type">WindowScreen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-420"></span><span id="withScreen"><span class="annot"><span class="annottext">withScreen :: (WindowScreen -&gt; Logger) -&gt; ScreenId -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#withScreen"><span class="hs-identifier hs-var hs-var">withScreen</span></a></span></span><span> </span><span id="local-6989586621679457765"><span class="annot"><span class="annottext">WindowScreen -&gt; Logger
</span><a href="#local-6989586621679457765"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679457764"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457764"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>  </span><span id="local-6989586621679457763"><span class="annot"><span class="annottext">[WindowScreen]
</span><a href="#local-6989586621679457763"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Screen i l a s sd]
</span><span class="hs-identifier hs-var">W.screens</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679457764"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WindowScreen]
</span><a href="#local-6989586621679457763"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679457761"><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457761"><span class="hs-identifier hs-var">s</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WindowScreen -&gt; Logger
</span><a href="#local-6989586621679457765"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679457761"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><span class="annottext">Maybe WindowScreen
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- $format</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- Combine logger formatting functions to make your</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- 'XMonad.Hooks.StatusBar.PP.ppExtras' more colorful and readable.</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- (For convenience, you can use '&lt;$&gt;' instead of \'.\' or \'$\' in hard to read</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- formatting lines.</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- For example:</span><span>
</span><span id="line-432"></span><span class="hs-comment">--</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- &gt; myPP = def {</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- &gt;     -- skipped</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- &gt;     , ppExtras = [lLoad, lTitle, logSp 3, wrapL &quot;[&quot; &quot;]&quot; $ date &quot;%a %d %b&quot;]</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- &gt;     , ppOrder = \(ws:l:_:xs) -&gt; [l,ws] ++ xs</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- &gt;     }</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- &gt;   where</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- &gt;     -- lTitle = fixedWidthL AlignCenter &quot;.&quot; 99 . dzenColorL &quot;cornsilk3&quot; &quot;&quot; . padL . shortenL 80 $ logTitle</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- &gt;     -- or something like:</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- &gt;     lTitle = fixedWidthL AlignCenter &quot;.&quot; 99 &lt;$&gt; dzenColorL &quot;cornsilk3&quot; &quot;&quot; &lt;$&gt; padL . shortenL 80 $ logTitle</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-443"></span><span class="hs-comment">-- &gt;     lLoad = dzenColorL &quot;#6A5ACD&quot; &quot;&quot; . wrapL loadIcon &quot;   &quot; . padL $ loadAvg</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- &gt;     loadIcon = &quot; ^i(/home/me/.dzen/icons/load.xbm)&quot;</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- For more information on how to add the pretty-printer to your status bar, please</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- check &quot;XMonad.Hooks.StatusBar&quot;.</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- Note: When applying 'shortenL' or 'fixedWidthL' to logger strings</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- containing colors or other formatting commands, apply the formatting</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- /after/ the length adjustment, or include \&quot;invisible\&quot; characters</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- in the length specification, e.g. in the above \'^fg(cornsilk3)\' and</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- \'^fg()' yields 19 invisible and 80 visible characters.</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-comment">-- | Use a string formatting function to edit a 'Logger' string.</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- For example, to create a tag function to prefix or label loggers,</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- as in \'tag: output\', use:</span><span>
</span><span id="line-458"></span><span class="hs-comment">--</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- &gt; tagL l = onLogger $ wrap (l ++ &quot;: &quot;) &quot;&quot;</span><span>
</span><span id="line-460"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-461"></span><span class="hs-comment">-- &gt;    tagL &quot;bat&quot; battery</span><span>
</span><span id="line-462"></span><span class="hs-comment">-- &gt;    tagL &quot;load&quot; loadAvg</span><span>
</span><span id="line-463"></span><span class="hs-comment">--</span><span>
</span><span id="line-464"></span><span class="hs-comment">-- If you already have a (String -&gt; String) function you want to</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- apply to a logger:</span><span>
</span><span id="line-466"></span><span class="hs-comment">--</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- &gt; revL = onLogger trim</span><span>
</span><span id="line-468"></span><span class="hs-comment">--</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- See formatting utility source code for more 'onLogger' usage examples.</span><span>
</span><span id="line-470"></span><span class="annot"><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-type">onLogger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-471"></span><span id="onLogger"><span class="annot"><span class="annottext">onLogger :: (String -&gt; String) -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-var hs-var">onLogger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Wrap a logger's output in delimiters, unless it is @X (Nothing)@</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- or @X (Just \&quot;\&quot;)@. Some examples:</span><span>
</span><span id="line-475"></span><span class="hs-comment">--</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- &gt;    wrapL &quot; | &quot; &quot; | &quot; (date &quot;%a %d %b&quot;) -- ' | Tue 19 Feb | '</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-478"></span><span class="hs-comment">-- &gt;    wrapL &quot;bat: &quot; &quot;&quot; battery            -- ' bat: battery_logger_output'</span><span>
</span><span id="line-479"></span><span class="annot"><a href="XMonad.Util.Loggers.html#wrapL"><span class="hs-identifier hs-type">wrapL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-480"></span><span id="wrapL"><span class="annot"><span class="annottext">wrapL :: String -&gt; String -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#wrapL"><span class="hs-identifier hs-var hs-var">wrapL</span></a></span></span><span> </span><span id="local-6989586621679457760"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457760"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679457759"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457759"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-var">onLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#wrap"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457760"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457759"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Make a logger's output constant width by padding with the given string,</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- /even if the logger is/ @X (Nothing)@ /or/ @X (Just \&quot;\&quot;)@. Useful to</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- reduce visual noise as a title logger shrinks and grows, to use a fixed</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- width for a logger that sometimes becomes Nothing, or even to create</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- fancy spacers or character based art effects.</span><span>
</span><span id="line-487"></span><span class="hs-comment">--</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- It fills missing logger output with a repeated character like \&quot;.\&quot;,</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- \&quot;:\&quot; or pattern, like \&quot; -.-\&quot;. The cycling padding string is reversed on</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- the left of the logger output. This is mainly useful with AlignCenter.</span><span>
</span><span id="line-491"></span><span class="annot"><a href="XMonad.Util.Loggers.html#fixedWidthL"><span class="hs-identifier hs-type">fixedWidthL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#Align"><span class="hs-identifier hs-type">Align</span></a></span><span>  </span><span class="hs-comment">-- ^ AlignCenter, AlignRight, or AlignLeft</span><span>
</span><span id="line-492"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ String to cycle to pad missing logger output</span><span>
</span><span id="line-493"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-comment">-- ^ Fixed length to output (including invisible formatting characters)</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-495"></span><span id="fixedWidthL"><span class="annot"><span class="annottext">fixedWidthL :: Align -&gt; String -&gt; Int -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#fixedWidthL"><span class="hs-identifier hs-var hs-var">fixedWidthL</span></a></span></span><span> </span><span id="local-6989586621679457758"><span class="annot"><span class="annottext">Align
</span><a href="#local-6989586621679457758"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679457757"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457757"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679457756"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457756"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679457755"><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457755"><span class="hs-identifier hs-var">logger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>    </span><span id="local-6989586621679457754"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679457754"><span class="hs-identifier hs-var">mbl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Logger
</span><a href="#local-6989586621679457755"><span class="hs-identifier hs-var">logger</span></a></span><span>
</span><span id="line-497"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679457753"><span class="annot"><span class="annottext">l :: String
</span><a href="#local-6989586621679457753"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679457754"><span class="hs-identifier hs-var">mbl</span></a></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Align
</span><a href="#local-6989586621679457758"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-499"></span><span>       </span><span class="annot"><span class="annottext">Align
</span><a href="XMonad.Util.Font.html#AlignCenter"><span class="hs-identifier hs-var">AlignCenter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a}. a -&gt; X (Maybe a)
</span><a href="#local-6989586621679457751"><span class="hs-identifier hs-var">toL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457756"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {t :: * -&gt; *} {a}. Foldable t =&gt; t a -&gt; String
</span><a href="#local-6989586621679457749"><span class="hs-identifier hs-var">padhalf</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457748"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>       </span><span class="annot"><span class="annottext">Align
</span><a href="XMonad.Util.Font.html#AlignRight"><span class="hs-identifier hs-var">AlignRight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a}. a -&gt; X (Maybe a)
</span><a href="#local-6989586621679457751"><span class="hs-identifier hs-var">toL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457756"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457748"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>       </span><span class="annot"><span class="annottext">Align
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {a}. a -&gt; X (Maybe a)
</span><a href="#local-6989586621679457751"><span class="hs-identifier hs-var">toL</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457756"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457753"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457748"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621679457751"><span class="annot"><span class="annottext">toL :: a -&gt; X (Maybe a)
</span><a href="#local-6989586621679457751"><span class="hs-identifier hs-var hs-var">toL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span>
</span><span id="line-504"></span><span>    </span><span id="local-6989586621679457748"><span class="annot"><span class="annottext">cs :: String
</span><a href="#local-6989586621679457748"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457757"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-505"></span><span>    </span><span id="local-6989586621679457749"><span class="annot"><span class="annottext">padhalf :: t a -&gt; String
</span><a href="#local-6989586621679457749"><span class="hs-identifier hs-var hs-var">padhalf</span></a></span></span><span> </span><span id="local-6989586621679457737"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679457737"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457756"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679457737"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457748"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="hs-comment">-- | Create a \&quot;spacer\&quot; logger, e.g. @logSp 3 -- loggerizes \'   \'@.</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- For more complex \&quot;spacers\&quot;, use 'fixedWidthL' with @return Nothing@.</span><span>
</span><span id="line-509"></span><span class="annot"><a href="XMonad.Util.Loggers.html#logSp"><span class="hs-identifier hs-type">logSp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-510"></span><span id="logSp"><span class="annot"><span class="annottext">logSp :: Int -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#logSp"><span class="hs-identifier hs-var hs-var">logSp</span></a></span></span><span> </span><span id="local-6989586621679457735"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457735"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679457735"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">cycle</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span>
</span><span id="line-511"></span><span>
</span><span id="line-512"></span><span class="hs-comment">-- | Pad a logger's output with a leading and trailing space, unless it</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- is @X (Nothing)@ or @X (Just \&quot;\&quot;)@.</span><span>
</span><span id="line-514"></span><span class="annot"><a href="XMonad.Util.Loggers.html#padL"><span class="hs-identifier hs-type">padL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-515"></span><span id="padL"><span class="annot"><span class="annottext">padL :: Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#padL"><span class="hs-identifier hs-var hs-var">padL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-var">onLogger</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#pad"><span class="hs-identifier hs-var">pad</span></a></span><span>
</span><span id="line-516"></span><span>
</span><span id="line-517"></span><span class="hs-comment">-- | Limit a logger's length, adding \&quot;...\&quot; if truncated.</span><span>
</span><span id="line-518"></span><span class="annot"><a href="XMonad.Util.Loggers.html#shortenL"><span class="hs-identifier hs-type">shortenL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-519"></span><span id="shortenL"><span class="annot"><span class="annottext">shortenL :: Int -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#shortenL"><span class="hs-identifier hs-var hs-var">shortenL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-var">onLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#shorten"><span class="hs-identifier hs-var">shorten</span></a></span><span>
</span><span id="line-520"></span><span>
</span><span id="line-521"></span><span class="hs-comment">-- | Color a logger's output with dzen foreground and background colors.</span><span>
</span><span id="line-522"></span><span class="hs-comment">--</span><span>
</span><span id="line-523"></span><span class="hs-comment">-- &gt;  dzenColorL &quot;green&quot; &quot;#2A4C3F&quot; battery</span><span>
</span><span id="line-524"></span><span class="annot"><a href="XMonad.Util.Loggers.html#dzenColorL"><span class="hs-identifier hs-type">dzenColorL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-525"></span><span id="dzenColorL"><span class="annot"><span class="annottext">dzenColorL :: String -&gt; String -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#dzenColorL"><span class="hs-identifier hs-var hs-var">dzenColorL</span></a></span></span><span> </span><span id="local-6989586621679457733"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457733"><span class="hs-identifier hs-var">fg</span></a></span></span><span> </span><span id="local-6989586621679457732"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457732"><span class="hs-identifier hs-var">bg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-var">onLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#dzenColor"><span class="hs-identifier hs-var">dzenColor</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457733"><span class="hs-identifier hs-var">fg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457732"><span class="hs-identifier hs-var">bg</span></a></span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-comment">-- | Color a logger's output with xmobar foreground and background colors.</span><span>
</span><span id="line-528"></span><span class="hs-comment">--</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- &gt;  xmobarColorL &quot;#6A5ACD&quot; &quot;gray6&quot; loadAverage</span><span>
</span><span id="line-530"></span><span class="annot"><a href="XMonad.Util.Loggers.html#xmobarColorL"><span class="hs-identifier hs-type">xmobarColorL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-531"></span><span id="xmobarColorL"><span class="annot"><span class="annottext">xmobarColorL :: String -&gt; String -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#xmobarColorL"><span class="hs-identifier hs-var hs-var">xmobarColorL</span></a></span></span><span> </span><span id="local-6989586621679457730"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457730"><span class="hs-identifier hs-var">fg</span></a></span></span><span> </span><span id="local-6989586621679457729"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457729"><span class="hs-identifier hs-var">bg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; Logger -&gt; Logger
</span><a href="XMonad.Util.Loggers.html#onLogger"><span class="hs-identifier hs-var">onLogger</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="XMonad.Hooks.StatusBar.PP.html#xmobarColor"><span class="hs-identifier hs-var">xmobarColor</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457730"><span class="hs-identifier hs-var">fg</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679457729"><span class="hs-identifier hs-var">bg</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="hs-comment">-- todo</span><span>
</span><span id="line-534"></span><span class="hs-comment">-- * dynamicLogXinerama logger? Or sorted onscreen Id's with &quot;current&quot; indicator?</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- is logCurrent really useful at all?</span><span>
</span><span id="line-536"></span><span class="hs-comment">--</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- * ppVisible, etc. Resolve code dup. somehow. Refactor DynamicLog so can</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- be used for regular PP stuff /and/ loggers?</span><span>
</span><span id="line-539"></span><span class="hs-comment">--</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- * fns for &quot;ppExtras as a whole&quot;, combine loggers more nicely.</span><span>
</span><span id="line-541"></span><span class="hs-comment">--</span><span>
</span><span id="line-542"></span><span class="hs-comment">-- * parsers  to use with fixedWidthL to be smarter about invisible characters?</span><span>
</span><span id="line-543"></span></pre></body></html>