<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  XMonad.Actions.Warp</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description :  Warp the pointer to a given window or screen.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) daniel@wagner-home.com</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  daniel@wagner-home.com</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Warp the pointer to a given window or screen.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.Warp</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>                           </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-18"></span><span>                           </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-19"></span><span>                           </span><span class="annot"><a href="XMonad.Actions.Warp.html#banish"><span class="hs-identifier">banish</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>                           </span><span class="annot"><a href="XMonad.Actions.Warp.html#banishScreen"><span class="hs-identifier">banishScreen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>                           </span><span class="annot"><a href="XMonad.Actions.Warp.html#Corner"><span class="hs-identifier">Corner</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>                           </span><span class="annot"><a href="XMonad.Actions.Warp.html#warpToScreen"><span class="hs-identifier">warpToScreen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                           </span><span class="annot"><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier">warpToWindow</span></a></span><span>
</span><span id="line-24"></span><span>                          </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">{- $usage
You can use this module with the following in your @xmonad.hs@:

&gt; import XMonad.Actions.Warp

then add appropriate keybindings to warp the pointer; for example:

&gt; , ((modm,   xK_z     ), warpToWindow (1%2) (1%2)) -- @@ Move pointer to currently focused window
&gt;
&gt;-- mod-ctrl-{w,e,r} @@ Move mouse pointer to screen 1, 2, or 3
&gt;
&gt;   [((modm .|. controlMask, key), warpToScreen sc (1%2) (1%2))
&gt;       | (key, sc) &lt;- zip [xK_w, xK_e, xK_r] [0..]]

Note that warping to a particular screen may change the focus.
-}</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- For detailed instructions on editing your key bindings, see</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- &lt;https://xmonad.org/TUTORIAL.html#customizing-xmonad the tutorial&gt;.</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">data</span><span> </span><span id="Corner"><span class="annot"><a href="XMonad.Actions.Warp.html#Corner"><span class="hs-identifier hs-var">Corner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UpperLeft"><span class="annot"><a href="XMonad.Actions.Warp.html#UpperLeft"><span class="hs-identifier hs-var">UpperLeft</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="UpperRight"><span class="annot"><a href="XMonad.Actions.Warp.html#UpperRight"><span class="hs-identifier hs-var">UpperRight</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="LowerLeft"><span class="annot"><a href="XMonad.Actions.Warp.html#LowerLeft"><span class="hs-identifier hs-var">LowerLeft</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="LowerRight"><span class="annot"><a href="XMonad.Actions.Warp.html#LowerRight"><span class="hs-identifier hs-var">LowerRight</span></a></span></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">{- | Move the mouse cursor to a corner of the focused window. Useful for
   uncluttering things.

   Internally, this uses numerical parameters. We parametrize on the 'Corner'
   type so the user need not see the violence inherent in
   the system.

   'warpToScreen' and 'warpToWindow' can be used in a variety of
   ways. Suppose you wanted to emulate Ratpoison's \'banish\' command,
   which moves the mouse pointer to a corner? warpToWindow can do that! -}</span><span>
</span><span id="line-63"></span><span class="annot"><a href="XMonad.Actions.Warp.html#banish"><span class="hs-identifier hs-type">banish</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Warp.html#Corner"><span class="hs-identifier hs-type">Corner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span id="banish"><span class="annot"><span class="annottext">banish :: Corner -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#banish"><span class="hs-identifier hs-var hs-var">banish</span></a></span></span><span> </span><span id="local-6989586621679414591"><span class="annot"><span class="annottext">Corner
</span><a href="#local-6989586621679414591"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Corner
</span><a href="#local-6989586621679414591"><span class="hs-identifier hs-var">direction</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>                     </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#LowerRight"><span class="hs-identifier hs-var">LowerRight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier hs-var">warpToWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-66"></span><span>                     </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#LowerLeft"><span class="hs-identifier hs-var">LowerLeft</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier hs-var">warpToWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-67"></span><span>                     </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#UpperLeft"><span class="hs-identifier hs-var">UpperLeft</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier hs-var">warpToWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-68"></span><span>                     </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#UpperRight"><span class="hs-identifier hs-var">UpperRight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier hs-var">warpToWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">{- | Same as 'banish' but moves the mouse to the corner of the
   currently focused screen -}</span><span>
</span><span id="line-72"></span><span class="annot"><a href="XMonad.Actions.Warp.html#banishScreen"><span class="hs-identifier hs-type">banishScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.Warp.html#Corner"><span class="hs-identifier hs-type">Corner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span id="banishScreen"><span class="annot"><span class="annottext">banishScreen :: Corner -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#banishScreen"><span class="hs-identifier hs-var hs-var">banishScreen</span></a></span></span><span> </span><span id="local-6989586621679414590"><span class="annot"><span class="annottext">Corner
</span><a href="#local-6989586621679414590"><span class="hs-identifier hs-var">direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Corner
</span><a href="#local-6989586621679414590"><span class="hs-identifier hs-var">direction</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-74"></span><span>                           </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#LowerRight"><span class="hs-identifier hs-var">LowerRight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="#local-6989586621679414589"><span class="hs-identifier hs-var">warpToCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-75"></span><span>                           </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#LowerLeft"><span class="hs-identifier hs-var">LowerLeft</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="#local-6989586621679414589"><span class="hs-identifier hs-var">warpToCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-76"></span><span>                           </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#UpperLeft"><span class="hs-identifier hs-var">UpperLeft</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="#local-6989586621679414589"><span class="hs-identifier hs-var">warpToCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-77"></span><span>                           </span><span class="annot"><span class="annottext">Corner
</span><a href="XMonad.Actions.Warp.html#UpperRight"><span class="hs-identifier hs-var">UpperRight</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; X ()
</span><a href="#local-6989586621679414589"><span class="hs-identifier hs-var">warpToCurrentScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>      </span><span id="local-6989586621679414589"><span class="annot"><span class="annottext">warpToCurrentScreen :: Rational -&gt; Rational -&gt; X ()
</span><a href="#local-6989586621679414589"><span class="hs-identifier hs-var hs-var">warpToCurrentScreen</span></a></span></span><span> </span><span id="local-6989586621679414585"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414585"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679414584"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414584"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>          </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679414583"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679414583"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-81"></span><span>             </span><span class="annot"><span class="annottext">ScreenId -&gt; Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToScreen"><span class="hs-identifier hs-var">warpToScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679414583"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414585"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414584"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-82"></span><span>             </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679414583"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span id="local-6989586621679414697"><span id="local-6989586621679414698"><span class="annot"><a href="XMonad.Actions.Warp.html#fraction"><span class="hs-identifier hs-type">fraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679414698"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679414697"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414698"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679414697"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-86"></span><span id="fraction"><span class="annot"><span class="annottext">fraction :: forall a b. (Integral a, Integral b) =&gt; Rational -&gt; a -&gt; b
</span><a href="XMonad.Actions.Warp.html#fraction"><span class="hs-identifier hs-var hs-var">fraction</span></a></span></span><span> </span><span id="local-6989586621679414567"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414567"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679414566"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679414566"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414567"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679414566"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="annot"><a href="XMonad.Actions.Warp.html#warp"><span class="hs-identifier hs-type">warp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span id="warp"><span class="annot"><span class="annottext">warp :: Window -&gt; Position -&gt; Position -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warp"><span class="hs-identifier hs-var hs-var">warp</span></a></span></span><span> </span><span id="local-6989586621679414562"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414562"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679414561"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679414561"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679414560"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679414560"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679414558"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679414558"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Window
-&gt; Window
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; Position
-&gt; Position
-&gt; IO ()
</span><span class="hs-identifier hs-var">warpPointer</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679414558"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">none</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414562"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679414561"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679414560"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Warp the pointer to a given position relative to the currently</span><span>
</span><span id="line-92"></span><span class="hs-comment">--   focused window.  Top left = (0,0), bottom right = (1,1).</span><span>
</span><span id="line-93"></span><span class="annot"><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier hs-type">warpToWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span id="warpToWindow"><span class="annot"><span class="annottext">warpToWindow :: Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToWindow"><span class="hs-identifier hs-var hs-var">warpToWindow</span></a></span></span><span> </span><span id="local-6989586621679414554"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414554"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679414553"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414553"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679414552"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679414552"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679414550"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414550"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; (WindowAttributes -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withWindowAttributes</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679414552"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414550"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679414548"><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679414548"><span class="hs-identifier hs-var">wa</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><span class="annottext">Window -&gt; Position -&gt; Position -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warp"><span class="hs-identifier hs-var">warp</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414550"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Integral b) =&gt; Rational -&gt; a -&gt; b
</span><a href="XMonad.Actions.Warp.html#fraction"><span class="hs-identifier hs-var">fraction</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414554"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_width</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679414548"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Integral b) =&gt; Rational -&gt; a -&gt; b
</span><a href="XMonad.Actions.Warp.html#fraction"><span class="hs-identifier hs-var">fraction</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414553"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_height</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679414548"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Warp the pointer to the given position (top left = (0,0), bottom</span><span>
</span><span id="line-99"></span><span class="hs-comment">--   right = (1,1)) on the given screen.</span><span>
</span><span id="line-100"></span><span class="annot"><a href="XMonad.Actions.Warp.html#warpToScreen"><span class="hs-identifier hs-type">warpToScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span id="warpToScreen"><span class="annot"><span class="annottext">warpToScreen :: ScreenId -&gt; Rational -&gt; Rational -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warpToScreen"><span class="hs-identifier hs-var hs-var">warpToScreen</span></a></span></span><span> </span><span id="local-6989586621679414545"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679414545"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679414544"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414544"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679414543"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414543"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679414542"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414542"><span class="hs-identifier hs-var">root</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Window
</span><span class="hs-identifier hs-var">theRoot</span></span><span>
</span><span id="line-103"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span class="hs-special">{</span><span class="annot"><span class="annottext">current :: forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679414538"><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679414538"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">visible :: forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var">visible</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679414536"><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679414536"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenDetail -&gt; Rectangle
</span><span class="hs-identifier hs-var">screenRect</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sd
</span><span class="hs-identifier hs-var">W.screenDetail</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679414545"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679414538"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Screen WorkspaceId (Layout Window) Window ScreenId ScreenDetail]
</span><a href="#local-6989586621679414536"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679414530"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679414530"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>            </span><span class="annot"><span class="annottext">Window -&gt; Position -&gt; Position -&gt; X ()
</span><a href="XMonad.Actions.Warp.html#warp"><span class="hs-identifier hs-var">warp</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679414542"><span class="hs-identifier hs-var">root</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679414530"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Integral b) =&gt; Rational -&gt; a -&gt; b
</span><a href="XMonad.Actions.Warp.html#fraction"><span class="hs-identifier hs-var">fraction</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414544"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_width</span></span><span>  </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679414530"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679414530"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Integral b) =&gt; Rational -&gt; a -&gt; b
</span><a href="XMonad.Actions.Warp.html#fraction"><span class="hs-identifier hs-var">fraction</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679414543"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; Dimension
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679414530"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span></pre></body></html>