<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language DeriveGeneric, DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module      : XMonad.Actions.GroupNavigation</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Description : Cycle through groups of windows across workspaces.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright   : (c) nzeh@cs.dal.ca</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License     : BSD3-style (see LICENSE)</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer  : nzeh@cs.dal.ca</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability   : unstable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability : unportable</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Provides methods for cycling through groups of windows across</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- workspaces, ignoring windows that do not belong to this group.  A</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- group consists of all windows matching a user-provided boolean</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- query.</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Also provides a method for jumping back to the most recently used</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- window in any given group, and predefined groups.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.GroupNavigation</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-24"></span><span>                                        </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-25"></span><span>                                        </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Direction"><span class="hs-identifier">Direction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#nextMatch"><span class="hs-identifier">nextMatch</span></a></span><span>
</span><span id="line-27"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#nextMatchOrDo"><span class="hs-identifier">nextMatchOrDo</span></a></span><span>
</span><span id="line-28"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#nextMatchWithThis"><span class="hs-identifier">nextMatchWithThis</span></a></span><span>
</span><span id="line-29"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#historyHook"><span class="hs-identifier">historyHook</span></a></span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>                                        </span><span class="annot"><span class="hs-comment">-- * Utilities</span></span><span>
</span><span id="line-32"></span><span>                                        </span><span class="annot"><span class="hs-comment">-- $utilities</span></span><span>
</span><span id="line-33"></span><span>                                      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#isOnAnyVisibleWS"><span class="hs-identifier">isOnAnyVisibleWS</span></a></span><span>
</span><span id="line-34"></span><span>                                      </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">asks</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">gets</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(!)</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Seq</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ViewL</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EmptyL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(:&lt;)</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">viewl</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;&lt;)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.X11.Types</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">drop</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">null</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reverse</span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.Core</span></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.ManageHook</span></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.Operations</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">windows</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withFocused</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">elem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&gt;=&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SS</span></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-comment">{- $usage

Import the module into your @xmonad.hs@:

&gt; import XMonad.Actions.GroupNavigation

To support cycling forward and backward through all xterm windows, add
something like this to your keybindings:

&gt; , ((modm              , xK_t), nextMatch Forward  (className =? &quot;XTerm&quot;))
&gt; , ((modm .|. shiftMask, xK_t), nextMatch Backward (className =? &quot;XTerm&quot;))

These key combinations do nothing if there is no xterm window open.
If you rather want to open a new xterm window if there is no open
xterm window, use 'nextMatchOrDo' instead:

&gt; , ((modm              , xK_t), nextMatchOrDo Forward  (className =? &quot;XTerm&quot;) (spawn &quot;xterm&quot;))
&gt; , ((modm .|. shiftMask, xK_t), nextMatchOrDo Backward (className =? &quot;XTerm&quot;) (spawn &quot;xterm&quot;))

You can use 'nextMatchWithThis' with an arbitrary query to cycle
through all windows for which this query returns the same value as the
current window.  For example, to cycle through all windows in the same
window class as the current window use:

&gt; , ((modm , xK_f), nextMatchWithThis Forward  className)
&gt; , ((modm , xK_b), nextMatchWithThis Backward className)

Finally, you can define keybindings to jump to the most recent window
matching a certain Boolean query.  To do this, you need to add
'historyHook' to your logHook:

&gt; main = xmonad $ def { logHook = historyHook }

Then the following keybindings, for example, allow you to return to
the most recent xterm or emacs window or to simply to the most recent
window:

&gt; , ((modm .|. controlMask, xK_e),         nextMatch History (className =? &quot;Emacs&quot;))
&gt; , ((modm .|. controlMask, xK_t),         nextMatch History (className =? &quot;XTerm&quot;))
&gt; , ((modm                , xK_BackSpace), nextMatch History (return True))

Again, you can use 'nextMatchOrDo' instead of 'nextMatch' if you want
to execute an action if no window matching the query exists. -}</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">--- Basic cyclic navigation based on queries -------------------------</span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | The direction in which to look for the next match</span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="Direction"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Forward"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Forward"><span class="hs-identifier hs-var">Forward</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Forward from current window or workspace</span><span>
</span><span id="line-102"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="Backward"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span></span><span> </span><span class="hs-comment">-- ^ Backward from current window or workspace</span><span>
</span><span id="line-103"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="History"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#History"><span class="hs-identifier hs-var">History</span></a></span></span><span>  </span><span class="hs-comment">-- ^ Backward in history</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Focuses the next window for which the given query produces the</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- same result as the currently focused window.  Does nothing if there</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- is no focused window (i.e., the current workspace is empty).</span><span>
</span><span id="line-108"></span><span id="local-6989586621679439437"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#nextMatchWithThis"><span class="hs-identifier hs-type">nextMatchWithThis</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679439437"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><a href="#local-6989586621679439437"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-109"></span><span id="nextMatchWithThis"><span class="annot"><span class="annottext">nextMatchWithThis :: forall a. Eq a =&gt; Direction -&gt; Query a -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#nextMatchWithThis"><span class="hs-identifier hs-var hs-var">nextMatchWithThis</span></a></span></span><span> </span><span id="local-6989586621679439180"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439180"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679439179"><span class="annot"><span class="annottext">Query a
</span><a href="#local-6989586621679439179"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679439178"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679439178"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>  </span><span id="local-6989586621679439177"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439177"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query a
</span><a href="#local-6989586621679439179"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679439178"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="annottext">Direction -&gt; Query Bool -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#nextMatch"><span class="hs-identifier hs-var">nextMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439180"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query a
</span><a href="#local-6989586621679439179"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; Query a -&gt; a -&gt; Query Bool
</span><span class="hs-operator hs-var">=?</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439177"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- | Focuses the next window that matches the given boolean query.</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Does nothing if there is no such window.  This is the same as</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- 'nextMatchOrDo' with alternate action @return ()@.</span><span>
</span><span id="line-116"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#nextMatch"><span class="hs-identifier hs-type">nextMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span id="nextMatch"><span class="annot"><span class="annottext">nextMatch :: Direction -&gt; Query Bool -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#nextMatch"><span class="hs-identifier hs-var hs-var">nextMatch</span></a></span></span><span> </span><span id="local-6989586621679439174"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439174"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679439173"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679439173"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; Query Bool -&gt; X () -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#nextMatchOrDo"><span class="hs-identifier hs-var">nextMatchOrDo</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439174"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679439173"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Focuses the next window that matches the given boolean query.  If</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- there is no such window, perform the given action instead.</span><span>
</span><span id="line-121"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#nextMatchOrDo"><span class="hs-identifier hs-type">nextMatchOrDo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="nextMatchOrDo"><span class="annot"><span class="annottext">nextMatchOrDo :: Direction -&gt; Query Bool -&gt; X () -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#nextMatchOrDo"><span class="hs-identifier hs-var hs-var">nextMatchOrDo</span></a></span></span><span> </span><span id="local-6989586621679439172"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439172"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679439171"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679439171"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span id="local-6989586621679439170"><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679439170"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; X (Seq Window)
</span><a href="XMonad.Actions.GroupNavigation.html#orderedWindowList"><span class="hs-identifier hs-var">orderedWindowList</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439172"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-123"></span><span>                            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Query Bool -&gt; X () -&gt; Seq Window -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#focusNextMatchOrDo"><span class="hs-identifier hs-var">focusNextMatchOrDo</span></a></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679439171"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679439170"><span class="hs-identifier hs-var">act</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- Produces the action to perform depending on whether there's a</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- matching window</span><span>
</span><span id="line-127"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#focusNextMatchOrDo"><span class="hs-identifier hs-type">focusNextMatchOrDo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span id="focusNextMatchOrDo"><span class="annot"><span class="annottext">focusNextMatchOrDo :: Query Bool -&gt; X () -&gt; Seq Window -&gt; X ()
</span><a href="XMonad.Actions.GroupNavigation.html#focusNextMatchOrDo"><span class="hs-identifier hs-var hs-var">focusNextMatchOrDo</span></a></span></span><span> </span><span id="local-6989586621679439167"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679439167"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span id="local-6989586621679439166"><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679439166"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; m Bool) -&gt; Seq a -&gt; m (Maybe a)
</span><a href="XMonad.Actions.GroupNavigation.html#findM"><span class="hs-identifier hs-var">findM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679439167"><span class="hs-identifier hs-var">qry</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>                             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679439166"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s a i l sd.
(Eq s, Eq a, Eq i) =&gt;
a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">SS.focusWindow</span></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- Returns the list of windows ordered by workspace as specified in</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- @xmonad.hs@.</span><span>
</span><span id="line-133"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#orderedWindowList"><span class="hs-identifier hs-type">orderedWindowList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span id="orderedWindowList"><span class="annot"><span class="annottext">orderedWindowList :: Direction -&gt; X (Seq Window)
</span><a href="XMonad.Actions.GroupNavigation.html#orderedWindowList"><span class="hs-identifier hs-var hs-var">orderedWindowList</span></a></span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="XMonad.Actions.GroupNavigation.html#History"><span class="hs-identifier hs-var">History</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-type">HistoryDB</span></a></span><span> </span><span id="local-6989586621679439160"><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439160"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679439159"><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439159"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439159"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439159"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439160"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-135"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#orderedWindowList"><span class="hs-identifier hs-var">orderedWindowList</span></a></span><span> </span><span id="local-6989586621679439157"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439157"><span class="hs-identifier hs-var">dir</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679439155"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439155"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-136"></span><span>  </span><span id="local-6989586621679439154"><span class="annot"><span class="annottext">Seq WorkspaceId
</span><a href="#local-6989586621679439154"><span class="hs-identifier hs-var">wsids</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; [WorkspaceId]
</span><span class="hs-identifier hs-var">workspaces</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var">config</span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439150"><span class="annot"><span class="annottext">wspcs :: Seq WindowSpace
</span><a href="#local-6989586621679439150"><span class="hs-identifier hs-var hs-var">wspcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; Seq WorkspaceId -&gt; Seq WindowSpace
</span><a href="XMonad.Actions.GroupNavigation.html#orderedWorkspaceList"><span class="hs-identifier hs-var">orderedWorkspaceList</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439155"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="annot"><span class="annottext">Seq WorkspaceId
</span><a href="#local-6989586621679439154"><span class="hs-identifier hs-var">wsids</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span id="local-6989586621679439144"><span class="annot"><span class="annottext">wins :: Seq Window
</span><a href="#local-6989586621679439144"><span class="hs-identifier hs-var hs-var">wins</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. Direction -&gt; Seq a -&gt; Seq a
</span><a href="#local-6989586621679439143"><span class="hs-identifier hs-var">dirfun</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679439157"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-139"></span><span>              </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">(&gt;&lt;)</span></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-140"></span><span>              </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">SS.integrate'</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">SS.stack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq WindowSpace
</span><a href="#local-6989586621679439150"><span class="hs-identifier hs-var">wspcs</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span id="local-6989586621679439139"><span class="annot"><span class="annottext">cur :: Maybe Window
</span><a href="#local-6989586621679439139"><span class="hs-identifier hs-var hs-var">cur</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">SS.peek</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439155"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439144"><span class="hs-identifier hs-var">wins</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Eq a =&gt; Seq a -&gt; a -&gt; Seq a
</span><a href="#local-6989586621679439137"><span class="hs-identifier hs-var">rotfun</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439144"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439139"><span class="hs-identifier hs-var">cur</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679439143"><span class="annot"><span class="annottext">dirfun :: Direction -&gt; Seq a -&gt; Seq a
</span><a href="#local-6989586621679439143"><span class="hs-identifier hs-var hs-var">dirfun</span></a></span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="XMonad.Actions.GroupNavigation.html#Backward"><span class="hs-identifier hs-var">Backward</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.reverse</span></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="#local-6989586621679439143"><span class="hs-identifier hs-var">dirfun</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679439137"><span class="annot"><span class="annottext">rotfun :: Seq a -&gt; a -&gt; Seq a
</span><a href="#local-6989586621679439137"><span class="hs-identifier hs-var hs-var">rotfun</span></a></span></span><span> </span><span id="local-6989586621679439132"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439132"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span id="local-6989586621679439131"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439131"><span class="hs-identifier hs-var">x</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; Seq a
</span><a href="XMonad.Actions.GroupNavigation.html#rotate"><span class="hs-identifier hs-var">rotate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><a href="XMonad.Actions.GroupNavigation.html#rotateTo"><span class="hs-identifier hs-var">rotateTo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439131"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439132"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- Returns the ordered workspace list as specified in @xmonad.hs@.</span><span>
</span><span id="line-149"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#orderedWorkspaceList"><span class="hs-identifier hs-type">orderedWorkspaceList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span>
</span><span id="line-150"></span><span id="orderedWorkspaceList"><span class="annot"><span class="annottext">orderedWorkspaceList :: WindowSet -&gt; Seq WorkspaceId -&gt; Seq WindowSpace
</span><a href="XMonad.Actions.GroupNavigation.html#orderedWorkspaceList"><span class="hs-identifier hs-var hs-var">orderedWorkspaceList</span></a></span></span><span> </span><span id="local-6989586621679439128"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439128"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span id="local-6989586621679439127"><span class="annot"><span class="annottext">Seq WorkspaceId
</span><a href="#local-6989586621679439127"><span class="hs-identifier hs-var">wsids</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><a href="XMonad.Actions.GroupNavigation.html#rotateTo"><span class="hs-identifier hs-var">rotateTo</span></a></span><span> </span><span class="annot"><span class="annottext">forall {l} {a}. Workspace WorkspaceId l a -&gt; Bool
</span><a href="#local-6989586621679439126"><span class="hs-identifier hs-var">isCurWS</span></a></span><span> </span><span class="annot"><span class="annottext">Seq WindowSpace
</span><a href="#local-6989586621679439125"><span class="hs-identifier hs-var">wspcs'</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-152"></span><span>      </span><span id="local-6989586621679439124"><span class="annot"><span class="annottext">wspcs :: [WindowSpace]
</span><a href="#local-6989586621679439124"><span class="hs-identifier hs-var hs-var">wspcs</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">SS.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439128"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span id="local-6989586621679439116"><span class="annot"><span class="annottext">wspcsMap :: Map WorkspaceId WindowSpace
</span><a href="#local-6989586621679439116"><span class="hs-identifier hs-var hs-var">wspcsMap</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679439115"><span class="annot"><span class="annottext">Map WorkspaceId WindowSpace
</span><a href="#local-6989586621679439115"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621679439114"><span class="annot"><span class="annottext">WindowSpace
</span><a href="#local-6989586621679439114"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">SS.tag</span></span><span> </span><span class="annot"><span class="annottext">WindowSpace
</span><a href="#local-6989586621679439114"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WindowSpace
</span><a href="#local-6989586621679439114"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceId WindowSpace
</span><a href="#local-6989586621679439115"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">[WindowSpace]
</span><a href="#local-6989586621679439124"><span class="hs-identifier hs-var">wspcs</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span id="local-6989586621679439125"><span class="annot"><span class="annottext">wspcs' :: Seq WindowSpace
</span><a href="#local-6989586621679439125"><span class="hs-identifier hs-var hs-var">wspcs'</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map WorkspaceId WindowSpace
</span><a href="#local-6989586621679439116"><span class="hs-identifier hs-var">wspcsMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; a
</span><span class="hs-operator hs-var">!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq WorkspaceId
</span><a href="#local-6989586621679439127"><span class="hs-identifier hs-var">wsids</span></a></span><span>
</span><span id="line-155"></span><span>      </span><span id="local-6989586621679439126"><span class="annot"><span class="annottext">isCurWS :: Workspace WorkspaceId l a -&gt; Bool
</span><a href="#local-6989586621679439126"><span class="hs-identifier hs-var hs-var">isCurWS</span></a></span></span><span> </span><span id="local-6989586621679439105"><span class="annot"><span class="annottext">Workspace WorkspaceId l a
</span><a href="#local-6989586621679439105"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">SS.tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId l a
</span><a href="#local-6989586621679439105"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">SS.tag</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">SS.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">SS.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439128"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">--- History navigation, requires a layout modifier -------------------</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- The state extension that holds the history information</span><span>
</span><span id="line-160"></span><span id="local-6989586621679439101"><span id="local-6989586621679439102"></span></span><span class="hs-keyword">data</span><span> </span><span id="HistoryDB"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-var">HistoryDB</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HistoryDB"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-var">HistoryDB</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- currently focused window</span><span>
</span><span id="line-161"></span><span>                           </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- previously focused windows</span><span>
</span><span id="line-162"></span><span>               </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439082"><span id="local-6989586621679439094"><span id="local-6989586621679439097"><span id="local-6989586621679439099"><span class="annot"><span class="annottext">ReadPrec [HistoryDB]
ReadPrec HistoryDB
Int -&gt; ReadS HistoryDB
ReadS [HistoryDB]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [HistoryDB]
$creadListPrec :: ReadPrec [HistoryDB]
readPrec :: ReadPrec HistoryDB
$creadPrec :: ReadPrec HistoryDB
readList :: ReadS [HistoryDB]
$creadList :: ReadS [HistoryDB]
readsPrec :: Int -&gt; ReadS HistoryDB
$creadsPrec :: Int -&gt; ReadS HistoryDB
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439066"><span id="local-6989586621679439068"><span id="local-6989586621679439077"><span class="annot"><span class="annottext">Int -&gt; HistoryDB -&gt; ShowS
[HistoryDB] -&gt; ShowS
HistoryDB -&gt; WorkspaceId
forall a.
(Int -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceId) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [HistoryDB] -&gt; ShowS
$cshowList :: [HistoryDB] -&gt; ShowS
show :: HistoryDB -&gt; WorkspaceId
$cshow :: HistoryDB -&gt; WorkspaceId
showsPrec :: Int -&gt; HistoryDB -&gt; ShowS
$cshowsPrec :: Int -&gt; HistoryDB -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep HistoryDB x -&gt; HistoryDB
forall x. HistoryDB -&gt; Rep HistoryDB x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep HistoryDB x -&gt; HistoryDB
$cfrom :: forall x. HistoryDB -&gt; Rep HistoryDB x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439059"><span class="annot"><span class="annottext">HistoryDB -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: HistoryDB -&gt; ()
$crnf :: HistoryDB -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-type">HistoryDB</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679439052"><span class="annot"><span class="annottext">initialValue :: HistoryDB
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Window -&gt; Seq Window -&gt; HistoryDB
</span><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-var">HistoryDB</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679439047"><span class="annot"><span class="annottext">extensionType :: HistoryDB -&gt; StateExtension
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">extensionType</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Read a, Show a, ExtensionClass a) =&gt; a -&gt; StateExtension
</span><span class="hs-identifier hs-var">PersistentExtension</span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | Action that needs to be executed as a logHook to maintain the</span><span>
</span><span id="line-170"></span><span class="hs-comment">-- focus history of all windows as the WindowSet changes.</span><span>
</span><span id="line-171"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#historyHook"><span class="hs-identifier hs-type">historyHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span id="historyHook"><span class="annot"><span class="annottext">historyHook :: X ()
</span><a href="XMonad.Actions.GroupNavigation.html#historyHook"><span class="hs-identifier hs-var hs-var">historyHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. NFData a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">force</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">HistoryDB -&gt; X HistoryDB
</span><a href="XMonad.Actions.GroupNavigation.html#updateHistory"><span class="hs-identifier hs-var">updateHistory</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- Updates the history in response to a WindowSet change</span><span>
</span><span id="line-175"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#updateHistory"><span class="hs-identifier hs-type">updateHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-type">HistoryDB</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-type">HistoryDB</span></a></span><span>
</span><span id="line-176"></span><span id="updateHistory"><span class="annot"><span class="annottext">updateHistory :: HistoryDB -&gt; X HistoryDB
</span><a href="XMonad.Actions.GroupNavigation.html#updateHistory"><span class="hs-identifier hs-var hs-var">updateHistory</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-type">HistoryDB</span></a></span><span> </span><span id="local-6989586621679439039"><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439039"><span class="hs-identifier hs-var">oldcur</span></a></span></span><span> </span><span id="local-6989586621679439038"><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439038"><span class="hs-identifier hs-var">oldhist</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679439037"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439037"><span class="hs-identifier hs-var">ss</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679439036"><span class="annot"><span class="annottext">newcur :: Maybe Window
</span><a href="#local-6989586621679439036"><span class="hs-identifier hs-var hs-var">newcur</span></a></span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">SS.peek</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439037"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span id="local-6989586621679439032"><span class="annot"><span class="annottext">wins :: Set Window
</span><a href="#local-6989586621679439032"><span class="hs-identifier hs-var hs-var">wins</span></a></span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a i l s sd. Eq a =&gt; StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">SS.allWindows</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679439037"><span class="hs-identifier hs-var">ss</span></a></span><span>
</span><span id="line-179"></span><span>      </span><span id="local-6989586621679439028"><span class="annot"><span class="annottext">newhist :: Seq Window
</span><a href="#local-6989586621679439028"><span class="hs-identifier hs-var hs-var">newhist</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`Set.member`</span></span><span> </span><span class="annot"><span class="annottext">Set Window
</span><a href="#local-6989586621679439032"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Maybe a -&gt; Seq a -&gt; Seq a
</span><a href="#local-6989586621679439025"><span class="hs-identifier hs-var">ins</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439039"><span class="hs-identifier hs-var">oldcur</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439038"><span class="hs-identifier hs-var">oldhist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Window -&gt; Seq Window -&gt; HistoryDB
</span><a href="XMonad.Actions.GroupNavigation.html#HistoryDB"><span class="hs-identifier hs-var">HistoryDB</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439036"><span class="hs-identifier hs-var">newcur</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Eq a =&gt; Maybe a -&gt; Seq a -&gt; Seq a
</span><a href="#local-6989586621679439024"><span class="hs-identifier hs-var">del</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
</span><a href="#local-6989586621679439036"><span class="hs-identifier hs-var">newcur</span></a></span><span> </span><span class="annot"><span class="annottext">Seq Window
</span><a href="#local-6989586621679439028"><span class="hs-identifier hs-var">newhist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679439025"><span class="annot"><span class="annottext">ins :: Maybe a -&gt; Seq a -&gt; Seq a
</span><a href="#local-6989586621679439025"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span id="local-6989586621679439023"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679439023"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679439022"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439022"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439022"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439022"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679439023"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621679439024"><span class="annot"><span class="annottext">del :: Maybe a -&gt; Seq a -&gt; Seq a
</span><a href="#local-6989586621679439024"><span class="hs-identifier hs-var hs-var">del</span></a></span></span><span> </span><span id="local-6989586621679439019"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679439019"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679439018"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439018"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439018"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679439017"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439017"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><span class="hs-identifier hs-var">Seq.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439017"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439018"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679439019"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span class="hs-comment">--- Some sequence helpers --------------------------------------------</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- Rotates the sequence by one position</span><span>
</span><span id="line-188"></span><span id="local-6989586621679439015"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#rotate"><span class="hs-identifier hs-type">rotate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679439015"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679439015"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-189"></span><span id="rotate"><span class="annot"><span class="annottext">rotate :: forall a. Seq a -&gt; Seq a
</span><a href="XMonad.Actions.GroupNavigation.html#rotate"><span class="hs-identifier hs-var hs-var">rotate</span></a></span></span><span> </span><span id="local-6989586621679439014"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439014"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. ViewL a -&gt; Seq a
</span><a href="#local-6989586621679439013"><span class="hs-identifier hs-var">rotate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439014"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-191"></span><span>    </span><span id="local-6989586621679439013"><span class="annot"><span class="annottext">rotate' :: ViewL a -&gt; Seq a
</span><a href="#local-6989586621679439013"><span class="hs-identifier hs-var hs-var">rotate'</span></a></span></span><span> </span><span class="annot"><span class="annottext">ViewL a
</span><span class="hs-identifier hs-var">EmptyL</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Seq a
</span><span class="hs-identifier hs-var">Seq.empty</span></span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="#local-6989586621679439013"><span class="hs-identifier hs-var">rotate'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439012"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439012"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679439011"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439011"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439011"><span class="hs-identifier hs-var">xs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">|&gt;</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679439012"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- Rotates the sequence until an element matching the given condition</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- is at the beginning of the sequence.</span><span>
</span><span id="line-196"></span><span id="local-6989586621679439372"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#rotateTo"><span class="hs-identifier hs-type">rotateTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679439372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679439372"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679439372"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-197"></span><span id="rotateTo"><span class="annot"><span class="annottext">rotateTo :: forall a. (a -&gt; Bool) -&gt; Seq a -&gt; Seq a
</span><a href="XMonad.Actions.GroupNavigation.html#rotateTo"><span class="hs-identifier hs-var hs-var">rotateTo</span></a></span></span><span> </span><span id="local-6989586621679439010"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679439010"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621679439009"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439009"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679439008"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439008"><span class="hs-identifier hs-var">lxs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679439007"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439007"><span class="hs-identifier hs-var">rxs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Seq a -&gt; (Seq a, Seq a)
</span><span class="hs-identifier hs-var">Seq.breakl</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679439010"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439009"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439007"><span class="hs-identifier hs-var">rxs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Seq a -&gt; Seq a -&gt; Seq a
</span><span class="hs-operator hs-var">&gt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439008"><span class="hs-identifier hs-var">lxs</span></a></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">--- A monadic find ---------------------------------------------------</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- Applies the given action to every sequence element in turn until</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- the first element is found for which the action returns true.  The</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- remaining elements in the sequence are ignored.</span><span>
</span><span id="line-204"></span><span id="local-6989586621679439424"><span id="local-6989586621679439425"><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#findM"><span class="hs-identifier hs-type">findM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679439425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679439424"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679439425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Seq</span></span><span> </span><span class="annot"><a href="#local-6989586621679439424"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679439425"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679439424"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-205"></span><span id="findM"><span class="annot"><span class="annottext">findM :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; m Bool) -&gt; Seq a -&gt; m (Maybe a)
</span><a href="XMonad.Actions.GroupNavigation.html#findM"><span class="hs-identifier hs-var hs-var">findM</span></a></span></span><span> </span><span id="local-6989586621679439003"><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679439003"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span id="local-6989586621679439002"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439002"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a}.
Monad m =&gt;
(a -&gt; m Bool) -&gt; ViewL a -&gt; m (Maybe a)
</span><a href="#local-6989586621679439001"><span class="hs-identifier hs-var">findM'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679439003"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679439002"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span id="local-6989586621679439001"><span class="annot"><span class="annottext">findM' :: (a -&gt; m Bool) -&gt; ViewL a -&gt; m (Maybe a)
</span><a href="#local-6989586621679439001"><span class="hs-identifier hs-var hs-var">findM'</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><span class="hs-identifier">_</span></span><span>   </span><span class="annot"><span class="annottext">ViewL a
</span><span class="hs-identifier hs-var">EmptyL</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="#local-6989586621679439001"><span class="hs-identifier hs-var">findM'</span></a></span><span> </span><span id="local-6989586621679438995"><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679438995"><span class="hs-identifier hs-var">qry</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679438994"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679438994"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&lt;</span></span><span> </span><span id="local-6989586621679438993"><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679438993"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-209"></span><span>      </span><span id="local-6989586621679438992"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679438992"><span class="hs-identifier hs-var">isMatch</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679438995"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679438994"><span class="hs-identifier hs-var">x'</span></a></span><span>
</span><span id="line-210"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679438992"><span class="hs-identifier hs-var">isMatch</span></a></span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679438994"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; m Bool) -&gt; Seq a -&gt; m (Maybe a)
</span><a href="XMonad.Actions.GroupNavigation.html#findM"><span class="hs-identifier hs-var">findM</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m Bool
</span><a href="#local-6989586621679438995"><span class="hs-identifier hs-var">qry</span></a></span><span> </span><span class="annot"><span class="annottext">Seq a
</span><a href="#local-6989586621679438993"><span class="hs-identifier hs-var">xs'</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- $utilities</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- #utilities#</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- Below are handy queries for use with 'nextMatch', 'nextMatchOrDo',</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- and 'nextMatchWithThis'.</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | A query that matches all windows on visible workspaces. This is</span><span>
</span><span id="line-221"></span><span class="hs-comment">-- useful for configurations with multiple screens, and matches even</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- invisible windows.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="XMonad.Actions.GroupNavigation.html#isOnAnyVisibleWS"><span class="hs-identifier hs-type">isOnAnyVisibleWS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-224"></span><span id="isOnAnyVisibleWS"><span class="annot"><span class="annottext">isOnAnyVisibleWS :: Query Bool
</span><a href="XMonad.Actions.GroupNavigation.html#isOnAnyVisibleWS"><span class="hs-identifier hs-var hs-var">isOnAnyVisibleWS</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679438991"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679438991"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679438990"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679438990"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679438986"><span class="annot"><span class="annottext">allVisible :: [Window]
</span><a href="#local-6989586621679438986"><span class="hs-identifier hs-var hs-var">allVisible</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">SS.integrate</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">SS.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">SS.workspace</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">SS.current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679438990"><span class="hs-identifier hs-var">ws</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var">SS.visible</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679438990"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>      </span><span id="local-6989586621679438980"><span class="annot"><span class="annottext">visibleWs :: Bool
</span><a href="#local-6989586621679438980"><span class="hs-identifier hs-var hs-var">visibleWs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679438991"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679438986"><span class="hs-identifier hs-var">allVisible</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span id="local-6989586621679438976"><span class="annot"><span class="annottext">unfocused :: Bool
</span><a href="#local-6989586621679438976"><span class="hs-identifier hs-var hs-var">unfocused</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679438991"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">SS.peek</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679438990"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679438980"><span class="hs-identifier hs-var">visibleWs</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679438976"><span class="hs-identifier hs-var">unfocused</span></a></span><span>
</span><span id="line-231"></span></pre></body></html>