<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  XMonad.Actions.OnScreen</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description :  Control workspaces on different screens (in xinerama mode).</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) 2009 Nils Schweinsberg</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  Nils Schweinsberg &lt;mail@n-sch.de&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Control workspaces on different screens (in xinerama mode).</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.OnScreen</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-19"></span><span>      </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier">onScreen</span></a></span><span>
</span><span id="line-20"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onScreen%27"><span class="hs-identifier">onScreen'</span></a></span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#Focus"><span class="hs-identifier">Focus</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#viewOnScreen"><span class="hs-identifier">viewOnScreen</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#greedyViewOnScreen"><span class="hs-identifier">greedyViewOnScreen</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onlyOnScreen"><span class="hs-identifier">onlyOnScreen</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#toggleOnScreen"><span class="hs-identifier">toggleOnScreen</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#toggleGreedyOnScreen"><span class="hs-identifier">toggleGreedyOnScreen</span></a></span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">new</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | Focus data definitions</span><span>
</span><span id="line-35"></span><span class="hs-keyword">data</span><span> </span><span id="Focus"><span class="annot"><a href="XMonad.Actions.OnScreen.html#Focus"><span class="hs-identifier hs-var">Focus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FocusNew"><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusNew"><span class="hs-identifier hs-var">FocusNew</span></a></span></span><span>                       </span><span class="hs-comment">-- ^ always focus the new screen</span><span>
</span><span id="line-36"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="FocusCurrent"><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span></span><span>                   </span><span class="hs-comment">-- ^ always keep the focus on the current screen</span><span>
</span><span id="line-37"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="FocusTag"><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusTag"><span class="hs-identifier hs-var">FocusTag</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span>           </span><span class="hs-comment">-- ^ always focus tag i on the new stack</span><span>
</span><span id="line-38"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="FocusTagVisible"><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusTagVisible"><span class="hs-identifier hs-var">FocusTagVisible</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span>    </span><span class="hs-comment">-- ^ focus tag i only if workspace with tag i is visible on the old stack</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Run any function that modifies the stack on a given screen. This function</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- will also need to know which Screen to focus after the function has been</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- run.</span><span>
</span><span id="line-44"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-type">onScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ function to run</span><span>
</span><span id="line-45"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#Focus"><span class="hs-identifier hs-type">Focus</span></a></span><span>                    </span><span class="hs-comment">-- ^ what to do with the focus</span><span>
</span><span id="line-46"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>                 </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-47"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>                </span><span class="hs-comment">-- ^ current stack</span><span>
</span><span id="line-48"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-49"></span><span id="onScreen"><span class="annot"><span class="annottext">onScreen :: (WindowSet -&gt; WindowSet)
-&gt; Focus -&gt; ScreenId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-var hs-var">onScreen</span></a></span></span><span> </span><span id="local-6989586621679425744"><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679425744"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679425743"><span class="annot"><span class="annottext">Focus
</span><a href="#local-6989586621679425743"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679425742"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425742"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span id="local-6989586621679425741"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425741"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425741"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621679425740"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425740"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s i l a sd. Eq s =&gt; s -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">lookupWorkspace</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425742"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425741"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425735"><span class="annot"><span class="annottext">fStack :: WindowSet
</span><a href="#local-6989586621679425735"><span class="hs-identifier hs-var hs-var">fStack</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679425744"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425740"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425741"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Focus -&gt; WindowSet -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="#local-6989586621679425743"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425741"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425735"><span class="hs-identifier hs-var">fStack</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- set focus for new stack</span><span>
</span><span id="line-58"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-type">setFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#Focus"><span class="hs-identifier hs-type">Focus</span></a></span><span>
</span><span id="line-59"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-comment">-- ^ old stack</span><span>
</span><span id="line-60"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-comment">-- ^ new stack</span><span>
</span><span id="line-61"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-62"></span><span id="setFocus"><span class="annot"><span class="annottext">setFocus :: Focus -&gt; WindowSet -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var hs-var">setFocus</span></a></span></span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusNew"><span class="hs-identifier hs-var">FocusNew</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679425732"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425732"><span class="hs-identifier hs-var">new</span></a></span></span><span>             </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425732"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-63"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span id="local-6989586621679425731"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425731"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679425730"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425730"><span class="hs-identifier hs-var">new</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall s i l a sd. Eq s =&gt; s -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">lookupWorkspace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">screen</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425731"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425730"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>         </span><span class="annot"><span class="annottext">Maybe WorkspaceId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425730"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-66"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679425727"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425727"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425727"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425730"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-67"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusTag"><span class="hs-identifier hs-type">FocusTag</span></a></span><span> </span><span id="local-6989586621679425726"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425726"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679425725"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425725"><span class="hs-identifier hs-var">new</span></a></span></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425726"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425725"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-68"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.OnScreen.html#FocusTagVisible"><span class="hs-identifier hs-type">FocusTagVisible</span></a></span><span> </span><span id="local-6989586621679425724"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425724"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679425723"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425723"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679425722"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425722"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425724"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">workspace</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Screen i l a sid sd]
</span><span class="hs-identifier hs-var">visible</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425723"><span class="hs-identifier hs-var">old</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>       </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Focus -&gt; WindowSet -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusTag"><span class="hs-identifier hs-var">FocusTag</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425724"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425723"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425722"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-71"></span><span>       </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Focus -&gt; WindowSet -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425723"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425722"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | A variation of @onScreen@ which will take any @X ()@ function and run it</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- on the given screen.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Warning: This function will change focus even if the function it's supposed</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- to run doesn't succeed.</span><span>
</span><span id="line-77"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onScreen%27"><span class="hs-identifier hs-type">onScreen'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ X function to run</span><span>
</span><span id="line-78"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.OnScreen.html#Focus"><span class="hs-identifier hs-type">Focus</span></a></span><span>      </span><span class="hs-comment">-- ^ focus</span><span>
</span><span id="line-79"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>   </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-80"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span id="onScreen%27"><span class="annot"><span class="annottext">onScreen' :: X () -&gt; Focus -&gt; ScreenId -&gt; X ()
</span><a href="XMonad.Actions.OnScreen.html#onScreen%27"><span class="hs-identifier hs-var hs-var">onScreen'</span></a></span></span><span> </span><span id="local-6989586621679425716"><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679425716"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679425715"><span class="annot"><span class="annottext">Focus
</span><a href="#local-6989586621679425715"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679425714"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425714"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679425713"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425713"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall s i l a sd. Eq s =&gt; s -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">lookupWorkspace</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425714"><span class="hs-identifier hs-var">sc</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425713"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-84"></span><span>         </span><span class="annot"><span class="annottext">Maybe WorkspaceId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>         </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679425710"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425710"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-86"></span><span>             </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425710"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-87"></span><span>             </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679425716"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-88"></span><span>             </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Focus -&gt; WindowSet -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#setFocus"><span class="hs-identifier hs-var">setFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="#local-6989586621679425715"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425713"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Switch to workspace @i@ on screen @sc@. If @i@ is visible use @view@ to</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- switch focus to the workspace @i@.</span><span>
</span><span id="line-93"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#viewOnScreen"><span class="hs-identifier hs-type">viewOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>    </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-94"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-comment">-- ^ index of the workspace</span><span>
</span><span id="line-95"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>   </span><span class="hs-comment">-- ^ current stack</span><span>
</span><span id="line-96"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-97"></span><span id="viewOnScreen"><span class="annot"><span class="annottext">viewOnScreen :: ScreenId -&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#viewOnScreen"><span class="hs-identifier hs-var hs-var">viewOnScreen</span></a></span></span><span> </span><span id="local-6989586621679425708"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425708"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679425707"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425707"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; Focus -&gt; ScreenId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-var">onScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425707"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusTag"><span class="hs-identifier hs-var">FocusTag</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425707"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425708"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | Switch to workspace @i@ on screen @sc@. If @i@ is visible use @greedyView@</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- to switch the current workspace with workspace @i@.</span><span>
</span><span id="line-102"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#greedyViewOnScreen"><span class="hs-identifier hs-type">greedyViewOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>    </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-103"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-comment">-- ^ index of the workspace</span><span>
</span><span id="line-104"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>   </span><span class="hs-comment">-- ^ current stack</span><span>
</span><span id="line-105"></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-106"></span><span id="greedyViewOnScreen"><span class="annot"><span class="annottext">greedyViewOnScreen :: ScreenId -&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#greedyViewOnScreen"><span class="hs-identifier hs-var hs-var">greedyViewOnScreen</span></a></span></span><span> </span><span id="local-6989586621679425706"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425706"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679425705"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425705"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; Focus -&gt; ScreenId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-var">onScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">greedyView</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425705"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusTagVisible"><span class="hs-identifier hs-var">FocusTagVisible</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425705"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425706"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Switch to workspace @i@ on screen @sc@. If @i@ is visible do nothing.</span><span>
</span><span id="line-110"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#onlyOnScreen"><span class="hs-identifier hs-type">onlyOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>    </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-111"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-comment">-- ^ index of the workspace</span><span>
</span><span id="line-112"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>   </span><span class="hs-comment">-- ^ current stack</span><span>
</span><span id="line-113"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-114"></span><span id="onlyOnScreen"><span class="annot"><span class="annottext">onlyOnScreen :: ScreenId -&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onlyOnScreen"><span class="hs-identifier hs-var hs-var">onlyOnScreen</span></a></span></span><span> </span><span id="local-6989586621679425703"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425703"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679425702"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425702"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; Focus -&gt; ScreenId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-var">onScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425702"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425703"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-comment">-- | @toggleOrView@ as in &quot;XMonad.Actions.CycleWS&quot; for @onScreen@ with view</span><span>
</span><span id="line-118"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#toggleOnScreen"><span class="hs-identifier hs-type">toggleOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>    </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-119"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-comment">-- ^ index of the workspace</span><span>
</span><span id="line-120"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>   </span><span class="hs-comment">-- ^ current stack</span><span>
</span><span id="line-121"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-122"></span><span id="toggleOnScreen"><span class="annot"><span class="annottext">toggleOnScreen :: ScreenId -&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#toggleOnScreen"><span class="hs-identifier hs-var hs-var">toggleOnScreen</span></a></span></span><span> </span><span id="local-6989586621679425701"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425701"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679425700"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425700"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; Focus -&gt; ScreenId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-var">onScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WorkspaceId -&gt; WindowSet -&gt; WindowSet)
-&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#toggleOrView%27"><span class="hs-identifier hs-var">toggleOrView'</span></a></span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425700"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425701"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="hs-comment">-- | @toggleOrView@ from &quot;XMonad.Actions.CycleWS&quot; for @onScreen@ with greedyView</span><span>
</span><span id="line-126"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#toggleGreedyOnScreen"><span class="hs-identifier hs-type">toggleGreedyOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span>    </span><span class="hs-comment">-- ^ screen id</span><span>
</span><span id="line-127"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-comment">-- ^ index of the workspace</span><span>
</span><span id="line-128"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>   </span><span class="hs-comment">-- ^ current stack</span><span>
</span><span id="line-129"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-130"></span><span id="toggleGreedyOnScreen"><span class="annot"><span class="annottext">toggleGreedyOnScreen :: ScreenId -&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#toggleGreedyOnScreen"><span class="hs-identifier hs-var hs-var">toggleGreedyOnScreen</span></a></span></span><span> </span><span id="local-6989586621679425698"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425698"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679425697"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425697"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet)
-&gt; Focus -&gt; ScreenId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#onScreen"><span class="hs-identifier hs-var">onScreen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WorkspaceId -&gt; WindowSet -&gt; WindowSet)
-&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#toggleOrView%27"><span class="hs-identifier hs-var">toggleOrView'</span></a></span><span> </span><span class="annot"><span class="annottext">forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">greedyView</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425697"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Focus
</span><a href="XMonad.Actions.OnScreen.html#FocusCurrent"><span class="hs-identifier hs-var">FocusCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679425698"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- a \&quot;pure\&quot; version of X.A.CycleWS.toggleOrDoSkip</span><span>
</span><span id="line-135"></span><span class="annot"><a href="XMonad.Actions.OnScreen.html#toggleOrView%27"><span class="hs-identifier hs-type">toggleOrView'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span>   </span><span class="hs-comment">-- ^ function to run</span><span>
</span><span id="line-136"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span>                               </span><span class="hs-comment">-- ^ tag to look for</span><span>
</span><span id="line-137"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>                                 </span><span class="hs-comment">-- ^ current stackset</span><span>
</span><span id="line-138"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-139"></span><span id="toggleOrView%27"><span class="annot"><span class="annottext">toggleOrView' :: (WorkspaceId -&gt; WindowSet -&gt; WindowSet)
-&gt; WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="XMonad.Actions.OnScreen.html#toggleOrView%27"><span class="hs-identifier hs-var hs-var">toggleOrView'</span></a></span></span><span> </span><span id="local-6989586621679425696"><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679425695"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425695"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679425694"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425695"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679425693"><span class="annot"><span class="annottext">st' :: [Workspace WorkspaceId (Layout Window) Window]
</span><a href="#local-6989586621679425693"><span class="hs-identifier hs-var hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- make sure we actually have to do something</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679425695"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">workspace</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Window) Window]
</span><a href="#local-6989586621679425693"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679425691"><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679425691"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Window) Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679425696"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Window) Window
</span><a href="#local-6989586621679425691"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679425694"><span class="hs-identifier hs-var">st</span></a></span><span>  </span><span class="hs-comment">-- finally, toggle!</span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- This module provides an easy way to control, what you see on other screens in</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- xinerama mode without having to focus them. Put this into your</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- @xmonad.hs@:</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- &gt; import XMonad.Actions.OnScreen</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- Then add the appropriate keybindings, for example replace your current keys</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- to switch the workspaces with this at the bottom of your keybindings:</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- &gt;     ++</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- &gt;     [ ((m .|. modm, k), windows (f i))</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- &gt;       | (i, k) &lt;- zip (workspaces conf) ([xK_1 .. xK_9] ++ [xK_0])</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- &gt;       , (f, m) &lt;- [ (viewOnScreen 0, 0)</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- &gt;                   , (viewOnScreen 1, controlMask)</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- &gt;                   , (greedyView, controlMask .|. shiftMask) ]</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- &gt;     ]</span><span>
</span><span id="line-165"></span><span class="hs-comment">--</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- This will provide you with the following keybindings:</span><span>
</span><span id="line-167"></span><span class="hs-comment">--</span><span>
</span><span id="line-168"></span><span class="hs-comment">--      * modkey + 1-0:</span><span>
</span><span id="line-169"></span><span class="hs-comment">--      Switch to workspace 1-0 on screen 0</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">--      * modkey + control + 1-0:</span><span>
</span><span id="line-172"></span><span class="hs-comment">--      Switch to workspace 1-0 on screen 1</span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span class="hs-comment">--      * modkey + control + shift + 1-0:</span><span>
</span><span id="line-175"></span><span class="hs-comment">--      Default greedyView behaviour</span><span>
</span><span id="line-176"></span><span class="hs-comment">--</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- A more basic version inside the default keybindings would be:</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt;        , ((modm .|. controlMask, xK_1), windows (viewOnScreen 0 &quot;1&quot;))</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- where 0 is the first screen and \&quot;1\&quot; the workspace with the tag \&quot;1\&quot;.</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- For detailed instructions on editing your key bindings, see</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- &lt;https://xmonad.org/TUTORIAL.html#customizing-xmonad the tutorial&gt;.</span><span>
</span><span id="line-186"></span></pre></body></html>