<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Module      :  XMonad.Actions.EasyMotion</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Description :  Focus a visible window using a key chord.</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Copyright   :  (c) Matt Kingston &lt;mattkingston@gmail.com&gt;</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Maintainer  :  mattkingston@gmail.com</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Provides functionality to use key chords to focus a visible window. Overlays a unique key chord</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- (a string) above each visible window and allows the user to select a window by typing that</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- chord.</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Inspired by &lt;https://github.com/easymotion/vim-easymotion vim-easymotion&gt;.</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- Thanks to &lt;https://github.com/larkery Tom Hinton&gt; for some feature inspiration and window</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- sorting code.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.EasyMotion</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-26"></span><span>                                   </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-27"></span><span>                                   </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#selectWindow"><span class="hs-identifier">selectWindow</span></a></span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span>                                   </span><span class="annot"><span class="hs-comment">-- * Configuration</span></span><span>
</span><span id="line-30"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EasyMotionConfig"><span class="hs-identifier">EasyMotionConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#ChordKeys"><span class="hs-identifier">ChordKeys</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span>                                   </span><span class="annot"><span class="hs-comment">-- * Creating overlays</span></span><span>
</span><span id="line-35"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#fullSize"><span class="hs-identifier">fullSize</span></a></span><span>
</span><span id="line-36"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#fixedSize"><span class="hs-identifier">fixedSize</span></a></span><span>
</span><span id="line-37"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#textSize"><span class="hs-identifier">textSize</span></a></span><span>
</span><span id="line-38"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#proportional"><span class="hs-identifier">proportional</span></a></span><span>
</span><span id="line-39"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#bar"><span class="hs-identifier">bar</span></a></span><span>
</span><span id="line-40"></span><span>                                 </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.Font.html"><span class="hs-identifier">XMonad.Util.Font</span></a></span><span>         </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Font.html#releaseXMF"><span class="hs-identifier">releaseXMF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#initXMF"><span class="hs-identifier">initXMF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#Align"><span class="hs-identifier">Align</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Font.html#AlignCenter"><span class="hs-identifier">AlignCenter</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier">XMonadFont</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#textExtentsXMF"><span class="hs-identifier">textExtentsXMF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.XUtils.html"><span class="hs-identifier">XMonad.Util.XUtils</span></a></span><span>       </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.XUtils.html#createNewWindow"><span class="hs-identifier">createNewWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.XUtils.html#paintAndWrite"><span class="hs-identifier">paintAndWrite</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.XUtils.html#deleteWindow"><span class="hs-identifier">deleteWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.XUtils.html#showWindow"><span class="hs-identifier">showWindow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">elems</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapWithKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- You can use this module's basic functionality with the following in your</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- @xmonad.hs@:</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;    import XMonad.Actions.EasyMotion (selectWindow)</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- To customise</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- &gt;    import XMonad.Actions.EasyMotion (selectWindow, EasyMotionConfig(..))</span><span>
</span><span id="line-61"></span><span class="hs-comment">--</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- Then add a keybinding and an action to the 'selectWindow' function.</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- In this case @M-f@ to focus the selected window:</span><span>
</span><span id="line-64"></span><span class="hs-comment">--</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), selectWindow def &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Similarly, to kill a window with @M-f@:</span><span>
</span><span id="line-68"></span><span class="hs-comment">--</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), selectWindow def &gt;&gt;= (`whenJust` killWindow))</span><span>
</span><span id="line-70"></span><span class="hs-comment">--</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- See 'EasyMotionConfig' for all configuration options. A short summary follows.</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- Default chord keys are @s,d,f,j,k,l@. To customise these and display options assign</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- different values to 'def' (the default configuration):</span><span>
</span><span id="line-75"></span><span class="hs-comment">--</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), (selectWindow def{sKeys = AnyKeys [xK_f, xK_d]}) &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-77"></span><span class="hs-comment">--</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- You must supply at least two different keys in the 'sKeys' list. Keys provided earlier in the list</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- will be used preferentially&#8212;therefore, keys you would like to use more frequently should be</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- earlier in the list.</span><span>
</span><span id="line-81"></span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- To map different sets of keys to different screens. The following configuration maps keys @fdsa@</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- to screen 0 and @hjkl@ to screen 1. Keys provided earlier in the list will be used preferentially.</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- Providing the same key for multiple screens is possible but will break down in some scenarios.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt;    import qualified Data.Map.Strict as StrictMap (fromList)</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt;    emConf :: EasyMotionConfig</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt;    emConf = def { sKeys = PerScreenKeys $ StrictMap.fromList [(0, [xK_f, xK_d, xK_s, xK_a]), (1, [xK_h, xK_j, xK_k, xK_l])] }</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt;    -- key bindings</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), selectWindow emConf &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-91"></span><span class="hs-comment">--</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- To customise the font:</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), (selectWindow def{emFont = &quot;xft: Sans-40&quot;}) &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- The 'emFont' field provided is supplied directly to the 'initXMF' function. The default is</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- @&quot;xft:Sans-100&quot;@. Some example options:</span><span>
</span><span id="line-98"></span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt;    &quot;xft: Sans-40&quot;</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt;    &quot;xft: Arial-100&quot;</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt;    &quot;xft: Cambria-80&quot;</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- Customise the overlay by supplying a function to 'overlayF'. The signature is</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- @'Position' -&gt; 'Rectangle' -&gt; 'Rectangle'@. The parameters are the height in pixels of</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- the selection chord and the rectangle of the window to be overlaid. Some are provided:</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;    import XMonad.Actions.EasyMotion (selectWindow, EasyMotionConfig(..), proportional, bar, fullSize)</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), (selectWindow def{ overlayF = proportional 0.3  }) &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), (selectWindow def{ overlayF = bar 0.5           }) &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), (selectWindow def{ overlayF = fullSize          }) &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt;    , ((modm, xK_f), (selectWindow def{ overlayF = fixedSize 300 350 }) &gt;&gt;= (`whenJust` windows . W.focusWindow))</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-comment">-- TODO:</span><span>
</span><span id="line-114"></span><span class="hs-comment">--  - An overlay function that creates an overlay a proportion of the width XOR height of the</span><span>
</span><span id="line-115"></span><span class="hs-comment">--    window it's over, and with a fixed w/h proportion? E.g. overlay-height = 0.3 *</span><span>
</span><span id="line-116"></span><span class="hs-comment">--    target-window-height; overlay-width = 0.5 * overlay-height.</span><span>
</span><span id="line-117"></span><span class="hs-comment">--  - An overlay function that creates an overlay of a fixed w,h, aligned mid,mid, or parametrised</span><span>
</span><span id="line-118"></span><span class="hs-comment">--    alignment?</span><span>
</span><span id="line-119"></span><span class="hs-comment">--  - Parametrise chord generation?</span><span>
</span><span id="line-120"></span><span class="hs-comment">--  - W.shift example; bring window from other screen to current screen? Only useful if we don't</span><span>
</span><span id="line-121"></span><span class="hs-comment">--    show chords on current workspace.</span><span>
</span><span id="line-122"></span><span class="hs-comment">--  - Use stringToKeysym, keysymToKeycode, keycodeToKeysym, keysymToString to take a string from</span><span>
</span><span id="line-123"></span><span class="hs-comment">--    the user?</span><span>
</span><span id="line-124"></span><span class="hs-comment">--  - Think a bit more about improving functionality with floating windows.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--    - currently, floating window z-order is not respected</span><span>
</span><span id="line-126"></span><span class="hs-comment">--    - could ignore floating windows</span><span>
</span><span id="line-127"></span><span class="hs-comment">--    - may be able to calculate the visible section of a floating window, and display the chord in</span><span>
</span><span id="line-128"></span><span class="hs-comment">--      that space</span><span>
</span><span id="line-129"></span><span class="hs-comment">--  - Provide an option to prepend the screen key to the easymotion keys (i.e. w,e,r)?</span><span>
</span><span id="line-130"></span><span class="hs-comment">--  - overlay alpha</span><span>
</span><span id="line-131"></span><span class="hs-comment">--  - Delay after selection so the user can see what they've chosen? Min-delay: 0 seconds. If</span><span>
</span><span id="line-132"></span><span class="hs-comment">--    there's a delay, perhaps keep the other windows covered briefly to naturally draw the user's</span><span>
</span><span id="line-133"></span><span class="hs-comment">--    attention to the window they've selected? Or briefly highlight the border of the selected</span><span>
</span><span id="line-134"></span><span class="hs-comment">--    window?</span><span>
</span><span id="line-135"></span><span class="hs-comment">--  - Option to cover windows that will not be selected by the current chord, such that it's</span><span>
</span><span id="line-136"></span><span class="hs-comment">--    slightly more obvious where to maintain focus.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--  - Something unpleasant happens when the user provides only two keys (let's say f, d) for</span><span>
</span><span id="line-138"></span><span class="hs-comment">--    chords. When they have five windows open, the following chords are generated: ddd, ddf, dfd,</span><span>
</span><span id="line-139"></span><span class="hs-comment">--    dff, fdd. When 'f' is pressed, all chords disappear unexpectedly because we know there are no</span><span>
</span><span id="line-140"></span><span class="hs-comment">--    other valid options. The user expects to press 'fdd'. This is an optimisation in software but</span><span>
</span><span id="line-141"></span><span class="hs-comment">--    pretty bad for usability, as the user continues firing keys into their</span><span>
</span><span id="line-142"></span><span class="hs-comment">--    now-unexpectedly-active window. And is of course only one concrete example of a more general</span><span>
</span><span id="line-143"></span><span class="hs-comment">--    problem.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--    Short-term solution:</span><span>
</span><span id="line-145"></span><span class="hs-comment">--      - Keep displaying the chord until the user has fully entered it</span><span>
</span><span id="line-146"></span><span class="hs-comment">--    Fix:</span><span>
</span><span id="line-147"></span><span class="hs-comment">--      - Show the shortest possible chords</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Associates a user window, an overlay window created by this module and a rectangle</span><span>
</span><span id="line-150"></span><span class="hs-comment">--   circumscribing these windows</span><span>
</span><span id="line-151"></span><span class="hs-keyword">data</span><span> </span><span id="OverlayWindow"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-var">OverlayWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-152"></span><span>  </span><span id="OverlayWindow"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-var">OverlayWindow</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="win"><span class="annot"><span class="annottext">OverlayWindow -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#win"><span class="hs-identifier hs-var hs-var">win</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>           </span><span class="hs-comment">-- ^ The window managed by xmonad</span><span>
</span><span id="line-153"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="attrs"><span class="annot"><span class="annottext">OverlayWindow -&gt; WindowAttributes
</span><a href="XMonad.Actions.EasyMotion.html#attrs"><span class="hs-identifier hs-var hs-var">attrs</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">WindowAttributes</span></span><span> </span><span class="hs-comment">-- ^ Window attributes for @win@</span><span>
</span><span id="line-154"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="overlay"><span class="annot"><span class="annottext">OverlayWindow -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#overlay"><span class="hs-identifier hs-var hs-var">overlay</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>           </span><span class="hs-comment">-- ^ Our window used to display the overlay</span><span>
</span><span id="line-155"></span><span>                </span><span class="hs-special">,</span><span> </span><span id="rect"><span class="annot"><span class="annottext">OverlayWindow -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#rect"><span class="hs-identifier hs-var hs-var">rect</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>        </span><span class="hs-comment">-- ^ The rectangle of @overlay@</span><span>
</span><span id="line-156"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | An overlay window and the chord used to select it</span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="Overlay"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-160"></span><span>  </span><span id="Overlay"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="overlayWin"><span class="annot"><span class="annottext">Overlay -&gt; OverlayWindow
</span><a href="XMonad.Actions.EasyMotion.html#overlayWin"><span class="hs-identifier hs-var hs-var">overlayWin</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span>    </span><span class="hs-comment">-- ^ The window managed by xmonad</span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-special">,</span><span> </span><span id="chord"><span class="annot"><span class="annottext">Overlay -&gt; [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var hs-var">chord</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span>         </span><span class="hs-comment">-- ^ The chord we'll display in the overlay</span><span>
</span><span id="line-162"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-comment">-- | Maps keys to windows. 'AnyKeys' maps keys to windows regardless which screen they're on.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--   'PerScreenKeys' maps keys to screens to windows. See @Usage@ for more examples.</span><span>
</span><span id="line-167"></span><span class="hs-keyword">data</span><span> </span><span id="ChordKeys"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#ChordKeys"><span class="hs-identifier hs-var">ChordKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AnyKeys"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-var">AnyKeys</span></a></span></span><span>       </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span id="PerScreenKeys"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#PerScreenKeys"><span class="hs-identifier hs-var">PerScreenKeys</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Configuration options for EasyMotion.</span><span>
</span><span id="line-171"></span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span class="hs-comment">--   All colors are hex strings, e.g. &quot;#000000&quot;</span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   If the number of windows for which chords are required exceeds 'maxChordLen', chords</span><span>
</span><span id="line-175"></span><span class="hs-comment">--   will simply not be generated for these windows. In this way, single-key selection may be</span><span>
</span><span id="line-176"></span><span class="hs-comment">--   preferred over the ability to select any window.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   'cancelKey', @xK_BackSpace@ and any duplicates will be removed from 'sKeys' if included.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   See @Usage@ for examples of 'sKeys'.</span><span>
</span><span id="line-180"></span><span class="hs-keyword">data</span><span> </span><span id="EasyMotionConfig"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EasyMotionConfig"><span class="hs-identifier hs-var">EasyMotionConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-181"></span><span>  </span><span id="EMConf"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EMConf"><span class="hs-identifier hs-var">EMConf</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="txtCol"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#txtCol"><span class="hs-identifier hs-var hs-var">txtCol</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                               </span><span class="hs-comment">-- ^ Color of the text displayed</span><span>
</span><span id="line-182"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="bgCol"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#bgCol"><span class="hs-identifier hs-var hs-var">bgCol</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                               </span><span class="hs-comment">-- ^ Color of the window overlaid</span><span>
</span><span id="line-183"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="overlayF"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#overlayF"><span class="hs-identifier hs-var hs-var">overlayF</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Function to generate overlay rectangle</span><span>
</span><span id="line-184"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="borderCol"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#borderCol"><span class="hs-identifier hs-var hs-var">borderCol</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                               </span><span class="hs-comment">-- ^ Color of the overlay window borders</span><span>
</span><span id="line-185"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="sKeys"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var hs-var">sKeys</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#ChordKeys"><span class="hs-identifier hs-type">ChordKeys</span></a></span><span>                            </span><span class="hs-comment">-- ^ Keys to use for window selection</span><span>
</span><span id="line-186"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="cancelKey"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#cancelKey"><span class="hs-identifier hs-var hs-var">cancelKey</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span>                               </span><span class="hs-comment">-- ^ Key to use to cancel selection</span><span>
</span><span id="line-187"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="emFont"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#emFont"><span class="hs-identifier hs-var hs-var">emFont</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                               </span><span class="hs-comment">-- ^ Font for selection characters (passed to 'initXMF')</span><span>
</span><span id="line-188"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="borderPx"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; Int
</span><a href="XMonad.Actions.EasyMotion.html#borderPx"><span class="hs-identifier hs-var hs-var">borderPx</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                                  </span><span class="hs-comment">-- ^ Width of border in pixels</span><span>
</span><span id="line-189"></span><span>         </span><span class="hs-special">,</span><span> </span><span id="maxChordLen"><span class="annot"><span class="annottext">EasyMotionConfig -&gt; Int
</span><a href="XMonad.Actions.EasyMotion.html#maxChordLen"><span class="hs-identifier hs-var hs-var">maxChordLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>                                  </span><span class="hs-comment">-- ^ Maximum chord length. Use 0 for no maximum.</span><span>
</span><span id="line-190"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EasyMotionConfig"><span class="hs-identifier hs-type">EasyMotionConfig</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679504454"><span class="annot"><span class="annottext">def :: EasyMotionConfig
</span><a href="#local-6989586621679504454"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EMConf"><span class="hs-identifier hs-type">EMConf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">txtCol :: WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#txtCol"><span class="hs-identifier hs-var">txtCol</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;#ffffff&quot;</span></span><span>
</span><span id="line-195"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">bgCol :: WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#bgCol"><span class="hs-identifier hs-var">bgCol</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;#000000&quot;</span></span><span>
</span><span id="line-196"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">overlayF :: Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#overlayF"><span class="hs-identifier hs-var">overlayF</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall f. RealFrac f =&gt; f -&gt; Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#proportional"><span class="hs-identifier hs-var">proportional</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.3</span></span><span class="hs-glyph">::</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">borderCol :: WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#borderCol"><span class="hs-identifier hs-var">borderCol</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;#ffffff&quot;</span></span><span>
</span><span id="line-198"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">sKeys :: ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var">sKeys</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[EventMask] -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-var">AnyKeys</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_s</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_d</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_f</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">]</span><span>
</span><span id="line-199"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cancelKey :: EventMask
</span><a href="XMonad.Actions.EasyMotion.html#cancelKey"><span class="hs-identifier hs-var">cancelKey</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_q</span></span><span>
</span><span id="line-200"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">borderPx :: Int
</span><a href="XMonad.Actions.EasyMotion.html#borderPx"><span class="hs-identifier hs-var">borderPx</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-201"></span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">maxChordLen :: Int
</span><a href="XMonad.Actions.EasyMotion.html#maxChordLen"><span class="hs-identifier hs-var">maxChordLen</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-cpp">
#ifdef XFT
</span><span>           </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">emFont :: WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#emFont"><span class="hs-identifier hs-var">emFont</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;xft:Sans-100&quot;</span></span><span class="hs-cpp">
#else
</span><span>           </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">emFont</span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;-misc-fixed-*-*-*-*-200-*-*-*-*-*-*-*&quot;</span><span class="hs-cpp">
#endif
</span><span>           </span><span class="hs-special">}</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Create overlay windows of the same size as the window they select</span><span>
</span><span id="line-210"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#fullSize"><span class="hs-identifier hs-type">fullSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-211"></span><span id="fullSize"><span class="annot"><span class="annottext">fullSize :: Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#fullSize"><span class="hs-identifier hs-var hs-var">fullSize</span></a></span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Create overlay windows a proportion of the size of the window they select</span><span>
</span><span id="line-214"></span><span id="local-6989586621679504804"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#proportional"><span class="hs-identifier hs-type">proportional</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621679504804"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679504804"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span></span><span>
</span><span id="line-215"></span><span id="proportional"><span class="annot"><span class="annottext">proportional :: forall f. RealFrac f =&gt; f -&gt; Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#proportional"><span class="hs-identifier hs-var hs-var">proportional</span></a></span></span><span> </span><span id="local-6989586621679504428"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679504428"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679504427"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504427"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span id="local-6989586621679504426"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504426"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rect_width :: EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504423"><span class="hs-identifier hs-var">newW</span></a></span><span>
</span><span id="line-216"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_height :: EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504421"><span class="hs-identifier hs-var">newH</span></a></span><span>
</span><span id="line-217"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504426"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504426"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504423"><span class="hs-identifier hs-var">newW</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span>
</span><span id="line-218"></span><span>                                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_y :: Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504426"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504426"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504421"><span class="hs-identifier hs-var">newH</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="local-6989586621679504421"><span class="annot"><span class="annottext">newH :: EventType
</span><a href="#local-6989586621679504421"><span class="hs-identifier hs-var hs-var">newH</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504427"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679504428"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504426"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679504423"><span class="annot"><span class="annottext">newW :: EventType
</span><a href="#local-6989586621679504423"><span class="hs-identifier hs-var hs-var">newW</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504421"><span class="hs-identifier hs-var">newH</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-comment">-- | Create fixed-size overlay windows</span><span>
</span><span id="line-224"></span><span id="local-6989586621679504789"><span id="local-6989586621679504790"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#fixedSize"><span class="hs-identifier hs-type">fixedSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679504790"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679504789"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679504790"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679504789"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span></span></span><span>
</span><span id="line-225"></span><span id="fixedSize"><span class="annot"><span class="annottext">fixedSize :: forall a b.
(Integral a, Integral b) =&gt;
a -&gt; b -&gt; Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#fixedSize"><span class="hs-identifier hs-var hs-var">fixedSize</span></a></span></span><span> </span><span id="local-6989586621679504389"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679504389"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679504388"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679504388"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679504387"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504387"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span id="local-6989586621679504386"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504386"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rect_width :: EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504385"><span class="hs-identifier hs-var">rw</span></a></span><span>
</span><span id="line-226"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_height :: EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504384"><span class="hs-identifier hs-var">rh</span></a></span><span>
</span><span id="line-227"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504386"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504386"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504385"><span class="hs-identifier hs-var">rw</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span>
</span><span id="line-228"></span><span>                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_y :: Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504386"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504386"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679504384"><span class="hs-identifier hs-var">rh</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-229"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679504385"><span class="annot"><span class="annottext">rw :: EventType
</span><a href="#local-6989586621679504385"><span class="hs-identifier hs-var hs-var">rw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679504389"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504387"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679504384"><span class="annot"><span class="annottext">rh :: EventType
</span><a href="#local-6989586621679504384"><span class="hs-identifier hs-var hs-var">rh</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679504388"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504387"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Create overlay windows the minimum size to contain their key chord</span><span>
</span><span id="line-234"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#textSize"><span class="hs-identifier hs-type">textSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-235"></span><span id="textSize"><span class="annot"><span class="annottext">textSize :: Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#textSize"><span class="hs-identifier hs-var hs-var">textSize</span></a></span></span><span> </span><span id="local-6989586621679504373"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504373"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span id="local-6989586621679504372"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504372"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rect_width :: EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504373"><span class="hs-identifier hs-var">th</span></a></span><span>
</span><span id="line-236"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_height :: EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504373"><span class="hs-identifier hs-var">th</span></a></span><span>
</span><span id="line-237"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504372"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504372"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504373"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span>
</span><span id="line-238"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_y :: Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504372"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504372"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504373"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Create overlay windows the full width of the window they select, the minimum height to contain</span><span>
</span><span id="line-241"></span><span class="hs-comment">--   their chord, and a proportion of the distance from the top of the window they select</span><span>
</span><span id="line-242"></span><span id="local-6989586621679504371"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#bar"><span class="hs-identifier hs-type">bar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RealFrac</span></span><span> </span><span class="annot"><a href="#local-6989586621679504371"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679504371"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span></span><span>
</span><span id="line-243"></span><span id="bar"><span class="annot"><span class="annottext">bar :: forall f. RealFrac f =&gt; f -&gt; Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#bar"><span class="hs-identifier hs-var hs-var">bar</span></a></span></span><span> </span><span id="local-6989586621679504352"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679504352"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679504351"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504351"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span id="local-6989586621679504350"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504350"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rect_width :: EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504350"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-244"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_height :: EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504351"><span class="hs-identifier hs-var">th</span></a></span><span>
</span><span id="line-245"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_x :: Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_x</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504350"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-246"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">rect_y :: Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Position
</span><span class="hs-identifier hs-var">rect_y</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504350"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679504349"><span class="hs-identifier hs-var">f'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504350"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504351"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-247"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>   </span><span class="hs-comment">-- clamp f in [0,1] as other values will appear to lock up xmonad as the overlay will be</span><span>
</span><span id="line-249"></span><span>   </span><span class="hs-comment">-- displayed off-screen</span><span>
</span><span id="line-250"></span><span>   </span><span id="local-6989586621679504349"><span class="annot"><span class="annottext">f' :: f
</span><a href="#local-6989586621679504349"><span class="hs-identifier hs-var hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-number">0.0</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679504352"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-number">1.0</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- | Handles overlay display and window selection. Called after config has been sanitised.</span><span>
</span><span id="line-253"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#handleSelectWindow"><span class="hs-identifier hs-type">handleSelectWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EasyMotionConfig"><span class="hs-identifier hs-type">EasyMotionConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span id="handleSelectWindow"><span class="annot"><span class="annottext">handleSelectWindow :: EasyMotionConfig -&gt; X (Maybe EventMask)
</span><a href="XMonad.Actions.EasyMotion.html#handleSelectWindow"><span class="hs-identifier hs-var hs-var">handleSelectWindow</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EMConf"><span class="hs-identifier hs-type">EMConf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sKeys :: EasyMotionConfig -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var">sKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-type">AnyKeys</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-255"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#handleSelectWindow"><span class="hs-identifier hs-var">handleSelectWindow</span></a></span><span> </span><span id="local-6989586621679504342"><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679504341"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504341"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X XMonadFont
</span><a href="XMonad.Util.Font.html#initXMF"><span class="hs-identifier hs-var">initXMF</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#emFont"><span class="hs-identifier hs-var">emFont</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679504340"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504340"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679504339"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504339"><span class="hs-identifier hs-var">asc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679504338"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504338"><span class="hs-identifier hs-var">dsc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504339"><span class="hs-identifier hs-var">asc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504338"><span class="hs-identifier hs-var">dsc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Position
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
XMonadFont -&gt; WorkspaceId -&gt; m (Position, Position)
</span><a href="XMonad.Util.Font.html#textExtentsXMF"><span class="hs-identifier hs-var">textExtentsXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504341"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">EventMask -&gt; WorkspaceId
</span><span class="hs-identifier hs-var">keysymToString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChordKeys -&gt; [EventMask]
</span><a href="#local-6989586621679504334"><span class="hs-identifier hs-var">allKeys</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var">sKeys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">XConf</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">theRoot :: XConf -&gt; EventMask
</span><span class="hs-identifier hs-var">theRoot</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504330"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504330"><span class="hs-identifier hs-var">rw</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">display :: XConf -&gt; Display
</span><span class="hs-identifier hs-var">display</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504328"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504328"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">XState</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">mapped :: XState -&gt; Set EventMask
</span><span class="hs-identifier hs-var">mapped</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504324"><span class="annot"><span class="annottext">Set EventMask
</span><a href="#local-6989586621679504324"><span class="hs-identifier hs-var">mappedWins</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">windowset :: XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504322"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679504322"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-comment">-- build overlays depending on key configuration</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679504320"><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504320"><span class="hs-identifier hs-var">overlays</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var">sKeys</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-type">AnyKeys</span></a></span><span> </span><span id="local-6989586621679504319"><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504319"><span class="hs-identifier hs-var">ks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[EventMask] -&gt; [OverlayWindow] -&gt; [Overlay]
</span><a href="#local-6989586621679504318"><span class="hs-identifier hs-var">buildOverlays</span></a></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504319"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X [OverlayWindow]
</span><a href="#local-6989586621679504317"><span class="hs-identifier hs-var">sortedOverlayWindows</span></a></span><span>
</span><span id="line-263"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><a href="#local-6989586621679504316"><span class="hs-identifier hs-type">visibleWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span>
</span><span id="line-265"></span><span>      </span><span id="local-6989586621679504316"><span class="annot"><span class="annottext">visibleWindows :: [EventMask]
</span><a href="#local-6989586621679504316"><span class="hs-identifier hs-var hs-var">visibleWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Set EventMask
</span><a href="#local-6989586621679504324"><span class="hs-identifier hs-var">mappedWins</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><a href="#local-6989586621679504317"><span class="hs-identifier hs-type">sortedOverlayWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-267"></span><span>      </span><span id="local-6989586621679504317"><span class="annot"><span class="annottext">sortedOverlayWindows :: X [OverlayWindow]
</span><a href="#local-6989586621679504317"><span class="hs-identifier hs-var hs-var">sortedOverlayWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OverlayWindow] -&gt; [OverlayWindow]
</span><a href="#local-6989586621679504315"><span class="hs-identifier hs-var">sortOverlayWindows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [EventMask] -&gt; X [OverlayWindow]
</span><a href="#local-6989586621679504314"><span class="hs-identifier hs-var">buildOverlayWindows</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504340"><span class="hs-identifier hs-var">th</span></a></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504316"><span class="hs-identifier hs-var">visibleWindows</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#PerScreenKeys"><span class="hs-identifier hs-type">PerScreenKeys</span></a></span><span> </span><span id="local-6989586621679504313"><span class="annot"><span class="annottext">Map ScreenId [EventMask]
</span><a href="#local-6989586621679504313"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a b. (k -&gt; a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapWithKey</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679504310"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504310"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679504309"><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504309"><span class="hs-identifier hs-var">ks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[EventMask] -&gt; [OverlayWindow] -&gt; [Overlay]
</span><a href="#local-6989586621679504318"><span class="hs-identifier hs-var">buildOverlays</span></a></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504309"><span class="hs-identifier hs-var">ks</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; X [OverlayWindow]
</span><a href="#local-6989586621679504308"><span class="hs-identifier hs-var">sortedOverlayWindows</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504310"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map ScreenId [EventMask]
</span><a href="#local-6989586621679504313"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-273"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="#local-6989586621679504307"><span class="hs-identifier hs-type">screenById</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prelude.html#WindowScreen"><span class="hs-identifier hs-type">WindowScreen</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span id="local-6989586621679504307"><span class="annot"><span class="annottext">screenById :: ScreenId -&gt; Maybe WindowScreen
</span><a href="#local-6989586621679504307"><span class="hs-identifier hs-var hs-var">screenById</span></a></span></span><span> </span><span id="local-6989586621679504306"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504306"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504306"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Screen i l a s sd]
</span><span class="hs-identifier hs-var">W.screens</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679504322"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="#local-6989586621679504302"><span class="hs-identifier hs-type">visibleWindowsOnScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621679504302"><span class="annot"><span class="annottext">visibleWindowsOnScreen :: ScreenId -&gt; [EventMask]
</span><a href="#local-6989586621679504302"><span class="hs-identifier hs-var hs-var">visibleWindowsOnScreen</span></a></span></span><span> </span><span id="local-6989586621679504301"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504301"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall l. IsList l =&gt; l -&gt; [Item l]
</span><span class="hs-identifier hs-var">toList</span></span><span> </span><span class="annot"><span class="annottext">Set EventMask
</span><a href="#local-6989586621679504324"><span class="hs-identifier hs-var">mappedWins</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScreenId -&gt; Maybe WindowScreen
</span><a href="#local-6989586621679504307"><span class="hs-identifier hs-var">screenById</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504301"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="#local-6989586621679504308"><span class="hs-identifier hs-type">sortedOverlayWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ScreenId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-279"></span><span>      </span><span id="local-6989586621679504308"><span class="annot"><span class="annottext">sortedOverlayWindows :: ScreenId -&gt; X [OverlayWindow]
</span><a href="#local-6989586621679504308"><span class="hs-identifier hs-var hs-var">sortedOverlayWindows</span></a></span></span><span> </span><span id="local-6989586621679504296"><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504296"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OverlayWindow] -&gt; [OverlayWindow]
</span><a href="#local-6989586621679504315"><span class="hs-identifier hs-var">sortOverlayWindows</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Position -&gt; [EventMask] -&gt; X [OverlayWindow]
</span><a href="#local-6989586621679504314"><span class="hs-identifier hs-var">buildOverlayWindows</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504340"><span class="hs-identifier hs-var">th</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScreenId -&gt; [EventMask]
</span><a href="#local-6989586621679504302"><span class="hs-identifier hs-var">visibleWindowsOnScreen</span></a></span><span> </span><span class="annot"><span class="annottext">ScreenId
</span><a href="#local-6989586621679504296"><span class="hs-identifier hs-var">sid</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679504295"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679504295"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; EventMask -&gt; Bool -&gt; CInt -&gt; CInt -&gt; EventMask -&gt; IO CInt
</span><span class="hs-identifier hs-var">grabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504328"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504330"><span class="hs-identifier hs-var">rw</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679504295"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabSuccess</span></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-283"></span><span>      </span><span id="local-6989586621679504289"><span class="annot"><span class="annottext">HandleResult
</span><a href="#local-6989586621679504289"><span class="hs-identifier hs-var">resultWin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504328"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XMonadFont -&gt; Overlay -&gt; X ()
</span><a href="#local-6989586621679504287"><span class="hs-identifier hs-var">displayOverlay</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504341"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#cancelKey"><span class="hs-identifier hs-var">cancelKey</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504320"><span class="hs-identifier hs-var">overlays</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; EventMask -&gt; IO ()
</span><span class="hs-identifier hs-var">ungrabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504328"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EventMask -&gt; X ()
</span><a href="XMonad.Util.XUtils.html#deleteWindow"><span class="hs-identifier hs-var">deleteWindow</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OverlayWindow -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; OverlayWindow
</span><a href="XMonad.Actions.EasyMotion.html#overlayWin"><span class="hs-identifier hs-var">overlayWin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504320"><span class="hs-identifier hs-var">overlays</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">sync</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504328"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><span class="annottext">XMonadFont -&gt; X ()
</span><a href="XMonad.Util.Font.html#releaseXMF"><span class="hs-identifier hs-var">releaseXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504341"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HandleResult
</span><a href="#local-6989586621679504289"><span class="hs-identifier hs-var">resultWin</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>        </span><span class="hs-comment">-- focus the selected window</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Selected"><span class="hs-identifier hs-type">Selected</span></a></span><span> </span><span id="local-6989586621679504282"><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504282"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OverlayWindow -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#win"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; OverlayWindow
</span><a href="XMonad.Actions.EasyMotion.html#overlayWin"><span class="hs-identifier hs-var">overlayWin</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504282"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="hs-comment">-- return focus correctly</span><span>
</span><span id="line-292"></span><span>        </span><span class="annot"><span class="annottext">HandleResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; Maybe a
</span><span class="hs-identifier hs-var">W.peek</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679504322"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s a i l sd.
(Eq s, Eq a, Eq i) =&gt;
a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.focusWindow</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">XMonadFont -&gt; X ()
</span><a href="XMonad.Util.Font.html#releaseXMF"><span class="hs-identifier hs-var">releaseXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504341"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-294"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><a href="#local-6989586621679504334"><span class="hs-identifier hs-type">allKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#ChordKeys"><span class="hs-identifier hs-type">ChordKeys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679504334"><span class="annot"><span class="annottext">allKeys :: ChordKeys -&gt; [EventMask]
</span><a href="#local-6989586621679504334"><span class="hs-identifier hs-var hs-var">allKeys</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-type">AnyKeys</span></a></span><span> </span><span id="local-6989586621679504276"><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504276"><span class="hs-identifier hs-var">ks</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504276"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="#local-6989586621679504334"><span class="hs-identifier hs-var">allKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#PerScreenKeys"><span class="hs-identifier hs-type">PerScreenKeys</span></a></span><span> </span><span id="local-6989586621679504275"><span class="annot"><span class="annottext">Map ScreenId [EventMask]
</span><a href="#local-6989586621679504275"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Map ScreenId [EventMask]
</span><a href="#local-6989586621679504275"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="#local-6989586621679504318"><span class="hs-identifier hs-type">buildOverlays</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>  </span><span id="local-6989586621679504318"><span class="annot"><span class="annottext">buildOverlays :: [EventMask] -&gt; [OverlayWindow] -&gt; [Overlay]
</span><a href="#local-6989586621679504318"><span class="hs-identifier hs-var hs-var">buildOverlays</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [EventMask] -&gt; [OverlayWindow] -&gt; [Overlay]
</span><a href="XMonad.Actions.EasyMotion.html#appendChords"><span class="hs-identifier hs-var">appendChords</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; Int
</span><a href="XMonad.Actions.EasyMotion.html#maxChordLen"><span class="hs-identifier hs-var">maxChordLen</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span>  </span><span class="annot"><a href="#local-6989586621679504314"><span class="hs-identifier hs-type">buildOverlayWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>  </span><span id="local-6989586621679504314"><span class="annot"><span class="annottext">buildOverlayWindows :: Position -&gt; [EventMask] -&gt; X [OverlayWindow]
</span><a href="#local-6989586621679504314"><span class="hs-identifier hs-var hs-var">buildOverlayWindows</span></a></span></span><span> </span><span id="local-6989586621679504273"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504273"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>                         </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Position -&gt; EventMask -&gt; X (Maybe OverlayWindow)
</span><a href="#local-6989586621679504269"><span class="hs-identifier hs-var">buildOverlayWin</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504273"><span class="hs-identifier hs-var">th</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span>  </span><span class="annot"><a href="#local-6989586621679504315"><span class="hs-identifier hs-type">sortOverlayWindows</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-307"></span><span>  </span><span id="local-6989586621679504315"><span class="annot"><span class="annottext">sortOverlayWindows :: [OverlayWindow] -&gt; [OverlayWindow]
</span><a href="#local-6989586621679504315"><span class="hs-identifier hs-var hs-var">sortOverlayWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. Ord b =&gt; (a -&gt; b) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortOn</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_x</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_y</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">OverlayWindow -&gt; WindowAttributes
</span><a href="XMonad.Actions.EasyMotion.html#attrs"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><a href="#local-6989586621679504265"><span class="hs-identifier hs-type">makeRect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowAttributes</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679504265"><span class="annot"><span class="annottext">makeRect :: WindowAttributes -&gt; Rectangle
</span><a href="#local-6989586621679504265"><span class="hs-identifier hs-var hs-var">makeRect</span></a></span></span><span> </span><span id="local-6989586621679504264"><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504264"><span class="hs-identifier hs-var">wa</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Position -&gt; Position -&gt; EventType -&gt; EventType -&gt; Rectangle
</span><span class="hs-identifier hs-var">Rectangle</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_x</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504264"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_y</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504264"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_width</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504264"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowAttributes -&gt; CInt
</span><span class="hs-identifier hs-var">wa_height</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504264"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span>  </span><span class="annot"><a href="#local-6989586621679504269"><span class="hs-identifier hs-type">buildOverlayWin</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>  </span><span id="local-6989586621679504269"><span class="annot"><span class="annottext">buildOverlayWin :: Position -&gt; EventMask -&gt; X (Maybe OverlayWindow)
</span><a href="#local-6989586621679504269"><span class="hs-identifier hs-var hs-var">buildOverlayWin</span></a></span></span><span> </span><span id="local-6989586621679504261"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504261"><span class="hs-identifier hs-var">th</span></a></span></span><span> </span><span id="local-6989586621679504260"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504260"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EventMask -&gt; X (Maybe WindowAttributes)
</span><a href="XMonad.Prelude.html#safeGetWindowAttributes"><span class="hs-identifier hs-var">safeGetWindowAttributes</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504260"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="annottext">Maybe WindowAttributes
</span><span class="hs-identifier hs-var">Nothing</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679504258"><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504258"><span class="hs-identifier hs-var">wAttrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679504257"><span class="annot"><span class="annottext">r :: Rectangle
</span><a href="#local-6989586621679504257"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; Position -&gt; Rectangle -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#overlayF"><span class="hs-identifier hs-var">overlayF</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679504261"><span class="hs-identifier hs-var">th</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowAttributes -&gt; Rectangle
</span><a href="#local-6989586621679504265"><span class="hs-identifier hs-var">makeRect</span></a></span><span> </span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504258"><span class="hs-identifier hs-var">wAttrs</span></a></span><span>
</span><span id="line-317"></span><span>      </span><span id="local-6989586621679504256"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504256"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Rectangle -&gt; Maybe EventMask -&gt; WorkspaceId -&gt; Bool -&gt; X EventMask
</span><a href="XMonad.Util.XUtils.html#createNewWindow"><span class="hs-identifier hs-var">createNewWindow</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504257"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rect :: Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#rect"><span class="hs-identifier hs-var">rect</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504257"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">overlay :: EventMask
</span><a href="XMonad.Actions.EasyMotion.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504256"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">win :: EventMask
</span><a href="XMonad.Actions.EasyMotion.html#win"><span class="hs-identifier hs-var">win</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504260"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attrs :: WindowAttributes
</span><a href="XMonad.Actions.EasyMotion.html#attrs"><span class="hs-identifier hs-var">attrs</span></a></span><span class="hs-glyph">=</span><span class="annot"><span class="annottext">WindowAttributes
</span><a href="#local-6989586621679504258"><span class="hs-identifier hs-var">wAttrs</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-comment">-- | Display an overlay with the provided formatting</span><span>
</span><span id="line-321"></span><span>  </span><span class="annot"><a href="#local-6989586621679504287"><span class="hs-identifier hs-type">displayOverlay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679504287"><span class="annot"><span class="annottext">displayOverlay :: XMonadFont -&gt; Overlay -&gt; X ()
</span><a href="#local-6989586621679504287"><span class="hs-identifier hs-var hs-var">displayOverlay</span></a></span></span><span> </span><span id="local-6989586621679504255"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504255"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">overlayWin :: Overlay -&gt; OverlayWindow
</span><a href="XMonad.Actions.EasyMotion.html#overlayWin"><span class="hs-identifier hs-var">overlayWin</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">rect :: OverlayWindow -&gt; Rectangle
</span><a href="XMonad.Actions.EasyMotion.html#rect"><span class="hs-identifier hs-var">rect</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504254"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504254"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">overlay :: OverlayWindow -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504253"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504253"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">chord :: Overlay -&gt; [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var">chord</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679504252"><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504252"><span class="hs-identifier hs-var">ch</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">EventMask -&gt; X ()
</span><a href="XMonad.Util.XUtils.html#showWindow"><span class="hs-identifier hs-var">showWindow</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504253"><span class="hs-identifier hs-var">o</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">EventMask
-&gt; XMonadFont
-&gt; EventType
-&gt; EventType
-&gt; EventType
-&gt; WorkspaceId
-&gt; WorkspaceId
-&gt; WorkspaceId
-&gt; WorkspaceId
-&gt; [Align]
-&gt; [WorkspaceId]
-&gt; X ()
</span><a href="XMonad.Util.XUtils.html#paintAndWrite"><span class="hs-identifier hs-var">paintAndWrite</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504253"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679504255"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_width</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504254"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rectangle -&gt; EventType
</span><span class="hs-identifier hs-var">rect_height</span></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679504254"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; Int
</span><a href="XMonad.Actions.EasyMotion.html#borderPx"><span class="hs-identifier hs-var">borderPx</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#bgCol"><span class="hs-identifier hs-var">bgCol</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#borderCol"><span class="hs-identifier hs-var">borderCol</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#txtCol"><span class="hs-identifier hs-var">txtCol</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; WorkspaceId
</span><a href="XMonad.Actions.EasyMotion.html#bgCol"><span class="hs-identifier hs-var">bgCol</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504342"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Align
</span><a href="XMonad.Util.Font.html#AlignCenter"><span class="hs-identifier hs-var">AlignCenter</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">EventMask -&gt; WorkspaceId
</span><span class="hs-identifier hs-var">keysymToString</span></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504252"><span class="hs-identifier hs-var">ch</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | Display overlay windows and chords for window selection</span><span>
</span><span id="line-327"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#selectWindow"><span class="hs-identifier hs-type">selectWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#EasyMotionConfig"><span class="hs-identifier hs-type">EasyMotionConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span id="selectWindow"><span class="annot"><span class="annottext">selectWindow :: EasyMotionConfig -&gt; X (Maybe EventMask)
</span><a href="XMonad.Actions.EasyMotion.html#selectWindow"><span class="hs-identifier hs-var hs-var">selectWindow</span></a></span></span><span> </span><span id="local-6989586621679504251"><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504251"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; X (Maybe EventMask)
</span><a href="XMonad.Actions.EasyMotion.html#handleSelectWindow"><span class="hs-identifier hs-var">handleSelectWindow</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504251"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">sKeys :: ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var">sKeys</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ChordKeys -&gt; ChordKeys
</span><a href="#local-6989586621679504250"><span class="hs-identifier hs-var">sanitiseKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#sKeys"><span class="hs-identifier hs-var">sKeys</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504251"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-330"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>  </span><span class="hs-comment">-- make sure the key lists don't contain: backspace, our cancel key, or duplicates</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><a href="#local-6989586621679504249"><span class="hs-identifier hs-type">sanitise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span>
</span><span id="line-333"></span><span>  </span><span id="local-6989586621679504249"><span class="annot"><span class="annottext">sanitise :: [EventMask] -&gt; [EventMask]
</span><a href="#local-6989586621679504249"><span class="hs-identifier hs-var hs-var">sanitise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig -&gt; EventMask
</span><a href="XMonad.Actions.EasyMotion.html#cancelKey"><span class="hs-identifier hs-var">cancelKey</span></a></span><span> </span><span class="annot"><span class="annottext">EasyMotionConfig
</span><a href="#local-6989586621679504251"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><a href="#local-6989586621679504250"><span class="hs-identifier hs-type">sanitiseKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#ChordKeys"><span class="hs-identifier hs-type">ChordKeys</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#ChordKeys"><span class="hs-identifier hs-type">ChordKeys</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span id="local-6989586621679504250"><span class="annot"><span class="annottext">sanitiseKeys :: ChordKeys -&gt; ChordKeys
</span><a href="#local-6989586621679504250"><span class="hs-identifier hs-var hs-var">sanitiseKeys</span></a></span></span><span> </span><span id="local-6989586621679504245"><span class="annot"><span class="annottext">ChordKeys
</span><a href="#local-6989586621679504245"><span class="hs-identifier hs-var">cKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ChordKeys
</span><a href="#local-6989586621679504245"><span class="hs-identifier hs-var">cKeys</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>      </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-type">AnyKeys</span></a></span><span> </span><span id="local-6989586621679504244"><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504244"><span class="hs-identifier hs-var">ks</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[EventMask] -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#AnyKeys"><span class="hs-identifier hs-var">AnyKeys</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[EventMask] -&gt; [EventMask]
</span><a href="#local-6989586621679504249"><span class="hs-identifier hs-var">sanitise</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504244"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#PerScreenKeys"><span class="hs-identifier hs-type">PerScreenKeys</span></a></span><span> </span><span id="local-6989586621679504243"><span class="annot"><span class="annottext">Map ScreenId [EventMask]
</span><a href="#local-6989586621679504243"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map ScreenId [EventMask] -&gt; ChordKeys
</span><a href="XMonad.Actions.EasyMotion.html#PerScreenKeys"><span class="hs-identifier hs-var">PerScreenKeys</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.map</span></span><span> </span><span class="annot"><span class="annottext">[EventMask] -&gt; [EventMask]
</span><a href="#local-6989586621679504249"><span class="hs-identifier hs-var">sanitise</span></a></span><span> </span><span class="annot"><span class="annottext">Map ScreenId [EventMask]
</span><a href="#local-6989586621679504243"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Take a list of overlays lacking chords, return a list of overlays with key chords</span><span>
</span><span id="line-341"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#appendChords"><span class="hs-identifier hs-type">appendChords</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#OverlayWindow"><span class="hs-identifier hs-type">OverlayWindow</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span id="appendChords"><span class="annot"><span class="annottext">appendChords :: Int -&gt; [EventMask] -&gt; [OverlayWindow] -&gt; [Overlay]
</span><a href="XMonad.Actions.EasyMotion.html#appendChords"><span class="hs-identifier hs-var hs-var">appendChords</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[OverlayWindow]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-343"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#appendChords"><span class="hs-identifier hs-var">appendChords</span></a></span><span> </span><span id="local-6989586621679504242"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679504242"><span class="hs-identifier hs-var">maxUserSelectedLen</span></a></span></span><span> </span><span id="local-6989586621679504241"><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504241"><span class="hs-identifier hs-var">ks</span></a></span></span><span> </span><span id="local-6989586621679504240"><span class="annot"><span class="annottext">[OverlayWindow]
</span><a href="#local-6989586621679504240"><span class="hs-identifier hs-var">overlayWins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">OverlayWindow -&gt; [EventMask] -&gt; Overlay
</span><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-var">Overlay</span></a></span><span> </span><span class="annot"><span class="annottext">[OverlayWindow]
</span><a href="#local-6989586621679504240"><span class="hs-identifier hs-var">overlayWins</span></a></span><span> </span><span class="annot"><span class="annottext">[[EventMask]]
</span><a href="#local-6989586621679504238"><span class="hs-identifier hs-var">chords</span></a></span><span>
</span><span id="line-345"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>  </span><span id="local-6989586621679504238"><span class="annot"><span class="annottext">chords :: [[EventMask]]
</span><a href="#local-6989586621679504238"><span class="hs-identifier hs-var hs-var">chords</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Applicative m =&gt; Int -&gt; m a -&gt; m [a]
</span><span class="hs-identifier hs-var">replicateM</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679504234"><span class="hs-identifier hs-var">chordLen</span></a></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504241"><span class="hs-identifier hs-var">ks</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-comment">-- the minimum necessary chord length to assign a unique chord to each visible window</span><span>
</span><span id="line-348"></span><span>  </span><span id="local-6989586621679504227"><span class="annot"><span class="annottext">minCoverLen :: Int
</span><a href="#local-6989586621679504227"><span class="hs-identifier hs-var hs-var">minCoverLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[OverlayWindow]
</span><a href="#local-6989586621679504240"><span class="hs-identifier hs-var">overlayWins</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`div`</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[EventMask]
</span><a href="#local-6989586621679504241"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-comment">-- if the user has specified a max chord length we use this even if it will not cover all</span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-comment">-- windows, as they may prefer to focus windows with fewer keys over the ability to focus any</span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-comment">-- window</span><span>
</span><span id="line-352"></span><span>  </span><span id="local-6989586621679504234"><span class="annot"><span class="annottext">chordLen :: Int
</span><a href="#local-6989586621679504234"><span class="hs-identifier hs-var hs-var">chordLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679504242"><span class="hs-identifier hs-var">maxUserSelectedLen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679504227"><span class="hs-identifier hs-var">minCoverLen</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679504227"><span class="hs-identifier hs-var">minCoverLen</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679504242"><span class="hs-identifier hs-var">maxUserSelectedLen</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | A three-state result for handling user-initiated selection cancellation, successful selection,</span><span>
</span><span id="line-355"></span><span class="hs-comment">--   or backspace.</span><span>
</span><span id="line-356"></span><span class="hs-keyword">data</span><span> </span><span id="HandleResult"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#HandleResult"><span class="hs-identifier hs-var">HandleResult</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Exit"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Selected"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Selected"><span class="hs-identifier hs-var">Selected</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Backspace"><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Backspace"><span class="hs-identifier hs-var">Backspace</span></a></span></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | Handle key press events for window selection.</span><span>
</span><span id="line-359"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-type">handleKeyboard</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#Overlay"><span class="hs-identifier hs-type">Overlay</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#HandleResult"><span class="hs-identifier hs-type">HandleResult</span></a></span><span>
</span><span id="line-360"></span><span id="handleKeyboard"><span class="annot"><span class="annottext">handleKeyboard :: Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var hs-var">handleKeyboard</span></a></span></span><span> </span><span class="annot"><span class="annottext">Display
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span><span>
</span><span id="line-361"></span><span class="annot"><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span id="local-6989586621679504218"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span id="local-6989586621679504217"><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span></span><span> </span><span id="local-6989586621679504216"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span></span><span> </span><span id="local-6989586621679504215"><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span></span><span> </span><span id="local-6989586621679504214"><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504214"><span class="hs-identifier hs-var">deselected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="annottext">X [()]
</span><a href="#local-6989586621679504213"><span class="hs-identifier hs-var">redraw</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679504212"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679504212"><span class="hs-identifier hs-var">ev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (XEventPtr -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">allocaXEvent</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679504210"><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679504210"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><span class="annottext">Display -&gt; EventMask -&gt; XEventPtr -&gt; IO ()
</span><span class="hs-identifier hs-var">maskEvent</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">keyPressMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">keyReleaseMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">buttonPressMask</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679504210"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="annottext">XEventPtr -&gt; IO Event
</span><span class="hs-identifier hs-var">getEvent</span></span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679504210"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Event -&gt; EventType
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679504212"><span class="hs-identifier hs-var">ev</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">keyPress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-367"></span><span>         </span><span id="local-6989586621679504201"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504201"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; KeyCode -&gt; CInt -&gt; IO EventMask
</span><span class="hs-identifier hs-var">keycodeToKeysym</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; KeyCode
</span><span class="hs-identifier hs-var">ev_keycode</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679504212"><span class="hs-identifier hs-var">ev</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-368"></span><span>         </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504201"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span><span>
</span><span id="line-369"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504201"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">xK_BackSpace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#Backspace"><span class="hs-identifier hs-var">Backspace</span></a></span><span>
</span><span id="line-370"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventMask -&gt; Bool
</span><a href="#local-6989586621679504198"><span class="hs-identifier hs-var">isNextOverlayKey</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504201"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EventMask -&gt; X HandleResult
</span><a href="#local-6989586621679504197"><span class="hs-identifier hs-var">handleNextOverlayKey</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504201"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-371"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504214"><span class="hs-identifier hs-var">deselected</span></a></span><span>
</span><span id="line-372"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Event -&gt; EventType
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679504212"><span class="hs-identifier hs-var">ev</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">buttonPress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-373"></span><span>         </span><span class="hs-comment">-- See XMonad.Prompt Note [Allow ButtonEvents]</span><span>
</span><span id="line-374"></span><span>         </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; CInt -&gt; EventMask -&gt; IO ()
</span><span class="hs-identifier hs-var">allowEvents</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">replayPointer</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-375"></span><span>         </span><span class="annot"><span class="annottext">Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504214"><span class="hs-identifier hs-var">deselected</span></a></span><span>
</span><span id="line-376"></span><span>     </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504214"><span class="hs-identifier hs-var">deselected</span></a></span><span>
</span><span id="line-377"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-378"></span><span>  </span><span id="local-6989586621679504213"><span class="annot"><span class="annottext">redraw :: X [()]
</span><a href="#local-6989586621679504213"><span class="hs-identifier hs-var hs-var">redraw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504214"><span class="hs-identifier hs-var">deselected</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-379"></span><span>  </span><span id="local-6989586621679504186"><span class="annot"><span class="annottext">retryBackspace :: HandleResult -&gt; X HandleResult
</span><a href="#local-6989586621679504186"><span class="hs-identifier hs-var hs-var">retryBackspace</span></a></span></span><span> </span><span id="local-6989586621679504185"><span class="annot"><span class="annottext">HandleResult
</span><a href="#local-6989586621679504185"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-380"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">HandleResult
</span><a href="#local-6989586621679504185"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><span class="annottext">HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#Backspace"><span class="hs-identifier hs-var">Backspace</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X [()]
</span><a href="#local-6989586621679504213"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504214"><span class="hs-identifier hs-var">deselected</span></a></span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><span class="annottext">HandleResult
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">HandleResult
</span><a href="#local-6989586621679504185"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span id="local-6989586621679504198"><span class="annot"><span class="annottext">isNextOverlayKey :: EventMask -&gt; Bool
</span><a href="#local-6989586621679504198"><span class="hs-identifier hs-var hs-var">isNextOverlayKey</span></a></span></span><span> </span><span id="local-6989586621679504180"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504180"><span class="hs-identifier hs-var">keySym</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504180"><span class="hs-identifier hs-var">keySym</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="annot"><span class="annottext">Overlay -&gt; [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var">chord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>  </span><span id="local-6989586621679504197"><span class="annot"><span class="annottext">handleNextOverlayKey :: EventMask -&gt; X HandleResult
</span><a href="#local-6989586621679504197"><span class="hs-identifier hs-var hs-var">handleNextOverlayKey</span></a></span></span><span> </span><span id="local-6989586621679504175"><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504175"><span class="hs-identifier hs-var">keySym</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504174"><span class="hs-identifier hs-var">fg</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-386"></span><span>      </span><span class="hs-special">[</span><span id="local-6989586621679504173"><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504173"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#Selected"><span class="hs-identifier hs-var">Selected</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504173"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><span class="annottext">[Overlay]
</span><span class="hs-identifier">_</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; (Overlay -&gt; X ())
-&gt; EventMask
-&gt; [Overlay]
-&gt; [Overlay]
-&gt; X HandleResult
</span><a href="XMonad.Actions.EasyMotion.html#handleKeyboard"><span class="hs-identifier hs-var">handleKeyboard</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679504218"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; X ()
</span><a href="#local-6989586621679504217"><span class="hs-identifier hs-var">drawFn</span></a></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504216"><span class="hs-identifier hs-var">cancel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Overlay] -&gt; [Overlay]
</span><a href="#local-6989586621679504172"><span class="hs-identifier hs-var">trim</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504174"><span class="hs-identifier hs-var">fg</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Overlay] -&gt; [Overlay]
</span><a href="#local-6989586621679504171"><span class="hs-identifier hs-var">clear</span></a></span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504170"><span class="hs-identifier hs-var">bg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">HandleResult -&gt; X HandleResult
</span><a href="#local-6989586621679504186"><span class="hs-identifier hs-var">retryBackspace</span></a></span><span>
</span><span id="line-388"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679504174"><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504174"><span class="hs-identifier hs-var">fg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679504170"><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504170"><span class="hs-identifier hs-var">bg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">partition</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">EventMask
</span><a href="#local-6989586621679504175"><span class="hs-identifier hs-var">keySym</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var">chord</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Overlay]
</span><a href="#local-6989586621679504215"><span class="hs-identifier hs-var">selected</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679504172"><span class="annot"><span class="annottext">trim :: [Overlay] -&gt; [Overlay]
</span><a href="#local-6989586621679504172"><span class="hs-identifier hs-var hs-var">trim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679504166"><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504166"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504166"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">chord :: [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var">chord</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Overlay -&gt; [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var">chord</span></a></span><span> </span><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504166"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679504171"><span class="annot"><span class="annottext">clear :: [Overlay] -&gt; [Overlay]
</span><a href="#local-6989586621679504171"><span class="hs-identifier hs-var hs-var">clear</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679504164"><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504164"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Overlay
</span><a href="#local-6989586621679504164"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">chord :: [EventMask]
</span><a href="XMonad.Actions.EasyMotion.html#chord"><span class="hs-identifier hs-var">chord</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span></pre></body></html>