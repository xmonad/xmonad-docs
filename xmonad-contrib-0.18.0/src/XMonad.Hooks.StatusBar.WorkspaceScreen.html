<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-comment">{- |
 Module      :  XMonad.Hooks.StatusBar.WorkspaceScreen
 Description :  Combine workspace names with screen information
 Copyright   :  (c) Yecine Megdiche &lt;yecine.megdiche@gmail.com&gt;
 License     :  BSD3-style (see LICENSE)

 Maintainer  :  Yecine Megdiche &lt;yecine.megdiche@gmail.com&gt;
 Stability   :  unstable
 Portability :  unportable

 In multi-head setup, it might be useful to have screen information of the
 visible workspaces combined with the workspace name, for example in a status
 bar. This module provides utility functions to do just that.
-}</span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Hooks.StatusBar.WorkspaceScreen</span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-21"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-22"></span><span>      </span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreen"><span class="hs-identifier">combineWithScreen</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreenName"><span class="hs-identifier">combineWithScreenName</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreenNumber"><span class="hs-identifier">combineWithScreenNumber</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#WorkspaceScreenCombiner"><span class="hs-identifier">WorkspaceScreenCombiner</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Limitations</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- $limitations</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Graphics.X11.Xrandr</span></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html"><span class="hs-identifier">XMonad.Hooks.StatusBar.PP</span></a></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">{- $usage
 You can use this module with the following in your @xmonad.hs@:

 &gt; import XMonad
 &gt; import XMonad.Hooks.StatusBar
 &gt; import XMonad.Hooks.StatusBar.PP
 &gt; import XMonad.Hooks.StatusBar.WorkspaceScreen

 For example, to add the screen number in parentheses to each visible
 workspace number, you can use 'combineWithScreenNumber':

 &gt; myWorkspaceScreenCombiner :: WorkspaceId -&gt; String -&gt; String
 &gt; myWorkspaceScreenCombiner w sc = w &lt;&gt; wrap &quot;(&quot; &quot;)&quot; sc
 &gt;
 &gt; mySB = statusBarProp &quot;xmobar&quot; (combineWithScreenNumber myWorkspaceScreenCombiner xmobarPP)
 &gt; main = xmonad $ withEasySB mySB defToggleStrutsKey def

 This will annotate the workspace names as following:

 &gt; [1(0)] 2 3 4 &lt;5(1)&gt; 6 7 8 9

 To use the screen's name instead, checkout 'combineWithScreenName':

 &gt; [1(eDP-1)] 2 3 4 &lt;5(HDMI-1)&gt; 6 7 8 9

 For advanced cases, use 'combineWithScreen'.
-}</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">{- $limitations
 For simplicity, this module assumes xmonad screen ids match screen/monitor
 numbers as managed by the X server (for example, as given by @xrandr
 --listactivemonitors@). Thus, it may not work well when screens show an
 overlapping range of the framebuffer, e.g. when using a projector. This also
 means that it doesn't work with &quot;XMonad.Layout.LayoutScreens&quot;.
 (This isn't difficult to fix, PRs welcome.)
-}</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | Type synonym for a function that combines a workspace name with a screen.</span><span>
</span><span id="line-74"></span><span class="hs-keyword">type</span><span> </span><span id="WorkspaceScreenCombiner"><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#WorkspaceScreenCombiner"><span class="hs-identifier hs-var">WorkspaceScreenCombiner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prelude.html#WindowScreen"><span class="hs-identifier hs-type">WindowScreen</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | A helper function that returns a list of screen names.</span><span>
</span><span id="line-77"></span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#screenNames"><span class="hs-identifier hs-type">screenNames</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-78"></span><span id="screenNames"><span class="annot"><span class="annottext">screenNames :: X [Maybe WorkspaceId]
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#screenNames"><span class="hs-identifier hs-var hs-var">screenNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">XConf</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679458906"><span class="annot"><span class="annottext">Display
display :: XConf -&gt; Display
display :: Display
</span><span class="hs-identifier hs-var hs-var">display</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679458904"><span class="annot"><span class="annottext">Window
theRoot :: XConf -&gt; Window
theRoot :: Window
</span><span class="hs-identifier hs-var hs-var">theRoot</span></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679458901"><span class="annot"><span class="annottext">getName :: XRRMonitorInfo -&gt; IO (Maybe WorkspaceId)
</span><a href="#local-6989586621679458901"><span class="hs-identifier hs-var hs-var">getName</span></a></span></span><span> </span><span id="local-6989586621679458900"><span class="annot"><span class="annottext">XRRMonitorInfo
</span><a href="#local-6989586621679458900"><span class="hs-identifier hs-var">mi</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO (Maybe WorkspaceId)
</span><span class="hs-identifier hs-var">getAtomName</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679458906"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XRRMonitorInfo -&gt; Window
</span><span class="hs-identifier hs-var">xrr_moninf_name</span></span><span> </span><span class="annot"><span class="annottext">XRRMonitorInfo
</span><a href="#local-6989586621679458900"><span class="hs-identifier hs-var">mi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>   </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">XRRMonitorInfo -&gt; IO (Maybe WorkspaceId)
</span><a href="#local-6989586621679458901"><span class="hs-identifier hs-var">getName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; Bool -&gt; IO (Maybe [XRRMonitorInfo])
</span><span class="hs-identifier hs-var">xrrGetMonitors</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679458906"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679458904"><span class="hs-identifier hs-var">theRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | Combine a workspace name with the screen name it's visible on.</span><span>
</span><span id="line-86"></span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreenName"><span class="hs-identifier hs-type">combineWithScreenName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span>
</span><span id="line-87"></span><span id="combineWithScreenName"><span class="annot"><span class="annottext">combineWithScreenName :: (WorkspaceId -&gt; WorkspaceId -&gt; WorkspaceId) -&gt; PP -&gt; X PP
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreenName"><span class="hs-identifier hs-var hs-var">combineWithScreenName</span></a></span></span><span> </span><span id="local-6989586621679458892"><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; WorkspaceId
</span><a href="#local-6989586621679458892"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X WorkspaceScreenCombiner -&gt; PP -&gt; X PP
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreen"><span class="hs-identifier hs-var">combineWithScreen</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679458891"><span class="annot"><span class="annottext">[Maybe WorkspaceId]
</span><a href="#local-6989586621679458891"><span class="hs-identifier hs-var">screens</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [Maybe WorkspaceId]
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#screenNames"><span class="hs-identifier hs-var">screenNames</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679458890"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458890"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679458889"><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679458889"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458890"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; WorkspaceId
</span><a href="#local-6989586621679458892"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458890"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Maybe WorkspaceId]
</span><a href="#local-6989586621679458891"><span class="hs-identifier hs-var">screens</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; Maybe a
</span><a href="XMonad.Prelude.html#%21%3F"><span class="hs-operator hs-var">!?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679458889"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Combine a workspace name with the screen number it's visible on.</span><span>
</span><span id="line-92"></span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreenNumber"><span class="hs-identifier hs-type">combineWithScreenNumber</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span>
</span><span id="line-93"></span><span id="combineWithScreenNumber"><span class="annot"><span class="annottext">combineWithScreenNumber :: (WorkspaceId -&gt; WorkspaceId -&gt; WorkspaceId) -&gt; PP -&gt; X PP
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreenNumber"><span class="hs-identifier hs-var hs-var">combineWithScreenNumber</span></a></span></span><span> </span><span id="local-6989586621679458885"><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; WorkspaceId
</span><a href="#local-6989586621679458885"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="annottext">X WorkspaceScreenCombiner -&gt; PP -&gt; X PP
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreen"><span class="hs-identifier hs-var">combineWithScreen</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679458883"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458883"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679458882"><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679458882"><span class="hs-identifier hs-var">sc</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; WorkspaceId
</span><a href="#local-6989586621679458885"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458883"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; WorkspaceId
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sid
</span><span class="hs-identifier hs-var">W.screen</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowScreen
</span><a href="#local-6989586621679458882"><span class="hs-identifier hs-var">sc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Combine a workspace name with a screen according to the given</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- 'WorkspaceScreenCombiner'.</span><span>
</span><span id="line-98"></span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreen"><span class="hs-identifier hs-type">combineWithScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#WorkspaceScreenCombiner"><span class="hs-identifier hs-type">WorkspaceScreenCombiner</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span>
</span><span id="line-99"></span><span id="combineWithScreen"><span class="annot"><span class="annottext">combineWithScreen :: X WorkspaceScreenCombiner -&gt; PP -&gt; X PP
</span><a href="XMonad.Hooks.StatusBar.WorkspaceScreen.html#combineWithScreen"><span class="hs-identifier hs-var hs-var">combineWithScreen</span></a></span></span><span> </span><span id="local-6989586621679458880"><span class="annot"><span class="annottext">X WorkspaceScreenCombiner
</span><a href="#local-6989586621679458880"><span class="hs-identifier hs-var">xCombiner</span></a></span></span><span> </span><span id="local-6989586621679458879"><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679458879"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679458878"><span class="annot"><span class="annottext">WorkspaceScreenCombiner
</span><a href="#local-6989586621679458878"><span class="hs-identifier hs-var">combiner</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceScreenCombiner
</span><a href="#local-6989586621679458880"><span class="hs-identifier hs-var">xCombiner</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621679458877"><span class="annot"><span class="annottext">[WindowScreen]
</span><a href="#local-6989586621679458877"><span class="hs-identifier hs-var">ss</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Screen i l a s sd]
</span><span class="hs-identifier hs-var">W.screens</span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679458879"><span class="hs-identifier hs-var">pp</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ppRename :: WorkspaceId -&gt; WindowSpace -&gt; WorkspaceId
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppRename"><span class="hs-identifier hs-var">ppRename</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PP -&gt; WorkspaceId -&gt; WindowSpace -&gt; WorkspaceId
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppRename"><span class="hs-identifier hs-var">ppRename</span></a></span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679458879"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679458872"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458872"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679458871"><span class="annot"><span class="annottext">WindowSpace
</span><a href="#local-6989586621679458871"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>            </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458872"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceScreenCombiner
</span><a href="#local-6989586621679458878"><span class="hs-identifier hs-var">combiner</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679458872"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">WindowSpace
</span><a href="#local-6989586621679458871"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WindowScreen]
</span><a href="#local-6989586621679458877"><span class="hs-identifier hs-var">ss</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-106"></span></pre></body></html>