<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Module      :  XMonad.Hooks.Modal</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Description :  Implements true modality in xmonad key-bindings.</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Copyright   :  (c) 2018  L. S. Leary</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Author      :  L. S. Leary</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Maintainer  :  Yecine Megdiche &lt;yecine.megdiche@gmail.com&gt;</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- This module implements modal keybindings for xmonad.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-comment">-- --&lt; Imports &amp; Exports &gt;-- {{{</span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Hooks.Modal</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-24"></span><span> </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-25"></span><span> </span><span class="annot"><span class="hs-comment">-- $Usage</span></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.Modal.html#modal"><span class="hs-identifier">modal</span></a></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#modeWithExit"><span class="hs-identifier">modeWithExit</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#mode"><span class="hs-identifier">mode</span></a></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier">Mode</span></a></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#mkKeysEz"><span class="hs-identifier">mkKeysEz</span></a></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#setMode"><span class="hs-identifier">setMode</span></a></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#exitMode"><span class="hs-identifier">exitMode</span></a></span><span>
</span><span id="line-33"></span><span> </span><span class="annot"><span class="hs-comment">-- * Provided Modes #ProvidedModes#</span></span><span>
</span><span id="line-34"></span><span> </span><span class="annot"><span class="hs-comment">-- $ProvidedModes</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#noModModeLabel"><span class="hs-identifier">noModModeLabel</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#noModMode"><span class="hs-identifier">noModMode</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#floatModeLabel"><span class="hs-identifier">floatModeLabel</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#floatMode"><span class="hs-identifier">floatMode</span></a></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#overlayedFloatModeLabel"><span class="hs-identifier">overlayedFloatModeLabel</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#overlayedFloatMode"><span class="hs-identifier">overlayedFloatMode</span></a></span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#floatMap"><span class="hs-identifier">floatMap</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#overlay"><span class="hs-identifier">overlay</span></a></span><span>
</span><span id="line-43"></span><span> </span><span class="annot"><span class="hs-comment">-- * Logger</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#logMode"><span class="hs-identifier">logMode</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- core</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- base</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bits</span></span><span>                     </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span>
</span><span id="line-51"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">complement</span></span><span>
</span><span id="line-52"></span><span>                                               </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- contrib</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Actions.FloatKeys.html"><span class="hs-identifier">XMonad.Actions.FloatKeys</span></a></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="XMonad.Actions.FloatKeys.html#keysMoveWindow"><span class="hs-identifier">keysMoveWindow</span></a></span><span>
</span><span id="line-57"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier">keysResizeWindow</span></a></span><span>
</span><span id="line-58"></span><span>                                               </span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.EZConfig.html"><span class="hs-identifier">XMonad.Util.EZConfig</span></a></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="XMonad.Util.EZConfig.html#parseKeyCombo"><span class="hs-identifier">parseKeyCombo</span></a></span><span>
</span><span id="line-61"></span><span>                                               </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.EZConfig.html#mkKeymap"><span class="hs-identifier">mkKeymap</span></a></span><span>
</span><span id="line-62"></span><span>                                               </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleConf.html"><span class="hs-identifier">XMonad.Util.ExtensibleConf</span></a></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XC</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.Grab.html"><span class="hs-identifier">XMonad.Util.Grab</span></a></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.Loggers.html"><span class="hs-identifier">XMonad.Util.Loggers</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="XMonad.Util.Parser.html"><span class="hs-identifier">XMonad.Util.Parser</span></a></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="XMonad.Util.Parser.html#runParser"><span class="hs-identifier">runParser</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- Original Draft By L.S.Leary : https://gist.github.com/LSLeary/6741b0572d62db3f0cea8e6618141b2f</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- --&lt; Usage &gt;-- {{{</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- $Usage</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- This module provides modal keybindings in xmonad. If you're not familiar with</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- modal keybindings from Vim, you can think of modes as submaps from</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &quot;XMonad.Actions.Submap&quot;, but after each action you execute, you land back in</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- the submap until you explicitly exit the submap. To use this module you</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- should apply the 'modal' function to the config, which will setup the list of</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- modes (or rather, @XConfig Layout -&gt; Mode@) you provide:</span><span>
</span><span id="line-83"></span><span class="hs-comment">--</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- &gt; import XMonad</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.Modal</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt; import XMonad.Util.EZConfig</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt; import qualified Data.Map as M</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt; main :: IO ()</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt; main =</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt;   xmonad</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;     . modal [noModMode, floatMode 10, overlayedFloatMode 10, sayHelloMode]</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;     $ def</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt;     `additionalKeysP` [ (&quot;M-S-n&quot;, setMode noModModeLabel)</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &gt;                       , (&quot;M-S-r&quot;, setMode floatModeLabel)</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt;                       , (&quot;M-S-z&quot;, setMode overlayedFloatModeLabel)</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- &gt;                       , (&quot;M-S-h&quot;, setMode &quot;Hello&quot;)</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt;                       ]</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt; sayHelloMode :: Mode</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt; sayHelloMode = mode &quot;Hello&quot; $ mkKeysEz</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt;   [ (&quot;h&quot;, xmessage &quot;Hello, World!&quot;)</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;   , (&quot;M-g&quot;, xmessage &quot;Goodbye, World!&quot;)</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- &gt;   ]</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- Alternatively, one could have defined @sayHelloMode@ as</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt; sayHelloMode :: Mode</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt; sayHelloMode = mode &quot;Hello&quot; $ \cfg -&gt;</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt;   M.fromList [ ((noModMask, xK_h), xmessage &quot;Hello, World!&quot;)</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt;              , ((modMask cfg, xK_g), xmessage &quot;Goodbye, World!&quot;)</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;              ]</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- In short, a 'Mode' has a label describing its purpose, as well as</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- attached keybindings. These are of the form</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">--   - @[(String, X ())]@, or</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">--   - @XConfig Layout -&gt; M.Map (ButtonMask, KeySym) (X ())@.</span><span>
</span><span id="line-121"></span><span class="hs-comment">--</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- The former&#8212;accessible via 'mkKeysEz'&#8212;is how specifying keys work with</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- &quot;XMonad.Util.EZConfig&quot;, while the latter is more geared towards how</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- defining keys works by default in xmonad. Note that, by default,</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- modes are exited with the Escape key. If one wishes to customise</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- this, the 'modeWithExit' function should be used instead of 'mode'</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- when defining a new mode.</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- The label of the active mode can be logged with 'logMode' to be</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- displayed in a status bar, for example (For more information check</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &quot;XMonad.Util.Loggers&quot;). Some examples are included in [the provided</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- modes](#g:ProvidedModes).</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- --&lt; Types &gt;-- {{{</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | From a list of &quot;XMonad.Util.EZConfig&quot;-style bindings, generate a</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- key representation.</span><span>
</span><span id="line-140"></span><span class="hs-comment">--</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- &gt;&gt;&gt; mkKeysEz [(&quot;h&quot;, xmessage &quot;Hello, world!&quot;)]</span><span>
</span><span id="line-142"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#mkKeysEz"><span class="hs-identifier hs-type">mkKeysEz</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Layout</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span id="mkKeysEz"><span class="annot"><span class="annottext">mkKeysEz :: [(String, X ())]
-&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#mkKeysEz"><span class="hs-identifier hs-var hs-var">mkKeysEz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *).
XConfig l -&gt; [(String, X ())] -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Util.EZConfig.html#mkKeymap"><span class="hs-identifier hs-var">mkKeymap</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="hs-comment">-- | The mode type. Use 'mode' or 'modeWithExit' to create modes.</span><span>
</span><span id="line-146"></span><span class="hs-keyword">data</span><span> </span><span id="Mode"><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Mode"><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="label"><span class="annot"><span class="annottext">Mode -&gt; String
</span><a href="XMonad.Hooks.Modal.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="boundKeys"><span class="annot"><span class="annottext">Mode -&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#boundKeys"><span class="hs-identifier hs-var hs-var">boundKeys</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Layout</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Newtype for the extensible config.</span><span>
</span><span id="line-152"></span><span class="hs-keyword">newtype</span><span> </span><span id="ModeConfig"><span class="annot"><a href="XMonad.Hooks.Modal.html#ModeConfig"><span class="hs-identifier hs-var">ModeConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="MC"><span class="annot"><a href="XMonad.Hooks.Modal.html#MC"><span class="hs-identifier hs-var">MC</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679510290"><span id="local-6989586621679510296"><span id="local-6989586621679510301"><span class="annot"><span class="annottext">NonEmpty ModeConfig -&gt; ModeConfig
ModeConfig -&gt; ModeConfig -&gt; ModeConfig
forall b. Integral b =&gt; b -&gt; ModeConfig -&gt; ModeConfig
forall a.
(a -&gt; a -&gt; a)
-&gt; (NonEmpty a -&gt; a)
-&gt; (forall b. Integral b =&gt; b -&gt; a -&gt; a)
-&gt; Semigroup a
stimes :: forall b. Integral b =&gt; b -&gt; ModeConfig -&gt; ModeConfig
$cstimes :: forall b. Integral b =&gt; b -&gt; ModeConfig -&gt; ModeConfig
sconcat :: NonEmpty ModeConfig -&gt; ModeConfig
$csconcat :: NonEmpty ModeConfig -&gt; ModeConfig
&lt;&gt; :: ModeConfig -&gt; ModeConfig -&gt; ModeConfig
$c&lt;&gt; :: ModeConfig -&gt; ModeConfig -&gt; ModeConfig
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Semigroup</span></span></span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Newtype for the extensible state.</span><span>
</span><span id="line-155"></span><span class="hs-keyword">newtype</span><span> </span><span id="CurrentMode"><span class="annot"><a href="XMonad.Hooks.Modal.html#CurrentMode"><span class="hs-identifier hs-var">CurrentMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CurrentMode"><span class="annot"><a href="XMonad.Hooks.Modal.html#CurrentMode"><span class="hs-identifier hs-var">CurrentMode</span></a></span></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="currentMode"><span class="annot"><span class="annottext">CurrentMode -&gt; Maybe Mode
</span><a href="XMonad.Hooks.Modal.html#currentMode"><span class="hs-identifier hs-var hs-var">currentMode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679510277"><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#CurrentMode"><span class="hs-identifier hs-type">CurrentMode</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679510275"><span class="annot"><span class="annottext">initialValue :: CurrentMode
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Mode -&gt; CurrentMode
</span><a href="XMonad.Hooks.Modal.html#CurrentMode"><span class="hs-identifier hs-var">CurrentMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- --&lt; Private &gt;-- {{{</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | The active keybindings corresponding to the active 'Mode' (or lack</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- thereof).</span><span>
</span><span id="line-168"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#currentKeys"><span class="hs-identifier hs-type">currentKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span id="currentKeys"><span class="annot"><span class="annottext">currentKeys :: X (Map (ButtonMask, KeySym) (X ()))
</span><a href="XMonad.Hooks.Modal.html#currentKeys"><span class="hs-identifier hs-var hs-var">currentKeys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679510272"><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510272"><span class="hs-identifier hs-var">cnf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var">config</span></span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentMode -&gt; Maybe Mode
</span><a href="XMonad.Hooks.Modal.html#currentMode"><span class="hs-identifier hs-var">currentMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-172"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679510268"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679510268"><span class="hs-identifier hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Mode -&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#boundKeys"><span class="hs-identifier hs-var">boundKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679510268"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510272"><span class="hs-identifier hs-var">cnf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">Maybe Mode
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *).
XConfig l -&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><span class="hs-identifier hs-var">keys</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var">config</span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Grab the keys corresponding to the active 'Mode' (or lack thereof).</span><span>
</span><span id="line-176"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#regrab"><span class="hs-identifier hs-type">regrab</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="regrab"><span class="annot"><span class="annottext">regrab :: X ()
</span><a href="XMonad.Hooks.Modal.html#regrab"><span class="hs-identifier hs-var hs-var">regrab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ButtonMask, KeySym)] -&gt; X ()
</span><a href="XMonad.Util.Grab.html#grab"><span class="hs-identifier hs-var">grab</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X (Map (ButtonMask, KeySym) (X ()))
</span><a href="XMonad.Hooks.Modal.html#currentKeys"><span class="hs-identifier hs-var">currentKeys</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Called after changing the mode. Grabs the correct keys and runs the</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- 'logHook'.</span><span>
</span><span id="line-181"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#refreshMode"><span class="hs-identifier hs-type">refreshMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span id="refreshMode"><span class="annot"><span class="annottext">refreshMode :: X ()
</span><a href="XMonad.Hooks.Modal.html#refreshMode"><span class="hs-identifier hs-var hs-var">refreshMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#regrab"><span class="hs-identifier hs-var">regrab</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var">config</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; X ()
</span><span class="hs-identifier hs-var">logHook</span></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Event hook to control the keybindings.</span><span>
</span><span id="line-185"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#modalEventHook"><span class="hs-identifier hs-type">modalEventHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Event</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">All</span></span><span>
</span><span id="line-186"></span><span id="modalEventHook"><span class="annot"><span class="annottext">modalEventHook :: Event -&gt; X All
</span><a href="XMonad.Hooks.Modal.html#modalEventHook"><span class="hs-identifier hs-var hs-var">modalEventHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X () -&gt; Event -&gt; X All
</span><a href="XMonad.Util.Grab.html#customRegrabEvHook"><span class="hs-identifier hs-var">customRegrabEvHook</span></a></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#regrab"><span class="hs-identifier hs-var">regrab</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">KeyEvent</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ev_event_type :: Event -&gt; EventType
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679510254"><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679510254"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_state :: Event -&gt; ButtonMask
</span><span class="hs-identifier hs-var">ev_state</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679510252"><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510252"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ev_keycode :: Event -&gt; KeyCode
</span><span class="hs-identifier hs-var">ev_keycode</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679510250"><span class="annot"><span class="annottext">KeyCode
</span><a href="#local-6989586621679510250"><span class="hs-identifier hs-var">code</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">EventType
</span><a href="#local-6989586621679510254"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">EventType
</span><span class="hs-identifier hs-var">keyPress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679510247"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679510247"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>      </span><span id="local-6989586621679510246"><span class="annot"><span class="annottext">(ButtonMask, KeySym)
</span><a href="#local-6989586621679510246"><span class="hs-identifier hs-var">kp</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ButtonMask -&gt; X ButtonMask
</span><span class="hs-identifier hs-var">cleanMask</span></span><span> </span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510252"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; KeyCode -&gt; CInt -&gt; IO KeySym
</span><span class="hs-identifier hs-var">keycodeToKeysym</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679510247"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">KeyCode
</span><a href="#local-6989586621679510250"><span class="hs-identifier hs-var">code</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>      </span><span id="local-6989586621679510242"><span class="annot"><span class="annottext">Map (ButtonMask, KeySym) (X ())
</span><a href="#local-6989586621679510242"><span class="hs-identifier hs-var">kbs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (Map (ButtonMask, KeySym) (X ()))
</span><a href="XMonad.Hooks.Modal.html#currentKeys"><span class="hs-identifier hs-var">currentKeys</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="annot"><span class="annottext">forall a. a -&gt; X a -&gt; X a
</span><span class="hs-identifier hs-var">userCodeDef</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">(ButtonMask, KeySym)
</span><a href="#local-6989586621679510246"><span class="hs-identifier hs-var">kp</span></a></span><span> </span><span class="annot"><span class="annottext">Map (ButtonMask, KeySym) (X ())
</span><a href="#local-6989586621679510242"><span class="hs-identifier hs-var">kbs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><span class="annottext">Event
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; All
</span><span class="hs-identifier hs-var">All</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- --&lt; Public &gt;-- {{{</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | Adds the provided modes to the user's config, and sets up the bells</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- and whistles needed for them to work.</span><span>
</span><span id="line-201"></span><span id="local-6989586621679510468"><span class="annot"><a href="XMonad.Hooks.Modal.html#modal"><span class="hs-identifier hs-type">modal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679510468"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679510468"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-202"></span><span id="modal"><span class="annot"><span class="annottext">modal :: forall (l :: * -&gt; *). [Mode] -&gt; XConfig l -&gt; XConfig l
</span><a href="XMonad.Hooks.Modal.html#modal"><span class="hs-identifier hs-var hs-var">modal</span></a></span></span><span> </span><span id="local-6989586621679510230"><span class="annot"><span class="annottext">[Mode]
</span><a href="#local-6989586621679510230"><span class="hs-identifier hs-var">modes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (l :: * -&gt; *).
(Semigroup a, Typeable a) =&gt;
(XConfig l -&gt; XConfig l) -&gt; a -&gt; XConfig l -&gt; XConfig l
</span><a href="XMonad.Util.ExtensibleConf.html#once"><span class="hs-identifier hs-var">XC.once</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679510228"><span class="annot"><span class="annottext">XConfig l
</span><a href="#local-6989586621679510228"><span class="hs-identifier hs-var">cnf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XConfig l
</span><a href="#local-6989586621679510228"><span class="hs-identifier hs-var">cnf</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">startupHook :: X ()
</span><span class="hs-identifier hs-var">startupHook</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; X ()
</span><span class="hs-identifier hs-var">startupHook</span></span><span> </span><span class="annot"><span class="annottext">XConfig l
</span><a href="#local-6989586621679510228"><span class="hs-identifier hs-var">cnf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679510226"><span class="hs-identifier hs-var">initModes</span></a></span><span>
</span><span id="line-204"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">handleEventHook :: Event -&gt; X All
</span><span class="hs-identifier hs-var">handleEventHook</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; Event -&gt; X All
</span><span class="hs-identifier hs-var">handleEventHook</span></span><span> </span><span class="annot"><span class="annottext">XConfig l
</span><a href="#local-6989586621679510228"><span class="hs-identifier hs-var">cnf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Event -&gt; X All
</span><a href="XMonad.Hooks.Modal.html#modalEventHook"><span class="hs-identifier hs-var">modalEventHook</span></a></span><span>
</span><span id="line-205"></span><span>               </span><span class="hs-special">}</span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Mode] -&gt; ModeConfig
</span><a href="XMonad.Hooks.Modal.html#MC"><span class="hs-identifier hs-var">MC</span></a></span><span> </span><span class="annot"><span class="annottext">[Mode]
</span><a href="#local-6989586621679510230"><span class="hs-identifier hs-var">modes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679510226"><span class="annot"><span class="annottext">initModes :: X ()
</span><a href="#local-6989586621679510226"><span class="hs-identifier hs-var hs-var">initModes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Mode -&gt; CurrentMode
</span><a href="XMonad.Hooks.Modal.html#CurrentMode"><span class="hs-identifier hs-var">CurrentMode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#refreshMode"><span class="hs-identifier hs-var">refreshMode</span></a></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Create a 'Mode' from the given binding to 'exitMode', label and</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- keybindings.</span><span>
</span><span id="line-212"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#modeWithExit"><span class="hs-identifier hs-type">modeWithExit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Layout</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-213"></span><span id="modeWithExit"><span class="annot"><span class="annottext">modeWithExit :: String
-&gt; String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ()))
-&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#modeWithExit"><span class="hs-identifier hs-var hs-var">modeWithExit</span></a></span></span><span> </span><span id="local-6989586621679510219"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510219"><span class="hs-identifier hs-var">exitKey</span></a></span></span><span> </span><span id="local-6989586621679510218"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510218"><span class="hs-identifier hs-var">mlabel</span></a></span></span><span> </span><span id="local-6989586621679510217"><span class="annot"><span class="annottext">XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="#local-6989586621679510217"><span class="hs-identifier hs-var">keys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())) -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510218"><span class="hs-identifier hs-var">mlabel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679510216"><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510216"><span class="hs-identifier hs-var">cnf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679510213"><span class="annot"><span class="annottext">exit :: (ButtonMask, KeySym)
</span><a href="#local-6989586621679510213"><span class="hs-identifier hs-var hs-var">exit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Parser a -&gt; String -&gt; Maybe a
</span><a href="XMonad.Util.Parser.html#runParser"><span class="hs-identifier hs-var">runParser</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; Parser (ButtonMask, KeySym)
</span><a href="XMonad.Util.EZConfig.html#parseKeyCombo"><span class="hs-identifier hs-var">parseKeyCombo</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510216"><span class="hs-identifier hs-var">cnf</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510219"><span class="hs-identifier hs-var">exitKey</span></a></span><span>
</span><span id="line-215"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">(ButtonMask, KeySym)
</span><a href="#local-6989586621679510213"><span class="hs-identifier hs-var">exit</span></a></span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#exitMode"><span class="hs-identifier hs-var">exitMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="#local-6989586621679510217"><span class="hs-identifier hs-var">keys</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510216"><span class="hs-identifier hs-var">cnf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | Create a 'Mode' from the given label and keybindings. Sets the</span><span>
</span><span id="line-218"></span><span class="hs-comment">-- @escape@ key to 'exitMode'.</span><span>
</span><span id="line-219"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#mode"><span class="hs-identifier hs-type">mode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Layout</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-220"></span><span id="mode"><span class="annot"><span class="annottext">mode :: String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())) -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#mode"><span class="hs-identifier hs-var hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ()))
-&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#modeWithExit"><span class="hs-identifier hs-var">modeWithExit</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;Escape&gt;&quot;</span></span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-comment">-- | Set the current 'Mode' based on its label.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#setMode"><span class="hs-identifier hs-type">setMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span id="setMode"><span class="annot"><span class="annottext">setMode :: String -&gt; X ()
</span><a href="XMonad.Hooks.Modal.html#setMode"><span class="hs-identifier hs-var hs-var">setMode</span></a></span></span><span> </span><span id="local-6989586621679510209"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510209"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
(MonadReader XConf m, Typeable a, Monoid b) =&gt;
(a -&gt; m b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleConf.html#with"><span class="hs-identifier hs-var">XC.with</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.Modal.html#MC"><span class="hs-identifier hs-type">MC</span></a></span><span> </span><span id="local-6989586621679510207"><span class="annot"><span class="annottext">[Mode]
</span><a href="#local-6989586621679510207"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510209"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; String
</span><a href="XMonad.Hooks.Modal.html#label"><span class="hs-keyword hs-var">label</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Mode]
</span><a href="#local-6989586621679510207"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">Maybe Mode
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679510205"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679510205"><span class="hs-identifier hs-var">m</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679510203"><span class="annot"><span class="annottext">CurrentMode
</span><a href="#local-6989586621679510203"><span class="hs-identifier hs-var">cm</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrentMode
</span><a href="#local-6989586621679510203"><span class="hs-identifier hs-var">cm</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">currentMode :: Maybe Mode
</span><a href="XMonad.Hooks.Modal.html#currentMode"><span class="hs-identifier hs-var">currentMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679510205"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#refreshMode"><span class="hs-identifier hs-var">refreshMode</span></a></span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span class="hs-comment">-- | Exits the current mode.</span><span>
</span><span id="line-232"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#exitMode"><span class="hs-identifier hs-type">exitMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span id="exitMode"><span class="annot"><span class="annottext">exitMode :: X ()
</span><a href="XMonad.Hooks.Modal.html#exitMode"><span class="hs-identifier hs-var hs-var">exitMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679510202"><span class="annot"><span class="annottext">CurrentMode
</span><a href="#local-6989586621679510202"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CurrentMode
</span><a href="#local-6989586621679510202"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">currentMode :: Maybe Mode
</span><a href="XMonad.Hooks.Modal.html#currentMode"><span class="hs-identifier hs-var">currentMode</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#refreshMode"><span class="hs-identifier hs-var">refreshMode</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | A 'Logger' to display the current mode.</span><span>
</span><span id="line-238"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#logMode"><span class="hs-identifier hs-type">logMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Loggers.html#Logger"><span class="hs-identifier hs-type">Logger</span></a></span><span>
</span><span id="line-239"></span><span id="logMode"><span class="annot"><span class="annottext">logMode :: Logger
</span><a href="XMonad.Hooks.Modal.html#logMode"><span class="hs-identifier hs-var hs-var">logMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Mode -&gt; String
</span><a href="XMonad.Hooks.Modal.html#label"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">CurrentMode -&gt; Maybe Mode
</span><a href="XMonad.Hooks.Modal.html#currentMode"><span class="hs-identifier hs-var">currentMode</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- Provided modes</span><span>
</span><span id="line-242"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#noModModeLabel"><span class="hs-identifier hs-type">noModModeLabel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#floatModeLabel"><span class="hs-identifier hs-type">floatModeLabel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#overlayedFloatModeLabel"><span class="hs-identifier hs-type">overlayedFloatModeLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-243"></span><span id="noModModeLabel"><span class="annot"><span class="annottext">noModModeLabel :: String
</span><a href="XMonad.Hooks.Modal.html#noModModeLabel"><span class="hs-identifier hs-var hs-var">noModModeLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NoMod&quot;</span></span><span>
</span><span id="line-244"></span><span id="floatModeLabel"><span class="annot"><span class="annottext">floatModeLabel :: String
</span><a href="XMonad.Hooks.Modal.html#floatModeLabel"><span class="hs-identifier hs-var hs-var">floatModeLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Float&quot;</span></span><span>
</span><span id="line-245"></span><span id="overlayedFloatModeLabel"><span class="annot"><span class="annottext">overlayedFloatModeLabel :: String
</span><a href="XMonad.Hooks.Modal.html#overlayedFloatModeLabel"><span class="hs-identifier hs-var hs-var">overlayedFloatModeLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Overlayed Float&quot;</span></span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-comment">-- | In this 'Mode', all keybindings are available without the need for pressing</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- the modifier. Pressing @escape@ exits the mode.</span><span>
</span><span id="line-249"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#noModMode"><span class="hs-identifier hs-type">noModMode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-250"></span><span id="noModMode"><span class="annot"><span class="annottext">noModMode :: Mode
</span><a href="XMonad.Hooks.Modal.html#noModMode"><span class="hs-identifier hs-var hs-var">noModMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-251"></span><span>  </span><span class="annot"><span class="annottext">String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())) -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#mode"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Hooks.Modal.html#noModModeLabel"><span class="hs-identifier hs-var">noModModeLabel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679510201"><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510201"><span class="hs-identifier hs-var">cnf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ButtonMask
-&gt; Map (ButtonMask, KeySym) (X ())
-&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#stripModifier"><span class="hs-identifier hs-var">stripModifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: * -&gt; *). XConfig l -&gt; ButtonMask
</span><span class="hs-identifier hs-var">modMask</span></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510201"><span class="hs-identifier hs-var">cnf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: * -&gt; *).
XConfig l -&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><span class="hs-identifier hs-var">keys</span></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510201"><span class="hs-identifier hs-var">cnf</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510201"><span class="hs-identifier hs-var">cnf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Generates the keybindings for 'floatMode' and 'overlayedFloatMode'.</span><span>
</span><span id="line-254"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#floatMap"><span class="hs-identifier hs-type">floatMap</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span> </span><span class="hs-comment">-- ^ Move mask</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span> </span><span class="hs-comment">-- ^ Enlarge mask</span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span> </span><span class="hs-comment">-- ^ Shrink mask</span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Step size</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span id="floatMap"><span class="annot"><span class="annottext">floatMap :: ButtonMask
-&gt; ButtonMask
-&gt; ButtonMask
-&gt; Int
-&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#floatMap"><span class="hs-identifier hs-var hs-var">floatMap</span></a></span></span><span> </span><span id="local-6989586621679510198"><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510198"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span id="local-6989586621679510197"><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510197"><span class="hs-identifier hs-var">enlarge</span></a></span></span><span> </span><span id="local-6989586621679510196"><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510196"><span class="hs-identifier hs-var">shrink</span></a></span></span><span> </span><span id="local-6989586621679510195"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-comment">-- move</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510198"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_h</span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysMoveWindow"><span class="hs-identifier hs-var">keysMoveWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510198"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysMoveWindow"><span class="hs-identifier hs-var">keysMoveWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510198"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysMoveWindow"><span class="hs-identifier hs-var">keysMoveWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510198"><span class="hs-identifier hs-var">move</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">)</span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysMoveWindow"><span class="hs-identifier hs-var">keysMoveWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-comment">-- enlarge</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510197"><span class="hs-identifier hs-var">enlarge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_h</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510197"><span class="hs-identifier hs-var">enlarge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510197"><span class="hs-identifier hs-var">enlarge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510197"><span class="hs-identifier hs-var">enlarge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-comment">-- shrink</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510196"><span class="hs-identifier hs-var">shrink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_h</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510196"><span class="hs-identifier hs-var">shrink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510196"><span class="hs-identifier hs-var">shrink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510196"><span class="hs-identifier hs-var">shrink</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(KeySym -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChangeDim -&gt; G -&gt; KeySym -&gt; X ()
</span><a href="XMonad.Actions.FloatKeys.html#keysResizeWindow"><span class="hs-identifier hs-var">keysResizeWindow</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510195"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><span class="hs-identifier hs-var">noModMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">X ()
</span><a href="XMonad.Hooks.Modal.html#exitMode"><span class="hs-identifier hs-var">exitMode</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span class="hs-comment">-- | A mode to control floating windows with @{hijk}@, @M-{hijk}@ and</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- @M-S-{hijk}@ in order to respectively move, enlarge and</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- shrink windows.</span><span>
</span><span id="line-282"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#floatMode"><span class="hs-identifier hs-type">floatMode</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Step size</span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-285"></span><span id="floatMode"><span class="annot"><span class="annottext">floatMode :: Int -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#floatMode"><span class="hs-identifier hs-var hs-var">floatMode</span></a></span></span><span> </span><span id="local-6989586621679510187"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510187"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())) -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#mode"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Hooks.Modal.html#floatModeLabel"><span class="hs-identifier hs-var">floatModeLabel</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679510185"><span class="annot"><span class="annottext">ButtonMask
modMask :: ButtonMask
modMask :: forall (l :: * -&gt; *). XConfig l -&gt; ButtonMask
</span><a href="#local-6989586621679510185"><span class="hs-identifier hs-var hs-var">modMask</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">ButtonMask
-&gt; ButtonMask
-&gt; ButtonMask
-&gt; Int
-&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#floatMap"><span class="hs-identifier hs-var">floatMap</span></a></span><span> </span><span class="annot"><span class="annottext">ButtonMask
</span><span class="hs-identifier hs-var">noModMask</span></span><span> </span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510185"><span class="hs-identifier hs-var">modMask</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510185"><span class="hs-identifier hs-var">modMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">ButtonMask
</span><span class="hs-identifier hs-var">shiftMask</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679510187"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Similar to 'resizeMode', but keeps the bindings of the original</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- config active.</span><span>
</span><span id="line-290"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#overlayedFloatMode"><span class="hs-identifier hs-type">overlayedFloatMode</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Step size</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-293"></span><span id="overlayedFloatMode"><span class="annot"><span class="annottext">overlayedFloatMode :: Int -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#overlayedFloatMode"><span class="hs-identifier hs-var hs-var">overlayedFloatMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Mode -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#overlay"><span class="hs-identifier hs-var">overlay</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Hooks.Modal.html#overlayedFloatModeLabel"><span class="hs-identifier hs-var">overlayedFloatModeLabel</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#floatMode"><span class="hs-identifier hs-var">floatMode</span></a></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- | Modifies a mode so that the keybindings are merged with those from</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- the config instead of replacing them.</span><span>
</span><span id="line-297"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#overlay"><span class="hs-identifier hs-type">overlay</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Label for the new mode</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span> </span><span class="hs-comment">-- ^ Base mode</span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-type">Mode</span></a></span><span>
</span><span id="line-301"></span><span id="overlay"><span class="annot"><span class="annottext">overlay :: String -&gt; Mode -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#overlay"><span class="hs-identifier hs-var hs-var">overlay</span></a></span></span><span> </span><span id="local-6989586621679510182"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510182"><span class="hs-keyword hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679510181"><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679510181"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())) -&gt; Mode
</span><a href="XMonad.Hooks.Modal.html#Mode"><span class="hs-identifier hs-var">Mode</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679510182"><span class="hs-keyword hs-var">label</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679510180"><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510180"><span class="hs-identifier hs-var">cnf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Mode -&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#boundKeys"><span class="hs-identifier hs-var">boundKeys</span></a></span><span> </span><span class="annot"><span class="annottext">Mode
</span><a href="#local-6989586621679510181"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510180"><span class="hs-identifier hs-var">cnf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *).
XConfig l -&gt; XConfig Layout -&gt; Map (ButtonMask, KeySym) (X ())
</span><span class="hs-identifier hs-var">keys</span></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510180"><span class="hs-identifier hs-var">cnf</span></a></span><span> </span><span class="annot"><span class="annottext">XConfig Layout
</span><a href="#local-6989586621679510180"><span class="hs-identifier hs-var">cnf</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Strips the modifier key from the provided keybindings.</span><span>
</span><span id="line-304"></span><span class="annot"><a href="XMonad.Hooks.Modal.html#stripModifier"><span class="hs-identifier hs-type">stripModifier</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span> </span><span class="hs-comment">-- ^ Modifier to remove</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ Original keybinding map</span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ButtonMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span id="stripModifier"><span class="annot"><span class="annottext">stripModifier :: ButtonMask
-&gt; Map (ButtonMask, KeySym) (X ())
-&gt; Map (ButtonMask, KeySym) (X ())
</span><a href="XMonad.Hooks.Modal.html#stripModifier"><span class="hs-identifier hs-var hs-var">stripModifier</span></a></span></span><span> </span><span id="local-6989586621679510179"><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510179"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k2 k1 a. Ord k2 =&gt; (k1 -&gt; k2) -&gt; Map k1 a -&gt; Map k2 a
</span><span class="hs-identifier hs-var">M.mapKeys</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679510177"><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510177"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679510176"><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679510176"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510177"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">complement</span></span><span> </span><span class="annot"><span class="annottext">ButtonMask
</span><a href="#local-6989586621679510179"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">KeySym
</span><a href="#local-6989586621679510176"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-comment">-- }}}</span><span>
</span><span id="line-311"></span></pre></body></html>