<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Module      :  XMonad.Util.Stack</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Description :  Utility functions for manipulating @Maybe Stack@s.</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Copyright   :  Quentin Moser &lt;moserq@gmail.com&gt;</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Maintainer  :  orphaned</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Utility functions for manipulating @Maybe Stack@s.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Util.Stack</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-19"></span><span>                           </span><span class="hs-comment">-- | This is a developer-oriented module, intended to be used</span><span>
</span><span id="line-20"></span><span>                           </span><span class="hs-comment">-- for writing new extentions.</span><span>
</span><span id="line-21"></span><span>                           </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier">Zipper</span></a></span><span>
</span><span id="line-22"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#emptyZ"><span class="hs-identifier">emptyZ</span></a></span><span>
</span><span id="line-23"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#singletonZ"><span class="hs-identifier">singletonZ</span></a></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>                           </span><span class="annot"><span class="hs-comment">-- * Conversions</span></span><span>
</span><span id="line-26"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#fromIndex"><span class="hs-identifier">fromIndex</span></a></span><span>
</span><span id="line-27"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#toIndex"><span class="hs-identifier">toIndex</span></a></span><span>
</span><span id="line-28"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier">fromTags</span></a></span><span>
</span><span id="line-29"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier">toTags</span></a></span><span>
</span><span id="line-30"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#zipperFocusedAtFirstOf"><span class="hs-identifier">zipperFocusedAtFirstOf</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span>                           </span><span class="annot"><span class="hs-comment">-- * 'Zipper' manipulation functions</span></span><span>
</span><span id="line-33"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Insertion, movement</span></span><span>
</span><span id="line-34"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#insertUpZ"><span class="hs-identifier">insertUpZ</span></a></span><span>
</span><span id="line-35"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#insertDownZ"><span class="hs-identifier">insertDownZ</span></a></span><span>
</span><span id="line-36"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#swapUpZ"><span class="hs-identifier">swapUpZ</span></a></span><span>
</span><span id="line-37"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#swapDownZ"><span class="hs-identifier">swapDownZ</span></a></span><span>
</span><span id="line-38"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#swapMasterZ"><span class="hs-identifier">swapMasterZ</span></a></span><span>
</span><span id="line-39"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Focus movement</span></span><span>
</span><span id="line-40"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#focusUpZ"><span class="hs-identifier">focusUpZ</span></a></span><span>
</span><span id="line-41"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#focusDownZ"><span class="hs-identifier">focusDownZ</span></a></span><span>
</span><span id="line-42"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#focusMasterZ"><span class="hs-identifier">focusMasterZ</span></a></span><span>
</span><span id="line-43"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#findS"><span class="hs-identifier">findS</span></a></span><span>
</span><span id="line-44"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#findZ"><span class="hs-identifier">findZ</span></a></span><span>
</span><span id="line-45"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Extraction</span></span><span>
</span><span id="line-46"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#getFocusZ"><span class="hs-identifier">getFocusZ</span></a></span><span>
</span><span id="line-47"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#getIZ"><span class="hs-identifier">getIZ</span></a></span><span>
</span><span id="line-48"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Sorting</span></span><span>
</span><span id="line-49"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#sortZ"><span class="hs-identifier">sortZ</span></a></span><span>
</span><span id="line-50"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#sortByZ"><span class="hs-identifier">sortByZ</span></a></span><span>
</span><span id="line-51"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Maps</span></span><span>
</span><span id="line-52"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapZ"><span class="hs-identifier">mapZ</span></a></span><span>
</span><span id="line-53"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapZ_"><span class="hs-identifier">mapZ_</span></a></span><span>
</span><span id="line-54"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapZM"><span class="hs-identifier">mapZM</span></a></span><span>
</span><span id="line-55"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapZM_"><span class="hs-identifier">mapZM_</span></a></span><span>
</span><span id="line-56"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#onFocusedZ"><span class="hs-identifier">onFocusedZ</span></a></span><span>
</span><span id="line-57"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#onFocusedZM"><span class="hs-identifier">onFocusedZM</span></a></span><span>
</span><span id="line-58"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#onIndexZ"><span class="hs-identifier">onIndexZ</span></a></span><span>
</span><span id="line-59"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#onIndexZM"><span class="hs-identifier">onIndexZM</span></a></span><span>
</span><span id="line-60"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Filters</span></span><span>
</span><span id="line-61"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#filterZ"><span class="hs-identifier">filterZ</span></a></span><span>
</span><span id="line-62"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#filterZ_"><span class="hs-identifier">filterZ_</span></a></span><span>
</span><span id="line-63"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#deleteFocusedZ"><span class="hs-identifier">deleteFocusedZ</span></a></span><span>
</span><span id="line-64"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#deleteIndexZ"><span class="hs-identifier">deleteIndexZ</span></a></span><span>
</span><span id="line-65"></span><span>                           </span><span class="annot"><span class="hs-comment">-- ** Folds</span></span><span>
</span><span id="line-66"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#foldrZ"><span class="hs-identifier">foldrZ</span></a></span><span>
</span><span id="line-67"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#foldlZ"><span class="hs-identifier">foldlZ</span></a></span><span>
</span><span id="line-68"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#foldrZ_"><span class="hs-identifier">foldrZ_</span></a></span><span>
</span><span id="line-69"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#foldlZ_"><span class="hs-identifier">foldlZ_</span></a></span><span>
</span><span id="line-70"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#elemZ"><span class="hs-identifier">elemZ</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>                           </span><span class="annot"><span class="hs-comment">-- * Other utility functions</span></span><span>
</span><span id="line-73"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#getI"><span class="hs-identifier">getI</span></a></span><span>
</span><span id="line-74"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#tagBy"><span class="hs-identifier">tagBy</span></a></span><span>
</span><span id="line-75"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#fromE"><span class="hs-identifier">fromE</span></a></span><span>
</span><span id="line-76"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier">mapE</span></a></span><span>
</span><span id="line-77"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapE_"><span class="hs-identifier">mapE_</span></a></span><span>
</span><span id="line-78"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier">mapEM</span></a></span><span>
</span><span id="line-79"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#mapEM_"><span class="hs-identifier">mapEM_</span></a></span><span>
</span><span id="line-80"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#reverseS"><span class="hs-identifier">reverseS</span></a></span><span>
</span><span id="line-81"></span><span>                         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#reverseZ"><span class="hs-identifier">reverseZ</span></a></span><span>
</span><span id="line-82"></span><span>                         </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">guard</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sortBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prelude.html#%21%3F"><span class="hs-operator">(!?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">type</span><span> </span><span id="Zipper"><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-var">Zipper</span></a></span></span><span> </span><span id="local-6989586621679445386"><span class="annot"><a href="#local-6989586621679445386"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679445386"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span id="local-6989586621679445631"><span class="annot"><a href="XMonad.Util.Stack.html#emptyZ"><span class="hs-identifier hs-type">emptyZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445631"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-91"></span><span id="emptyZ"><span class="annot"><span class="annottext">emptyZ :: forall a. Zipper a
</span><a href="XMonad.Util.Stack.html#emptyZ"><span class="hs-identifier hs-var hs-var">emptyZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span id="local-6989586621679445628"><span class="annot"><a href="XMonad.Util.Stack.html#singletonZ"><span class="hs-identifier hs-type">singletonZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679445628"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445628"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-94"></span><span id="singletonZ"><span class="annot"><span class="annottext">singletonZ :: forall a. a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#singletonZ"><span class="hs-identifier hs-var hs-var">singletonZ</span></a></span></span><span> </span><span id="local-6989586621679445385"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445385"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445385"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- * Conversions</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | Create a stack from a list, and the 0-based index of the focused element.</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- If the index is out of bounds, focus will go to the first element.</span><span>
</span><span id="line-100"></span><span id="local-6989586621679445621"><span class="annot"><a href="XMonad.Util.Stack.html#fromIndex"><span class="hs-identifier hs-type">fromIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679445621"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445621"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-101"></span><span id="fromIndex"><span class="annot"><span class="annottext">fromIndex :: forall a. [a] -&gt; Int -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromIndex"><span class="hs-identifier hs-var hs-var">fromIndex</span></a></span></span><span> </span><span id="local-6989586621679445383"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445383"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span id="local-6989586621679445382"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445382"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">($)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445382"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445383"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- | Turn a stack into a list and the index of its focused element.</span><span>
</span><span id="line-104"></span><span id="local-6989586621679445610"><span class="annot"><a href="XMonad.Util.Stack.html#toIndex"><span class="hs-identifier hs-type">toIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445610"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679445610"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-105"></span><span id="toIndex"><span class="annot"><span class="annottext">toIndex :: forall a. Zipper a -&gt; ([a], Maybe Int)
</span><a href="XMonad.Util.Stack.html#toIndex"><span class="hs-identifier hs-var hs-var">toIndex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span class="annot"><a href="XMonad.Util.Stack.html#toIndex"><span class="hs-identifier hs-var">toIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445376"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445376"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445376"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445376"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Create a stack from a list of 'Either'-tagged values. Focus will go to</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- the first 'Right' value, or if there is none, to the first 'Left' one.</span><span>
</span><span id="line-110"></span><span id="local-6989586621679445619"><span class="annot"><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-type">fromTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445619"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445619"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445619"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-111"></span><span id="fromTags"><span class="annot"><span class="annottext">fromTags :: forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var hs-var">fromTags</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a}. ([a], Maybe a, [a]) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445371"><span class="hs-identifier hs-var">finalize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">forall {a}.
Either a a -&gt; ([a], Maybe a, [a]) -&gt; ([a], Maybe a, [a])
</span><a href="#local-6989586621679445368"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679445368"><span class="annot"><span class="annottext">step :: Either a a -&gt; ([a], Maybe a, [a]) -&gt; ([a], Maybe a, [a])
</span><a href="#local-6989586621679445368"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679445367"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445367"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445366"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445366"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445365"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445365"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445364"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445364"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445367"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445366"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445365"><span class="hs-identifier hs-var">f</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445364"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>          </span><span class="annot"><a href="#local-6989586621679445368"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679445363"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445363"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445362"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445362"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445361"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445361"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445362"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445363"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445361"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>          </span><span class="annot"><a href="#local-6989586621679445368"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679445360"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445360"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445359"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445359"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445358"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445358"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445357"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445357"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445360"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445359"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445358"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445357"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>          </span><span class="annot"><a href="#local-6989586621679445368"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679445356"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445356"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445355"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445355"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445354"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445354"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445355"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445356"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445354"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>          </span><span id="local-6989586621679445371"><span class="annot"><span class="annottext">finalize :: ([a], Maybe a, [a]) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445371"><span class="hs-identifier hs-var hs-var">finalize</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445353"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445353"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445352"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445352"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445351"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445351"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445352"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445353"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445351"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-117"></span><span>          </span><span class="annot"><a href="#local-6989586621679445371"><span class="hs-identifier hs-var">finalize</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445349"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445349"><span class="hs-identifier hs-var">u</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445348"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445348"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445347"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445347"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445348"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445349"><span class="hs-identifier hs-var">u</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445347"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-118"></span><span>          </span><span class="annot"><a href="#local-6989586621679445371"><span class="hs-identifier hs-var">finalize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Turn a stack into an 'Either'-tagged list. The focused element</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- will be tagged with 'Right', the others with 'Left'.</span><span>
</span><span id="line-122"></span><span id="local-6989586621679445596"><span class="annot"><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-type">toTags</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445596"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445596"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-123"></span><span id="toTags"><span class="annot"><span class="annottext">toTags :: forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var hs-var">toTags</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-124"></span><span class="annot"><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445346"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445346"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445346"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445346"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-125"></span><span>                  </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445346"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-comment">-- | @differentiate zs xs@ takes the first @z@ from @z2 that also belongs to</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- @xs@ and turns @xs@ into a stack with @z@ being the current element. Acts</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- as 'XMonad.StackSet.differentiate' if @zs@ and @xs@ don't intersect.</span><span>
</span><span id="line-130"></span><span id="local-6989586621679445591"><span class="annot"><a href="XMonad.Util.Stack.html#zipperFocusedAtFirstOf"><span class="hs-identifier hs-type">zipperFocusedAtFirstOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679445591"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679445591"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679445591"><span class="hs-identifier hs-type">q</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445591"><span class="hs-identifier hs-type">q</span></a></span></span><span>
</span><span id="line-131"></span><span id="zipperFocusedAtFirstOf"><span class="annot"><span class="annottext">zipperFocusedAtFirstOf :: forall q. Eq q =&gt; [q] -&gt; [q] -&gt; Zipper q
</span><a href="XMonad.Util.Stack.html#zipperFocusedAtFirstOf"><span class="hs-identifier hs-var hs-var">zipperFocusedAtFirstOf</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span id="local-6989586621679445337"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445337"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445337"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-132"></span><span class="annot"><a href="XMonad.Util.Stack.html#zipperFocusedAtFirstOf"><span class="hs-identifier hs-var">zipperFocusedAtFirstOf</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679445335"><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679445335"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679445334"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445334"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679445333"><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445333"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679445335"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445333"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: q
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679445335"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-135"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [q]
</span><span class="hs-identifier hs-var">W.up</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">takeWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679445335"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445333"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-136"></span><span>                </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [q]
</span><span class="hs-identifier hs-var">W.down</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>  </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">q
</span><a href="#local-6989586621679445335"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445333"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-137"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall q. Eq q =&gt; [q] -&gt; [q] -&gt; Zipper q
</span><a href="XMonad.Util.Stack.html#zipperFocusedAtFirstOf"><span class="hs-identifier hs-var">zipperFocusedAtFirstOf</span></a></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445334"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">[q]
</span><a href="#local-6989586621679445333"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-comment">-- * Zipper functions</span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- ** Insertion, movement</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Insert an element before the focused one, and focus it</span><span>
</span><span id="line-145"></span><span id="local-6989586621679445584"><span class="annot"><a href="XMonad.Util.Stack.html#insertUpZ"><span class="hs-identifier hs-type">insertUpZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679445584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445584"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445584"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-146"></span><span id="insertUpZ"><span class="annot"><span class="annottext">insertUpZ :: forall a. a -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#insertUpZ"><span class="hs-identifier hs-var hs-var">insertUpZ</span></a></span></span><span> </span><span id="local-6989586621679445327"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445327"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445327"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span class="annot"><a href="XMonad.Util.Stack.html#insertUpZ"><span class="hs-identifier hs-var">insertUpZ</span></a></span><span> </span><span id="local-6989586621679445326"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445326"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445325"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445325"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445325"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445326"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445325"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445325"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Insert an element after the focused one, and focus it</span><span>
</span><span id="line-150"></span><span id="local-6989586621679445324"><span class="annot"><a href="XMonad.Util.Stack.html#insertDownZ"><span class="hs-identifier hs-type">insertDownZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679445324"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445324"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445324"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-151"></span><span id="insertDownZ"><span class="annot"><span class="annottext">insertDownZ :: forall a. a -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#insertDownZ"><span class="hs-identifier hs-var hs-var">insertDownZ</span></a></span></span><span> </span><span id="local-6989586621679445323"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445323"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445323"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span class="annot"><a href="XMonad.Util.Stack.html#insertDownZ"><span class="hs-identifier hs-var">insertDownZ</span></a></span><span> </span><span id="local-6989586621679445322"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445322"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445321"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445321"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445321"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445322"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445321"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445321"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- | Swap the focused element with the previous one</span><span>
</span><span id="line-155"></span><span id="local-6989586621679445581"><span class="annot"><a href="XMonad.Util.Stack.html#swapUpZ"><span class="hs-identifier hs-type">swapUpZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445581"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445581"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-156"></span><span id="swapUpZ"><span class="annot"><span class="annottext">swapUpZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#swapUpZ"><span class="hs-identifier hs-var hs-var">swapUpZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-157"></span><span class="annot"><a href="XMonad.Util.Stack.html#swapUpZ"><span class="hs-identifier hs-var">swapUpZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445320"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445320"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679445319"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445319"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445318"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445318"><span class="hs-identifier hs-var">up</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445320"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445320"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445318"><span class="hs-identifier hs-var">up</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445319"><span class="hs-identifier hs-var">u</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445320"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span class="annot"><a href="XMonad.Util.Stack.html#swapUpZ"><span class="hs-identifier hs-var">swapUpZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445317"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445317"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445317"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445317"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Swap the focused element with the next one</span><span>
</span><span id="line-161"></span><span id="local-6989586621679445316"><span class="annot"><a href="XMonad.Util.Stack.html#swapDownZ"><span class="hs-identifier hs-type">swapDownZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445316"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445316"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-162"></span><span id="swapDownZ"><span class="annot"><span class="annottext">swapDownZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#swapDownZ"><span class="hs-identifier hs-var hs-var">swapDownZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-163"></span><span class="annot"><a href="XMonad.Util.Stack.html#swapDownZ"><span class="hs-identifier hs-var">swapDownZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445315"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445315"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679445314"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445314"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445313"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445313"><span class="hs-identifier hs-var">down</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445315"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445315"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445313"><span class="hs-identifier hs-var">down</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445314"><span class="hs-identifier hs-var">d</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445315"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-164"></span><span class="annot"><a href="XMonad.Util.Stack.html#swapDownZ"><span class="hs-identifier hs-var">swapDownZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445312"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445312"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445312"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445312"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Swap the focused element with the first one</span><span>
</span><span id="line-167"></span><span id="local-6989586621679445311"><span class="annot"><a href="XMonad.Util.Stack.html#swapMasterZ"><span class="hs-identifier hs-type">swapMasterZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445311"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445311"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-168"></span><span id="swapMasterZ"><span class="annot"><span class="annottext">swapMasterZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#swapMasterZ"><span class="hs-identifier hs-var hs-var">swapMasterZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-169"></span><span class="annot"><a href="XMonad.Util.Stack.html#swapMasterZ"><span class="hs-identifier hs-var">swapMasterZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679445310"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445310"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445309"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445309"><span class="hs-identifier hs-var">up</span></a></span></span><span> </span><span id="local-6989586621679445308"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445308"><span class="hs-identifier hs-var">down</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445310"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445309"><span class="hs-identifier hs-var">up</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445308"><span class="hs-identifier hs-var">down</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- ** Focus movement</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Move the focus to the previous element</span><span>
</span><span id="line-174"></span><span id="local-6989586621679445307"><span class="annot"><a href="XMonad.Util.Stack.html#focusUpZ"><span class="hs-identifier hs-type">focusUpZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445307"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445307"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-175"></span><span id="focusUpZ"><span class="annot"><span class="annottext">focusUpZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#focusUpZ"><span class="hs-identifier hs-var hs-var">focusUpZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-176"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusUpZ"><span class="hs-identifier hs-var">focusUpZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445305"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445305"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679445304"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445304"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445303"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445303"><span class="hs-identifier hs-var">up</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445305"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445304"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445303"><span class="hs-identifier hs-var">up</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445305"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445305"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusUpZ"><span class="hs-identifier hs-var">focusUpZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445302"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445302"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445302"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445302"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-178"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusUpZ"><span class="hs-identifier hs-var">focusUpZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679445300"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445300"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679445299"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445299"><span class="hs-identifier hs-var">down</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445299"><span class="hs-identifier hs-var">down</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445299"><span class="hs-identifier hs-var">down</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445300"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-comment">-- | Move the focus to the next element</span><span>
</span><span id="line-181"></span><span id="local-6989586621679445297"><span class="annot"><a href="XMonad.Util.Stack.html#focusDownZ"><span class="hs-identifier hs-type">focusDownZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445297"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445297"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-182"></span><span id="focusDownZ"><span class="annot"><span class="annottext">focusDownZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#focusDownZ"><span class="hs-identifier hs-var hs-var">focusDownZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-183"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusDownZ"><span class="hs-identifier hs-var">focusDownZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445295"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445295"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679445294"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445294"><span class="hs-identifier hs-var">d</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445293"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445293"><span class="hs-identifier hs-var">down</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445295"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445294"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445295"><span class="hs-identifier hs-var">s</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445295"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445293"><span class="hs-identifier hs-var">down</span></a></span><span>
</span><span id="line-184"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusDownZ"><span class="hs-identifier hs-var">focusDownZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445292"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445292"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445292"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445292"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-185"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusDownZ"><span class="hs-identifier hs-var">focusDownZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679445291"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445291"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445290"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445290"><span class="hs-identifier hs-var">up</span></a></span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445290"><span class="hs-identifier hs-var">up</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445290"><span class="hs-identifier hs-var">up</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445291"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | Move the focus to the first element</span><span>
</span><span id="line-188"></span><span id="local-6989586621679445289"><span class="annot"><a href="XMonad.Util.Stack.html#focusMasterZ"><span class="hs-identifier hs-type">focusMasterZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445289"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445289"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-189"></span><span id="focusMasterZ"><span class="annot"><span class="annottext">focusMasterZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#focusMasterZ"><span class="hs-identifier hs-var hs-var">focusMasterZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-190"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusMasterZ"><span class="hs-identifier hs-var">focusMasterZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679445287"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445287"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445286"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445286"><span class="hs-identifier hs-var">up</span></a></span></span><span> </span><span id="local-6989586621679445285"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445285"><span class="hs-identifier hs-var">down</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445286"><span class="hs-identifier hs-var">up</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445286"><span class="hs-identifier hs-var">up</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445286"><span class="hs-identifier hs-var">up</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445287"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445285"><span class="hs-identifier hs-var">down</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span class="annot"><a href="XMonad.Util.Stack.html#focusMasterZ"><span class="hs-identifier hs-var">focusMasterZ</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445283"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445283"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445283"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | Refocus a @Stack a@ on an element satisfying the predicate, or fail to</span><span>
</span><span id="line-195"></span><span class="hs-comment">--   @Nothing@.</span><span>
</span><span id="line-196"></span><span id="local-6989586621679445572"><span class="annot"><a href="XMonad.Util.Stack.html#findS"><span class="hs-identifier hs-type">findS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445572"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679445572"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679445572"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-197"></span><span id="findS"><span class="annot"><span class="annottext">findS :: forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><a href="XMonad.Util.Stack.html#findS"><span class="hs-identifier hs-var hs-var">findS</span></a></span></span><span> </span><span id="local-6989586621679445276"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445276"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679445275"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445275"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445275"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445276"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445275"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445273"><span class="hs-identifier hs-var">findUp</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445275"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445272"><span class="hs-identifier hs-var">findDown</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445275"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679445272"><span class="annot"><span class="annottext">findDown :: Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445272"><span class="hs-identifier hs-var hs-var">findDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#reverseZ"><span class="hs-identifier hs-var">reverseZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445273"><span class="hs-identifier hs-var">findUp</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><a href="XMonad.Util.Stack.html#reverseS"><span class="hs-identifier hs-var">reverseS</span></a></span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621679445273"><span class="annot"><span class="annottext">findUp :: Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445273"><span class="hs-identifier hs-var hs-var">findUp</span></a></span></span><span> </span><span id="local-6989586621679445271"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445271"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679445270"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445270"><span class="hs-identifier hs-var">u</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445269"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445269"><span class="hs-identifier hs-var">ups</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445271"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445276"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445270"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679445273"><span class="hs-identifier hs-var">findUp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                                   </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445270"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445269"><span class="hs-identifier hs-var">ups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445271"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445271"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>                 </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | Refocus a @Zipper a@ on an element satisfying the predicate, or fail to</span><span>
</span><span id="line-204"></span><span class="hs-comment">--   @Nothing@.</span><span>
</span><span id="line-205"></span><span id="local-6989586621679445562"><span class="annot"><a href="XMonad.Util.Stack.html#findZ"><span class="hs-identifier hs-type">findZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445562"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-206"></span><span id="findZ"><span class="annot"><span class="annottext">findZ :: forall a. (a -&gt; Bool) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#findZ"><span class="hs-identifier hs-var hs-var">findZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-207"></span><span class="annot"><a href="XMonad.Util.Stack.html#findZ"><span class="hs-identifier hs-var">findZ</span></a></span><span> </span><span id="local-6989586621679445268"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445268"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445267"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445267"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><a href="XMonad.Util.Stack.html#findS"><span class="hs-identifier hs-var">findS</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445268"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445267"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- ** Extraction</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Get the focused element</span><span>
</span><span id="line-212"></span><span id="local-6989586621679445560"><span class="annot"><a href="XMonad.Util.Stack.html#getFocusZ"><span class="hs-identifier hs-type">getFocusZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445560"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679445560"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-213"></span><span id="getFocusZ"><span class="annot"><span class="annottext">getFocusZ :: forall a. Zipper a -&gt; Maybe a
</span><a href="XMonad.Util.Stack.html#getFocusZ"><span class="hs-identifier hs-var hs-var">getFocusZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-comment">-- | Get the element at a given index</span><span>
</span><span id="line-216"></span><span id="local-6989586621679445557"><span class="annot"><a href="XMonad.Util.Stack.html#getIZ"><span class="hs-identifier hs-type">getIZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679445557"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-217"></span><span id="getIZ"><span class="annot"><span class="annottext">getIZ :: forall a. Int -&gt; Zipper a -&gt; Maybe a
</span><a href="XMonad.Util.Stack.html#getIZ"><span class="hs-identifier hs-var hs-var">getIZ</span></a></span></span><span> </span><span id="local-6989586621679445265"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445265"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; Maybe a
</span><a href="XMonad.Util.Stack.html#getI"><span class="hs-identifier hs-var">getI</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445265"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- ** Sorting</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Sort a stack of elements supporting 'Ord'</span><span>
</span><span id="line-222"></span><span id="local-6989586621679445553"><span class="annot"><a href="XMonad.Util.Stack.html#sortZ"><span class="hs-identifier hs-type">sortZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679445553"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445553"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445553"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-223"></span><span id="sortZ"><span class="annot"><span class="annottext">sortZ :: forall a. Ord a =&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#sortZ"><span class="hs-identifier hs-var hs-var">sortZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#sortByZ"><span class="hs-identifier hs-var">sortByZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Sort a stack with an arbitrary sorting function</span><span>
</span><span id="line-226"></span><span id="local-6989586621679445551"><span class="annot"><a href="XMonad.Util.Stack.html#sortByZ"><span class="hs-identifier hs-type">sortByZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ordering</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445551"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445551"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-227"></span><span id="sortByZ"><span class="annot"><span class="annottext">sortByZ :: forall a. (a -&gt; a -&gt; Ordering) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#sortByZ"><span class="hs-identifier hs-var hs-var">sortByZ</span></a></span></span><span> </span><span id="local-6989586621679445260"><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679445260"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Ordering) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">sortBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {t} {t} {t}. (t -&gt; t -&gt; t) -&gt; Either t t -&gt; Either t t -&gt; t
</span><a href="#local-6989586621679445259"><span class="hs-identifier hs-var">adapt</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Ordering
</span><a href="#local-6989586621679445260"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679445259"><span class="annot"><span class="annottext">adapt :: (t -&gt; t -&gt; t) -&gt; Either t t -&gt; Either t t -&gt; t
</span><a href="#local-6989586621679445259"><span class="hs-identifier hs-var hs-var">adapt</span></a></span></span><span> </span><span id="local-6989586621679445258"><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679445258"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679445257"><span class="annot"><span class="annottext">Either t t
</span><a href="#local-6989586621679445257"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621679445256"><span class="annot"><span class="annottext">Either t t
</span><a href="#local-6989586621679445256"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
</span><a href="#local-6989586621679445258"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Either a a -&gt; a
</span><a href="XMonad.Util.Stack.html#fromE"><span class="hs-identifier hs-var">fromE</span></a></span><span> </span><span class="annot"><span class="annottext">Either t t
</span><a href="#local-6989586621679445257"><span class="hs-identifier hs-var">e1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Either a a -&gt; a
</span><a href="XMonad.Util.Stack.html#fromE"><span class="hs-identifier hs-var">fromE</span></a></span><span> </span><span class="annot"><span class="annottext">Either t t
</span><a href="#local-6989586621679445256"><span class="hs-identifier hs-var">e2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- ** Maps</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Map a function over a stack. The boolean argument indcates whether</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- the current element is the focused one</span><span>
</span><span id="line-234"></span><span id="local-6989586621679445542"><span id="local-6989586621679445543"><span class="annot"><a href="XMonad.Util.Stack.html#mapZ"><span class="hs-identifier hs-type">mapZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445542"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445542"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-235"></span><span id="mapZ"><span class="annot"><span class="annottext">mapZ :: forall a b. (Bool -&gt; a -&gt; b) -&gt; Zipper a -&gt; Zipper b
</span><a href="XMonad.Util.Stack.html#mapZ"><span class="hs-identifier hs-var hs-var">mapZ</span></a></span></span><span> </span><span id="local-6989586621679445255"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b
</span><a href="#local-6989586621679445255"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b) -&gt; Either a a -&gt; Either b b
</span><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-var">mapE</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b
</span><a href="#local-6989586621679445255"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | 'mapZ' without the 'Bool' argument</span><span>
</span><span id="line-238"></span><span id="local-6989586621679445536"><span id="local-6989586621679445537"><span class="annot"><a href="XMonad.Util.Stack.html#mapZ_"><span class="hs-identifier hs-type">mapZ_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445536"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445537"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445536"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-239"></span><span id="mapZ_"><span class="annot"><span class="annottext">mapZ_ :: forall a b. (a -&gt; b) -&gt; Zipper a -&gt; Zipper b
</span><a href="XMonad.Util.Stack.html#mapZ_"><span class="hs-identifier hs-var hs-var">mapZ_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b) -&gt; Zipper a -&gt; Zipper b
</span><a href="XMonad.Util.Stack.html#mapZ"><span class="hs-identifier hs-var">mapZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-comment">-- | Monadic version of 'mapZ'</span><span>
</span><span id="line-242"></span><span id="local-6989586621679445529"><span id="local-6989586621679445530"><span id="local-6989586621679445531"><span class="annot"><a href="XMonad.Util.Stack.html#mapZM"><span class="hs-identifier hs-type">mapZM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679445531"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445531"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445529"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445530"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445531"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445529"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-243"></span><span id="mapZM"><span class="annot"><span class="annottext">mapZM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Zipper a -&gt; m (Zipper b)
</span><a href="XMonad.Util.Stack.html#mapZM"><span class="hs-identifier hs-var hs-var">mapZM</span></a></span></span><span> </span><span id="local-6989586621679445243"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; m b
</span><a href="#local-6989586621679445243"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445242"><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445242"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Either a a -&gt; m (Either b b)
</span><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier hs-var">mapEM</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; m b
</span><a href="#local-6989586621679445243"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445242"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- | Monadic version of 'mapZ_'</span><span>
</span><span id="line-247"></span><span id="local-6989586621679445511"><span id="local-6989586621679445512"><span id="local-6989586621679445513"><span class="annot"><a href="XMonad.Util.Stack.html#mapZM_"><span class="hs-identifier hs-type">mapZM_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679445513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445511"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445512"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445513"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445511"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-248"></span><span id="mapZM_"><span class="annot"><span class="annottext">mapZM_ :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Zipper a -&gt; m (Zipper b)
</span><a href="XMonad.Util.Stack.html#mapZM_"><span class="hs-identifier hs-var hs-var">mapZM_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Zipper a -&gt; m (Zipper b)
</span><a href="XMonad.Util.Stack.html#mapZM"><span class="hs-identifier hs-var">mapZM</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- | Apply a function to the focused element</span><span>
</span><span id="line-251"></span><span id="local-6989586621679445507"><span class="annot"><a href="XMonad.Util.Stack.html#onFocusedZ"><span class="hs-identifier hs-type">onFocusedZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445507"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445507"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445507"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-252"></span><span id="onFocusedZ"><span class="annot"><span class="annottext">onFocusedZ :: forall a. (a -&gt; a) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#onFocusedZ"><span class="hs-identifier hs-var hs-var">onFocusedZ</span></a></span></span><span> </span><span id="local-6989586621679445237"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679445237"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b) -&gt; Zipper a -&gt; Zipper b
</span><a href="XMonad.Util.Stack.html#mapZ"><span class="hs-identifier hs-var">mapZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679445236"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445236"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679445235"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445235"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445236"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679445237"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445235"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445235"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span class="hs-comment">-- | Monadic version of 'onFocusedZ'</span><span>
</span><span id="line-255"></span><span id="local-6989586621679445504"><span id="local-6989586621679445505"><span class="annot"><a href="XMonad.Util.Stack.html#onFocusedZM"><span class="hs-identifier hs-type">onFocusedZM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679445505"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445505"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445505"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-256"></span><span id="onFocusedZM"><span class="annot"><span class="annottext">onFocusedZM :: forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; m a) -&gt; Zipper a -&gt; m (Zipper a)
</span><a href="XMonad.Util.Stack.html#onFocusedZM"><span class="hs-identifier hs-var hs-var">onFocusedZM</span></a></span></span><span> </span><span id="local-6989586621679445231"><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679445231"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Zipper a -&gt; m (Zipper b)
</span><a href="XMonad.Util.Stack.html#mapZM"><span class="hs-identifier hs-var">mapZM</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679445230"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445230"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679445229"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445229"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445230"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679445231"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445229"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445229"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Apply a function to the element at the given index</span><span>
</span><span id="line-259"></span><span id="local-6989586621679445500"><span class="annot"><a href="XMonad.Util.Stack.html#onIndexZ"><span class="hs-identifier hs-type">onIndexZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445500"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445500"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445500"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-260"></span><span id="onIndexZ"><span class="annot"><span class="annottext">onIndexZ :: forall a. Int -&gt; (a -&gt; a) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#onIndexZ"><span class="hs-identifier hs-var hs-var">onIndexZ</span></a></span></span><span> </span><span id="local-6989586621679445224"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445224"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679445223"><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445223"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445224"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445223"><span class="hs-keyword hs-var">as</span></a></span><span>
</span><span id="line-261"></span><span class="annot"><a href="XMonad.Util.Stack.html#onIndexZ"><span class="hs-identifier hs-var">onIndexZ</span></a></span><span> </span><span id="local-6989586621679445221"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445221"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679445220"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679445220"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445219"><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445219"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445221"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445219"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679445217"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445217"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445217"><span class="hs-identifier hs-var">before</span></a></span><span>
</span><span id="line-263"></span><span>                    </span><span class="hs-special">(</span><span id="local-6989586621679445216"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445216"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445215"><span class="annot"><span class="annottext">Either a a
</span><a href="#local-6989586621679445215"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445214"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445214"><span class="hs-identifier hs-var">after</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445216"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b) -&gt; Either a a -&gt; Either b b
</span><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-var">mapE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621679445220"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either a a
</span><a href="#local-6989586621679445215"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445214"><span class="hs-identifier hs-var">after</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Monadic version of 'onIndexZ'</span><span>
</span><span id="line-266"></span><span id="local-6989586621679445496"><span id="local-6989586621679445497"><span class="annot"><a href="XMonad.Util.Stack.html#onIndexZM"><span class="hs-identifier hs-type">onIndexZM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679445497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445496"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445496"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445497"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445496"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-267"></span><span id="onIndexZM"><span class="annot"><span class="annottext">onIndexZM :: forall (m :: * -&gt; *) a.
Monad m =&gt;
Int -&gt; (a -&gt; m a) -&gt; Zipper a -&gt; m (Zipper a)
</span><a href="XMonad.Util.Stack.html#onIndexZM"><span class="hs-identifier hs-var hs-var">onIndexZM</span></a></span></span><span> </span><span id="local-6989586621679445208"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445208"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679445207"><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679445207"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445206"><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445206"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. Int -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">splitAt</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445208"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span> </span><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445206"><span class="hs-keyword hs-var">as</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-268"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621679445205"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445205"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445205"><span class="hs-identifier hs-var">before</span></a></span><span>
</span><span id="line-269"></span><span>                     </span><span class="hs-special">(</span><span id="local-6989586621679445204"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445204"><span class="hs-identifier hs-var">before</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445203"><span class="annot"><span class="annottext">Either a a
</span><a href="#local-6989586621679445203"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445202"><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445202"><span class="hs-identifier hs-var">after</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679445201"><span class="annot"><span class="annottext">Either a a
</span><a href="#local-6989586621679445201"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Either a a -&gt; m (Either b b)
</span><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier hs-var">mapEM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679445207"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either a a
</span><a href="#local-6989586621679445203"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-270"></span><span>                                             </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445204"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Either a a
</span><a href="#local-6989586621679445201"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Either a a]
</span><a href="#local-6989586621679445202"><span class="hs-identifier hs-var">after</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- ** Filters</span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-comment">-- | Fiter a stack according to a predicate. The refocusing behavior</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- mimics XMonad's usual one. The boolean argument indicates whether the current</span><span>
</span><span id="line-276"></span><span class="hs-comment">-- element is the focused one.</span><span>
</span><span id="line-277"></span><span id="local-6989586621679445493"><span class="annot"><a href="XMonad.Util.Stack.html#filterZ"><span class="hs-identifier hs-type">filterZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445493"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445493"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-278"></span><span id="filterZ"><span class="annot"><span class="annottext">filterZ :: forall a. (Bool -&gt; a -&gt; Bool) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#filterZ"><span class="hs-identifier hs-var hs-var">filterZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-279"></span><span class="annot"><a href="XMonad.Util.Stack.html#filterZ"><span class="hs-identifier hs-var">filterZ</span></a></span><span> </span><span id="local-6989586621679445200"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
</span><a href="#local-6989586621679445200"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445199"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
</span><a href="#local-6989586621679445200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-280"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
</span><a href="#local-6989586621679445200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
</span><a href="#local-6989586621679445200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445198"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445198"><span class="hs-identifier hs-var">up'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445197"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445197"><span class="hs-identifier hs-var">down'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445198"><span class="hs-identifier hs-var">up'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445197"><span class="hs-identifier hs-var">down'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-284"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445196"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445196"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445195"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445195"><span class="hs-identifier hs-var">up'</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445196"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445195"><span class="hs-identifier hs-var">up'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-285"></span><span>                       </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445194"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445194"><span class="hs-identifier hs-var">up'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679445193"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445193"><span class="hs-identifier hs-var">f</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679445192"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445192"><span class="hs-identifier hs-var">down'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>  </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445199"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">focus :: a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445193"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-286"></span><span>                                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">up :: [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445194"><span class="hs-identifier hs-var">up'</span></a></span><span>
</span><span id="line-287"></span><span>                                                        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">down :: [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445192"><span class="hs-identifier hs-var">down'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | 'filterZ' without the 'Bool' argument</span><span>
</span><span id="line-290"></span><span id="local-6989586621679445191"><span class="annot"><a href="XMonad.Util.Stack.html#filterZ_"><span class="hs-identifier hs-type">filterZ_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445191"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-291"></span><span id="filterZ_"><span class="annot"><span class="annottext">filterZ_ :: forall a. (a -&gt; Bool) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#filterZ_"><span class="hs-identifier hs-var hs-var">filterZ_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Bool -&gt; a -&gt; Bool) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#filterZ"><span class="hs-identifier hs-var">filterZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Delete the focused element</span><span>
</span><span id="line-294"></span><span id="local-6989586621679445190"><span class="annot"><a href="XMonad.Util.Stack.html#deleteFocusedZ"><span class="hs-identifier hs-type">deleteFocusedZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445190"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445190"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-295"></span><span id="deleteFocusedZ"><span class="annot"><span class="annottext">deleteFocusedZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#deleteFocusedZ"><span class="hs-identifier hs-var hs-var">deleteFocusedZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Bool -&gt; a -&gt; Bool) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#filterZ"><span class="hs-identifier hs-var">filterZ</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679445189"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445189"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679445189"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Delete the ith element</span><span>
</span><span id="line-298"></span><span id="local-6989586621679445489"><span class="annot"><a href="XMonad.Util.Stack.html#deleteIndexZ"><span class="hs-identifier hs-type">deleteIndexZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445489"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445489"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-299"></span><span id="deleteIndexZ"><span class="annot"><span class="annottext">deleteIndexZ :: forall a. Int -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#deleteIndexZ"><span class="hs-identifier hs-var hs-var">deleteIndexZ</span></a></span></span><span> </span><span id="local-6989586621679445186"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445186"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679445185"><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445185"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445181"><span class="annot"><span class="annottext">numbered :: Zipper (Int, a)
</span><a href="#local-6989586621679445181"><span class="hs-identifier hs-var hs-var">numbered</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [Either a a] -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#fromTags"><span class="hs-identifier hs-var">fromTags</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">forall {a} {b}. a -&gt; Either b b -&gt; Either (a, b) (a, b)
</span><a href="#local-6989586621679445180"><span class="hs-identifier hs-var">number</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Zipper a -&gt; [Either a a]
</span><a href="XMonad.Util.Stack.html#toTags"><span class="hs-identifier hs-var">toTags</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Zipper a
</span><a href="#local-6989586621679445185"><span class="hs-identifier hs-var">z</span></a></span><span>
</span><span id="line-300"></span><span>                       </span><span id="local-6989586621679445180"><span class="annot"><span class="annottext">number :: a -&gt; Either b b -&gt; Either (a, b) (a, b)
</span><a href="#local-6989586621679445180"><span class="hs-identifier hs-var hs-var">number</span></a></span></span><span> </span><span id="local-6989586621679445179"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445179"><span class="hs-identifier hs-var">j</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b) -&gt; Either a a -&gt; Either b b
</span><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-var">mapE</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679445178"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445178"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445179"><span class="hs-identifier hs-var">j</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445178"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; Zipper a -&gt; Zipper b
</span><a href="XMonad.Util.Stack.html#mapZ_"><span class="hs-identifier hs-var">mapZ_</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#filterZ_"><span class="hs-identifier hs-var">filterZ_</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445186"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Zipper (Int, a)
</span><a href="#local-6989586621679445181"><span class="hs-identifier hs-var">numbered</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- ** Folds</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | Analogous to 'foldr'. The 'Bool' argument to the step functions indicates</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- whether the current element is the focused one</span><span>
</span><span id="line-307"></span><span id="local-6989586621679445480"><span id="local-6989586621679445481"><span class="annot"><a href="XMonad.Util.Stack.html#foldrZ"><span class="hs-identifier hs-type">foldrZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445480"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445480"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445480"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445481"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445480"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-308"></span><span id="foldrZ"><span class="annot"><span class="annottext">foldrZ :: forall a b. (Bool -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldrZ"><span class="hs-identifier hs-var hs-var">foldrZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679445177"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445177"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445177"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-309"></span><span class="annot"><a href="XMonad.Util.Stack.html#foldrZ"><span class="hs-identifier hs-var">foldrZ</span></a></span><span> </span><span id="local-6989586621679445176"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b -&gt; b
</span><a href="#local-6989586621679445176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445175"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445175"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445174"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445174"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445172"><span class="annot"><span class="annottext">b1 :: b
</span><a href="#local-6989586621679445172"><span class="hs-identifier hs-var hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b -&gt; b
</span><a href="#local-6989586621679445176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445175"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445174"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>                          </span><span id="local-6989586621679445171"><span class="annot"><span class="annottext">b2 :: b
</span><a href="#local-6989586621679445171"><span class="hs-identifier hs-var hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b -&gt; b
</span><a href="#local-6989586621679445176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445174"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445172"><span class="hs-identifier hs-var">b1</span></a></span><span>
</span><span id="line-311"></span><span>                          </span><span id="local-6989586621679445169"><span class="annot"><span class="annottext">b3 :: b
</span><a href="#local-6989586621679445169"><span class="hs-identifier hs-var hs-var">b3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b -&gt; b
</span><a href="#local-6989586621679445176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445171"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445174"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445169"><span class="hs-identifier hs-var">b3</span></a></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-comment">-- | Analogous to 'foldl'. The 'Bool' argument to the step functions indicates</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- whether the current element is the focused one</span><span>
</span><span id="line-316"></span><span id="local-6989586621679445471"><span id="local-6989586621679445472"><span class="annot"><a href="XMonad.Util.Stack.html#foldlZ"><span class="hs-identifier hs-type">foldlZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445472"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445472"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445472"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445472"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-317"></span><span id="foldlZ"><span class="annot"><span class="annottext">foldlZ :: forall b a. (Bool -&gt; b -&gt; a -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldlZ"><span class="hs-identifier hs-var hs-var">foldlZ</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; a -&gt; b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679445166"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445166"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445166"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-318"></span><span class="annot"><a href="XMonad.Util.Stack.html#foldlZ"><span class="hs-identifier hs-var">foldlZ</span></a></span><span> </span><span id="local-6989586621679445165"><span class="annot"><span class="annottext">Bool -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679445165"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679445164"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445164"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679445163"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445163"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679445161"><span class="annot"><span class="annottext">b1 :: b
</span><a href="#local-6989586621679445161"><span class="hs-identifier hs-var hs-var">b1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679445165"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445164"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445163"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>                          </span><span id="local-6989586621679445160"><span class="annot"><span class="annottext">b2 :: b
</span><a href="#local-6989586621679445160"><span class="hs-identifier hs-var hs-var">b2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679445165"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445161"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445163"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>                          </span><span id="local-6989586621679445158"><span class="annot"><span class="annottext">b3 :: b
</span><a href="#local-6989586621679445158"><span class="hs-identifier hs-var hs-var">b3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679445165"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445160"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679445163"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>                      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679445158"><span class="hs-identifier hs-var">b3</span></a></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-comment">-- | 'foldrZ' without the 'Bool' argument.</span><span>
</span><span id="line-324"></span><span id="local-6989586621679445467"><span id="local-6989586621679445468"><span class="annot"><a href="XMonad.Util.Stack.html#foldrZ_"><span class="hs-identifier hs-type">foldrZ_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445467"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445467"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445467"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445468"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445467"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-325"></span><span id="foldrZ_"><span class="annot"><span class="annottext">foldrZ_ :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldrZ_"><span class="hs-identifier hs-var hs-var">foldrZ_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldrZ"><span class="hs-identifier hs-var">foldrZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span class="hs-comment">-- | 'foldlZ' without the 'Bool' argument.</span><span>
</span><span id="line-328"></span><span id="local-6989586621679445463"><span id="local-6989586621679445464"><span class="annot"><a href="XMonad.Util.Stack.html#foldlZ_"><span class="hs-identifier hs-type">foldlZ_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445464"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445463"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445464"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445464"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445463"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445464"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-329"></span><span id="foldlZ_"><span class="annot"><span class="annottext">foldlZ_ :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldlZ_"><span class="hs-identifier hs-var hs-var">foldlZ_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. (Bool -&gt; b -&gt; a -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldlZ"><span class="hs-identifier hs-var">foldlZ</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span class="hs-comment">-- | Find whether an element is present in a stack.</span><span>
</span><span id="line-332"></span><span id="local-6989586621679445460"><span class="annot"><a href="XMonad.Util.Stack.html#elemZ"><span class="hs-identifier hs-type">elemZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679445460"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445460"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445460"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-333"></span><span id="elemZ"><span class="annot"><span class="annottext">elemZ :: forall a. Eq a =&gt; a -&gt; Zipper a -&gt; Bool
</span><a href="XMonad.Util.Stack.html#elemZ"><span class="hs-identifier hs-var hs-var">elemZ</span></a></span></span><span> </span><span id="local-6989586621679445156"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445156"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; Zipper a -&gt; b
</span><a href="XMonad.Util.Stack.html#foldlZ_"><span class="hs-identifier hs-var">foldlZ_</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Bool
</span><a href="#local-6989586621679445155"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679445155"><span class="annot"><span class="annottext">step :: Bool -&gt; a -&gt; Bool
</span><a href="#local-6989586621679445155"><span class="hs-identifier hs-var hs-var">step</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-335"></span><span>          </span><span class="annot"><a href="#local-6989586621679445155"><span class="hs-identifier hs-var">step</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621679445153"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445153"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445153"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445156"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span class="hs-comment">-- * Other utility functions</span><span>
</span><span id="line-339"></span><span>
</span><span id="line-340"></span><span class="hs-comment">-- | Safe version of '!!'</span><span>
</span><span id="line-341"></span><span id="local-6989586621679445555"><span class="annot"><a href="XMonad.Util.Stack.html#getI"><span class="hs-identifier hs-type">getI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679445555"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679445555"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-342"></span><span id="getI"><span class="annot"><span class="annottext">getI :: forall a. Int -&gt; [a] -&gt; Maybe a
</span><a href="XMonad.Util.Stack.html#getI"><span class="hs-identifier hs-var hs-var">getI</span></a></span></span><span> </span><span id="local-6989586621679445152"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445152"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679445151"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445151"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445151"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; Maybe a
</span><a href="XMonad.Prelude.html#%21%3F"><span class="hs-operator hs-var">!?</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679445152"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-343"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">getI</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Prelude.(!?) instead.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | Map a function across both 'Left's and 'Right's.</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- The 'Bool' argument is 'True' in a 'Right', 'False'</span><span>
</span><span id="line-347"></span><span class="hs-comment">-- in a 'Left'.</span><span>
</span><span id="line-348"></span><span id="local-6989586621679445538"><span id="local-6989586621679445539"><span class="annot"><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-type">mapE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445539"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445538"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445539"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445539"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445538"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445538"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-349"></span><span id="mapE"><span class="annot"><span class="annottext">mapE :: forall a b. (Bool -&gt; a -&gt; b) -&gt; Either a a -&gt; Either b b
</span><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-var hs-var">mapE</span></a></span></span><span> </span><span id="local-6989586621679445150"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b
</span><a href="#local-6989586621679445150"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679445149"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445149"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b
</span><a href="#local-6989586621679445150"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445149"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-350"></span><span class="annot"><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-var">mapE</span></a></span><span> </span><span id="local-6989586621679445148"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b
</span><a href="#local-6989586621679445148"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679445147"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445147"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; b
</span><a href="#local-6989586621679445148"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445147"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-351"></span><span>
</span><span id="line-352"></span><span id="local-6989586621679445453"><span id="local-6989586621679445454"><span class="annot"><a href="XMonad.Util.Stack.html#mapE_"><span class="hs-identifier hs-type">mapE_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445453"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445454"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445453"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445453"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-353"></span><span id="mapE_"><span class="annot"><span class="annottext">mapE_ :: forall a b. (a -&gt; b) -&gt; Either a a -&gt; Either b b
</span><a href="XMonad.Util.Stack.html#mapE_"><span class="hs-identifier hs-var hs-var">mapE_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Bool -&gt; a -&gt; b) -&gt; Either a a -&gt; Either b b
</span><a href="XMonad.Util.Stack.html#mapE"><span class="hs-identifier hs-var">mapE</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">-- | Monadic version of 'mapE'</span><span>
</span><span id="line-356"></span><span id="local-6989586621679445514"><span id="local-6989586621679445515"><span id="local-6989586621679445516"><span class="annot"><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier hs-type">mapEM</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679445516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445514"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445516"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445514"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445514"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-357"></span><span id="mapEM"><span class="annot"><span class="annottext">mapEM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Either a a -&gt; m (Either b b)
</span><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier hs-var hs-var">mapEM</span></a></span></span><span> </span><span id="local-6989586621679445141"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; m b
</span><a href="#local-6989586621679445141"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679445140"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445140"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; m b
</span><a href="#local-6989586621679445141"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445140"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-358"></span><span class="annot"><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier hs-var">mapEM</span></a></span><span> </span><span id="local-6989586621679445139"><span class="annot"><span class="annottext">Bool -&gt; a -&gt; m b
</span><a href="#local-6989586621679445139"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679445138"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445138"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; m b
</span><a href="#local-6989586621679445139"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445138"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span id="local-6989586621679445445"><span id="local-6989586621679445446"><span id="local-6989586621679445447"><span class="annot"><a href="XMonad.Util.Stack.html#mapEM_"><span class="hs-identifier hs-type">mapEM_</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679445447"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445446"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445447"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445445"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445446"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445446"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445447"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445445"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445445"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-361"></span><span id="mapEM_"><span class="annot"><span class="annottext">mapEM_ :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; Either a a -&gt; m (Either b b)
</span><a href="XMonad.Util.Stack.html#mapEM_"><span class="hs-identifier hs-var hs-var">mapEM_</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
Monad m =&gt;
(Bool -&gt; a -&gt; m b) -&gt; Either a a -&gt; m (Either b b)
</span><a href="XMonad.Util.Stack.html#mapEM"><span class="hs-identifier hs-var">mapEM</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="hs-comment">-- | Get the @a@ from an @Either a a@</span><span>
</span><span id="line-364"></span><span id="local-6989586621679445544"><span class="annot"><a href="XMonad.Util.Stack.html#fromE"><span class="hs-identifier hs-type">fromE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445544"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445544"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-365"></span><span id="fromE"><span class="annot"><span class="annottext">fromE :: forall a. Either a a -&gt; a
</span><a href="XMonad.Util.Stack.html#fromE"><span class="hs-identifier hs-var hs-var">fromE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679445135"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445135"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445135"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-366"></span><span class="annot"><a href="XMonad.Util.Stack.html#fromE"><span class="hs-identifier hs-var">fromE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679445134"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445134"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445134"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="hs-comment">-- | Tag the element with 'Right' if the property is true, 'Left' otherwise</span><span>
</span><span id="line-369"></span><span id="local-6989586621679445440"><span class="annot"><a href="XMonad.Util.Stack.html#tagBy"><span class="hs-identifier hs-type">tagBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679445440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679445440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="#local-6989586621679445440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445440"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-370"></span><span id="tagBy"><span class="annot"><span class="annottext">tagBy :: forall a. (a -&gt; Bool) -&gt; a -&gt; Either a a
</span><a href="XMonad.Util.Stack.html#tagBy"><span class="hs-identifier hs-var hs-var">tagBy</span></a></span></span><span> </span><span id="local-6989586621679445133"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445133"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679445132"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445132"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679445133"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445132"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445132"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445132"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-comment">-- | Reverse a @Stack a@; O(1).</span><span>
</span><span id="line-373"></span><span id="local-6989586621679445563"><span class="annot"><a href="XMonad.Util.Stack.html#reverseS"><span class="hs-identifier hs-type">reverseS</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679445563"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679445563"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-374"></span><span id="reverseS"><span class="annot"><span class="annottext">reverseS :: forall a. Stack a -&gt; Stack a
</span><a href="XMonad.Util.Stack.html#reverseS"><span class="hs-identifier hs-var hs-var">reverseS</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679445131"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445131"><span class="hs-identifier hs-var">foc</span></a></span></span><span> </span><span id="local-6989586621679445130"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445130"><span class="hs-identifier hs-var">ups</span></a></span></span><span> </span><span id="local-6989586621679445129"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445129"><span class="hs-identifier hs-var">downs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679445131"><span class="hs-identifier hs-var">foc</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445129"><span class="hs-identifier hs-var">downs</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679445130"><span class="hs-identifier hs-var">ups</span></a></span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Reverse a @Zipper a@; O(1).</span><span>
</span><span id="line-377"></span><span id="local-6989586621679445128"><span class="annot"><a href="XMonad.Util.Stack.html#reverseZ"><span class="hs-identifier hs-type">reverseZ</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445128"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Stack.html#Zipper"><span class="hs-identifier hs-type">Zipper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679445128"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-378"></span><span id="reverseZ"><span class="annot"><span class="annottext">reverseZ :: forall a. Zipper a -&gt; Zipper a
</span><a href="XMonad.Util.Stack.html#reverseZ"><span class="hs-identifier hs-var hs-var">reverseZ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><a href="XMonad.Util.Stack.html#reverseS"><span class="hs-identifier hs-var">reverseS</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span></pre></body></html>