<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE CPP #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiWayIf #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-6"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Module      :  XMonad.Actions.TreeSelect</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Description :  Display workspaces or actions in a tree-like format.</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Copyright   :  (c) Tom Smeets &lt;tom.tsmeets@gmail.com&gt;</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Maintainer  :  Tom Smeets &lt;tom.tsmeets@gmail.com&gt;</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- TreeSelect displays your workspaces or actions in a Tree-like format.</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- You can select the desired workspace/action with the cursor or hjkl keys.</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- This module is fully configurable and very useful if you like to have a</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- lot of workspaces.</span><span>
</span><span id="line-23"></span><span class="hs-comment">--</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Only the nodes up to the currently selected are displayed.</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- This will be configurable in the near future by changing 'ts_hidechildren' to @False@, this is not yet implemented.</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &lt;&lt;https://wiki.haskell.org/wikiupload/thumb/0/0b/Treeselect-Workspace.png/800px-Treeselect-Workspace.png&gt;&gt;</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-30"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.TreeSelect</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">(</span><span>
</span><span id="line-32"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-34"></span><span>      </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselectWorkspace"><span class="hs-identifier">treeselectWorkspace</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#toWorkspaces"><span class="hs-identifier">toWorkspaces</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselectAction"><span class="hs-identifier">treeselectAction</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Configuring</span></span><span>
</span><span id="line-39"></span><span>      </span><span class="annot"><span class="hs-comment">-- $config</span></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Pixel</span></span><span>
</span><span id="line-41"></span><span>      </span><span class="annot"><span class="hs-comment">-- $pixel</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier">TSConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#tsDefaultConfig"><span class="hs-identifier">tsDefaultConfig</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">def</span></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Navigation</span></span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><span class="hs-comment">-- $navigation</span></span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#defaultNavigation"><span class="hs-identifier">defaultNavigation</span></a></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#select"><span class="hs-identifier">select</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#cancel"><span class="hs-identifier">cancel</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveParent"><span class="hs-identifier">moveParent</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveChild"><span class="hs-identifier">moveChild</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveNext"><span class="hs-identifier">moveNext</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#movePrev"><span class="hs-identifier">movePrev</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveHistBack"><span class="hs-identifier">moveHistBack</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveHistForward"><span class="hs-identifier">moveHistForward</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveTo"><span class="hs-identifier">moveTo</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Advanced usage</span></span><span>
</span><span id="line-61"></span><span>      </span><span class="annot"><span class="hs-comment">-- $advusage</span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier">TSNode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselect"><span class="hs-identifier">treeselect</span></a></span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselectAt"><span class="hs-identifier">treeselectAt</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tree</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Foreign</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">shiftL</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shiftR</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;.)</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftX</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html"><span class="hs-identifier">XMonad.Util.Font</span></a></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.NamedWindows.html"><span class="hs-identifier">XMonad.Util.NamedWindows</span></a></span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.TreeZipper.html"><span class="hs-identifier">XMonad.Util.TreeZipper</span></a></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.WorkspaceHistory.html"><span class="hs-identifier">XMonad.Hooks.WorkspaceHistory</span></a></span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span class="hs-cpp">

#ifdef XFT
</span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.X11.Xrender</span></span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Graphics.X11.Xft</span></span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- These imports are used in the following example</span><span>
</span><span id="line-90"></span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt; import Data.Tree</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt; import XMonad.Actions.TreeSelect</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.WorkspaceHistory</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt; import qualified XMonad.StackSet as W</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- For selecting Workspaces, you need to define them in a tree structure using 'Data.Tree.Node' instead of just a standard list</span><span>
</span><span id="line-97"></span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- Here is an example workspace-tree</span><span>
</span><span id="line-99"></span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt; myWorkspaces :: Forest String</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt; myWorkspaces = [ Node &quot;Browser&quot; [] -- a workspace for your browser</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt;                , Node &quot;Home&quot;       -- for everyday activity's</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt;                    [ Node &quot;1&quot; []   --  with 4 extra sub-workspaces, for even more activity's</span><span>
</span><span id="line-104"></span><span class="hs-comment">-- &gt;                    , Node &quot;2&quot; []</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- &gt;                    , Node &quot;3&quot; []</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- &gt;                    , Node &quot;4&quot; []</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;                    ]</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt;                , Node &quot;Programming&quot; -- for all your programming needs</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt;                    [ Node &quot;Haskell&quot; []</span><span>
</span><span id="line-110"></span><span class="hs-comment">-- &gt;                    , Node &quot;Docs&quot;    [] -- documentation</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- &gt;                    ]</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- &gt;                ]</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- Then add it to your 'XMonad.Core.workspaces' using the 'toWorkspaces' function.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- Optionally, if you add 'workspaceHistoryHook' to your 'logHook' you can use the \'o\' and \'i\' keys to select from previously-visited workspaces</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &gt; xmonad $ def { ...</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &gt;              , workspaces = toWorkspaces myWorkspaces</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- &gt;              , logHook = workspaceHistoryHook</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- &gt;              }</span><span>
</span><span id="line-122"></span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- After that you still need to bind buttons to 'treeselectWorkspace' to start selecting a workspaces and moving windows</span><span>
</span><span id="line-124"></span><span class="hs-comment">--</span><span>
</span><span id="line-125"></span><span class="hs-comment">-- you could bind @Mod-f@ to switch workspace</span><span>
</span><span id="line-126"></span><span class="hs-comment">--</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- &gt;  , ((modMask, xK_f), treeselectWorkspace myTreeConf myWorkspaces W.greedyView)</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- and bind @Mod-Shift-f@ to moving the focused windows to a workspace</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- &gt;  , ((modMask .|. shiftMask, xK_f), treeselectWorkspace myTreeConf myWorkspaces W.shift)</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="hs-comment">-- $config</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- The selection menu is very configurable, you can change the font, all colors and the sizes of the boxes.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- The default config defined as 'def'</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- &gt; def = TSConfig { ts_hidechildren = True</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- &gt;                , ts_background   = 0xc0c0c0c0</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- &gt;                , ts_font         = &quot;xft:Sans-16&quot;</span><span>
</span><span id="line-141"></span><span class="hs-comment">-- &gt;                , ts_node         = (0xff000000, 0xff50d0db)</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- &gt;                , ts_nodealt      = (0xff000000, 0xff10b8d6)</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- &gt;                , ts_highlight    = (0xffffffff, 0xffff0000)</span><span>
</span><span id="line-144"></span><span class="hs-comment">-- &gt;                , ts_extra        = 0xff000000</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- &gt;                , ts_node_width   = 200</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- &gt;                , ts_node_height  = 30</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- &gt;                , ts_originX      = 0</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- &gt;                , ts_originY      = 0</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- &gt;                , ts_indent       = 80</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- &gt;                , ts_navigate     = defaultNavigation</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- &gt;                }</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-comment">-- $pixel</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- The 'Pixel' Color format is in the form of @0xaarrggbb@</span><span>
</span><span id="line-156"></span><span class="hs-comment">--</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- Note that transparency is only supported if you have a window compositor running like &lt;https://github.com/chjj/compton compton&gt;</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">-- Some Examples:</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-162"></span><span class="hs-comment">-- white       = 0xffffffff</span><span>
</span><span id="line-163"></span><span class="hs-comment">-- black       = 0xff000000</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- red         = 0xffff0000</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- green       = 0xff00ff00</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- blue        = 0xff0000ff</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- transparent = 0x00000000</span><span>
</span><span id="line-168"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- $navigation</span><span>
</span><span id="line-171"></span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- Keybindings for navigations can also be modified</span><span>
</span><span id="line-173"></span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- This is the definition of 'defaultNavigation'</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- &gt; defaultNavigation :: M.Map (KeyMask, KeySym) (TreeSelect a (Maybe a))</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- &gt; defaultNavigation = M.fromList</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- &gt;     [ ((0, xK_Escape), cancel)</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- &gt;     , ((0, xK_Return), select)</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- &gt;     , ((0, xK_space),  select)</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- &gt;     , ((0, xK_Up),     movePrev)</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- &gt;     , ((0, xK_Down),   moveNext)</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- &gt;     , ((0, xK_Left),   moveParent)</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- &gt;     , ((0, xK_Right),  moveChild)</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- &gt;     , ((0, xK_k),      movePrev)</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- &gt;     , ((0, xK_j),      moveNext)</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- &gt;     , ((0, xK_h),      moveParent)</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- &gt;     , ((0, xK_l),      moveChild)</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- &gt;     , ((0, xK_o),      moveHistBack)</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- &gt;     , ((0, xK_i),      moveHistForward)</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- &gt;     ]</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- $advusage</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- This module can also be used to select any other action</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="hs-comment">-- | Extensive configuration for displaying the tree.</span><span>
</span><span id="line-197"></span><span class="hs-comment">--</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- This class also has a 'Default' instance</span><span>
</span><span id="line-199"></span><span class="hs-keyword">data</span><span> </span><span id="TSConfig"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-var">TSConfig</span></a></span></span><span> </span><span id="local-6989586621679451831"><span class="annot"><a href="#local-6989586621679451831"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TSConfig"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-var">TSConfig</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="ts_hidechildren"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Bool
</span><a href="XMonad.Actions.TreeSelect.html#ts_hidechildren"><span class="hs-identifier hs-var hs-var">ts_hidechildren</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-comment">-- ^ when enabled, only the parents (and their first children) of the current node will be shown (This feature is not yet implemented!)</span><span>
</span><span id="line-200"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_background"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#ts_background"><span class="hs-identifier hs-var hs-var">ts_background</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="hs-comment">-- ^ background color filling the entire screen.</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_font"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; WorkspaceId
</span><a href="XMonad.Actions.TreeSelect.html#ts_font"><span class="hs-identifier hs-var hs-var">ts_font</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ XMF font for drawing the node name extra text</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_node"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; (Pixel, Pixel)
</span><a href="XMonad.Actions.TreeSelect.html#ts_node"><span class="hs-identifier hs-var hs-var">ts_node</span></a></span></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ node foreground (text) and background color when not selected</span><span>
</span><span id="line-205"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_nodealt"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; (Pixel, Pixel)
</span><a href="XMonad.Actions.TreeSelect.html#ts_nodealt"><span class="hs-identifier hs-var hs-var">ts_nodealt</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ every other node will use this color instead of 'ts_node'</span><span>
</span><span id="line-206"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_highlight"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; (Pixel, Pixel)
</span><a href="XMonad.Actions.TreeSelect.html#ts_highlight"><span class="hs-identifier hs-var hs-var">ts_highlight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ node foreground (text) and background color when selected</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_extra"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#ts_extra"><span class="hs-identifier hs-var hs-var">ts_extra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="hs-comment">-- ^ extra text color</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_node_width"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_node_width"><span class="hs-identifier hs-var hs-var">ts_node_width</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ node width in pixels</span><span>
</span><span id="line-211"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_node_height"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_node_height"><span class="hs-identifier hs-var hs-var">ts_node_height</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ node height in pixels</span><span>
</span><span id="line-212"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_originX"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_originX"><span class="hs-identifier hs-var hs-var">ts_originX</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ tree X position on the screen in pixels</span><span>
</span><span id="line-213"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_originY"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_originY"><span class="hs-identifier hs-var hs-var">ts_originY</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ tree Y position on the screen in pixels</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_indent"><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_indent"><span class="hs-identifier hs-var hs-var">ts_indent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ indentation amount for each level in pixels</span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>                           </span><span class="hs-special">,</span><span> </span><span id="ts_navigate"><span class="annot"><span class="annottext">forall a.
TSConfig a -&gt; Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="XMonad.Actions.TreeSelect.html#ts_navigate"><span class="hs-identifier hs-var hs-var">ts_navigate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451831"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679451831"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ key bindings for navigating the tree</span><span>
</span><span id="line-218"></span><span>                           </span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679451809"><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451809"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>    </span><span id="local-6989586621679451374"><span class="annot"><span class="annottext">def :: TSConfig a
</span><a href="#local-6989586621679451374"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ts_hidechildren :: Bool
</span><a href="XMonad.Actions.TreeSelect.html#ts_hidechildren"><span class="hs-identifier hs-var">ts_hidechildren</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-222"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_background :: Pixel
</span><a href="XMonad.Actions.TreeSelect.html#ts_background"><span class="hs-identifier hs-var">ts_background</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xc0c0c0c0</span></span><span>
</span><span id="line-223"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_font :: WorkspaceId
</span><a href="XMonad.Actions.TreeSelect.html#ts_font"><span class="hs-identifier hs-var">ts_font</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;xft:Sans-16&quot;</span></span><span>
</span><span id="line-224"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_node :: (Pixel, Pixel)
</span><a href="XMonad.Actions.TreeSelect.html#ts_node"><span class="hs-identifier hs-var">ts_node</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff000000</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff50d0db</span></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_nodealt :: (Pixel, Pixel)
</span><a href="XMonad.Actions.TreeSelect.html#ts_nodealt"><span class="hs-identifier hs-var">ts_nodealt</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff000000</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff10b8d6</span></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_highlight :: (Pixel, Pixel)
</span><a href="XMonad.Actions.TreeSelect.html#ts_highlight"><span class="hs-identifier hs-var">ts_highlight</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xffffffff</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xffff0000</span></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_extra :: Pixel
</span><a href="XMonad.Actions.TreeSelect.html#ts_extra"><span class="hs-identifier hs-var">ts_extra</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff000000</span></span><span>
</span><span id="line-228"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_node_width :: Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_node_width"><span class="hs-identifier hs-var">ts_node_width</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">200</span></span><span>
</span><span id="line-229"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_node_height :: Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_node_height"><span class="hs-identifier hs-var">ts_node_height</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">30</span></span><span>
</span><span id="line-230"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_originX :: Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_originX"><span class="hs-identifier hs-var">ts_originX</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-231"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_originY :: Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_originY"><span class="hs-identifier hs-var">ts_originY</span></a></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-232"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_indent :: Int
</span><a href="XMonad.Actions.TreeSelect.html#ts_indent"><span class="hs-identifier hs-var">ts_indent</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">80</span></span><span>
</span><span id="line-233"></span><span>                   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ts_navigate :: Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="XMonad.Actions.TreeSelect.html#ts_navigate"><span class="hs-identifier hs-var">ts_navigate</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="XMonad.Actions.TreeSelect.html#defaultNavigation"><span class="hs-identifier hs-var">defaultNavigation</span></a></span><span>
</span><span id="line-234"></span><span>                   </span><span class="hs-special">}</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Default navigation</span><span>
</span><span id="line-237"></span><span class="hs-comment">--</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- * navigation using either arrow key or vi style hjkl</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- * Return or Space to confirm</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- * Escape or Backspace to cancel to</span><span>
</span><span id="line-241"></span><span id="local-6989586621679451808"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#defaultNavigation"><span class="hs-identifier hs-type">defaultNavigation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">M.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451808"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679451808"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-242"></span><span id="defaultNavigation"><span class="annot"><span class="annottext">defaultNavigation :: forall a. Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="XMonad.Actions.TreeSelect.html#defaultNavigation"><span class="hs-identifier hs-var hs-var">defaultNavigation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_Escape</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#cancel"><span class="hs-identifier hs-var">cancel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_Return</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#select"><span class="hs-identifier hs-var">select</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_space</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#select"><span class="hs-identifier hs-var">select</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_Up</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>     </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#movePrev"><span class="hs-identifier hs-var">movePrev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_Down</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveNext"><span class="hs-identifier hs-var">moveNext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_Left</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>   </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveParent"><span class="hs-identifier hs-var">moveParent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_Right</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>  </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveChild"><span class="hs-identifier hs-var">moveChild</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#movePrev"><span class="hs-identifier hs-var">movePrev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveNext"><span class="hs-identifier hs-var">moveNext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_h</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveParent"><span class="hs-identifier hs-var">moveParent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveChild"><span class="hs-identifier hs-var">moveChild</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_o</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveHistBack"><span class="hs-identifier hs-var">moveHistBack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">xK_i</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>      </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveHistForward"><span class="hs-identifier hs-var">moveHistForward</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Default configuration.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Using nice alternating blue nodes</span><span>
</span><span id="line-261"></span><span id="local-6989586621679451339"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#tsDefaultConfig"><span class="hs-identifier hs-type">tsDefaultConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451339"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-262"></span><span id="tsDefaultConfig"><span class="annot"><span class="annottext">tsDefaultConfig :: forall a. TSConfig a
</span><a href="XMonad.Actions.TreeSelect.html#tsDefaultConfig"><span class="hs-identifier hs-var hs-var">tsDefaultConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-263"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">tsDefaultConfig</span><span> </span><span class="hs-pragma">&quot;Use def (from Data.Default, and re-exported by XMonad.Actions.TreeSelect) instead.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | Tree Node With a name and extra text</span><span>
</span><span id="line-266"></span><span class="hs-keyword">data</span><span> </span><span id="TSNode"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-var">TSNode</span></a></span></span><span> </span><span id="local-6989586621679451800"><span class="annot"><a href="#local-6989586621679451800"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TSNode"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-var">TSNode</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="tsn_name"><span class="annot"><span class="annottext">forall a. TSNode a -&gt; WorkspaceId
</span><a href="XMonad.Actions.TreeSelect.html#tsn_name"><span class="hs-identifier hs-var hs-var">tsn_name</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-267"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="tsn_extra"><span class="annot"><span class="annottext">forall a. TSNode a -&gt; WorkspaceId
</span><a href="XMonad.Actions.TreeSelect.html#tsn_extra"><span class="hs-identifier hs-var hs-var">tsn_extra</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ extra text, displayed next to the node name</span><span>
</span><span id="line-268"></span><span>                       </span><span class="hs-special">,</span><span> </span><span id="tsn_value"><span class="annot"><span class="annottext">forall a. TSNode a -&gt; a
</span><a href="XMonad.Actions.TreeSelect.html#tsn_value"><span class="hs-identifier hs-var hs-var">tsn_value</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679451800"><span class="hs-identifier hs-type">a</span></a></span><span>      </span><span class="hs-comment">-- ^ value to return when this node is selected</span><span>
</span><span id="line-269"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | State used by TreeSelect.</span><span>
</span><span id="line-272"></span><span class="hs-comment">--</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- Contains all needed information such as the window, font and a zipper over the tree.</span><span>
</span><span id="line-274"></span><span class="hs-keyword">data</span><span> </span><span id="TSState"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSState"><span class="hs-identifier hs-var">TSState</span></a></span></span><span> </span><span id="local-6989586621679451795"><span class="annot"><a href="#local-6989586621679451795"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TSState"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSState"><span class="hs-identifier hs-var">TSState</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="tss_tree"><span class="annot"><span class="annottext">forall a. TSState a -&gt; TreeZipper (TSNode a)
</span><a href="XMonad.Actions.TreeSelect.html#tss_tree"><span class="hs-identifier hs-var hs-var">tss_tree</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.TreeZipper.html#TreeZipper"><span class="hs-identifier hs-type">TreeZipper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451795"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_window"><span class="annot"><span class="annottext">forall a. TSState a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_window"><span class="hs-identifier hs-var hs-var">tss_window</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-276"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_display"><span class="annot"><span class="annottext">forall a. TSState a -&gt; Display
</span><a href="XMonad.Actions.TreeSelect.html#tss_display"><span class="hs-identifier hs-var hs-var">tss_display</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span>
</span><span id="line-277"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_size"><span class="annot"><span class="annottext">forall a. TSState a -&gt; (Int, Int)
</span><a href="XMonad.Actions.TreeSelect.html#tss_size"><span class="hs-identifier hs-var hs-var">tss_size</span></a></span></span><span>     </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ size of 'tz_window'</span><span>
</span><span id="line-278"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_xfont"><span class="annot"><span class="annottext">forall a. TSState a -&gt; XMonadFont
</span><a href="XMonad.Actions.TreeSelect.html#tss_xfont"><span class="hs-identifier hs-var hs-var">tss_xfont</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span>
</span><span id="line-279"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_gc"><span class="annot"><span class="annottext">forall a. TSState a -&gt; GC
</span><a href="XMonad.Actions.TreeSelect.html#tss_gc"><span class="hs-identifier hs-var hs-var">tss_gc</span></a></span></span><span>       </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span>
</span><span id="line-280"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_visual"><span class="annot"><span class="annottext">forall a. TSState a -&gt; Visual
</span><a href="XMonad.Actions.TreeSelect.html#tss_visual"><span class="hs-identifier hs-var hs-var">tss_visual</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Visual</span></span><span>
</span><span id="line-281"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_colormap"><span class="annot"><span class="annottext">forall a. TSState a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_colormap"><span class="hs-identifier hs-var hs-var">tss_colormap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Colormap</span></span><span>
</span><span id="line-282"></span><span>                         </span><span class="hs-special">,</span><span> </span><span id="tss_history"><span class="annot"><span class="annottext">forall a. TSState a -&gt; ([[WorkspaceId]], [[WorkspaceId]])
</span><a href="XMonad.Actions.TreeSelect.html#tss_history"><span class="hs-identifier hs-var hs-var">tss_history</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ history zipper, navigated with 'moveHistBack' and 'moveHistForward'</span><span>
</span><span id="line-283"></span><span>                         </span><span class="hs-special">}</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | State monad transformer using 'TSState'</span><span>
</span><span id="line-286"></span><span class="hs-keyword">newtype</span><span> </span><span id="TreeSelect"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-var">TreeSelect</span></a></span></span><span> </span><span id="local-6989586621679451779"><span class="annot"><a href="#local-6989586621679451779"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679451778"><span class="annot"><a href="#local-6989586621679451778"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TreeSelect"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-var">TreeSelect</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="runTreeSelect"><span class="annot"><span class="annottext">forall a b.
TreeSelect a b -&gt; ReaderT (TSConfig a) (StateT (TSState a) X) b
</span><a href="XMonad.Actions.TreeSelect.html#runTreeSelect"><span class="hs-identifier hs-var hs-var">runTreeSelect</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451779"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSState"><span class="hs-identifier hs-type">TSState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451779"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679451778"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679451304"><span id="local-6989586621679451309"><span id="local-6989586621679451315"><span class="annot"><span class="annottext">forall {a}. Applicative (TreeSelect a)
forall a. a -&gt; TreeSelect a a
forall a a. a -&gt; TreeSelect a a
forall a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
forall a b.
TreeSelect a a -&gt; (a -&gt; TreeSelect a b) -&gt; TreeSelect a b
forall a a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
forall a a b.
TreeSelect a a -&gt; (a -&gt; TreeSelect a b) -&gt; TreeSelect a b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
return :: forall a. a -&gt; TreeSelect a a
$creturn :: forall a a. a -&gt; TreeSelect a a
&gt;&gt; :: forall a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
$c&gt;&gt; :: forall a a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
&gt;&gt;= :: forall a b.
TreeSelect a a -&gt; (a -&gt; TreeSelect a b) -&gt; TreeSelect a b
$c&gt;&gt;= :: forall a a b.
TreeSelect a a -&gt; (a -&gt; TreeSelect a b) -&gt; TreeSelect a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451272"><span id="local-6989586621679451277"><span id="local-6989586621679451282"><span id="local-6989586621679451287"><span id="local-6989586621679451293"><span class="annot"><span class="annottext">forall {a}. Functor (TreeSelect a)
forall a. a -&gt; TreeSelect a a
forall a a. a -&gt; TreeSelect a a
forall a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a a
forall a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
forall a b.
TreeSelect a (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
forall a a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a a
forall a a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
forall a a b.
TreeSelect a (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
forall a b c.
(a -&gt; b -&gt; c) -&gt; TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a c
forall a a b c.
(a -&gt; b -&gt; c) -&gt; TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
&lt;* :: forall a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a a
$c&lt;* :: forall a a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a a
*&gt; :: forall a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
$c*&gt; :: forall a a b. TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a b
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a c
$cliftA2 :: forall a a b c.
(a -&gt; b -&gt; c) -&gt; TreeSelect a a -&gt; TreeSelect a b -&gt; TreeSelect a c
&lt;*&gt; :: forall a b.
TreeSelect a (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
$c&lt;*&gt; :: forall a a b.
TreeSelect a (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
pure :: forall a. a -&gt; TreeSelect a a
$cpure :: forall a a. a -&gt; TreeSelect a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451259"><span id="local-6989586621679451265"><span class="annot"><span class="annottext">forall a b. a -&gt; TreeSelect a b -&gt; TreeSelect a a
forall a b. (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
forall a a b. a -&gt; TreeSelect a b -&gt; TreeSelect a a
forall a a b. (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
&lt;$ :: forall a b. a -&gt; TreeSelect a b -&gt; TreeSelect a a
$c&lt;$ :: forall a a b. a -&gt; TreeSelect a b -&gt; TreeSelect a a
fmap :: forall a b. (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
$cfmap :: forall a a b. (a -&gt; b) -&gt; TreeSelect a a -&gt; TreeSelect a b
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451239"><span id="local-6989586621679451244"><span id="local-6989586621679451250"><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSState"><span class="hs-identifier hs-type">TSState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451779"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span class="hs-special">,</span><span>  </span><span id="local-6989586621679451218"><span id="local-6989586621679451223"><span id="local-6989586621679451229"><span class="annot"><span class="hs-identifier hs-type">MonadReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451779"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451209"><span class="annot"><span class="annottext">forall a. Monad (TreeSelect a)
forall a. IO a -&gt; TreeSelect a a
forall a a. IO a -&gt; TreeSelect a a
forall (m :: * -&gt; *).
Monad m -&gt; (forall a. IO a -&gt; m a) -&gt; MonadIO m
liftIO :: forall a. IO a -&gt; TreeSelect a a
$cliftIO :: forall a a. IO a -&gt; TreeSelect a a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var">MonadIO</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-comment">-- | Lift the 'X' action into the 'XMonad.Actions.TreeSelect.TreeSelect' monad</span><span>
</span><span id="line-290"></span><span id="local-6989586621679451688"><span id="local-6989586621679451689"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#liftX"><span class="hs-identifier hs-type">liftX</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679451689"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451688"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451689"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-291"></span><span id="liftX"><span class="annot"><span class="annottext">liftX :: forall a b. X a -&gt; TreeSelect b a
</span><a href="XMonad.Actions.TreeSelect.html#liftX"><span class="hs-identifier hs-var hs-var">liftX</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b.
ReaderT (TSConfig a) (StateT (TSState a) X) b -&gt; TreeSelect a b
</span><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-var">TreeSelect</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Run Treeselect with a given config and tree.</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- This can be used for selectiong anything</span><span>
</span><span id="line-295"></span><span class="hs-comment">--</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- * for switching workspaces and moving windows use 'treeselectWorkspace'</span><span>
</span><span id="line-297"></span><span class="hs-comment">-- * for selecting actions use 'treeselectAction'</span><span>
</span><span id="line-298"></span><span id="local-6989586621679451676"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselect"><span class="hs-identifier hs-type">treeselect</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451676"><span class="hs-identifier hs-type">a</span></a></span><span>         </span><span class="hs-comment">-- ^ config file</span><span>
</span><span id="line-299"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ a list of 'Data.Tree.Tree's to select from.</span><span>
</span><span id="line-300"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679451676"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-301"></span><span id="treeselect"><span class="annot"><span class="annottext">treeselect :: forall a. TSConfig a -&gt; Forest (TSNode a) -&gt; X (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#treeselect"><span class="hs-identifier hs-var hs-var">treeselect</span></a></span></span><span> </span><span id="local-6989586621679451192"><span class="annot"><span class="annottext">TSConfig a
</span><a href="#local-6989586621679451192"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679451191"><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679451191"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
TSConfig a
-&gt; TreeZipper (TSNode a) -&gt; [[WorkspaceId]] -&gt; X (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#treeselectAt"><span class="hs-identifier hs-var">treeselectAt</span></a></span><span> </span><span class="annot"><span class="annottext">TSConfig a
</span><a href="#local-6989586621679451192"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Forest a -&gt; TreeZipper a
</span><a href="XMonad.Util.TreeZipper.html#fromForest"><span class="hs-identifier hs-var">fromForest</span></a></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679451191"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Same as 'treeselect' but ad a specific starting position</span><span>
</span><span id="line-304"></span><span id="local-6989586621679451673"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselectAt"><span class="hs-identifier hs-type">treeselectAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451673"><span class="hs-identifier hs-type">a</span></a></span><span>         </span><span class="hs-comment">-- ^ config file</span><span>
</span><span id="line-305"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.TreeZipper.html#TreeZipper"><span class="hs-identifier hs-type">TreeZipper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ tree structure with a cursor position (starting node)</span><span>
</span><span id="line-306"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ list of paths that can be navigated with 'moveHistBack' and 'moveHistForward' (bound to the 'o' and 'i' keys)</span><span>
</span><span id="line-307"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679451673"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-308"></span><span id="treeselectAt"><span class="annot"><span class="annottext">treeselectAt :: forall a.
TSConfig a
-&gt; TreeZipper (TSNode a) -&gt; [[WorkspaceId]] -&gt; X (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#treeselectAt"><span class="hs-identifier hs-var hs-var">treeselectAt</span></a></span></span><span> </span><span id="local-6989586621679451127"><span class="annot"><span class="annottext">conf :: TSConfig a
</span><a href="#local-6989586621679451127"><span class="hs-identifier hs-var">conf</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679451114"><span id="local-6989586621679451115"><span id="local-6989586621679451116"><span id="local-6989586621679451117"><span id="local-6989586621679451118"><span id="local-6989586621679451119"><span id="local-6989586621679451120"><span id="local-6989586621679451121"><span id="local-6989586621679451122"><span id="local-6989586621679451123"><span id="local-6989586621679451124"><span id="local-6989586621679451125"><span id="local-6989586621679451126"><span class="annot"><span class="annottext">Bool
Int
WorkspaceId
Pixel
(Pixel, Pixel)
Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_navigate :: Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_indent :: Int
ts_originY :: Int
ts_originX :: Int
ts_node_height :: Int
ts_node_width :: Int
ts_extra :: Pixel
ts_highlight :: (Pixel, Pixel)
ts_nodealt :: (Pixel, Pixel)
ts_node :: (Pixel, Pixel)
ts_font :: WorkspaceId
ts_background :: Pixel
ts_hidechildren :: Bool
ts_navigate :: forall a.
TSConfig a -&gt; Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_indent :: forall a. TSConfig a -&gt; Int
ts_originY :: forall a. TSConfig a -&gt; Int
ts_originX :: forall a. TSConfig a -&gt; Int
ts_node_height :: forall a. TSConfig a -&gt; Int
ts_node_width :: forall a. TSConfig a -&gt; Int
ts_extra :: forall a. TSConfig a -&gt; Pixel
ts_highlight :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_nodealt :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_node :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_font :: forall a. TSConfig a -&gt; WorkspaceId
ts_background :: forall a. TSConfig a -&gt; Pixel
ts_hidechildren :: forall a. TSConfig a -&gt; Bool
</span><a href="#local-6989586621679451114"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679451113"><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679451113"><span class="hs-identifier hs-var">zipper</span></a></span></span><span> </span><span id="local-6989586621679451112"><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679451112"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679451110"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-comment">-- create a window on the currently focused screen</span><span>
</span><span id="line-310"></span><span>    </span><span id="local-6989586621679451109"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451109"><span class="hs-identifier hs-var">rootw</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Pixel
</span><span class="hs-identifier hs-var">theRoot</span></span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">{</span><span id="local-6989586621679451102"><span id="local-6989586621679451103"><span id="local-6989586621679451104"><span id="local-6989586621679451105"><span class="annot"><span class="annottext">Position
Dimension
rect_x :: Rectangle -&gt; Position
rect_y :: Rectangle -&gt; Position
rect_width :: Rectangle -&gt; Dimension
rect_height :: Rectangle -&gt; Dimension
rect_height :: Dimension
rect_width :: Dimension
rect_y :: Position
rect_x :: Position
</span><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScreenDetail -&gt; Rectangle
</span><span class="hs-identifier hs-var">screenRect</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; sd
</span><span class="hs-identifier hs-var">W.screenDetail</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679451092"><span class="annot"><span class="annottext">VisualInfo
</span><a href="#local-6989586621679451092"><span class="hs-identifier hs-var">vinfo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Dimension -&gt; CInt -&gt; CInt -&gt; IO (Maybe VisualInfo)
</span><span class="hs-identifier hs-var">matchVisualInfo</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Dimension
</span><span class="hs-identifier hs-var">defaultScreen</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">4</span></span><span>
</span><span id="line-314"></span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679451088"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451088"><span class="hs-identifier hs-var">colormap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; Visual -&gt; CInt -&gt; IO Pixel
</span><span class="hs-identifier hs-var">createColormap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451109"><span class="hs-identifier hs-var">rootw</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VisualInfo -&gt; Visual
</span><span class="hs-identifier hs-var">visualInfo_visual</span></span><span> </span><span class="annot"><span class="annottext">VisualInfo
</span><a href="#local-6989586621679451092"><span class="hs-identifier hs-var">vinfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">allocNone</span></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span>    </span><span id="local-6989586621679451084"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (Ptr SetWindowAttributes -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">allocaSetWindowAttributes</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679451082"><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679451082"><span class="hs-identifier hs-var">attributes</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">set_override_redirect</span></span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679451082"><span class="hs-identifier hs-var">attributes</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">set_colormap</span></span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679451082"><span class="hs-identifier hs-var">attributes</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451088"><span class="hs-identifier hs-var">colormap</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">set_background_pixel</span></span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679451082"><span class="hs-identifier hs-var">attributes</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451125"><span class="hs-identifier hs-var">ts_background</span></a></span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">set_border_pixel</span></span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679451082"><span class="hs-identifier hs-var">attributes</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0</span></span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679451077"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451077"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Display
-&gt; Pixel
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; CInt
-&gt; CInt
-&gt; CInt
-&gt; Visual
-&gt; Pixel
-&gt; Ptr SetWindowAttributes
-&gt; IO Pixel
</span><span class="hs-identifier hs-var">createWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451109"><span class="hs-identifier hs-var">rootw</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679451105"><span class="hs-identifier hs-var">rect_x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679451104"><span class="hs-identifier hs-var">rect_y</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679451103"><span class="hs-identifier hs-var">rect_width</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679451102"><span class="hs-identifier hs-var">rect_height</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VisualInfo -&gt; CInt
</span><span class="hs-identifier hs-var">visualInfo_depth</span></span><span> </span><span class="annot"><span class="annottext">VisualInfo
</span><a href="#local-6989586621679451092"><span class="hs-identifier hs-var">vinfo</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">inputOutput</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VisualInfo -&gt; Visual
</span><span class="hs-identifier hs-var">visualInfo_visual</span></span><span> </span><span class="annot"><span class="annottext">VisualInfo
</span><a href="#local-6989586621679451092"><span class="hs-identifier hs-var">vinfo</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">cWColormap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">cWBorderPixel</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">cWBackPixel</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Ptr SetWindowAttributes
</span><a href="#local-6989586621679451082"><span class="hs-identifier hs-var">attributes</span></a></span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; ClassHint -&gt; IO ()
</span><span class="hs-identifier hs-var">setClassHint</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451077"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; WorkspaceId -&gt; ClassHint
</span><span class="hs-identifier hs-var">ClassHint</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;xmonad-tree_select&quot;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;xmonad&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451077"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>        </span><span class="hs-comment">-- TODO: move below?</span><span>
</span><span id="line-328"></span><span>        </span><span class="hs-comment">-- make the window visible</span><span>
</span><span id="line-329"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">mapWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>        </span><span class="hs-comment">-- listen to key and mouse button events</span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">selectInput</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">exposureMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">keyPressMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">buttonReleaseMask</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>        </span><span class="hs-comment">-- TODO: enable mouse select?</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-comment">-- and mouse button 1</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">Display
-&gt; Dimension
-&gt; KeyMask
-&gt; Pixel
-&gt; Bool
-&gt; Pixel
-&gt; CInt
-&gt; CInt
-&gt; Pixel
-&gt; Pixel
-&gt; IO ()
</span><span class="hs-identifier hs-var">grabButton</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">button1</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">anyModifier</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">buttonReleaseMask</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">none</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">none</span></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- grab the keyboard</span><span>
</span><span id="line-339"></span><span>    </span><span id="local-6989586621679451057"><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679451057"><span class="hs-identifier hs-var">status</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; Bool -&gt; CInt -&gt; CInt -&gt; Pixel -&gt; IO CInt
</span><span class="hs-identifier hs-var">grabKeyboard</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabModeAsync</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>    </span><span id="local-6989586621679451054"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679451054"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">CInt
</span><a href="#local-6989586621679451057"><span class="hs-identifier hs-var">status</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">grabSuccess</span></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-343"></span><span>            </span><span class="hs-comment">-- load the XMF font</span><span>
</span><span id="line-344"></span><span>            </span><span id="local-6989586621679451052"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679451052"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; IO GC
</span><span class="hs-identifier hs-var">createGC</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-345"></span><span>            </span><span id="local-6989586621679451050"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679451050"><span class="hs-identifier hs-var">xfont</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; X XMonadFont
</span><a href="XMonad.Util.Font.html#initXMF"><span class="hs-identifier hs-var">initXMF</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451124"><span class="hs-identifier hs-var">ts_font</span></a></span><span>
</span><span id="line-346"></span><span>
</span><span id="line-347"></span><span>            </span><span class="hs-comment">-- run the treeselect Monad</span><span>
</span><span id="line-348"></span><span>            </span><span id="local-6989586621679451048"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679451048"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b.
TreeSelect a b -&gt; ReaderT (TSConfig a) (StateT (TSState a) X) b
</span><a href="XMonad.Actions.TreeSelect.html#runTreeSelect"><span class="hs-identifier hs-var">runTreeSelect</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TSConfig a
</span><a href="#local-6989586621679451127"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>                </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSState"><span class="hs-identifier hs-type">TSState</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tss_tree :: TreeZipper (TSNode a)
</span><a href="XMonad.Actions.TreeSelect.html#tss_tree"><span class="hs-identifier hs-var">tss_tree</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679451113"><span class="hs-identifier hs-var">zipper</span></a></span><span>
</span><span id="line-350"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_window :: Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_window"><span class="hs-identifier hs-var">tss_window</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-351"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_display :: Display
</span><a href="XMonad.Actions.TreeSelect.html#tss_display"><span class="hs-identifier hs-var">tss_display</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span>
</span><span id="line-352"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_xfont :: XMonadFont
</span><a href="XMonad.Actions.TreeSelect.html#tss_xfont"><span class="hs-identifier hs-var">tss_xfont</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679451050"><span class="hs-identifier hs-var">xfont</span></a></span><span>
</span><span id="line-353"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_size :: (Int, Int)
</span><a href="XMonad.Actions.TreeSelect.html#tss_size"><span class="hs-identifier hs-var">tss_size</span></a></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679451103"><span class="hs-identifier hs-var">rect_width</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><a href="#local-6989586621679451102"><span class="hs-identifier hs-var">rect_height</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_gc :: GC
</span><a href="XMonad.Actions.TreeSelect.html#tss_gc"><span class="hs-identifier hs-var">tss_gc</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679451052"><span class="hs-identifier hs-var">gc</span></a></span><span>
</span><span id="line-355"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_visual :: Visual
</span><a href="XMonad.Actions.TreeSelect.html#tss_visual"><span class="hs-identifier hs-var">tss_visual</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VisualInfo -&gt; Visual
</span><span class="hs-identifier hs-var">visualInfo_visual</span></span><span> </span><span class="annot"><span class="annottext">VisualInfo
</span><a href="#local-6989586621679451092"><span class="hs-identifier hs-var">vinfo</span></a></span><span>
</span><span id="line-356"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_colormap :: Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_colormap"><span class="hs-identifier hs-var">tss_colormap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451088"><span class="hs-identifier hs-var">colormap</span></a></span><span>
</span><span id="line-357"></span><span>                       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tss_history :: ([[WorkspaceId]], [[WorkspaceId]])
</span><a href="XMonad.Actions.TreeSelect.html#tss_history"><span class="hs-identifier hs-var">tss_history</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679451112"><span class="hs-identifier hs-var">hist</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>                       </span><span class="hs-special">}</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span>            </span><span class="hs-comment">-- release the XMF font</span><span>
</span><span id="line-361"></span><span>            </span><span class="annot"><span class="annottext">XMonadFont -&gt; X ()
</span><a href="XMonad.Util.Font.html#releaseXMF"><span class="hs-identifier hs-var">releaseXMF</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679451050"><span class="hs-identifier hs-var">xfont</span></a></span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; IO ()
</span><span class="hs-identifier hs-var">freeGC</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679451052"><span class="hs-identifier hs-var">gc</span></a></span><span>
</span><span id="line-363"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679451048"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-comment">-- destroy the window</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">unmapWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">destroyWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451084"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">freeColormap</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679451088"><span class="hs-identifier hs-var">colormap</span></a></span><span>
</span><span id="line-372"></span><span>        </span><span class="hs-comment">-- Flush the output buffer and wait for all the events to be processed</span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-comment">-- TODO: is this needed?</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">sync</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679451110"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679451054"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="hs-comment">-- | Select a workspace and execute a \&quot;view\&quot; function from &quot;XMonad.StackSet&quot; on it.</span><span>
</span><span id="line-378"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselectWorkspace"><span class="hs-identifier hs-type">treeselectWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span>
</span><span id="line-379"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ your tree of workspace-names</span><span>
</span><span id="line-380"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ the \&quot;view\&quot; function.</span><span>
</span><span id="line-381"></span><span>                                                               </span><span class="hs-comment">-- Instances can be 'W.greedyView' for switching to a workspace</span><span>
</span><span id="line-382"></span><span>                                                               </span><span class="hs-comment">-- and/or 'W.shift' for moving the focused window to a selected workspace.</span><span>
</span><span id="line-383"></span><span>                                                               </span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span>                                                               </span><span class="hs-comment">-- These actions can also be combined by doing</span><span>
</span><span id="line-385"></span><span>                                                               </span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span>                                                               </span><span class="hs-comment">-- &gt; \i -&gt; W.greedyView i . W.shift i</span><span>
</span><span id="line-387"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span id="treeselectWorkspace"><span class="annot"><span class="annottext">treeselectWorkspace :: TSConfig WorkspaceId
-&gt; Forest WorkspaceId
-&gt; (WorkspaceId -&gt; WindowSet -&gt; WindowSet)
-&gt; X ()
</span><a href="XMonad.Actions.TreeSelect.html#treeselectWorkspace"><span class="hs-identifier hs-var hs-var">treeselectWorkspace</span></a></span></span><span> </span><span id="local-6989586621679451037"><span class="annot"><span class="annottext">TSConfig WorkspaceId
</span><a href="#local-6989586621679451037"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679451036"><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679451036"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span id="local-6989586621679451035"><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679451035"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-comment">-- get all defined workspaces</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-comment">-- They have to be set with 'toWorkspaces'!</span><span>
</span><span id="line-391"></span><span>    </span><span id="local-6989586621679451034"><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Pixel) Pixel]
</span><a href="#local-6989586621679451034"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-comment">-- check the 'XConfig.workspaces'</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">all</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Pixel) Pixel]
</span><a href="#local-6989586621679451034"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Forest WorkspaceId -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.TreeSelect.html#toWorkspaces"><span class="hs-identifier hs-var">toWorkspaces</span></a></span><span> </span><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679451036"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-comment">-- convert the 'Forest WorkspaceId' to 'Forest (TSNode WorkspaceId)'</span><span>
</span><span id="line-397"></span><span>        </span><span id="local-6989586621679451029"><span class="annot"><span class="annottext">[Tree (TSNode WorkspaceId)]
</span><a href="#local-6989586621679451029"><span class="hs-identifier hs-var">wsf</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
(Functor m, Applicative m, Monad m) =&gt;
[Tree a] -&gt; (a -&gt; m b) -&gt; m [Tree b]
</span><a href="XMonad.Actions.TreeSelect.html#forMForest"><span class="hs-identifier hs-var">forMForest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Forest WorkspaceId -&gt; Forest (WorkspaceId, WorkspaceId)
</span><a href="XMonad.Actions.TreeSelect.html#mkPaths"><span class="hs-identifier hs-var">mkPaths</span></a></span><span> </span><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679451036"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679451026"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451026"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679451025"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451025"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. WorkspaceId -&gt; WorkspaceId -&gt; a -&gt; TSNode a
</span><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-var">TSNode</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451026"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Does not exist!&quot;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a} {l}. WorkspaceId -&gt; Workspace a l Pixel -&gt; X (TSNode a)
</span><a href="#local-6989586621679451023"><span class="hs-identifier hs-var">mkNode</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451026"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679451021"><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Pixel) Pixel
</span><a href="#local-6989586621679451021"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451025"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceId (Layout Pixel) Pixel
</span><a href="#local-6989586621679451021"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Pixel) Pixel]
</span><a href="#local-6989586621679451034"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span>        </span><span class="hs-comment">-- get the current workspace path</span><span>
</span><span id="line-400"></span><span>        </span><span id="local-6989586621679451020"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451020"><span class="hs-identifier hs-var">me</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>        </span><span id="local-6989586621679451018"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679451018"><span class="hs-identifier hs-var">hist</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X [WorkspaceId]
</span><a href="XMonad.Hooks.WorkspaceHistory.html#workspaceHistory"><span class="hs-identifier hs-var">workspaceHistory</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><span class="annottext">forall a.
TSConfig a
-&gt; TreeZipper (TSNode a) -&gt; [[WorkspaceId]] -&gt; X (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#treeselectAt"><span class="hs-identifier hs-var">treeselectAt</span></a></span><span> </span><span class="annot"><span class="annottext">TSConfig WorkspaceId
</span><a href="#local-6989586621679451037"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall b a.
Eq b =&gt;
(a -&gt; b) -&gt; [b] -&gt; TreeZipper a -&gt; Maybe (TreeZipper a)
</span><a href="XMonad.Util.TreeZipper.html#followPath"><span class="hs-identifier hs-var">followPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TSNode a -&gt; WorkspaceId
</span><a href="XMonad.Actions.TreeSelect.html#tsn_name"><span class="hs-identifier hs-var">tsn_name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.TreeSelect.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451020"><span class="hs-identifier hs-var">me</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Forest a -&gt; TreeZipper a
</span><a href="XMonad.Util.TreeZipper.html#fromForest"><span class="hs-identifier hs-var">fromForest</span></a></span><span> </span><span class="annot"><span class="annottext">[Tree (TSNode WorkspaceId)]
</span><a href="#local-6989586621679451029"><span class="hs-identifier hs-var">wsf</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.TreeSelect.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679451018"><span class="hs-identifier hs-var">hist</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; WindowSet -&gt; WindowSet
</span><a href="#local-6989586621679451035"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>        </span><span class="hs-comment">-- error!</span><span>
</span><span id="line-406"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679451012"><span class="annot"><span class="annottext">msg :: WorkspaceId
</span><a href="#local-6989586621679451012"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId] -&gt; WorkspaceId
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;Please add:&quot;</span></span><span>
</span><span id="line-407"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;    workspaces = toWorkspaces myWorkspaces&quot;</span></span><span>
</span><span id="line-408"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;to your XMonad config!&quot;</span></span><span>
</span><span id="line-409"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-410"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;XConfig.workspaces: &quot;</span></span><span>
</span><span id="line-411"></span><span>                            </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceId (Layout Pixel) Pixel]
</span><a href="#local-6989586621679451034"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; WorkspaceId -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451012"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-413"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; WorkspaceId -&gt; m ()
</span><span class="hs-identifier hs-var">xmessage</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451012"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-414"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621679451023"><span class="annot"><span class="annottext">mkNode :: WorkspaceId -&gt; Workspace a l Pixel -&gt; X (TSNode a)
</span><a href="#local-6989586621679451023"><span class="hs-identifier hs-var hs-var">mkNode</span></a></span></span><span> </span><span id="local-6989586621679451001"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451001"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679451000"><span class="annot"><span class="annottext">Workspace a l Pixel
</span><a href="#local-6989586621679451000"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>        </span><span class="hs-comment">-- find the focused window's name on this workspace</span><span>
</span><span id="line-418"></span><span>        </span><span id="local-6989586621679450999"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450999"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; WorkspaceId
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Pixel -&gt; X NamedWindow
</span><a href="XMonad.Util.NamedWindows.html#getName"><span class="hs-identifier hs-var">getName</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">Workspace a l Pixel
</span><a href="#local-6989586621679451000"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. WorkspaceId -&gt; WorkspaceId -&gt; a -&gt; TSNode a
</span><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-var">TSNode</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679451001"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450999"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace a l Pixel
</span><a href="#local-6989586621679451000"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-comment">-- | Convert the workspace-tree to a flat list of paths such that XMonad can use them</span><span>
</span><span id="line-422"></span><span class="hs-comment">--</span><span>
</span><span id="line-423"></span><span class="hs-comment">-- The Nodes will be separated by a dot (\'.\') character</span><span>
</span><span id="line-424"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#toWorkspaces"><span class="hs-identifier hs-type">toWorkspaces</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">]</span><span>
</span><span id="line-425"></span><span id="toWorkspaces"><span class="annot"><span class="annottext">toWorkspaces :: Forest WorkspaceId -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.TreeSelect.html#toWorkspaces"><span class="hs-identifier hs-var hs-var">toWorkspaces</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Tree a -&gt; [a]
</span><span class="hs-identifier hs-var">flatten</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Forest WorkspaceId -&gt; Forest (WorkspaceId, WorkspaceId)
</span><a href="XMonad.Actions.TreeSelect.html#mkPaths"><span class="hs-identifier hs-var">mkPaths</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#mkPaths"><span class="hs-identifier hs-type">mkPaths</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span id="mkPaths"><span class="annot"><span class="annottext">mkPaths :: Forest WorkspaceId -&gt; Forest (WorkspaceId, WorkspaceId)
</span><a href="XMonad.Actions.TreeSelect.html#mkPaths"><span class="hs-identifier hs-var hs-var">mkPaths</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679450991"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450991"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679450990"><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679450990"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450991"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450991"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; Tree WorkspaceId -&gt; Tree (WorkspaceId, WorkspaceId)
</span><a href="#local-6989586621679450989"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450991"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679450990"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679450989"><span class="annot"><span class="annottext">f :: WorkspaceId -&gt; Tree WorkspaceId -&gt; Tree (WorkspaceId, WorkspaceId)
</span><a href="#local-6989586621679450989"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679450988"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450988"><span class="hs-identifier hs-var">pth</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679450987"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450987"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679450986"><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679450986"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679450985"><span class="annot"><span class="annottext">pth' :: WorkspaceId
</span><a href="#local-6989586621679450985"><span class="hs-identifier hs-var hs-var">pth'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450988"><span class="hs-identifier hs-var">pth</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450987"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-431"></span><span>                         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450987"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450985"><span class="hs-identifier hs-var">pth'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceId -&gt; Tree WorkspaceId -&gt; Tree (WorkspaceId, WorkspaceId)
</span><a href="#local-6989586621679450989"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450985"><span class="hs-identifier hs-var">pth'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Forest WorkspaceId
</span><a href="#local-6989586621679450986"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#splitPath"><span class="hs-identifier hs-type">splitPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-434"></span><span id="splitPath"><span class="annot"><span class="annottext">splitPath :: WorkspaceId -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.TreeSelect.html#splitPath"><span class="hs-identifier hs-var hs-var">splitPath</span></a></span></span><span> </span><span id="local-6989586621679450984"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450984"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450984"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679450982"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450982"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450982"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679450981"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450981"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679450980"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450980"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450981"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceId -&gt; [WorkspaceId]
</span><a href="XMonad.Actions.TreeSelect.html#splitPath"><span class="hs-identifier hs-var">splitPath</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450980"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | Select from a Tree of 'X' actions</span><span>
</span><span id="line-439"></span><span class="hs-comment">--</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- &lt;&lt;https://wiki.haskell.org/wikiupload/thumb/9/9b/Treeselect-Action.png/800px-Treeselect-Action.png&gt;&gt;</span><span>
</span><span id="line-441"></span><span class="hs-comment">--</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- Each of these actions have to be specified inside a 'TSNode'</span><span>
</span><span id="line-443"></span><span class="hs-comment">--</span><span>
</span><span id="line-444"></span><span class="hs-comment">-- Example</span><span>
</span><span id="line-445"></span><span class="hs-comment">--</span><span>
</span><span id="line-446"></span><span class="hs-comment">-- &gt; treeselectAction myTreeConf</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- &gt;    [ Node (TSNode &quot;Hello&quot;    &quot;displays hello&quot;      (spawn &quot;xmessage hello!&quot;)) []</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- &gt;    , Node (TSNode &quot;Shutdown&quot; &quot;Poweroff the system&quot; (spawn &quot;shutdown&quot;)) []</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- &gt;    , Node (TSNode &quot;Brightness&quot; &quot;Sets screen brightness using xbacklight&quot; (return ()))</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- &gt;        [ Node (TSNode &quot;Bright&quot; &quot;FULL POWER!!&quot;            (spawn &quot;xbacklight -set 100&quot;)) []</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- &gt;        , Node (TSNode &quot;Normal&quot; &quot;Normal Brightness (50%)&quot; (spawn &quot;xbacklight -set 50&quot;))  []</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- &gt;        , Node (TSNode &quot;Dim&quot;    &quot;Quite dark&quot;              (spawn &quot;xbacklight -set 10&quot;))  []</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- &gt;        ]</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- &gt;    ]</span><span>
</span><span id="line-455"></span><span id="local-6989586621679451573"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#treeselectAction"><span class="hs-identifier hs-type">treeselectAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679451573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679451573"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-456"></span><span id="treeselectAction"><span class="annot"><span class="annottext">treeselectAction :: forall a. TSConfig (X a) -&gt; Forest (TSNode (X a)) -&gt; X ()
</span><a href="XMonad.Actions.TreeSelect.html#treeselectAction"><span class="hs-identifier hs-var hs-var">treeselectAction</span></a></span></span><span> </span><span id="local-6989586621679450976"><span class="annot"><span class="annottext">TSConfig (X a)
</span><a href="#local-6989586621679450976"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679450975"><span class="annot"><span class="annottext">Forest (TSNode (X a))
</span><a href="#local-6989586621679450975"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. TSConfig a -&gt; Forest (TSNode a) -&gt; X (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#treeselect"><span class="hs-identifier hs-var">treeselect</span></a></span><span> </span><span class="annot"><span class="annottext">TSConfig (X a)
</span><a href="#local-6989586621679450976"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode (X a))
</span><a href="#local-6989586621679450975"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679450974"><span class="annot"><span class="annottext">X a
</span><a href="#local-6989586621679450974"><span class="hs-identifier hs-var">a</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">X a
</span><a href="#local-6989586621679450974"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><span class="annottext">Maybe (X a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span id="local-6989586621679451606"><span id="local-6989586621679451607"><span id="local-6989586621679451608"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#forMForest"><span class="hs-identifier hs-type">forMForest</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="#local-6989586621679451607"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679451607"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451606"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451608"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="#local-6989586621679451606"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-461"></span><span id="forMForest"><span class="annot"><span class="annottext">forMForest :: forall (m :: * -&gt; *) a b.
(Functor m, Applicative m, Monad m) =&gt;
[Tree a] -&gt; (a -&gt; m b) -&gt; m [Tree b]
</span><a href="XMonad.Actions.TreeSelect.html#forMForest"><span class="hs-identifier hs-var hs-var">forMForest</span></a></span></span><span> </span><span id="local-6989586621679450963"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679450963"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679450962"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679450962"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
(Functor m, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; Tree a -&gt; m (Tree b)
</span><a href="XMonad.Actions.TreeSelect.html#mapMTree"><span class="hs-identifier hs-var">mapMTree</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679450962"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679450963"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span id="local-6989586621679451560"><span id="local-6989586621679451561"><span id="local-6989586621679451562"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#mapMTree"><span class="hs-identifier hs-type">mapMTree</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451560"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="#local-6989586621679451561"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679451562"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tree</span></span><span> </span><span class="annot"><a href="#local-6989586621679451560"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-464"></span><span id="mapMTree"><span class="annot"><span class="annottext">mapMTree :: forall (m :: * -&gt; *) a b.
(Functor m, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; Tree a -&gt; m (Tree b)
</span><a href="XMonad.Actions.TreeSelect.html#mapMTree"><span class="hs-identifier hs-var hs-var">mapMTree</span></a></span></span><span> </span><span id="local-6989586621679450949"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679450949"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679450948"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679450948"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679450947"><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679450947"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [Tree a] -&gt; Tree a
</span><span class="hs-identifier hs-var">Node</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679450949"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679450948"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span>  </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b.
(Functor m, Applicative m, Monad m) =&gt;
(a -&gt; m b) -&gt; Tree a -&gt; m (Tree b)
</span><a href="XMonad.Actions.TreeSelect.html#mapMTree"><span class="hs-identifier hs-var">mapMTree</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679450949"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Tree a]
</span><a href="#local-6989586621679450947"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span>
</span><span id="line-467"></span><span class="hs-comment">-- | Quit returning the currently selected node</span><span>
</span><span id="line-468"></span><span id="local-6989586621679450945"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#select"><span class="hs-identifier hs-type">select</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450945"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450945"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-469"></span><span id="select"><span class="annot"><span class="annottext">select :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#select"><span class="hs-identifier hs-var hs-var">select</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. TSNode a -&gt; a
</span><a href="XMonad.Actions.TreeSelect.html#tsn_value"><span class="hs-identifier hs-var">tsn_value</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; a
</span><a href="XMonad.Util.TreeZipper.html#cursor"><span class="hs-identifier hs-var">cursor</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; TreeZipper (TSNode a)
</span><a href="XMonad.Actions.TreeSelect.html#tss_tree"><span class="hs-identifier hs-var">tss_tree</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span class="hs-comment">-- | Quit without returning anything</span><span>
</span><span id="line-472"></span><span id="local-6989586621679451802"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#cancel"><span class="hs-identifier hs-type">cancel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451802"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679451802"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-473"></span><span id="cancel"><span class="annot"><span class="annottext">cancel :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#cancel"><span class="hs-identifier hs-var hs-var">cancel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-- TODO: redraw only what is necessary.</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- Examples: redrawAboveCursor, redrawBelowCursor and redrawCursor</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- | Move the cursor to its parent node</span><span>
</span><span id="line-479"></span><span id="local-6989586621679450941"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveParent"><span class="hs-identifier hs-type">moveParent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450941"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450941"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-480"></span><span id="moveParent"><span class="annot"><span class="annottext">moveParent :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveParent"><span class="hs-identifier hs-var hs-var">moveParent</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a)))
-&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-var">moveWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; Maybe (TreeZipper a)
</span><a href="XMonad.Util.TreeZipper.html#parent"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- | Move the cursor one level down, highlighting its first child-node</span><span>
</span><span id="line-483"></span><span id="local-6989586621679450936"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveChild"><span class="hs-identifier hs-type">moveChild</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450936"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450936"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-484"></span><span id="moveChild"><span class="annot"><span class="annottext">moveChild :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveChild"><span class="hs-identifier hs-var hs-var">moveChild</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a)))
-&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-var">moveWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; Maybe (TreeZipper a)
</span><a href="XMonad.Util.TreeZipper.html#children"><span class="hs-identifier hs-var">children</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="hs-comment">-- | Move the cursor to the next child-node</span><span>
</span><span id="line-487"></span><span id="local-6989586621679450932"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveNext"><span class="hs-identifier hs-type">moveNext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450932"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450932"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-488"></span><span id="moveNext"><span class="annot"><span class="annottext">moveNext :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveNext"><span class="hs-identifier hs-var hs-var">moveNext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a)))
-&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-var">moveWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; Maybe (TreeZipper a)
</span><a href="XMonad.Util.TreeZipper.html#nextChild"><span class="hs-identifier hs-var">nextChild</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | Move the cursor to the previous child-node</span><span>
</span><span id="line-491"></span><span id="local-6989586621679450928"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#movePrev"><span class="hs-identifier hs-type">movePrev</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450928"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450928"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-492"></span><span id="movePrev"><span class="annot"><span class="annottext">movePrev :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#movePrev"><span class="hs-identifier hs-var hs-var">movePrev</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a)))
-&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-var">moveWith</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; Maybe (TreeZipper a)
</span><a href="XMonad.Util.TreeZipper.html#previousChild"><span class="hs-identifier hs-var">previousChild</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- | Move backwards in history</span><span>
</span><span id="line-495"></span><span id="local-6989586621679450924"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveHistBack"><span class="hs-identifier hs-type">moveHistBack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450924"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450924"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-496"></span><span id="moveHistBack"><span class="annot"><span class="annottext">moveHistBack :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveHistBack"><span class="hs-identifier hs-var hs-var">moveHistBack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-497"></span><span>    </span><span id="local-6989586621679450919"><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450919"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-498"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; ([[WorkspaceId]], [[WorkspaceId]])
</span><a href="XMonad.Actions.TreeSelect.html#tss_history"><span class="hs-identifier hs-var">tss_history</span></a></span><span> </span><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450919"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-499"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679450917"><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450917"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679450916"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450916"><span class="hs-identifier hs-var">a</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679450915"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450915"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679450914"><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450914"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-500"></span><span>            </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450919"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">tss_history :: ([[WorkspaceId]], [[WorkspaceId]])
</span><a href="XMonad.Actions.TreeSelect.html#tss_history"><span class="hs-identifier hs-var">tss_history</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450916"><span class="hs-identifier hs-var">a</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450917"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450915"><span class="hs-identifier hs-var">y</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450914"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">forall a. [WorkspaceId] -&gt; TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveTo"><span class="hs-identifier hs-var">moveTo</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450915"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><span class="annottext">([[WorkspaceId]], [[WorkspaceId]])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span class="hs-comment">-- | Move forward in history</span><span>
</span><span id="line-505"></span><span id="local-6989586621679450912"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveHistForward"><span class="hs-identifier hs-type">moveHistForward</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450912"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450912"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-506"></span><span id="moveHistForward"><span class="annot"><span class="annottext">moveHistForward :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveHistForward"><span class="hs-identifier hs-var hs-var">moveHistForward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>    </span><span id="local-6989586621679450907"><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450907"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; ([[WorkspaceId]], [[WorkspaceId]])
</span><a href="XMonad.Actions.TreeSelect.html#tss_history"><span class="hs-identifier hs-var">tss_history</span></a></span><span> </span><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450907"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-509"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679450906"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450906"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679450905"><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450905"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679450904"><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450904"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-510"></span><span>            </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450907"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">tss_history :: ([[WorkspaceId]], [[WorkspaceId]])
</span><a href="XMonad.Actions.TreeSelect.html#tss_history"><span class="hs-identifier hs-var">tss_history</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450905"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450906"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[[WorkspaceId]]
</span><a href="#local-6989586621679450904"><span class="hs-identifier hs-var">ys</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-511"></span><span>            </span><span class="annot"><span class="annottext">forall a. [WorkspaceId] -&gt; TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveTo"><span class="hs-identifier hs-var">moveTo</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450906"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-512"></span><span>        </span><span class="annot"><span class="annottext">([[WorkspaceId]], [[WorkspaceId]])
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-513"></span><span>
</span><span id="line-514"></span><span class="hs-comment">-- | Move to a specific node</span><span>
</span><span id="line-515"></span><span id="local-6989586621679451543"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveTo"><span class="hs-identifier hs-type">moveTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ path, always starting from the top</span><span>
</span><span id="line-516"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451543"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679451543"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-517"></span><span id="moveTo"><span class="annot"><span class="annottext">moveTo :: forall a. [WorkspaceId] -&gt; TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#moveTo"><span class="hs-identifier hs-var hs-var">moveTo</span></a></span></span><span> </span><span id="local-6989586621679450900"><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450900"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
(TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a)))
-&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-var">moveWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b a.
Eq b =&gt;
(a -&gt; b) -&gt; [b] -&gt; TreeZipper a -&gt; Maybe (TreeZipper a)
</span><a href="XMonad.Util.TreeZipper.html#followPath"><span class="hs-identifier hs-var">followPath</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. TSNode a -&gt; WorkspaceId
</span><a href="XMonad.Actions.TreeSelect.html#tsn_name"><span class="hs-identifier hs-var">tsn_name</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceId]
</span><a href="#local-6989586621679450900"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; TreeZipper a
</span><a href="XMonad.Util.TreeZipper.html#rootNode"><span class="hs-identifier hs-var">rootNode</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var">redraw</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-comment">-- | Apply a transformation on the internal 'XMonad.Util.TreeZipper.TreeZipper'.</span><span>
</span><span id="line-520"></span><span id="local-6989586621679451549"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-type">moveWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.TreeZipper.html#TreeZipper"><span class="hs-identifier hs-type">TreeZipper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451549"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.TreeZipper.html#TreeZipper"><span class="hs-identifier hs-type">TreeZipper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451549"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451549"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-521"></span><span id="moveWith"><span class="annot"><span class="annottext">moveWith :: forall a.
(TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a)))
-&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#moveWith"><span class="hs-identifier hs-var hs-var">moveWith</span></a></span></span><span> </span><span id="local-6989586621679450894"><span class="annot"><span class="annottext">TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a))
</span><a href="#local-6989586621679450894"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621679450893"><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450893"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-523"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a) -&gt; Maybe (TreeZipper (TSNode a))
</span><a href="#local-6989586621679450894"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. TSState a -&gt; TreeZipper (TSNode a)
</span><a href="XMonad.Actions.TreeSelect.html#tss_tree"><span class="hs-identifier hs-var">tss_tree</span></a></span><span> </span><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450893"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-524"></span><span>        </span><span class="hs-comment">-- TODO: redraw cursor only?</span><span>
</span><span id="line-525"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679450892"><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450892"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">TSState a
</span><a href="#local-6989586621679450893"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tss_tree :: TreeZipper (TSNode a)
</span><a href="XMonad.Actions.TreeSelect.html#tss_tree"><span class="hs-identifier hs-var">tss_tree</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450892"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-526"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TreeZipper (TSNode a))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">-- | wait for keys and run navigation</span><span>
</span><span id="line-529"></span><span id="local-6989586621679450891"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-type">navigate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679450891"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679450891"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-530"></span><span id="navigate"><span class="annot"><span class="annottext">navigate :: forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var hs-var">navigate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Display
</span><a href="XMonad.Actions.TreeSelect.html#tss_display"><span class="hs-identifier hs-var">tss_display</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679450864"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450864"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (XEventPtr -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">allocaXEvent</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679450862"><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679450862"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; XEventPtr -&gt; IO ()
</span><span class="hs-identifier hs-var">maskEvent</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450864"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">exposureMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">keyPressMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">buttonReleaseMask</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">buttonPressMask</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679450862"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span>    </span><span id="local-6989586621679450859"><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679450859"><span class="hs-identifier hs-var">ev</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">XEventPtr -&gt; IO Event
</span><span class="hs-identifier hs-var">getEvent</span></span><span> </span><span class="annot"><span class="annottext">XEventPtr
</span><a href="#local-6989586621679450862"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-534"></span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Dimension
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679450859"><span class="hs-identifier hs-var">ev</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">keyPress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>           </span><span id="local-6989586621679450855"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450855"><span class="hs-identifier hs-var">ks</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Display -&gt; KeyCode -&gt; CInt -&gt; IO Pixel
</span><span class="hs-identifier hs-var">keycodeToKeysym</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450864"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; KeyCode
</span><span class="hs-identifier hs-var">ev_keycode</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679450859"><span class="hs-identifier hs-var">ev</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-number">0</span></span><span>
</span><span id="line-537"></span><span>           </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-538"></span><span>               </span><span id="local-6989586621679450852"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679450852"><span class="hs-identifier hs-var">mask</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. X a -&gt; TreeSelect b a
</span><a href="XMonad.Actions.TreeSelect.html#liftX"><span class="hs-identifier hs-var">liftX</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">X (KeyMask -&gt; KeyMask)
</span><a href="XMonad.Prelude.html#cleanKeyMask"><span class="hs-identifier hs-var">cleanKeyMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Event -&gt; KeyMask
</span><span class="hs-identifier hs-var">ev_state</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679450859"><span class="hs-identifier hs-var">ev</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>               </span><span id="local-6989586621679450849"><span class="annot"><span class="annottext">Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="#local-6989586621679450849"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="annot"><span class="annottext">forall a.
TSConfig a -&gt; Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="XMonad.Actions.TreeSelect.html#ts_navigate"><span class="hs-identifier hs-var">ts_navigate</span></a></span><span>
</span><span id="line-540"></span><span>               </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679450852"><span class="hs-identifier hs-var">mask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450855"><span class="hs-identifier hs-var">ks</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
</span><a href="#local-6989586621679450849"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-541"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Event -&gt; Dimension
</span><span class="hs-identifier hs-var">ev_event_type</span></span><span> </span><span class="annot"><span class="annottext">Event
</span><a href="#local-6989586621679450859"><span class="hs-identifier hs-var">ev</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Dimension
</span><span class="hs-identifier hs-var">buttonPress</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-542"></span><span>           </span><span class="hs-comment">-- See XMonad.Prompt Note [Allow ButtonEvents]</span><span>
</span><span id="line-543"></span><span>           </span><span class="annot"><span class="annottext">Display -&gt; CInt -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">allowEvents</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450864"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">CInt
</span><span class="hs-identifier hs-var">replayPointer</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-identifier hs-var">currentTime</span></span><span>
</span><span id="line-544"></span><span>           </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-545"></span><span>       </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeSelect a (Maybe a)
</span><a href="XMonad.Actions.TreeSelect.html#navigate"><span class="hs-identifier hs-var">navigate</span></a></span><span>
</span><span id="line-546"></span><span>
</span><span id="line-547"></span><span class="hs-comment">-- | Request a full redraw</span><span>
</span><span id="line-548"></span><span id="local-6989586621679451627"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-type">redraw</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451627"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-549"></span><span id="redraw"><span class="annot"><span class="annottext">redraw :: forall a. TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#redraw"><span class="hs-identifier hs-var hs-var">redraw</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679450833"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450833"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_window"><span class="hs-identifier hs-var">tss_window</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span id="local-6989586621679450832"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450832"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Display
</span><a href="XMonad.Actions.TreeSelect.html#tss_display"><span class="hs-identifier hs-var">tss_display</span></a></span><span>
</span><span id="line-552"></span><span>
</span><span id="line-553"></span><span>    </span><span class="hs-comment">-- clear window</span><span>
</span><span id="line-554"></span><span>    </span><span class="hs-comment">-- TODO: not always needed!</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">clearWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450832"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450833"><span class="hs-identifier hs-var">win</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span>    </span><span id="local-6989586621679450830"><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450830"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; TreeZipper (TSNode a)
</span><a href="XMonad.Actions.TreeSelect.html#tss_tree"><span class="hs-identifier hs-var">tss_tree</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a.
Int
-&gt; Int
-&gt; [(Forest (TSNode a), TSNode a, Forest (TSNode a))]
-&gt; TreeSelect a Int
</span><a href="XMonad.Actions.TreeSelect.html#drawLayers"><span class="hs-identifier hs-var">drawLayers</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; Forest a
</span><a href="XMonad.Util.TreeZipper.html#tz_before"><span class="hs-identifier hs-var">tz_before</span></a></span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450830"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; a
</span><a href="XMonad.Util.TreeZipper.html#cursor"><span class="hs-identifier hs-var">cursor</span></a></span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450830"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; Forest a
</span><a href="XMonad.Util.TreeZipper.html#tz_after"><span class="hs-identifier hs-var">tz_after</span></a></span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450830"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">forall a. TreeZipper a -&gt; [(Forest a, a, Forest a)]
</span><a href="XMonad.Util.TreeZipper.html#tz_parents"><span class="hs-identifier hs-var">tz_parents</span></a></span><span> </span><span class="annot"><span class="annottext">TreeZipper (TSNode a)
</span><a href="#local-6989586621679450830"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span id="local-6989586621679451527"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#drawLayers"><span class="hs-identifier hs-type">drawLayers</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ indentation level</span><span>
</span><span id="line-562"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ height</span><span>
</span><span id="line-563"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Forest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ node layers (from top to bottom!)</span><span>
</span><span id="line-564"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span><span>
</span><span id="line-565"></span><span id="drawLayers"><span class="annot"><span class="annottext">drawLayers :: forall a.
Int
-&gt; Int
-&gt; [(Forest (TSNode a), TSNode a, Forest (TSNode a))]
-&gt; TreeSelect a Int
</span><a href="XMonad.Actions.TreeSelect.html#drawLayers"><span class="hs-identifier hs-var hs-var">drawLayers</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679450799"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450799"><span class="hs-identifier hs-var">yl</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450799"><span class="hs-identifier hs-var">yl</span></a></span><span>
</span><span id="line-566"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#drawLayers"><span class="hs-identifier hs-var">drawLayers</span></a></span><span> </span><span id="local-6989586621679450798"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450798"><span class="hs-identifier hs-var">xl</span></a></span></span><span> </span><span id="local-6989586621679450797"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450797"><span class="hs-identifier hs-var">yl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679450796"><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679450796"><span class="hs-identifier hs-var">bs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679450795"><span class="annot"><span class="annottext">TSNode a
</span><a href="#local-6989586621679450795"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679450794"><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679450794"><span class="hs-keyword hs-var">as</span></a></span></span><span class="hs-special">)</span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679450793"><span class="annot"><span class="annottext">[(Forest (TSNode a), TSNode a, Forest (TSNode a))]
</span><a href="#local-6989586621679450793"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-567"></span><span>    </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679450780"><span id="local-6989586621679450781"><span id="local-6989586621679450782"><span id="local-6989586621679450783"><span id="local-6989586621679450784"><span id="local-6989586621679450785"><span id="local-6989586621679450786"><span id="local-6989586621679450787"><span id="local-6989586621679450788"><span id="local-6989586621679450789"><span id="local-6989586621679450790"><span id="local-6989586621679450791"><span id="local-6989586621679450792"><span class="annot"><span class="annottext">Bool
Int
WorkspaceId
Pixel
(Pixel, Pixel)
Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_navigate :: Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_indent :: Int
ts_originY :: Int
ts_originX :: Int
ts_node_height :: Int
ts_node_width :: Int
ts_extra :: Pixel
ts_highlight :: (Pixel, Pixel)
ts_nodealt :: (Pixel, Pixel)
ts_node :: (Pixel, Pixel)
ts_font :: WorkspaceId
ts_background :: Pixel
ts_hidechildren :: Bool
ts_navigate :: forall a.
TSConfig a -&gt; Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_indent :: forall a. TSConfig a -&gt; Int
ts_originY :: forall a. TSConfig a -&gt; Int
ts_originX :: forall a. TSConfig a -&gt; Int
ts_node_height :: forall a. TSConfig a -&gt; Int
ts_node_width :: forall a. TSConfig a -&gt; Int
ts_extra :: forall a. TSConfig a -&gt; Pixel
ts_highlight :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_nodealt :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_node :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_font :: forall a. TSConfig a -&gt; WorkspaceId
ts_background :: forall a. TSConfig a -&gt; Pixel
ts_hidechildren :: forall a. TSConfig a -&gt; Bool
</span><a href="#local-6989586621679450780"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679450776"><span class="annot"><span class="annottext">nodeColor :: a -&gt; (Pixel, Pixel)
</span><a href="#local-6989586621679450776"><span class="hs-identifier hs-var hs-var">nodeColor</span></a></span></span><span> </span><span id="local-6989586621679450775"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679450775"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a. Integral a =&gt; a -&gt; Bool
</span><span class="hs-identifier hs-var">odd</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679450775"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Pixel, Pixel)
</span><a href="#local-6989586621679450789"><span class="hs-identifier hs-var">ts_node</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">(Pixel, Pixel)
</span><a href="#local-6989586621679450788"><span class="hs-identifier hs-var">ts_nodealt</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span>    </span><span class="hs-comment">-- draw nodes above</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450797"><span class="hs-identifier hs-var">yl</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679450796"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679450772"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450772"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679450771"><span class="annot"><span class="annottext">TSNode a
</span><a href="#local-6989586621679450771"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><span class="annottext">forall a.
Int -&gt; Int -&gt; TSNode a -&gt; (Pixel, Pixel) -&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#drawNode"><span class="hs-identifier hs-var">drawNode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450798"><span class="hs-identifier hs-var">xl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450772"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">TSNode a
</span><a href="#local-6989586621679450771"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Integral a =&gt; a -&gt; (Pixel, Pixel)
</span><a href="#local-6989586621679450776"><span class="hs-identifier hs-var">nodeColor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450772"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>        </span><span class="hs-comment">-- drawLayers (xl + 1) (y + 1) ns</span><span>
</span><span id="line-575"></span><span>        </span><span class="hs-comment">-- TODO: draw rest? if not ts_hidechildren</span><span>
</span><span id="line-576"></span><span>        </span><span class="hs-comment">-- drawLayers (xl + 1) (y + 1) ns</span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>    </span><span class="hs-comment">-- draw the current / parent node</span><span>
</span><span id="line-579"></span><span>    </span><span class="hs-comment">-- if this is the last (currently focused) we use the 'ts_highlight' color</span><span>
</span><span id="line-580"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679450767"><span class="annot"><span class="annottext">current_level :: Int
</span><a href="#local-6989586621679450767"><span class="hs-identifier hs-var hs-var">current_level</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450797"><span class="hs-identifier hs-var">yl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679450796"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><span class="annottext">forall a.
Int -&gt; Int -&gt; TSNode a -&gt; (Pixel, Pixel) -&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#drawNode"><span class="hs-identifier hs-var">drawNode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450798"><span class="hs-identifier hs-var">xl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450767"><span class="hs-identifier hs-var">current_level</span></a></span><span> </span><span class="annot"><span class="annottext">TSNode a
</span><a href="#local-6989586621679450795"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-582"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(Forest (TSNode a), TSNode a, Forest (TSNode a))]
</span><a href="#local-6989586621679450793"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(Pixel, Pixel)
</span><a href="#local-6989586621679450787"><span class="hs-identifier hs-var">ts_highlight</span></a></span><span>
</span><span id="line-583"></span><span>                   </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall {a}. Integral a =&gt; a -&gt; (Pixel, Pixel)
</span><a href="#local-6989586621679450776"><span class="hs-identifier hs-var">nodeColor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450767"><span class="hs-identifier hs-var">current_level</span></a></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span>    </span><span id="local-6989586621679450763"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450763"><span class="hs-identifier hs-var">l2</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a.
Int
-&gt; Int
-&gt; [(Forest (TSNode a), TSNode a, Forest (TSNode a))]
-&gt; TreeSelect a Int
</span><a href="XMonad.Actions.TreeSelect.html#drawLayers"><span class="hs-identifier hs-var">drawLayers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450798"><span class="hs-identifier hs-var">xl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450767"><span class="hs-identifier hs-var">current_level</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Forest (TSNode a), TSNode a, Forest (TSNode a))]
</span><a href="#local-6989586621679450793"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span>    </span><span class="hs-comment">-- draw nodes below</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><span class="hs-identifier hs-var">forM_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450763"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679450794"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679450762"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450762"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Node</span></span><span> </span><span id="local-6989586621679450761"><span class="annot"><span class="annottext">TSNode a
</span><a href="#local-6989586621679450761"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-589"></span><span>        </span><span class="annot"><span class="annottext">forall a.
Int -&gt; Int -&gt; TSNode a -&gt; (Pixel, Pixel) -&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#drawNode"><span class="hs-identifier hs-var">drawNode</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450798"><span class="hs-identifier hs-var">xl</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450762"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">TSNode a
</span><a href="#local-6989586621679450761"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {a}. Integral a =&gt; a -&gt; (Pixel, Pixel)
</span><a href="#local-6989586621679450776"><span class="hs-identifier hs-var">nodeColor</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450762"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>        </span><span class="hs-comment">-- TODO: draw rest? if not ts_hidechildren</span><span>
</span><span id="line-591"></span><span>        </span><span class="hs-comment">-- drawLayers (xl + 1) (y + 1) ns</span><span>
</span><span id="line-592"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450763"><span class="hs-identifier hs-var">l2</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">Forest (TSNode a)
</span><a href="#local-6989586621679450794"><span class="hs-keyword hs-var">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span>
</span><span id="line-595"></span><span class="hs-comment">-- | Draw a node at a given indentation and height level</span><span>
</span><span id="line-596"></span><span id="local-6989586621679451515"><span class="annot"><a href="XMonad.Actions.TreeSelect.html#drawNode"><span class="hs-identifier hs-type">drawNode</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ indentation level (not in pixels)</span><span>
</span><span id="line-597"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ height level (not in pixels)</span><span>
</span><span id="line-598"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ node to draw</span><span>
</span><span id="line-599"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ node foreground (font) and background color</span><span>
</span><span id="line-600"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TreeSelect"><span class="hs-identifier hs-type">TreeSelect</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679451515"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-601"></span><span id="drawNode"><span class="annot"><span class="annottext">drawNode :: forall a.
Int -&gt; Int -&gt; TSNode a -&gt; (Pixel, Pixel) -&gt; TreeSelect a ()
</span><a href="XMonad.Actions.TreeSelect.html#drawNode"><span class="hs-identifier hs-var hs-var">drawNode</span></a></span></span><span> </span><span id="local-6989586621679450741"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450741"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span id="local-6989586621679450740"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450740"><span class="hs-identifier hs-var">iy</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSNode"><span class="hs-identifier hs-type">TSNode</span></a></span><span class="hs-special">{</span><span id="local-6989586621679450737"><span id="local-6989586621679450738"><span id="local-6989586621679450739"><span class="annot"><span class="annottext">a
WorkspaceId
tsn_value :: a
tsn_extra :: WorkspaceId
tsn_name :: WorkspaceId
tsn_value :: forall a. TSNode a -&gt; a
tsn_extra :: forall a. TSNode a -&gt; WorkspaceId
tsn_name :: forall a. TSNode a -&gt; WorkspaceId
</span><a href="#local-6989586621679450737"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679450736"><span class="annot"><span class="annottext">(Pixel, Pixel)
</span><a href="#local-6989586621679450736"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#TSConfig"><span class="hs-identifier hs-type">TSConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679450723"><span id="local-6989586621679450724"><span id="local-6989586621679450725"><span id="local-6989586621679450726"><span id="local-6989586621679450727"><span id="local-6989586621679450728"><span id="local-6989586621679450729"><span id="local-6989586621679450730"><span id="local-6989586621679450731"><span id="local-6989586621679450732"><span id="local-6989586621679450733"><span id="local-6989586621679450734"><span id="local-6989586621679450735"><span class="annot"><span class="annottext">Bool
Int
WorkspaceId
Pixel
(Pixel, Pixel)
Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_navigate :: Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_indent :: Int
ts_originY :: Int
ts_originX :: Int
ts_node_height :: Int
ts_node_width :: Int
ts_extra :: Pixel
ts_highlight :: (Pixel, Pixel)
ts_nodealt :: (Pixel, Pixel)
ts_node :: (Pixel, Pixel)
ts_font :: WorkspaceId
ts_background :: Pixel
ts_hidechildren :: Bool
ts_navigate :: forall a.
TSConfig a -&gt; Map (KeyMask, Pixel) (TreeSelect a (Maybe a))
ts_indent :: forall a. TSConfig a -&gt; Int
ts_originY :: forall a. TSConfig a -&gt; Int
ts_originX :: forall a. TSConfig a -&gt; Int
ts_node_height :: forall a. TSConfig a -&gt; Int
ts_node_width :: forall a. TSConfig a -&gt; Int
ts_extra :: forall a. TSConfig a -&gt; Pixel
ts_highlight :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_nodealt :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_node :: forall a. TSConfig a -&gt; (Pixel, Pixel)
ts_font :: forall a. TSConfig a -&gt; WorkspaceId
ts_background :: forall a. TSConfig a -&gt; Pixel
ts_hidechildren :: forall a. TSConfig a -&gt; Bool
</span><a href="#local-6989586621679450723"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679450722"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450722"><span class="hs-identifier hs-var">window</span></a></span></span><span>       </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_window"><span class="hs-identifier hs-var">tss_window</span></a></span><span>
</span><span id="line-604"></span><span>    </span><span id="local-6989586621679450721"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450721"><span class="hs-identifier hs-var">display</span></a></span></span><span>      </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Display
</span><a href="XMonad.Actions.TreeSelect.html#tss_display"><span class="hs-identifier hs-var">tss_display</span></a></span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679450720"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450720"><span class="hs-identifier hs-var">font</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; XMonadFont
</span><a href="XMonad.Actions.TreeSelect.html#tss_xfont"><span class="hs-identifier hs-var">tss_xfont</span></a></span><span>
</span><span id="line-606"></span><span>    </span><span id="local-6989586621679450719"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450719"><span class="hs-identifier hs-var">gc</span></a></span></span><span>           </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; GC
</span><a href="XMonad.Actions.TreeSelect.html#tss_gc"><span class="hs-identifier hs-var">tss_gc</span></a></span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621679450718"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450718"><span class="hs-identifier hs-var">colormap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Pixel
</span><a href="XMonad.Actions.TreeSelect.html#tss_colormap"><span class="hs-identifier hs-var">tss_colormap</span></a></span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621679450717"><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450717"><span class="hs-identifier hs-var">visual</span></a></span></span><span>   </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">forall a. TSState a -&gt; Visual
</span><a href="XMonad.Actions.TreeSelect.html#tss_visual"><span class="hs-identifier hs-var">tss_visual</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pixel
-&gt; Display
-&gt; Visual
-&gt; Pixel
-&gt; GC
-&gt; XMonadFont
-&gt; (Pixel, Pixel)
-&gt; WorkspaceId
-&gt; Pixel
-&gt; WorkspaceId
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; IO ()
</span><a href="XMonad.Actions.TreeSelect.html#drawWinBox"><span class="hs-identifier hs-var">drawWinBox</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450722"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450721"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450717"><span class="hs-identifier hs-var">visual</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450718"><span class="hs-identifier hs-var">colormap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450719"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450720"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">(Pixel, Pixel)
</span><a href="#local-6989586621679450736"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450739"><span class="hs-identifier hs-var">tsn_name</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450729"><span class="hs-identifier hs-var">ts_extra</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450738"><span class="hs-identifier hs-var">tsn_extra</span></a></span><span>
</span><span id="line-610"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450741"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450724"><span class="hs-identifier hs-var">ts_indent</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450726"><span class="hs-identifier hs-var">ts_originX</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450740"><span class="hs-identifier hs-var">iy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450727"><span class="hs-identifier hs-var">ts_node_height</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450725"><span class="hs-identifier hs-var">ts_originY</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>        </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450728"><span class="hs-identifier hs-var">ts_node_width</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450727"><span class="hs-identifier hs-var">ts_node_height</span></a></span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span>    </span><span class="hs-comment">-- TODO: draw extra text (transparent background? or ts_background)</span><span>
</span><span id="line-614"></span><span>    </span><span class="hs-comment">-- drawWinBox window fnt col2 nodeH (scW-x) (mes) (x+nodeW) y 8</span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span class="hs-comment">-- | Draw a simple box with text</span><span>
</span><span id="line-617"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#drawWinBox"><span class="hs-identifier hs-type">drawWinBox</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Visual</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Colormap</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span id="drawWinBox"><span class="annot"><span class="annottext">drawWinBox :: Pixel
-&gt; Display
-&gt; Visual
-&gt; Pixel
-&gt; GC
-&gt; XMonadFont
-&gt; (Pixel, Pixel)
-&gt; WorkspaceId
-&gt; Pixel
-&gt; WorkspaceId
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; Int
-&gt; IO ()
</span><a href="XMonad.Actions.TreeSelect.html#drawWinBox"><span class="hs-identifier hs-var hs-var">drawWinBox</span></a></span></span><span> </span><span id="local-6989586621679450714"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450714"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span id="local-6989586621679450713"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450713"><span class="hs-identifier hs-var">display</span></a></span></span><span> </span><span id="local-6989586621679450712"><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450712"><span class="hs-identifier hs-var">visual</span></a></span></span><span> </span><span id="local-6989586621679450711"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450711"><span class="hs-identifier hs-var">colormap</span></a></span></span><span> </span><span id="local-6989586621679450710"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450710"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span id="local-6989586621679450709"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450709"><span class="hs-identifier hs-var">font</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679450708"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450708"><span class="hs-identifier hs-var">fg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679450707"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450707"><span class="hs-identifier hs-var">bg</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679450706"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450706"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span id="local-6989586621679450705"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450705"><span class="hs-identifier hs-var">fg2</span></a></span></span><span> </span><span id="local-6989586621679450704"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450704"><span class="hs-identifier hs-var">text2</span></a></span></span><span> </span><span id="local-6989586621679450703"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450703"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679450702"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450702"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679450701"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450701"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679450700"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450700"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-619"></span><span>    </span><span class="hs-comment">-- draw box</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450713"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450710"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450707"><span class="hs-identifier hs-var">bg</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span class="annot"><span class="annottext">Display
-&gt; Pixel
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; Dimension
-&gt; Dimension
-&gt; IO ()
</span><span class="hs-identifier hs-var">fillRectangle</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450713"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450714"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450710"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450703"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450702"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450701"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450700"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-comment">-- dreaw text</span><span>
</span><span id="line-624"></span><span>    </span><span class="annot"><span class="annottext">Display
-&gt; Pixel
-&gt; Visual
-&gt; Pixel
-&gt; GC
-&gt; XMonadFont
-&gt; Pixel
-&gt; Position
-&gt; Position
-&gt; WorkspaceId
-&gt; IO ()
</span><a href="XMonad.Actions.TreeSelect.html#drawStringXMF"><span class="hs-identifier hs-var">drawStringXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450713"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450714"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450712"><span class="hs-identifier hs-var">visual</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450711"><span class="hs-identifier hs-var">colormap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450710"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450709"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450708"><span class="hs-identifier hs-var">fg</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450703"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450702"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450700"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-627"></span><span>        </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450706"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-628"></span><span>
</span><span id="line-629"></span><span>    </span><span class="hs-comment">-- dreaw extra text</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><span class="annottext">Display
-&gt; Pixel
-&gt; Visual
-&gt; Pixel
-&gt; GC
-&gt; XMonadFont
-&gt; Pixel
-&gt; Position
-&gt; Position
-&gt; WorkspaceId
-&gt; IO ()
</span><a href="XMonad.Actions.TreeSelect.html#drawStringXMF"><span class="hs-identifier hs-var">drawStringXMF</span></a></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450713"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450714"><span class="hs-identifier hs-var">win</span></a></span><span> </span><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450712"><span class="hs-identifier hs-var">visual</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450711"><span class="hs-identifier hs-var">colormap</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450710"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450709"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450705"><span class="hs-identifier hs-var">fg2</span></a></span><span>
</span><span id="line-631"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450703"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450701"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-632"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450702"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450700"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>        </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450704"><span class="hs-identifier hs-var">text2</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="hs-comment">-- | Modified version of 'XMonad.Util.Font.printStringXMF' that uses 'Pixel' as color format</span><span>
</span><span id="line-636"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#drawStringXMF"><span class="hs-identifier hs-type">drawStringXMF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Display</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Drawable</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Visual</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Colormap</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GC</span></span><span>
</span><span id="line-637"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Font.html#XMonadFont"><span class="hs-identifier hs-type">XMonadFont</span></a></span><span> </span><span class="hs-comment">-- ^ XMF Font</span><span>
</span><span id="line-638"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="hs-comment">-- ^ font color</span><span>
</span><span id="line-639"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>   </span><span class="hs-comment">-- ^ x-position</span><span>
</span><span id="line-640"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span>   </span><span class="hs-comment">-- ^ y-position</span><span>
</span><span id="line-641"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ string text</span><span>
</span><span id="line-642"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span id="drawStringXMF"><span class="annot"><span class="annottext">drawStringXMF :: Display
-&gt; Pixel
-&gt; Visual
-&gt; Pixel
-&gt; GC
-&gt; XMonadFont
-&gt; Pixel
-&gt; Position
-&gt; Position
-&gt; WorkspaceId
-&gt; IO ()
</span><a href="XMonad.Actions.TreeSelect.html#drawStringXMF"><span class="hs-identifier hs-var hs-var">drawStringXMF</span></a></span></span><span> </span><span id="local-6989586621679450695"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span></span><span> </span><span id="local-6989586621679450694"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450694"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span id="local-6989586621679450693"><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450693"><span class="hs-identifier hs-var">visual</span></a></span></span><span> </span><span id="local-6989586621679450692"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450692"><span class="hs-identifier hs-var">colormap</span></a></span></span><span> </span><span id="local-6989586621679450691"><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450691"><span class="hs-identifier hs-var">gc</span></a></span></span><span> </span><span id="local-6989586621679450690"><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450690"><span class="hs-identifier hs-var">font</span></a></span></span><span> </span><span id="local-6989586621679450689"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450689"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span id="local-6989586621679450688"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450688"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679450687"><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450687"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span id="local-6989586621679450686"><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450686"><span class="hs-identifier hs-var">text</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">XMonadFont
</span><a href="#local-6989586621679450690"><span class="hs-identifier hs-var">font</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><a href="XMonad.Util.Font.html#Core"><span class="hs-identifier hs-type">Core</span></a></span><span> </span><span id="local-6989586621679450684"><span class="annot"><span class="annottext">FontStruct
</span><a href="#local-6989586621679450684"><span class="hs-identifier hs-var">fnt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-645"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450691"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450689"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-646"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">setFont</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450691"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FontStruct -&gt; Pixel
</span><span class="hs-identifier hs-var">fontFromFontStruct</span></span><span> </span><span class="annot"><span class="annottext">FontStruct
</span><a href="#local-6989586621679450684"><span class="hs-identifier hs-var">fnt</span></a></span><span>
</span><span id="line-647"></span><span>        </span><span class="annot"><span class="annottext">Display
-&gt; Pixel -&gt; GC -&gt; Position -&gt; Position -&gt; WorkspaceId -&gt; IO ()
</span><span class="hs-identifier hs-var">drawImageString</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450694"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450691"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450688"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450687"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450686"><span class="hs-identifier hs-var">text</span></a></span><span>
</span><span id="line-648"></span><span>    </span><span class="annot"><a href="XMonad.Util.Font.html#Utf8"><span class="hs-identifier hs-type">Utf8</span></a></span><span> </span><span id="local-6989586621679450679"><span class="annot"><span class="annottext">FontSet
</span><a href="#local-6989586621679450679"><span class="hs-identifier hs-var">fnt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-649"></span><span>        </span><span class="annot"><span class="annottext">Display -&gt; GC -&gt; Pixel -&gt; IO ()
</span><span class="hs-identifier hs-var">setForeground</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450691"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450689"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-650"></span><span>        </span><span class="annot"><span class="annottext">Display
-&gt; Pixel
-&gt; FontSet
-&gt; GC
-&gt; Position
-&gt; Position
-&gt; WorkspaceId
-&gt; IO ()
</span><span class="hs-identifier hs-var">wcDrawImageString</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450694"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">FontSet
</span><a href="#local-6989586621679450679"><span class="hs-identifier hs-var">fnt</span></a></span><span> </span><span class="annot"><span class="annottext">GC
</span><a href="#local-6989586621679450691"><span class="hs-identifier hs-var">gc</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450688"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450687"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450686"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-cpp">
#ifdef XFT
</span><span>    </span><span class="annot"><a href="XMonad.Util.Font.html#Xft"><span class="hs-identifier hs-type">Xft</span></a></span><span> </span><span id="local-6989586621679450676"><span class="annot"><span class="annottext">NonEmpty XftFont
</span><a href="#local-6989586621679450676"><span class="hs-identifier hs-var">fnts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-653"></span><span>        </span><span class="annot"><span class="annottext">forall a.
Display -&gt; Pixel -&gt; Visual -&gt; Pixel -&gt; (XftDraw -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withXftDraw</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450694"><span class="hs-identifier hs-var">window</span></a></span><span> </span><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450693"><span class="hs-identifier hs-var">visual</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450692"><span class="hs-identifier hs-var">colormap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-654"></span><span>            </span><span class="hs-glyph">\</span><span id="local-6989586621679450674"><span class="annot"><span class="annottext">XftDraw
</span><a href="#local-6989586621679450674"><span class="hs-identifier hs-var">ft_draw</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a.
Display
-&gt; Visual -&gt; Pixel -&gt; XRenderColor -&gt; (XftColor -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withXftColorValue</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679450695"><span class="hs-identifier hs-var">display</span></a></span><span> </span><span class="annot"><span class="annottext">Visual
</span><a href="#local-6989586621679450693"><span class="hs-identifier hs-var">visual</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450692"><span class="hs-identifier hs-var">colormap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pixel -&gt; XRenderColor
</span><a href="XMonad.Actions.TreeSelect.html#fromARGB"><span class="hs-identifier hs-var">fromARGB</span></a></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450689"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span class="hs-cpp">
#if MIN_VERSION_X11_xft(0, 3, 4)
</span><span>            </span><span class="hs-glyph">\</span><span id="local-6989586621679450671"><span class="annot"><span class="annottext">XftColor
</span><a href="#local-6989586621679450671"><span class="hs-identifier hs-var">ft_color</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XftDraw
-&gt; XftColor -&gt; [XftFont] -&gt; Int -&gt; Int -&gt; WorkspaceId -&gt; IO ()
</span><span class="hs-identifier hs-var">xftDrawStringFallback</span></span><span> </span><span class="annot"><span class="annottext">XftDraw
</span><a href="#local-6989586621679450674"><span class="hs-identifier hs-var">ft_draw</span></a></span><span> </span><span class="annot"><span class="annottext">XftColor
</span><a href="#local-6989586621679450671"><span class="hs-identifier hs-var">ft_color</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NE.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty XftFont
</span><a href="#local-6989586621679450676"><span class="hs-identifier hs-var">fnts</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450688"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="XMonad.Prelude.html#fi"><span class="hs-identifier hs-var">fi</span></a></span><span> </span><span class="annot"><span class="annottext">Position
</span><a href="#local-6989586621679450687"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceId
</span><a href="#local-6989586621679450686"><span class="hs-identifier hs-var">text</span></a></span><span class="hs-cpp">
#else
</span><span>            </span><span class="hs-glyph">\</span><span class="hs-identifier">ft_color</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">xftDrawString</span><span> </span><span class="hs-identifier">ft_draw</span><span> </span><span class="hs-identifier">ft_color</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">NE.head</span><span> </span><span class="hs-identifier">fnts</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">x</span><span> </span><span class="hs-identifier">y</span><span> </span><span class="hs-identifier">text</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- | Convert 'Pixel' to 'XRenderColor'</span><span>
</span><span id="line-662"></span><span class="hs-comment">--</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- Note that it uses short to represent its components</span><span>
</span><span id="line-664"></span><span class="annot"><a href="XMonad.Actions.TreeSelect.html#fromARGB"><span class="hs-identifier hs-type">fromARGB</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pixel</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XRenderColor</span></span><span>
</span><span id="line-665"></span><span id="fromARGB"><span class="annot"><span class="annottext">fromARGB :: Pixel -&gt; XRenderColor
</span><a href="XMonad.Actions.TreeSelect.html#fromARGB"><span class="hs-identifier hs-var hs-var">fromARGB</span></a></span></span><span> </span><span id="local-6989586621679450667"><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450667"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span class="hs-cpp">
#if MIN_VERSION_X11_xft(0, 3, 3)
</span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int -&gt; Int -&gt; XRenderColor
</span><span class="hs-identifier hs-var">XRenderColor</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450665"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450664"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450663"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679450662"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-cpp">
#else
</span><span>    </span><span class="hs-comment">-- swapped green/blue as a workaround for the faulty Storable instance in X11-xft &lt; 0.3.3</span><span>
</span><span id="line-670"></span><span>    </span><span class="hs-identifier">XRenderColor</span><span> </span><span class="hs-identifier">r</span><span> </span><span class="hs-identifier">b</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-identifier">a</span><span class="hs-cpp">
#endif
</span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-673"></span><span>    </span><span id="local-6989586621679450665"><span class="annot"><span class="annottext">r :: Int
</span><a href="#local-6989586621679450665"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff00</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftR</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450667"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621679450664"><span class="annot"><span class="annottext">g :: Int
</span><a href="#local-6989586621679450664"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff00</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450667"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span id="local-6989586621679450663"><span class="annot"><span class="annottext">b :: Int
</span><a href="#local-6989586621679450663"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff00</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftL</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450667"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-676"></span><span>    </span><span id="local-6989586621679450662"><span class="annot"><span class="annottext">a :: Int
</span><a href="#local-6989586621679450662"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><span class="hs-number">0xff00</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.&amp;.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">shiftR</span></span><span> </span><span class="annot"><span class="annottext">Pixel
</span><a href="#local-6989586621679450667"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span class="hs-cpp">
#endif
</span></pre></body></html>