<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE InstanceSigs   #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns   #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Module      :  XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Description :  Toggle arbitrary windows to and from the current workspace.</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Copyright   :  (c) Konstantin Sobolev &lt;konstantin.sobolev@gmail.com&gt;</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- License     :  BSD-style (see LICENSE)</span><span>
</span><span id="line-10"></span><span class="hs-comment">--</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Maintainer  :  Konstantin Sobolev &lt;konstantin.sobolev@gmail.com&gt;</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-14"></span><span class="hs-comment">--</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Named scratchpads that support several arbitrary applications at the same time.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Util.NamedScratchpad</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier">NamedScratchpad</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier">scratchpadWorkspaceTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nonFloating"><span class="hs-identifier">nonFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#defaultFloating"><span class="hs-identifier">defaultFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customFloating"><span class="hs-identifier">customFloating</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier">NamedScratchpads</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadAction"><span class="hs-identifier">namedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#spawnHereNamedScratchpadAction"><span class="hs-identifier">spawnHereNamedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier">customRunNamedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#allNamedScratchpadAction"><span class="hs-identifier">allNamedScratchpadAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadManageHook"><span class="hs-identifier">namedScratchpadManageHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsHideOnFocusLoss"><span class="hs-identifier">nsHideOnFocusLoss</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsSingleScratchpadPerWorkspace"><span class="hs-identifier">nsSingleScratchpadPerWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Dynamic Scratchpads</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- $dynamic-scratchpads</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#dynamicNSPAction"><span class="hs-identifier">dynamicNSPAction</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#toggleDynamicNSP"><span class="hs-identifier">toggleDynamicNSP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Exclusive Scratchpads</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-comment">-- $exclusive-scratchpads</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#addExclusives"><span class="hs-identifier">addExclusives</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Keyboard related</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#resetFocusedNSP"><span class="hs-identifier">resetFocusedNSP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Mouse related</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#setNoexclusive"><span class="hs-identifier">setNoexclusive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#resizeNoexclusive"><span class="hs-identifier">resizeNoexclusive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#floatMoveNoexclusive"><span class="hs-identifier">floatMoveNoexclusive</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Deprecations</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier">namedScratchpadFilterOutWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspacePP"><span class="hs-identifier">namedScratchpadFilterOutWorkspacePP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(!?)</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html"><span class="hs-identifier">XMonad.Actions.DynamicWorkspaces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier">addHiddenWorkspace</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.SpawnOn.html"><span class="hs-identifier">XMonad.Actions.SpawnOn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.SpawnOn.html#spawnHere"><span class="hs-identifier">spawnHere</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Actions.TagWindows.html"><span class="hs-identifier">XMonad.Actions.TagWindows</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Actions.TagWindows.html#addTag"><span class="hs-identifier">addTag</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.TagWindows.html#delTag"><span class="hs-identifier">delTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html"><span class="hs-identifier">XMonad.Hooks.ManageHelpers</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier">doRectFloat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html"><span class="hs-identifier">XMonad.Hooks.RefocusLast</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier">withRecentsIn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html"><span class="hs-identifier">XMonad.Hooks.StatusBar.PP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier">PP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#ppSort"><span class="hs-identifier">ppSort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">appEndo</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filterM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prelude.html#findM"><span class="hs-identifier">findM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">for_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">liftA2</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unless</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=&lt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NE</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- Allows to have several floating scratchpads running different applications.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Bind a key to 'namedScratchpadAction'.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- Pressing it will spawn configured application, or bring it to the current</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- workspace if it already exists.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- Pressing the key with the application on the current workspace will</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- send it to a hidden workspace called @NSP@.</span><span>
</span><span id="line-80"></span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- If you already have a workspace called @NSP@, it will use that.</span><span>
</span><span id="line-82"></span><span class="hs-comment">-- @NSP@ will also appear in xmobar and dzen status bars. You can tweak your</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- @dynamicLog@ settings to filter it out if you like.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- Create named scratchpads configuration in your xmonad.hs like this:</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">-- &gt; import XMonad.StackSet as W</span><span>
</span><span id="line-88"></span><span class="hs-comment">-- &gt; import XMonad.ManageHook</span><span>
</span><span id="line-89"></span><span class="hs-comment">-- &gt; import XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-90"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- &gt; scratchpads = [</span><span>
</span><span id="line-92"></span><span class="hs-comment">-- &gt; -- run htop in xterm, find it by title, use default floating window placement</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- &gt;     NS &quot;htop&quot; &quot;xterm -e htop&quot; (title =? &quot;htop&quot;) defaultFloating ,</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-95"></span><span class="hs-comment">-- &gt; -- run stardict, find it by class name, place it in the floating window</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- &gt; -- 1/6 of screen width from the left, 1/6 of screen height</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- &gt; -- from the top, 2/3 of screen width by 2/3 of screen height</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- &gt;     NS &quot;stardict&quot; &quot;stardict&quot; (className =? &quot;Stardict&quot;)</span><span>
</span><span id="line-99"></span><span class="hs-comment">-- &gt;         (customFloating $ W.RationalRect (1/6) (1/6) (2/3) (2/3)) ,</span><span>
</span><span id="line-100"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- &gt; -- run gvim, find by role, don't float</span><span>
</span><span id="line-102"></span><span class="hs-comment">-- &gt;     NS &quot;notes&quot; &quot;gvim --role notes ~/notes.txt&quot; (role =? &quot;notes&quot;) nonFloating</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- &gt; ] where role = stringProperty &quot;WM_WINDOW_ROLE&quot;</span><span>
</span><span id="line-104"></span><span class="hs-comment">--</span><span>
</span><span id="line-105"></span><span class="hs-comment">-- Add keybindings:</span><span>
</span><span id="line-106"></span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask .|. shiftMask, xK_t), namedScratchpadAction scratchpads &quot;htop&quot;)</span><span>
</span><span id="line-108"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask .|. shiftMask, xK_s), namedScratchpadAction scratchpads &quot;stardict&quot;)</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- &gt;  , ((modm .|. controlMask .|. shiftMask, xK_n), namedScratchpadAction scratchpads &quot;notes&quot;)</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- ... and a manage hook:</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &gt;  , manageHook = namedScratchpadManageHook scratchpads</span><span>
</span><span id="line-114"></span><span class="hs-comment">--</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- For detailed instruction on editing the key binding see</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- &lt;https://xmonad.org/TUTORIAL.html#customizing-xmonad the tutorial&gt;</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- For some applications (like displaying your workspaces in a status bar) it</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- is convenient to filter out the @NSP@ workspace when looking at all</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- workspaces. For this, you can use 'XMonad.Hooks.StatusBar.PP.filterOutWsPP',</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- or 'XMonad.Util.WorkspaceCompare.filterOutWs' together with</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- 'XMonad.Hooks.EwmhDesktops.addEwmhWorkspaceSort' if your status bar gets</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- the list of workspaces from EWMH.  See the documentation of these functions</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- for examples.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- If you want to explore this module further, scratchpads can come in</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- many forms and flavours:</span><span>
</span><span id="line-128"></span><span class="hs-comment">--</span><span>
</span><span id="line-129"></span><span class="hs-comment">--   + \&quot;Regular\&quot; scratchpads: they can be predefined and</span><span>
</span><span id="line-130"></span><span class="hs-comment">--     summoned/banished with a key press.  These are the scratchpads</span><span>
</span><span id="line-131"></span><span class="hs-comment">--     that you have seen above.</span><span>
</span><span id="line-132"></span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span class="hs-comment">--   + [Dynamic scratchpads](#g:dynamic-scratchpads), which allow you to</span><span>
</span><span id="line-134"></span><span class="hs-comment">--     dynamically declare existing windows as scratchpads.  These can</span><span>
</span><span id="line-135"></span><span class="hs-comment">--     be treated as a separate type of scratchpad.</span><span>
</span><span id="line-136"></span><span class="hs-comment">--</span><span>
</span><span id="line-137"></span><span class="hs-comment">--   + [Exclusive](#g:exclusive-scratchpads) scratchpads, which can be</span><span>
</span><span id="line-138"></span><span class="hs-comment">--     seen as a property of already existing scratchpads.  Marking</span><span>
</span><span id="line-139"></span><span class="hs-comment">--     scratchpads as exclusive will not allow them to be shown on the</span><span>
</span><span id="line-140"></span><span class="hs-comment">--     same workspace; the scratchpad being brought up will hide the</span><span>
</span><span id="line-141"></span><span class="hs-comment">--     others.</span><span>
</span><span id="line-142"></span><span class="hs-comment">--</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- See the relevant sections in the documentation for more information.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- Further, there is also a @logHook@ that you can use to hide</span><span>
</span><span id="line-146"></span><span class="hs-comment">-- scratchpads when they lose focus; this is functionality akin to what</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- some dropdown terminals provide.  See the documentation of</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- 'nsHideOnFocusLoss' for an example how to set this up.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Single named scratchpad configuration</span><span>
</span><span id="line-152"></span><span class="hs-keyword">data</span><span> </span><span id="NamedScratchpad"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-var">NamedScratchpad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NS"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NS"><span class="hs-identifier hs-var">NS</span></a></span></span><span> </span><span class="hs-special">{</span><span> </span><span id="name"><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>      </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-153"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="cmd"><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var hs-var">cmd</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>      </span><span class="hs-comment">-- ^ Command used to run application</span><span>
</span><span id="line-154"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="query"><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>  </span><span class="hs-comment">-- ^ Query to find already running application</span><span>
</span><span id="line-155"></span><span>                          </span><span class="hs-special">,</span><span> </span><span id="hook"><span class="annot"><span class="annottext">NamedScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#hook"><span class="hs-identifier hs-var hs-var">hook</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>  </span><span class="hs-comment">-- ^ Manage hook called for application window, use it to define the placement. See @nonFloating@, @defaultFloating@ and @customFloating@</span><span>
</span><span id="line-156"></span><span>                          </span><span class="hs-special">}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- | The NSP state.</span><span>
</span><span id="line-159"></span><span class="hs-keyword">data</span><span> </span><span id="NSPState"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NSPState"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="nspExclusives"><span class="annot"><span class="annottext">NSPState -&gt; Map String NamedScratchpads
</span><a href="XMonad.Util.NamedScratchpad.html#nspExclusives"><span class="hs-identifier hs-var hs-var">nspExclusives</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">-- ^ Associates the name of a scratchpad to some list of scratchpads</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-comment">-- that should be mutually exclusive to it.</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="nspScratchpads"><span class="annot"><span class="annottext">NSPState -&gt; Map String NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#nspScratchpads"><span class="hs-identifier hs-var hs-var">nspScratchpads</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- ^ Associates a name to an entire scratchpad.</span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679482485"><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">initialValue</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679482480"><span class="annot"><span class="annottext">initialValue :: NSPState
</span><a href="#local-6989586621679482480"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
-&gt; Map String NamedScratchpad -&gt; NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Try to:</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">--    (i) Fill the 'nspScratchpads' portion of the 'NSPState' with the</span><span>
</span><span id="line-174"></span><span class="hs-comment">--        given list of scratchpads.  In case that particular map of the</span><span>
</span><span id="line-175"></span><span class="hs-comment">--        state is already non-empty, don't do anything and return that</span><span>
</span><span id="line-176"></span><span class="hs-comment">--        state.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">--   (ii) Replace possibly dummy scratchpads in @nspExclusives@ with</span><span>
</span><span id="line-179"></span><span class="hs-comment">--        proper values.  For convenience, the user may specify</span><span>
</span><span id="line-180"></span><span class="hs-comment">--        exclusive scratchpads by name in the startup hook.  However,</span><span>
</span><span id="line-181"></span><span class="hs-comment">--        we don't necessarily have all information then to immediately</span><span>
</span><span id="line-182"></span><span class="hs-comment">--        turn these into proper NamedScratchpads.  As such, we thinly</span><span>
</span><span id="line-183"></span><span class="hs-comment">--        wrap the names into an NSP skeleton, to be filled in later.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--        This function, to be executed _before_</span><span>
</span><span id="line-185"></span><span class="hs-comment">--        'someNamedScratchpadAction' is the (latest) point where that</span><span>
</span><span id="line-186"></span><span class="hs-comment">--        happens.</span><span>
</span><span id="line-187"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#fillNSPState"><span class="hs-identifier hs-type">fillNSPState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span>
</span><span id="line-188"></span><span id="fillNSPState"><span class="annot"><span class="annottext">fillNSPState :: NamedScratchpads -&gt; X NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#fillNSPState"><span class="hs-identifier hs-var hs-var">fillNSPState</span></a></span></span><span> </span><span id="local-6989586621679482478"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482478"><span class="hs-identifier hs-var">nsps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679482477"><span class="annot"><span class="annottext">nsp :: NSPState
</span><a href="#local-6989586621679482477"><span class="hs-identifier hs-var">nsp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span> </span><span id="local-6989586621679482476"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482476"><span class="hs-identifier hs-var">exs</span></a></span></span><span> </span><span id="local-6989586621679482475"><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482475"><span class="hs-identifier hs-var">scratches</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482475"><span class="hs-identifier hs-var">scratches</span></a></span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482472"><span class="annot"><span class="annottext">nspState :: NSPState
</span><a href="#local-6989586621679482472"><span class="hs-identifier hs-var hs-var">nspState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
-&gt; Map String NamedScratchpad -&gt; NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map String NamedScratchpads -&gt; Map String NamedScratchpads
</span><a href="#local-6989586621679482471"><span class="hs-identifier hs-var">fillOut</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482476"><span class="hs-identifier hs-var">exs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482470"><span class="hs-identifier hs-var">nspScratches</span></a></span><span>
</span><span id="line-192"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NSPState
</span><a href="#local-6989586621679482472"><span class="hs-identifier hs-var">nspState</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="annot"><span class="annottext">NSPState
</span><a href="#local-6989586621679482472"><span class="hs-identifier hs-var">nspState</span></a></span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">NSPState
</span><a href="#local-6989586621679482477"><span class="hs-identifier hs-var">nsp</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- @fillNSPState@ only runs once, so the complexity here is probably</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">-- not a big deal.</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="#local-6989586621679482470"><span class="hs-identifier hs-type">nspScratches</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span>
</span><span id="line-198"></span><span>    </span><span id="local-6989586621679482470"><span class="annot"><span class="annottext">nspScratches :: Map String NamedScratchpad
</span><a href="#local-6989586621679482470"><span class="hs-identifier hs-var hs-var">nspScratches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482478"><span class="hs-identifier hs-var">nsps</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482478"><span class="hs-identifier hs-var">nsps</span></a></span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621679482471"><span class="hs-identifier hs-type">fillOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679482471"><span class="annot"><span class="annottext">fillOut :: Map String NamedScratchpads -&gt; Map String NamedScratchpads
</span><a href="#local-6989586621679482471"><span class="hs-identifier hs-var hs-var">fillOut</span></a></span></span><span> </span><span id="local-6989586621679482466"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482466"><span class="hs-identifier hs-var">exs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482465"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482465"><span class="hs-identifier hs-var">nspMap</span></a></span></span><span> </span><span id="local-6989586621679482464"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482464"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; NamedScratchpads -&gt; NamedScratchpads
</span><a href="#local-6989586621679482462"><span class="hs-identifier hs-var">replaceWith</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482464"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482465"><span class="hs-identifier hs-var">nspMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482466"><span class="hs-identifier hs-var">exs</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482478"><span class="hs-identifier hs-var">nsps</span></a></span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><a href="#local-6989586621679482462"><span class="hs-identifier hs-type">replaceWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621679482462"><span class="annot"><span class="annottext">replaceWith :: NamedScratchpad -&gt; NamedScratchpads -&gt; NamedScratchpads
</span><a href="#local-6989586621679482462"><span class="hs-identifier hs-var hs-var">replaceWith</span></a></span></span><span> </span><span id="local-6989586621679482461"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482461"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482460"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482460"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482460"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482461"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482461"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482460"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Manage hook that makes the window non-floating</span><span>
</span><span id="line-205"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nonFloating"><span class="hs-identifier hs-type">nonFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-206"></span><span id="nonFloating"><span class="annot"><span class="annottext">nonFloating :: ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#nonFloating"><span class="hs-identifier hs-var hs-var">nonFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">idHook</span></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Manage hook that makes the window floating with the default placement</span><span>
</span><span id="line-209"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#defaultFloating"><span class="hs-identifier hs-type">defaultFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-210"></span><span id="defaultFloating"><span class="annot"><span class="annottext">defaultFloating :: ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#defaultFloating"><span class="hs-identifier hs-var hs-var">defaultFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ManageHook
</span><span class="hs-identifier hs-var">doFloat</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="hs-comment">-- | Manage hook that makes the window floating with custom placement</span><span>
</span><span id="line-213"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customFloating"><span class="hs-identifier hs-type">customFloating</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-214"></span><span id="customFloating"><span class="annot"><span class="annottext">customFloating :: RationalRect -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#customFloating"><span class="hs-identifier hs-var hs-var">customFloating</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; ManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier hs-var">doRectFloat</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | @isNSP win nsps@ checks whether the window @win@ is any scratchpad</span><span>
</span><span id="line-217"></span><span class="hs-comment">-- in @nsps@.</span><span>
</span><span id="line-218"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#isNSP"><span class="hs-identifier hs-type">isNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-219"></span><span id="isNSP"><span class="annot"><span class="annottext">isNSP :: Window -&gt; NamedScratchpads -&gt; X Bool
</span><a href="XMonad.Util.NamedScratchpad.html#isNSP"><span class="hs-identifier hs-var hs-var">isNSP</span></a></span></span><span> </span><span id="local-6989586621679482456"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482456"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *). Foldable t =&gt; t Bool -&gt; Bool
</span><span class="hs-identifier hs-var">or</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-operator hs-var">`runQuery`</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482456"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Named scratchpads configuration</span><span>
</span><span id="line-222"></span><span class="hs-keyword">type</span><span> </span><span id="NamedScratchpads"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-var">NamedScratchpads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Runs application which should appear in specified scratchpad</span><span>
</span><span id="line-225"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-type">runApplication</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span id="runApplication"><span class="annot"><span class="annottext">runApplication :: NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-var hs-var">runApplication</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m ()
</span><span class="hs-identifier hs-var">spawn</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Runs application which should appear in a specified scratchpad on the workspace it was launched on</span><span>
</span><span id="line-229"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#runApplicationHere"><span class="hs-identifier hs-type">runApplicationHere</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span id="runApplicationHere"><span class="annot"><span class="annottext">runApplicationHere :: NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplicationHere"><span class="hs-identifier hs-var hs-var">runApplicationHere</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Actions.SpawnOn.html#spawnHere"><span class="hs-identifier hs-var">spawnHere</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | Action to pop up specified named scratchpad</span><span>
</span><span id="line-233"></span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- Note [Ignored Arguments]: Most of the time, this function ignores its</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- first argument and uses 'NSPState' instead.  The only time when it</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- does not is when no other window has been opened before in the</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- running xmonad instance.  If this is not your use-case, you can</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- safely call this function with an empty list.</span><span>
</span><span id="line-239"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadAction"><span class="hs-identifier hs-type">namedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-240"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>           </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-241"></span><span>                      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span id="namedScratchpadAction"><span class="annot"><span class="annottext">namedScratchpadAction :: NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadAction"><span class="hs-identifier hs-var hs-var">namedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var">customRunNamedScratchpadAction</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-var">runApplication</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Action to pop up specified named scratchpad, initially starting it on the current workspace.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- This function /almost always/ ignores its first argument; see Note</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- [Ignored Arguments] for 'namedScratchpadAction'.</span><span>
</span><span id="line-248"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#spawnHereNamedScratchpadAction"><span class="hs-identifier hs-type">spawnHereNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>           </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-249"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                     </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-250"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span id="spawnHereNamedScratchpadAction"><span class="annot"><span class="annottext">spawnHereNamedScratchpadAction :: NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#spawnHereNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">spawnHereNamedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var">customRunNamedScratchpadAction</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplicationHere"><span class="hs-identifier hs-var">runApplicationHere</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Action to pop up specified named scratchpad, given a custom way to initially start the application.</span><span>
</span><span id="line-254"></span><span class="hs-comment">--</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- This function /almost always/ ignores its second argument; see Note</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- [Ignored Arguments] for 'namedScratchpadAction'.</span><span>
</span><span id="line-257"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-type">customRunNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>  </span><span class="hs-comment">-- ^ Function initially running the application, given the configured @scratchpad@ cmd</span><span>
</span><span id="line-258"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>           </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-259"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>                     </span><span class="hs-comment">-- ^ Scratchpad name</span><span>
</span><span id="line-260"></span><span>                               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span id="customRunNamedScratchpadAction"><span class="annot"><span class="annottext">customRunNamedScratchpadAction :: (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">customRunNamedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ())
-&gt; (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-var">someNamedScratchpadAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482447"><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482447"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679482446"><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679482446"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482447"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. NonEmpty a -&gt; a
</span><span class="hs-identifier hs-var">NE.head</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679482446"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="hs-comment">-- | Like 'namedScratchpadAction', but execute the action for all</span><span>
</span><span id="line-264"></span><span class="hs-comment">-- scratchpads that match the query.</span><span>
</span><span id="line-265"></span><span class="hs-comment">--</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- This function /almost always/ ignores its first argument; see Note</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- [Ignored Arguments] for 'namedScratchpadAction'.</span><span>
</span><span id="line-268"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#allNamedScratchpadAction"><span class="hs-identifier hs-type">allNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>
</span><span id="line-269"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-270"></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span id="allNamedScratchpadAction"><span class="annot"><span class="annottext">allNamedScratchpadAction :: NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#allNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">allNamedScratchpadAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ())
-&gt; (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-var">someNamedScratchpadAction</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#runApplication"><span class="hs-identifier hs-var">runApplication</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | A @logHook@ to hide scratchpads when they lose focus.  This can be</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- useful for e.g. dropdown terminals.  Note that this also requires you</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- to use the 'XMonad.Hooks.RefocusLast.refocusLastLogHook'.</span><span>
</span><span id="line-276"></span><span class="hs-comment">--</span><span>
</span><span id="line-277"></span><span class="hs-comment">-- ==== __Example__</span><span>
</span><span id="line-278"></span><span class="hs-comment">--</span><span>
</span><span id="line-279"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.RefocusLast (refocusLastLogHook)</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- &gt; import XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- &gt; main = xmonad $ def</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- &gt;   { logHook = refocusLastLogHook</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- &gt;            &gt;&gt; nsHideOnFocusLoss myScratchpads</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- &gt;               -- enable hiding for all of @myScratchpads@</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- &gt;   }</span><span>
</span><span id="line-287"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsHideOnFocusLoss"><span class="hs-identifier hs-type">nsHideOnFocusLoss</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span id="nsHideOnFocusLoss"><span class="annot"><span class="annottext">nsHideOnFocusLoss :: NamedScratchpads -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#nsHideOnFocusLoss"><span class="hs-identifier hs-var hs-var">nsHideOnFocusLoss</span></a></span></span><span> </span><span id="local-6989586621679482443"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482443"><span class="hs-identifier hs-var">scratches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; WindowSet -&gt; (Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#nsHideOnCondition"><span class="hs-identifier hs-var">nsHideOnCondition</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679482441"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482441"><span class="hs-identifier hs-var">lastFocus</span></a></span></span><span> </span><span id="local-6989586621679482440"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482440"><span class="hs-identifier hs-var">_curFoc</span></a></span></span><span> </span><span id="local-6989586621679482439"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482439"><span class="hs-identifier hs-var">_ws</span></a></span></span><span> </span><span id="local-6989586621679482438"><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482438"><span class="hs-identifier hs-var">hideScratch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; NamedScratchpads -&gt; X Bool
</span><a href="XMonad.Util.NamedScratchpad.html#isNSP"><span class="hs-identifier hs-var">isNSP</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482441"><span class="hs-identifier hs-var">lastFocus</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482443"><span class="hs-identifier hs-var">scratches</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482438"><span class="hs-identifier hs-var">hideScratch</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482441"><span class="hs-identifier hs-var">lastFocus</span></a></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | A @logHook@ to have only one active scratchpad on a workspace. This can</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- be useful when working with multiple floating scratchpads which would</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- otherwise be stacked. Note that this also requires you to use the</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- 'XMonad.Hooks.RefocusLast.refocusLastLogHook'.</span><span>
</span><span id="line-297"></span><span class="hs-comment">--</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- ==== __Example__</span><span>
</span><span id="line-299"></span><span class="hs-comment">--</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.RefocusLast (refocusLastLogHook)</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- &gt; import XMonad.Util.NamedScratchpad</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- &gt; main = xmonad $ def</span><span>
</span><span id="line-304"></span><span class="hs-comment">-- &gt;   { logHook = refocusLastLogHook</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- &gt;            &gt;&gt; nsHideOnNewScratchpad myScratchpads</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- &gt;               -- enable hiding for all of @myScratchpads@</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- &gt;   }</span><span>
</span><span id="line-308"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsSingleScratchpadPerWorkspace"><span class="hs-identifier hs-type">nsSingleScratchpadPerWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span id="nsSingleScratchpadPerWorkspace"><span class="annot"><span class="annottext">nsSingleScratchpadPerWorkspace :: NamedScratchpads -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#nsSingleScratchpadPerWorkspace"><span class="hs-identifier hs-var hs-var">nsSingleScratchpadPerWorkspace</span></a></span></span><span> </span><span id="local-6989586621679482436"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482436"><span class="hs-identifier hs-var">scratches</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-310"></span><span>    </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; WindowSet -&gt; (Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#nsHideOnCondition"><span class="hs-identifier hs-var">nsHideOnCondition</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span> </span><span id="local-6989586621679482435"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482435"><span class="hs-identifier hs-var">_lastFocus</span></a></span></span><span> </span><span id="local-6989586621679482434"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482434"><span class="hs-identifier hs-var">curFocus</span></a></span></span><span> </span><span id="local-6989586621679482433"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482433"><span class="hs-identifier hs-var">winSet</span></a></span></span><span> </span><span id="local-6989586621679482432"><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482432"><span class="hs-identifier hs-var">hideScratch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-311"></span><span>        </span><span id="local-6989586621679482431"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482431"><span class="hs-identifier hs-var">allScratchesButCurrent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-312"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b c.
Applicative f =&gt;
(a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c
</span><span class="hs-identifier hs-var">liftA2</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">(&lt;&amp;&amp;&gt;)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482434"><span class="hs-identifier hs-var">curFocus</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; NamedScratchpads -&gt; X Bool
</span><a href="XMonad.Util.NamedScratchpad.html#isNSP"><span class="hs-operator hs-var">`isNSP`</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482436"><span class="hs-identifier hs-var">scratches</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.index</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482433"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>        </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; NamedScratchpads -&gt; X Bool
</span><a href="XMonad.Util.NamedScratchpad.html#isNSP"><span class="hs-identifier hs-var">isNSP</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482434"><span class="hs-identifier hs-var">curFocus</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482436"><span class="hs-identifier hs-var">scratches</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-315"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482431"><span class="hs-identifier hs-var">allScratchesButCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482432"><span class="hs-identifier hs-var">hideScratch</span></a></span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span class="hs-comment">-- | Hide scratchpads according to some condition. See 'nsHideOnFocusLoss' and</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- 'nsSingleScratchpadPerWorkspace' for usage examples.</span><span>
</span><span id="line-319"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#nsHideOnCondition"><span class="hs-identifier hs-type">nsHideOnCondition</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>           </span><span class="hs-comment">-- Last focus.</span><span>
</span><span id="line-321"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>           </span><span class="hs-comment">-- Current focus.</span><span>
</span><span id="line-322"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>        </span><span class="hs-comment">-- Current windowset.</span><span>
</span><span id="line-323"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- A function to hide the named scratchpad.</span><span>
</span><span id="line-324"></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span id="nsHideOnCondition"><span class="annot"><span class="annottext">nsHideOnCondition :: (Window -&gt; Window -&gt; WindowSet -&gt; (Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#nsHideOnCondition"><span class="hs-identifier hs-var hs-var">nsHideOnCondition</span></a></span></span><span> </span><span id="local-6989586621679482427"><span class="annot"><span class="annottext">Window -&gt; Window -&gt; WindowSet -&gt; (Window -&gt; X ()) -&gt; X ()
</span><a href="#local-6989586621679482427"><span class="hs-identifier hs-var">cond</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482425"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482425"><span class="hs-identifier hs-var">winSet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482424"><span class="annot"><span class="annottext">cur :: String
</span><a href="#local-6989586621679482424"><span class="hs-identifier hs-var hs-var">cur</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482425"><span class="hs-identifier hs-var">winSet</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><span class="annottext">forall a. String -&gt; a -&gt; (Window -&gt; Window -&gt; X a) -&gt; X a
</span><a href="XMonad.Hooks.RefocusLast.html#withRecentsIn"><span class="hs-identifier hs-var">withRecentsIn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482424"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482422"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482422"><span class="hs-identifier hs-var">lastFocus</span></a></span></span><span> </span><span id="local-6989586621679482421"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482421"><span class="hs-identifier hs-var">curFocus</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679482420"><span class="hs-identifier hs-type">hideScratch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>            </span><span id="local-6989586621679482420"><span class="annot"><span class="annottext">hideScratch :: Window -&gt; X ()
</span><a href="#local-6989586621679482420"><span class="hs-identifier hs-var hs-var">hideScratch</span></a></span></span><span> </span><span id="local-6989586621679482419"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482419"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var">shiftToNSP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482425"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482419"><span class="hs-identifier hs-var">win</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>            </span><span id="local-6989586621679482411"><span class="annot"><span class="annottext">isWorthy :: Bool
</span><a href="#local-6989586621679482411"><span class="hs-identifier hs-var hs-var">isWorthy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>                </span><span class="hs-comment">-- Check for the window being on the current workspace; if there</span><span>
</span><span id="line-333"></span><span>                </span><span class="hs-comment">-- is no history (i.e., curFocus &#8801; lastFocus), don't do anything</span><span>
</span><span id="line-334"></span><span>                </span><span class="hs-comment">-- because the potential scratchpad is definitely focused.</span><span>
</span><span id="line-335"></span><span>                </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482422"><span class="hs-identifier hs-var">lastFocus</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.index</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482425"><span class="hs-identifier hs-var">winSet</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482422"><span class="hs-identifier hs-var">lastFocus</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482421"><span class="hs-identifier hs-var">curFocus</span></a></span><span>
</span><span id="line-336"></span><span>                </span><span class="hs-comment">-- Don't do anything on the NSP workspace, lest the world explodes.</span><span>
</span><span id="line-337"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482424"><span class="hs-identifier hs-var">cur</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679482411"><span class="hs-identifier hs-var">isWorthy</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-339"></span><span>            </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; WindowSet -&gt; (Window -&gt; X ()) -&gt; X ()
</span><a href="#local-6989586621679482427"><span class="hs-identifier hs-var">cond</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482422"><span class="hs-identifier hs-var">lastFocus</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482421"><span class="hs-identifier hs-var">curFocus</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482425"><span class="hs-identifier hs-var">winSet</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="#local-6989586621679482420"><span class="hs-identifier hs-var">hideScratch</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="hs-comment">-- | Execute some action on a named scratchpad.</span><span>
</span><span id="line-342"></span><span class="hs-comment">--</span><span>
</span><span id="line-343"></span><span class="hs-comment">-- This function /almost always/ ignores its third argument; see Note</span><span>
</span><span id="line-344"></span><span class="hs-comment">-- [Ignored Arguments] for 'namedScratchpadAction'.</span><span>
</span><span id="line-345"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-type">someNamedScratchpadAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NE.NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span>
</span><span id="line-348"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-349"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span id="someNamedScratchpadAction"><span class="annot"><span class="annottext">someNamedScratchpadAction :: ((Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ())
-&gt; (NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#someNamedScratchpadAction"><span class="hs-identifier hs-var hs-var">someNamedScratchpadAction</span></a></span></span><span> </span><span id="local-6989586621679482408"><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
</span><a href="#local-6989586621679482408"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679482407"><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="#local-6989586621679482407"><span class="hs-identifier hs-var">runApp</span></a></span></span><span> </span><span id="local-6989586621679482406"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482406"><span class="hs-identifier hs-var">_ns</span></a></span></span><span> </span><span id="local-6989586621679482405"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482405"><span class="hs-identifier hs-var">scratchpadName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679482404"><span class="annot"><span class="annottext">Map String NamedScratchpad
nspScratchpads :: Map String NamedScratchpad
nspScratchpads :: NSPState -&gt; Map String NamedScratchpad
</span><a href="#local-6989586621679482404"><span class="hs-identifier hs-var hs-var">nspScratchpads</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads -&gt; X NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#fillNSPState"><span class="hs-identifier hs-var">fillNSPState</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482406"><span class="hs-identifier hs-var">_ns</span></a></span><span>  </span><span class="hs-comment">-- See Note [Filling NSPState]</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482404"><span class="hs-identifier hs-var">nspScratchpads</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; Maybe a
</span><span class="hs-operator hs-var">!?</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482405"><span class="hs-identifier hs-var">scratchpadName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679482403"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482403"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482402"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482402"><span class="hs-identifier hs-var">winSet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679482401"><span class="annot"><span class="annottext">focusedWspWindows :: [Window]
</span><a href="#local-6989586621679482401"><span class="hs-identifier hs-var hs-var">focusedWspWindows</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.index</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482402"><span class="hs-identifier hs-var">winSet</span></a></span><span>
</span><span id="line-355"></span><span>                </span><span id="local-6989586621679482399"><span class="annot"><span class="annottext">allWindows :: [Window]
</span><a href="#local-6989586621679482399"><span class="hs-identifier hs-var hs-var">allWindows</span></a></span></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a i l s sd. Eq a =&gt; StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.allWindows</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482402"><span class="hs-identifier hs-var">winSet</span></a></span><span>
</span><span id="line-356"></span><span>            </span><span id="local-6989586621679482397"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482397"><span class="hs-identifier hs-var">matchingOnCurrent</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482403"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482401"><span class="hs-identifier hs-var">focusedWspWindows</span></a></span><span>
</span><span id="line-357"></span><span>            </span><span id="local-6989586621679482396"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482396"><span class="hs-identifier hs-var">matchingOnAll</span></a></span></span><span>     </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482403"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482399"><span class="hs-identifier hs-var">allWindows</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482397"><span class="hs-identifier hs-var">matchingOnCurrent</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-360"></span><span>                </span><span class="hs-comment">-- no matching window on the current workspace -&gt; scratchpad not running or in background</span><span>
</span><span id="line-361"></span><span>                </span><span class="annot"><span class="annottext">Maybe (NonEmpty Window)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>                    </span><span class="hs-comment">-- summon the scratchpad</span><span>
</span><span id="line-363"></span><span>                    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (NonEmpty a)
</span><span class="hs-identifier hs-var">NE.nonEmpty</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679482396"><span class="hs-identifier hs-var">matchingOnAll</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-364"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (NonEmpty Window)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; X ()
</span><a href="#local-6989586621679482407"><span class="hs-identifier hs-var">runApp</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482403"><span class="hs-identifier hs-var">conf</span></a></span><span>
</span><span id="line-365"></span><span>                        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679482394"><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679482394"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
</span><a href="#local-6989586621679482408"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482402"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679482394"><span class="hs-identifier hs-var">wins</span></a></span><span>
</span><span id="line-366"></span><span>                    </span><span class="hs-comment">-- check for exclusive scratchpads to hide</span><span>
</span><span id="line-367"></span><span>                    </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#hideUnwanted"><span class="hs-identifier hs-var">hideUnwanted</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482403"><span class="hs-identifier hs-var">conf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span>                </span><span class="hs-comment">-- matching window running on current workspace -&gt; window should be shifted to scratchpad workspace</span><span>
</span><span id="line-370"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679482390"><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679482390"><span class="hs-identifier hs-var">wins</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var">shiftToNSP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482402"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; NonEmpty Window -&gt; X ()
</span><a href="#local-6989586621679482408"><span class="hs-operator hs-var">`f`</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty Window
</span><a href="#local-6989586621679482390"><span class="hs-identifier hs-var">wins</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">Maybe NamedScratchpad
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">{- Note [Filling NSPState]

We have to potentially populate the state with the given scratchpads
here, in case the manageHook didn't run yet and it's still empty.

For backwards compatibility, 3fc830aa09368dca04df24bf7ec4ac817f2de479
introduced an internal state that's filled in the
namedScratchpadManageHook.  A priori, this means that we would need some
kind of MapRequestEvent to happen before processing scratchpads, since
the manageHook doesn't run otherwise, leaving the extensible state empty
until then.  When trying to open a scratchpad right after starting
xmonad&#8212;i.e., before having opened a window&#8212;we thus have to populate the
NSPState before looking for scratchpads.

Related: https://github.com/xmonad/xmonad-contrib/issues/728
-}</span><span>
</span><span id="line-389"></span><span>
</span><span id="line-390"></span><span class="hs-comment">-- | Tag of the scratchpad workspace</span><span>
</span><span id="line-391"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-type">scratchpadWorkspaceTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-392"></span><span id="scratchpadWorkspaceTag"><span class="annot"><span class="annottext">scratchpadWorkspaceTag :: String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var hs-var">scratchpadWorkspaceTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NSP&quot;</span></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span class="hs-comment">-- | Manage hook to use with named scratchpads</span><span>
</span><span id="line-395"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadManageHook"><span class="hs-identifier hs-type">namedScratchpadManageHook</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpads"><span class="hs-identifier hs-type">NamedScratchpads</span></a></span><span> </span><span class="hs-comment">-- ^ Named scratchpads configuration</span><span>
</span><span id="line-396"></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-397"></span><span id="namedScratchpadManageHook"><span class="annot"><span class="annottext">namedScratchpadManageHook :: NamedScratchpads -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadManageHook"><span class="hs-identifier hs-var hs-var">namedScratchpadManageHook</span></a></span></span><span> </span><span id="local-6989586621679482389"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482389"><span class="hs-identifier hs-var">nsps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-398"></span><span>    </span><span id="local-6989586621679482388"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482388"><span class="hs-identifier hs-var">ns</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NSPState -&gt; Map String NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#nspScratchpads"><span class="hs-identifier hs-var">nspScratchpads</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpads -&gt; X NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#fillNSPState"><span class="hs-identifier hs-var">fillNSPState</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482389"><span class="hs-identifier hs-var">nsps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="annottext">forall m. Monoid m =&gt; [m] -&gt; m
</span><span class="hs-identifier hs-var">composeAll</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482383"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482383"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482383"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. (Monad m, Monoid a) =&gt; m Bool -&gt; m a -&gt; m a
</span><span class="hs-operator hs-var">--&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#hook"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482383"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482388"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Shift some windows to the scratchpad workspace according to the</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- given function.  The workspace is created if necessary.</span><span>
</span><span id="line-403"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-type">shiftToNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span id="shiftToNSP"><span class="annot"><span class="annottext">shiftToNSP :: [WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var hs-var">shiftToNSP</span></a></span></span><span> </span><span id="local-6989586621679482381"><span class="annot"><span class="annottext">[WindowSpace]
</span><a href="#local-6989586621679482381"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span id="local-6989586621679482380"><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><a href="#local-6989586621679482380"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var">W.tag</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WindowSpace]
</span><a href="#local-6989586621679482381"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-406"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier hs-var">addHiddenWorkspace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><a href="#local-6989586621679482380"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-410"></span><span class="hs-comment">-- Dynamic scratchpad functionality</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-comment">-- $dynamic-scratchpads</span><span>
</span><span id="line-413"></span><span class="hs-comment">--</span><span>
</span><span id="line-414"></span><span class="hs-comment">-- Dynamic scratchpads allow you to declare existing windows as</span><span>
</span><span id="line-415"></span><span class="hs-comment">-- scratchpads.  You can bind a key to make a window start/stop being a</span><span>
</span><span id="line-416"></span><span class="hs-comment">-- scratchpad, and another key to toggle its visibility.  Because</span><span>
</span><span id="line-417"></span><span class="hs-comment">-- dynamic scratchpads are based on existing windows, they have some</span><span>
</span><span id="line-418"></span><span class="hs-comment">-- caveats in comparison to &quot;normal&quot; scratchpads:</span><span>
</span><span id="line-419"></span><span class="hs-comment">--</span><span>
</span><span id="line-420"></span><span class="hs-comment">--   * @xmonad@ has no way of knowing /how/ windows were spawned and</span><span>
</span><span id="line-421"></span><span class="hs-comment">--     thus one is not able to &quot;start&quot; dynamic scratchpads again after</span><span>
</span><span id="line-422"></span><span class="hs-comment">--     the associated window has been closed.</span><span>
</span><span id="line-423"></span><span class="hs-comment">--</span><span>
</span><span id="line-424"></span><span class="hs-comment">--   * If you already have an active dynamic scratchpad @&quot;dyn1&quot;@ and you</span><span>
</span><span id="line-425"></span><span class="hs-comment">--     call 'toggleDynamicNSP' with another window, that window will</span><span>
</span><span id="line-426"></span><span class="hs-comment">--     henceforth occupy the @&quot;dyn1&quot;@ scratchpad.  If you still need the</span><span>
</span><span id="line-427"></span><span class="hs-comment">--     old window, you might have to travel to your scratchpad workspace</span><span>
</span><span id="line-428"></span><span class="hs-comment">--     ('scratchpadWorkspaceTag') in order to retrieve it.</span><span>
</span><span id="line-429"></span><span class="hs-comment">--</span><span>
</span><span id="line-430"></span><span class="hs-comment">-- As an example, the following snippet contains keybindings for two</span><span>
</span><span id="line-431"></span><span class="hs-comment">-- dynamic scratchpads, called @&quot;dyn1&quot;@ and @&quot;dyn2&quot;@:</span><span>
</span><span id="line-432"></span><span class="hs-comment">--</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- &gt; import XMonad.Util.NamedScratchpads</span><span>
</span><span id="line-434"></span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-435"></span><span class="hs-comment">-- &gt; , (&quot;M-s-a&quot;, withFocused $ toggleDynamicNSP &quot;dyn1&quot;)</span><span>
</span><span id="line-436"></span><span class="hs-comment">-- &gt; , (&quot;M-s-b&quot;, withFocused $ toggleDynamicNSP &quot;dyn2&quot;)</span><span>
</span><span id="line-437"></span><span class="hs-comment">-- &gt; , (&quot;M-a&quot;  , dynamicNSPAction &quot;dyn1&quot;)</span><span>
</span><span id="line-438"></span><span class="hs-comment">-- &gt; , (&quot;M-b&quot;  , dynamicNSPAction &quot;dyn2&quot;)</span><span>
</span><span id="line-439"></span><span class="hs-comment">--</span><span>
</span><span id="line-440"></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- | A 'NamedScratchpad' representing a &quot;dynamic&quot; scratchpad; i.e., a</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- scratchpad based on an already existing window.</span><span>
</span><span id="line-443"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#mkDynamicNSP"><span class="hs-identifier hs-type">mkDynamicNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span>
</span><span id="line-444"></span><span id="mkDynamicNSP"><span class="annot"><span class="annottext">mkDynamicNSP :: String -&gt; Window -&gt; NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#mkDynamicNSP"><span class="hs-identifier hs-var hs-var">mkDynamicNSP</span></a></span></span><span> </span><span id="local-6989586621679482376"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482376"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679482375"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482375"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-445"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NS"><span class="hs-identifier hs-type">NS</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">name :: String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var">name</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482376"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-446"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">cmd :: String
</span><a href="XMonad.Util.NamedScratchpad.html#cmd"><span class="hs-identifier hs-var">cmd</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>               </span><span class="hs-comment">-- we are never going to spawn a dynamic scratchpad</span><span>
</span><span id="line-447"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">query :: Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482375"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-448"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hook :: ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#hook"><span class="hs-identifier hs-var">hook</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>           </span><span class="hs-comment">-- cmd is never called so this will never run</span><span>
</span><span id="line-449"></span><span>       </span><span class="hs-special">}</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- | Make a window a dynamic scratchpad</span><span>
</span><span id="line-452"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#addDynamicNSP"><span class="hs-identifier hs-type">addDynamicNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span id="addDynamicNSP"><span class="annot"><span class="annottext">addDynamicNSP :: String -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#addDynamicNSP"><span class="hs-identifier hs-var hs-var">addDynamicNSP</span></a></span></span><span> </span><span id="local-6989586621679482372"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482372"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679482371"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482371"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span> </span><span id="local-6989586621679482369"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482369"><span class="hs-identifier hs-var">exs</span></a></span></span><span> </span><span id="local-6989586621679482368"><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482368"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-454"></span><span>  </span><span class="annot"><span class="annottext">Map String NamedScratchpads
-&gt; Map String NamedScratchpad -&gt; NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482369"><span class="hs-identifier hs-var">exs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482372"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Window -&gt; NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#mkDynamicNSP"><span class="hs-identifier hs-var">mkDynamicNSP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482372"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482371"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482368"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>
</span><span id="line-456"></span><span class="hs-comment">-- | Make a window stop being a dynamic scratchpad</span><span>
</span><span id="line-457"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#removeDynamicNSP"><span class="hs-identifier hs-type">removeDynamicNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span id="removeDynamicNSP"><span class="annot"><span class="annottext">removeDynamicNSP :: String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#removeDynamicNSP"><span class="hs-identifier hs-var hs-var">removeDynamicNSP</span></a></span></span><span> </span><span id="local-6989586621679482365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482365"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span> </span><span id="local-6989586621679482364"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482364"><span class="hs-identifier hs-var">exs</span></a></span></span><span> </span><span id="local-6989586621679482363"><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482363"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
-&gt; Map String NamedScratchpad -&gt; NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482364"><span class="hs-identifier hs-var">exs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482365"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482363"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span class="hs-comment">-- | Toggle the visibility of a dynamic scratchpad.</span><span>
</span><span id="line-461"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#dynamicNSPAction"><span class="hs-identifier hs-type">dynamicNSPAction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span id="dynamicNSPAction"><span class="annot"><span class="annottext">dynamicNSPAction :: String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#dynamicNSPAction"><span class="hs-identifier hs-var hs-var">dynamicNSPAction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(NamedScratchpad -&gt; X ()) -&gt; NamedScratchpads -&gt; String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#customRunNamedScratchpadAction"><span class="hs-identifier hs-var">customRunNamedScratchpadAction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-comment">-- | Either create a dynamic scratchpad out of the given window, or stop</span><span>
</span><span id="line-465"></span><span class="hs-comment">-- a window from being one if it already is.</span><span>
</span><span id="line-466"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#toggleDynamicNSP"><span class="hs-identifier hs-type">toggleDynamicNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span id="toggleDynamicNSP"><span class="annot"><span class="annottext">toggleDynamicNSP :: String -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#toggleDynamicNSP"><span class="hs-identifier hs-var hs-var">toggleDynamicNSP</span></a></span></span><span> </span><span id="local-6989586621679482360"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482360"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679482359"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482359"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679482358"><span class="annot"><span class="annottext">Map String NamedScratchpad
nspScratchpads :: Map String NamedScratchpad
nspScratchpads :: NSPState -&gt; Map String NamedScratchpad
</span><a href="#local-6989586621679482358"><span class="hs-identifier hs-var hs-var">nspScratchpads</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482358"><span class="hs-identifier hs-var">nspScratchpads</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; Maybe a
</span><span class="hs-operator hs-var">!?</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-470"></span><span>        </span><span class="annot"><span class="annottext">Maybe NamedScratchpad
</span><span class="hs-identifier hs-var">Nothing</span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#addDynamicNSP"><span class="hs-identifier hs-var">addDynamicNSP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482359"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-471"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679482357"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482357"><span class="hs-identifier hs-var">nsp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m Bool -&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">ifM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482357"><span class="hs-identifier hs-var">nsp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482359"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#removeDynamicNSP"><span class="hs-identifier hs-var">removeDynamicNSP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482360"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#addDynamicNSP"><span class="hs-identifier hs-var">addDynamicNSP</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482360"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482359"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>
</span><span id="line-475"></span><span class="hs-comment">-----------------------------------------------------------------------</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- Exclusive scratchpads</span><span>
</span><span id="line-477"></span><span>
</span><span id="line-478"></span><span class="hs-comment">-- $exclusive-scratchpads</span><span>
</span><span id="line-479"></span><span class="hs-comment">--</span><span>
</span><span id="line-480"></span><span class="hs-comment">-- Exclusive scratchpads allow you to hide certain scratchpads in</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- relation to others.  There can be multiple groups of pairwise</span><span>
</span><span id="line-482"></span><span class="hs-comment">-- exclusive scratchpads; whenever one such scratchpad gets called, it</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- will hide all other scratchpads on the focused workspace that are in</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- this group.</span><span>
</span><span id="line-485"></span><span class="hs-comment">--</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- For example, having defined &quot;Calc&quot;, &quot;Mail&quot;, and &quot;Term&quot; scratchpads,</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- you can use 'addExclusives' to make some of them dislike each other:</span><span>
</span><span id="line-488"></span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- &gt; myExclusives = addExclusives</span><span>
</span><span id="line-490"></span><span class="hs-comment">-- &gt;   [ [&quot;Calc&quot;, &quot;Mail&quot;]</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- &gt;   , [&quot;Mail&quot;, &quot;Term&quot;]</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- &gt;   ]</span><span>
</span><span id="line-493"></span><span class="hs-comment">--</span><span>
</span><span id="line-494"></span><span class="hs-comment">-- You now have to add @myExclusives@ to you startupHook:</span><span>
</span><span id="line-495"></span><span class="hs-comment">--</span><span>
</span><span id="line-496"></span><span class="hs-comment">-- &gt; main :: IO</span><span>
</span><span id="line-497"></span><span class="hs-comment">-- &gt; main = xmonad . &#8230; . $ def</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- &gt;   { &#8230;</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- &gt;   , startupHook = myStartupHook &gt;&gt; myExclusives</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- &gt;   }</span><span>
</span><span id="line-501"></span><span class="hs-comment">--</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- This will hide the &quot;Mail&quot; scratchpad whenever the &quot;Calc&quot; scratchpad</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- is brought up, and vice-versa.  Likewise, &quot;Mail&quot; and &quot;Term&quot; behave in</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- this way, but &quot;Calc&quot; and &quot;Term&quot; may peacefully coexist.</span><span>
</span><span id="line-505"></span><span class="hs-comment">--</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- If you move a scratchpad it still gets hidden when you fetch a</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- scratchpad of the same family.  To change that behaviour&#8212;and make</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- windows not exclusive anymore when they get resized or moved&#8212;add</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- these mouse bindings (see</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#Editing_mouse_bindings&quot;):</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- &gt;     , ((mod4Mask, button1), floatMoveNoexclusive)</span><span>
</span><span id="line-513"></span><span class="hs-comment">-- &gt;     , ((mod4Mask, button3), resizeNoexclusive)</span><span>
</span><span id="line-514"></span><span class="hs-comment">--</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- To reset a moved scratchpad to the original position that you set</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- with its hook, focus is and then call 'resetFocusedNSP'.  For</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- example, if you want to extend @M-\&lt;Return\&gt;@ to reset the placement</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- when a scratchpad is in focus but keep the default behaviour for</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- tiled windows, set these key bindings:</span><span>
</span><span id="line-520"></span><span class="hs-comment">--</span><span>
</span><span id="line-521"></span><span class="hs-comment">-- &gt; , ((modMask, xK_Return), windows W.swapMaster &gt;&gt; resetFocusedNSP)</span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="hs-comment">-- | Make some scratchpads exclusive.</span><span>
</span><span id="line-524"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#addExclusives"><span class="hs-identifier hs-type">addExclusives</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span id="addExclusives"><span class="annot"><span class="annottext">addExclusives :: [[String]] -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#addExclusives"><span class="hs-identifier hs-var hs-var">addExclusives</span></a></span></span><span> </span><span id="local-6989586621679482355"><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679482355"><span class="hs-identifier hs-var">exs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679482354"><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482354"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-comment">-- Re-initialise `ws' to nothing, so we can react to changes in case</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-comment">-- of a restart.  See 'fillNSPState' for more details on filling.</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; a -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#put"><span class="hs-identifier hs-var">XS.put</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map String NamedScratchpads
-&gt; Map String NamedScratchpad -&gt; NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-var">NSPState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
-&gt; Map String NamedScratchpads
-&gt; [String]
-&gt; Map String NamedScratchpads
</span><a href="#local-6989586621679482353"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">[[String]]
</span><a href="#local-6989586621679482355"><span class="hs-identifier hs-var">exs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482354"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpads -&gt; X NSPState
</span><a href="XMonad.Util.NamedScratchpad.html#fillNSPState"><span class="hs-identifier hs-var">fillNSPState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482354"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-comment">-- Ignoring that this is specialised to NSPs, it works something like</span><span>
</span><span id="line-534"></span><span>    </span><span class="hs-comment">-- &gt;&gt;&gt; foldl' (go []) mempty [[1, 2], [3, 4], [1, 3]]</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-comment">-- fromList [(1, [3, 2]), (2, [1]), (3, [1, 4]), (4, [3])]</span><span>
</span><span id="line-536"></span><span>    </span><span id="local-6989586621679482353"><span class="annot"><span class="annottext">go :: [String]
-&gt; Map String NamedScratchpads
-&gt; [String]
-&gt; Map String NamedScratchpads
</span><a href="#local-6989586621679482353"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><span class="hs-identifier">_</span></span><span>  </span><span id="local-6989586621679482347"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482347"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482347"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="annot"><a href="#local-6989586621679482353"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679482346"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679482346"><span class="hs-identifier hs-var">ms</span></a></span></span><span> </span><span id="local-6989586621679482345"><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482345"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679482344"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482344"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679482343"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679482343"><span class="hs-identifier hs-var">ns</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String]
-&gt; Map String NamedScratchpads
-&gt; [String]
-&gt; Map String NamedScratchpads
</span><a href="#local-6989586621679482353"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482344"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679482346"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; (a -&gt; a -&gt; a) -&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insertWith</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482344"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; NamedScratchpads
</span><a href="#local-6989586621679482341"><span class="hs-identifier hs-var">mkNSP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679482346"><span class="hs-identifier hs-var">ms</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679482343"><span class="hs-identifier hs-var">ns</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482345"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679482343"><span class="hs-identifier hs-var">ns</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span id="local-6989586621679482341"><span class="annot"><span class="annottext">mkNSP :: [String] -&gt; NamedScratchpads
</span><a href="#local-6989586621679482341"><span class="hs-identifier hs-var hs-var">mkNSP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482335"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482335"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Query Bool -&gt; ManageHook -&gt; NamedScratchpad
</span><a href="XMonad.Util.NamedScratchpad.html#NS"><span class="hs-identifier hs-var">NS</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482335"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>
</span><span id="line-540"></span><span class="hs-comment">-- | @setNoexclusive w@ makes the window @w@ lose its exclusivity</span><span>
</span><span id="line-541"></span><span class="hs-comment">-- features.</span><span>
</span><span id="line-542"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#setNoexclusive"><span class="hs-identifier hs-type">setNoexclusive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span id="setNoexclusive"><span class="annot"><span class="annottext">setNoexclusive :: Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#setNoexclusive"><span class="hs-identifier hs-var hs-var">setNoexclusive</span></a></span></span><span> </span><span id="local-6989586621679482334"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482334"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679482333"><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482333"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; NamedScratchpads -&gt; X Bool
</span><a href="XMonad.Util.NamedScratchpad.html#isNSP"><span class="hs-identifier hs-var">isNSP</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482334"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpad
</span><a href="#local-6989586621679482333"><span class="hs-identifier hs-var">ws</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-546"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X ()
</span><a href="XMonad.Actions.TagWindows.html#addTag"><span class="hs-identifier hs-var">addTag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NSP_NOEXCLUSIVE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482334"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- | If the focused window is a scratchpad, the scratchpad gets reset to</span><span>
</span><span id="line-549"></span><span class="hs-comment">-- the original placement specified with the hook and becomes exclusive</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- again.</span><span>
</span><span id="line-551"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#resetFocusedNSP"><span class="hs-identifier hs-type">resetFocusedNSP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span id="resetFocusedNSP"><span class="annot"><span class="annottext">resetFocusedNSP :: X ()
</span><a href="XMonad.Util.NamedScratchpad.html#resetFocusedNSP"><span class="hs-identifier hs-var hs-var">resetFocusedNSP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span> </span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">Map.elems</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679482332"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482332"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482330"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482330"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-555"></span><span>        </span><span id="local-6989586621679482329"><span class="annot"><span class="annottext">Maybe NamedScratchpad
</span><a href="#local-6989586621679482329"><span class="hs-identifier hs-var">mbWin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
Monad m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m (Maybe a)
</span><a href="XMonad.Prelude.html#findM"><span class="hs-identifier hs-var">findM</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-operator hs-var">`runQuery`</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482330"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482332"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-556"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="annot"><span class="annottext">Maybe NamedScratchpad
</span><a href="#local-6989586621679482329"><span class="hs-identifier hs-var">mbWin</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482327"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482327"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-557"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Endo a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">appEndo</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; ManageHook
</span><a href="XMonad.Util.NamedScratchpad.html#hook"><span class="hs-identifier hs-var">hook</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482327"><span class="hs-identifier hs-var">win</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482330"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-558"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#hideUnwanted"><span class="hs-identifier hs-var">hideUnwanted</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpad -&gt; String
</span><a href="XMonad.Util.NamedScratchpad.html#name"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482327"><span class="hs-identifier hs-var">win</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X ()
</span><a href="XMonad.Actions.TagWindows.html#delTag"><span class="hs-identifier hs-var">delTag</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NSP_NOEXCLUSIVE&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482330"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="hs-comment">-- | @hideUnwanted nspWindow@ hides all windows that @nspWindow@ does</span><span>
</span><span id="line-562"></span><span class="hs-comment">-- not like; i.e., windows that are in some kind of exclusivity contract</span><span>
</span><span id="line-563"></span><span class="hs-comment">-- with it.</span><span>
</span><span id="line-564"></span><span class="hs-comment">--</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- A consistency assumption for this is that @nspWindow@ must be the</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- currently focused window.  For this to take effect, @nspWindow@ must</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- not have set the @_NSP_NOEXCLUSIVE@ property, neither must any</span><span>
</span><span id="line-568"></span><span class="hs-comment">-- exclusive window we'd like to hide.</span><span>
</span><span id="line-569"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#hideUnwanted"><span class="hs-identifier hs-type">hideUnwanted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span id="hideUnwanted"><span class="annot"><span class="annottext">hideUnwanted :: String -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#hideUnwanted"><span class="hs-identifier hs-var hs-var">hideUnwanted</span></a></span></span><span> </span><span id="local-6989586621679482326"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482326"><span class="hs-identifier hs-var">nspWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482325"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482325"><span class="hs-identifier hs-var">winSet</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-571"></span><span>    </span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NSPState"><span class="hs-identifier hs-type">NSPState</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679482324"><span class="annot"><span class="annottext">Map String NamedScratchpads
nspExclusives :: Map String NamedScratchpads
nspExclusives :: NSPState -&gt; Map String NamedScratchpads
</span><a href="#local-6989586621679482324"><span class="hs-identifier hs-var hs-var">nspExclusives</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (ExtensionClass a, XLike m) =&gt; m a
</span><a href="XMonad.Util.ExtensibleState.html#get"><span class="hs-identifier hs-var">XS.get</span></a></span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-identifier hs-var">whenJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map String NamedScratchpads
</span><a href="#local-6989586621679482324"><span class="hs-identifier hs-var">nspExclusives</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; Map k a -&gt; k -&gt; Maybe a
</span><span class="hs-operator hs-var">!?</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482326"><span class="hs-identifier hs-var">nspWindow</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482323"><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482323"><span class="hs-identifier hs-var">unwanted</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-573"></span><span>        </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482322"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482322"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679482321"><span class="hs-identifier hs-var">notIgnored</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482322"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-574"></span><span>            </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.index</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482325"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679482320"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482320"><span class="hs-identifier hs-var">win</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-575"></span><span>                </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NamedScratchpads -&gt; Query Bool
</span><a href="#local-6989586621679482319"><span class="hs-identifier hs-var">isUnwanted</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpads
</span><a href="#local-6989586621679482323"><span class="hs-identifier hs-var">unwanted</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482320"><span class="hs-identifier hs-var">win</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-576"></span><span>                    </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; ((Window -&gt; X ()) -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#shiftToNSP"><span class="hs-identifier hs-var">shiftToNSP</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">W.workspaces</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679482325"><span class="hs-identifier hs-var">winSet</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482320"><span class="hs-identifier hs-var">win</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><a href="#local-6989586621679482321"><span class="hs-identifier hs-type">notIgnored</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-579"></span><span>    </span><span id="local-6989586621679482321"><span class="annot"><span class="annottext">notIgnored :: Query Bool
</span><a href="#local-6989586621679482321"><span class="hs-identifier hs-var hs-var">notIgnored</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">notElem</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NSP_NOEXCLUSIVE&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String]
</span><span class="hs-identifier hs-var">words</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Query String
</span><span class="hs-identifier hs-var">stringProperty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_XMONAD_TAGS&quot;</span></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><a href="#local-6989586621679482319"><span class="hs-identifier hs-type">isUnwanted</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#NamedScratchpad"><span class="hs-identifier hs-type">NamedScratchpad</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-582"></span><span>    </span><span id="local-6989586621679482319"><span class="annot"><span class="annottext">isUnwanted :: NamedScratchpads -&gt; Query Bool
</span><a href="#local-6989586621679482319"><span class="hs-identifier hs-var hs-var">isUnwanted</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679482321"><span class="hs-identifier hs-var">notIgnored</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">&lt;&amp;&amp;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679482314"><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482314"><span class="hs-identifier hs-var">nsp</span></a></span></span><span> </span><span id="local-6989586621679482313"><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679482313"><span class="hs-identifier hs-var">qs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query Bool
</span><a href="#local-6989586621679482313"><span class="hs-identifier hs-var">qs</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m Bool -&gt; m Bool
</span><span class="hs-operator hs-var">&lt;||&gt;</span></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad -&gt; Query Bool
</span><a href="XMonad.Util.NamedScratchpad.html#query"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">NamedScratchpad
</span><a href="#local-6989586621679482314"><span class="hs-identifier hs-var">nsp</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="hs-comment">-- | Float and drag the window; make it lose its exclusivity status in</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- the process.</span><span>
</span><span id="line-586"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#floatMoveNoexclusive"><span class="hs-identifier hs-type">floatMoveNoexclusive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-comment">-- ^ Window which should be moved</span><span>
</span><span id="line-587"></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span id="floatMoveNoexclusive"><span class="annot"><span class="annottext">floatMoveNoexclusive :: Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#floatMoveNoexclusive"><span class="hs-identifier hs-var hs-var">floatMoveNoexclusive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Window -&gt; X a) -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#mouseHelper"><span class="hs-identifier hs-var">mouseHelper</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">mouseMoveWindow</span></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="hs-comment">-- | Resize window and make it lose its exclusivity status in the</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- process.</span><span>
</span><span id="line-592"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#resizeNoexclusive"><span class="hs-identifier hs-type">resizeNoexclusive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-comment">-- ^ Window which should be resized</span><span>
</span><span id="line-593"></span><span>                  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-594"></span><span id="resizeNoexclusive"><span class="annot"><span class="annottext">resizeNoexclusive :: Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#resizeNoexclusive"><span class="hs-identifier hs-var hs-var">resizeNoexclusive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Window -&gt; X a) -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#mouseHelper"><span class="hs-identifier hs-var">mouseHelper</span></a></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">mouseResizeWindow</span></span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span id="local-6989586621679482686"><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#mouseHelper"><span class="hs-identifier hs-type">mouseHelper</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><a href="#local-6989586621679482686"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-597"></span><span id="mouseHelper"><span class="annot"><span class="annottext">mouseHelper :: forall a. (Window -&gt; X a) -&gt; Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#mouseHelper"><span class="hs-identifier hs-var hs-var">mouseHelper</span></a></span></span><span> </span><span id="local-6989586621679482305"><span class="annot"><span class="annottext">Window -&gt; X a
</span><a href="#local-6989586621679482305"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679482304"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482304"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><a href="XMonad.Util.NamedScratchpad.html#setNoexclusive"><span class="hs-identifier hs-var">setNoexclusive</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482304"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-598"></span><span>               </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">focus</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482304"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-599"></span><span>               </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; X a
</span><a href="#local-6989586621679482305"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679482304"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-600"></span><span>               </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">forall i l a s sd. StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftMaster</span></span><span>
</span><span id="line-601"></span><span>
</span><span id="line-602"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-603"></span><span class="hs-comment">-- Deprecations</span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="hs-comment">-- | Transforms a workspace list containing the NSP workspace into one that</span><span>
</span><span id="line-606"></span><span class="hs-comment">-- doesn't contain it. Intended for use with logHooks.</span><span>
</span><span id="line-607"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier hs-type">namedScratchpadFilterOutWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span>
</span><span id="line-608"></span><span id="namedScratchpadFilterOutWorkspace"><span class="annot"><span class="annottext">namedScratchpadFilterOutWorkspace :: [WindowSpace] -&gt; [WindowSpace]
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier hs-var hs-var">namedScratchpadFilterOutWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Workspace</span></span><span> </span><span id="local-6989586621679482300"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482300"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="annot"><span class="annottext">Layout Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679482300"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="XMonad.Util.NamedScratchpad.html#scratchpadWorkspaceTag"><span class="hs-identifier hs-var">scratchpadWorkspaceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">namedScratchpadFilterOutWorkspace</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Util.WorkspaceCompare.filterOutWs [scratchpadWorkspaceTag] instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span class="hs-comment">-- | Transforms a pretty-printer into one not displaying the NSP workspace.</span><span>
</span><span id="line-612"></span><span class="hs-comment">--</span><span>
</span><span id="line-613"></span><span class="hs-comment">-- A simple use could be:</span><span>
</span><span id="line-614"></span><span class="hs-comment">--</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- &gt; logHook = dynamicLogWithPP . namedScratchpadFilterOutWorkspace $ def</span><span>
</span><span id="line-616"></span><span class="hs-comment">--</span><span>
</span><span id="line-617"></span><span class="hs-comment">-- Here is another example, when using &quot;XMonad.Layout.IndependentScreens&quot;.</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- If you have handles @hLeft@ and @hRight@ for bars on the left and right screens, respectively, and @pp@ is a pretty-printer function that takes a handle, you could write</span><span>
</span><span id="line-619"></span><span class="hs-comment">--</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- &gt; logHook = let log screen handle = dynamicLogWithPP . namedScratchpadFilterOutWorkspacePP . marshallPP screen . pp $ handle</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- &gt;           in log 0 hLeft &gt;&gt; log 1 hRight</span><span>
</span><span id="line-622"></span><span class="annot"><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspacePP"><span class="hs-identifier hs-type">namedScratchpadFilterOutWorkspacePP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.StatusBar.PP.html#PP"><span class="hs-identifier hs-type">PP</span></a></span><span>
</span><span id="line-623"></span><span id="namedScratchpadFilterOutWorkspacePP"><span class="annot"><span class="annottext">namedScratchpadFilterOutWorkspacePP :: PP -&gt; PP
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspacePP"><span class="hs-identifier hs-var hs-var">namedScratchpadFilterOutWorkspacePP</span></a></span></span><span> </span><span id="local-6989586621679482299"><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679482299"><span class="hs-identifier hs-var">pp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679482299"><span class="hs-identifier hs-var">pp</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-624"></span><span>  </span><span class="annot"><span class="annottext">ppSort :: X ([WindowSpace] -&gt; [WindowSpace])
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppSort"><span class="hs-identifier hs-var">ppSort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[WindowSpace] -&gt; [WindowSpace]
</span><a href="XMonad.Util.NamedScratchpad.html#namedScratchpadFilterOutWorkspace"><span class="hs-identifier hs-var">namedScratchpadFilterOutWorkspace</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">PP -&gt; X ([WindowSpace] -&gt; [WindowSpace])
</span><a href="XMonad.Hooks.StatusBar.PP.html#ppSort"><span class="hs-identifier hs-var">ppSort</span></a></span><span> </span><span class="annot"><span class="annottext">PP
</span><a href="#local-6989586621679482299"><span class="hs-identifier hs-var">pp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-625"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-626"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">namedScratchpadFilterOutWorkspacePP</span><span> </span><span class="hs-pragma">&quot;Use XMonad.Hooks.StatusBar.PP.filterOutWsPP [scratchpadWorkspaceTag] instead&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-627"></span></pre></body></html>