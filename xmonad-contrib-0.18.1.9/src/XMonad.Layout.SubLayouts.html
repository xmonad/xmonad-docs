<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ParallelListComp #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE PatternGuards #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TupleSections #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ViewPatterns #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Module      :  XMonad.Layout.SubLayouts</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- Description :  A layout combinator that allows layouts to be nested.</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Copyright   :  (c) 2009 Adam Vogt</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- License     :  BSD-style (see xmonad/LICENSE)</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- Maintainer  :  vogt.adam@gmail.com</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-20"></span><span class="hs-comment">--</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- A layout combinator that allows layouts to be nested.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Layout.SubLayouts</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#subLayout"><span class="hs-identifier">subLayout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#subTabbed"><span class="hs-identifier">subTabbed</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pushGroup"><span class="hs-identifier">pushGroup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pullGroup"><span class="hs-identifier">pullGroup</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pushWindow"><span class="hs-identifier">pushWindow</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pullWindow"><span class="hs-identifier">pullWindow</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier">onGroup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier">toSubl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#mergeDir"><span class="hs-identifier">mergeDir</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupMsg"><span class="hs-identifier">GroupMsg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Broadcast"><span class="hs-identifier">Broadcast</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#defaultSublMap"><span class="hs-identifier">defaultSublMap</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier">Sublayout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Screenshots</span></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="hs-comment">-- $screenshots</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Todo</span></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- $todo</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html"><span class="hs-identifier">XMonad.Layout.Decoration</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Decoration"><span class="hs-identifier">Decoration</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#DefaultShrinker"><span class="hs-identifier">DefaultShrinker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html"><span class="hs-identifier">XMonad.Layout.LayoutModifier</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#LayoutModifier"><span class="hs-identifier">LayoutModifier</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#handleMess"><span class="hs-identifier">handleMess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#modifyLayout"><span class="hs-identifier">modifyLayout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>                                    </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#redoLayout"><span class="hs-identifier">redoLayout</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>                                    </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier">ModifiedLayout</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.Simplest.html"><span class="hs-identifier">XMonad.Layout.Simplest</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Simplest.html#Simplest"><span class="hs-identifier">Simplest</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.Tabbed.html"><span class="hs-identifier">XMonad.Layout.Tabbed</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#shrinkText"><span class="hs-identifier">shrinkText</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>                            </span><span class="annot"><a href="XMonad.Layout.Tabbed.html#TabbedDecoration"><span class="hs-identifier">TabbedDecoration</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.Tabbed.html#addTabs"><span class="hs-identifier">addTabs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Layout.WindowNavigation.html"><span class="hs-identifier">XMonad.Layout.WindowNavigation</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.WindowNavigation.html#Navigate"><span class="hs-identifier">Navigate</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.WindowNavigation.html#Apply"><span class="hs-identifier">Apply</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Invisible.html"><span class="hs-identifier">XMonad.Util.Invisible</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Invisible.html#Invisible"><span class="hs-identifier">Invisible</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html"><span class="hs-identifier">XMonad.Util.Types</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Types.html#Direction2D"><span class="hs-identifier">Direction2D</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">def</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Arrow</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Arrow</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">second</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&amp;&amp;&amp;)</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">X</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Layout.BoringWindows.html"><span class="hs-identifier">XMonad.Layout.BoringWindows</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">M</span></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- $screenshots</span><span>
</span><span id="line-72"></span><span class="hs-comment">--</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- &lt;&lt;http://haskell.org/sitewiki/images/thumb/8/8b/Xmonad-SubLayouts-xinerama.png/480px-Xmonad-SubLayouts-xinerama.png&gt;&gt;</span><span>
</span><span id="line-74"></span><span class="hs-comment">--</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- Larger version: &lt;http://haskell.org/sitewiki/images/8/8b/Xmonad-SubLayouts-xinerama.png&gt;</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- $todo</span><span>
</span><span id="line-78"></span><span class="hs-comment">--  /Issue 288/</span><span>
</span><span id="line-79"></span><span class="hs-comment">--</span><span>
</span><span id="line-80"></span><span class="hs-comment">--  &quot;XMonad.Layout.ResizableTile&quot; assumes that its environment</span><span>
</span><span id="line-81"></span><span class="hs-comment">--  contains only the windows it is running: sublayouts are currently run with</span><span>
</span><span id="line-82"></span><span class="hs-comment">--  the stack containing only the windows passed to it in its environment, but</span><span>
</span><span id="line-83"></span><span class="hs-comment">--  any changes that the layout makes are not merged back.</span><span>
</span><span id="line-84"></span><span class="hs-comment">--</span><span>
</span><span id="line-85"></span><span class="hs-comment">--  Should the behavior be made optional?</span><span>
</span><span id="line-86"></span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span class="hs-comment">--  /Features/</span><span>
</span><span id="line-88"></span><span class="hs-comment">--</span><span>
</span><span id="line-89"></span><span class="hs-comment">--   * suggested managehooks for merging specific windows, or the apropriate</span><span>
</span><span id="line-90"></span><span class="hs-comment">--     layout based hack to find out the number of groups currently showed, but</span><span>
</span><span id="line-91"></span><span class="hs-comment">--     the size of current window groups is not available (outside of this</span><span>
</span><span id="line-92"></span><span class="hs-comment">--     growing module)</span><span>
</span><span id="line-93"></span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span class="hs-comment">--  /SimpleTabbed as a SubLayout/</span><span>
</span><span id="line-95"></span><span class="hs-comment">--</span><span>
</span><span id="line-96"></span><span class="hs-comment">--  'subTabbed' works well, but it would be more uniform to avoid the use of</span><span>
</span><span id="line-97"></span><span class="hs-comment">--  addTabs, with the sublayout being Simplest (but</span><span>
</span><span id="line-98"></span><span class="hs-comment">--  'XMonad.Layout.Tabbed.simpleTabbed' is this...).  The only thing to be</span><span>
</span><span id="line-99"></span><span class="hs-comment">--  gained by fixing this issue is the ability to mix and match decoration</span><span>
</span><span id="line-100"></span><span class="hs-comment">--  styles. Better compatibility with some other layouts of which I am not</span><span>
</span><span id="line-101"></span><span class="hs-comment">--  aware could be another benefit.</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">--  'simpleTabbed' (and other decorated layouts) fail horribly when used as</span><span>
</span><span id="line-104"></span><span class="hs-comment">--  subLayouts:</span><span>
</span><span id="line-105"></span><span class="hs-comment">--</span><span>
</span><span id="line-106"></span><span class="hs-comment">--    * decorations stick around: layout is run after being told to Hide</span><span>
</span><span id="line-107"></span><span class="hs-comment">--</span><span>
</span><span id="line-108"></span><span class="hs-comment">--    * mouse events do not change focus: the group-ungroup does not respect</span><span>
</span><span id="line-109"></span><span class="hs-comment">--      the focus changes it wants?</span><span>
</span><span id="line-110"></span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span class="hs-comment">--    * sending ReleaseResources before running it makes xmonad very slow, and</span><span>
</span><span id="line-112"></span><span class="hs-comment">--      still leaves borders sticking around</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- You can use this module with the following in your @xmonad.hs@:</span><span>
</span><span id="line-117"></span><span class="hs-comment">--</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- &gt; import XMonad.Layout.SubLayouts</span><span>
</span><span id="line-119"></span><span class="hs-comment">-- &gt; import XMonad.Layout.WindowNavigation</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- Using &quot;XMonad.Layout.BoringWindows&quot; is optional and it allows you to add a</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- keybinding to skip over the non-visible windows.</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- &gt; import XMonad.Layout.BoringWindows</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- Then edit your @layoutHook@ by adding the 'subTabbed' layout modifier:</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- &gt; myLayout = windowNavigation $ subTabbed $ boringWindows $</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- &gt;                        Tall 1 (3/100) (1/2) ||| etc..</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- &gt; main = xmonad def { layoutHook = myLayout }</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- &quot;XMonad.Layout.WindowNavigation&quot; is used to specify which windows to merge,</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- and it is not integrated into the modifier because it can be configured, and</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- works best as the outer modifier.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- Then to your keybindings add:</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_h), sendMessage $ pullGroup L)</span><span>
</span><span id="line-139"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_l), sendMessage $ pullGroup R)</span><span>
</span><span id="line-140"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_k), sendMessage $ pullGroup U)</span><span>
</span><span id="line-141"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_j), sendMessage $ pullGroup D)</span><span>
</span><span id="line-142"></span><span class="hs-comment">--  &gt;</span><span>
</span><span id="line-143"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_m), withFocused (sendMessage . MergeAll))</span><span>
</span><span id="line-144"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_u), withFocused (sendMessage . UnMerge))</span><span>
</span><span id="line-145"></span><span class="hs-comment">--  &gt;</span><span>
</span><span id="line-146"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_period), onGroup W.focusUp')</span><span>
</span><span id="line-147"></span><span class="hs-comment">--  &gt; , ((modm .|. controlMask, xK_comma), onGroup W.focusDown')</span><span>
</span><span id="line-148"></span><span class="hs-comment">--</span><span>
</span><span id="line-149"></span><span class="hs-comment">--  These additional keybindings require the optional</span><span>
</span><span id="line-150"></span><span class="hs-comment">--  &quot;XMonad.Layout.BoringWindows&quot; layoutModifier. The focus will skip over the</span><span>
</span><span id="line-151"></span><span class="hs-comment">--  windows that are not focused in each sublayout.</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">--  &gt; , ((modm, xK_j), focusDown)</span><span>
</span><span id="line-154"></span><span class="hs-comment">--  &gt; , ((modm, xK_k), focusUp)</span><span>
</span><span id="line-155"></span><span class="hs-comment">--</span><span>
</span><span id="line-156"></span><span class="hs-comment">--  A 'submap' can be used to make modifying the sublayouts using 'onGroup' and</span><span>
</span><span id="line-157"></span><span class="hs-comment">--  'toSubl' simpler:</span><span>
</span><span id="line-158"></span><span class="hs-comment">--</span><span>
</span><span id="line-159"></span><span class="hs-comment">--  &gt; ,((modm, xK_s), submap $ defaultSublMap conf)</span><span>
</span><span id="line-160"></span><span class="hs-comment">--</span><span>
</span><span id="line-161"></span><span class="hs-comment">--  /NOTE:/ is there some reason that @asks config &gt;&gt;= submap . defaultSublMap@</span><span>
</span><span id="line-162"></span><span class="hs-comment">--  could not be used in the keybinding instead? It avoids having to explicitly</span><span>
</span><span id="line-163"></span><span class="hs-comment">--  pass the conf.</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- For more detailed instructions, see</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- &lt;https://xmonad.org/TUTORIAL.html#customizing-xmonad the tutorial&gt;</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- and &quot;XMonad.Doc.Extending#Editing_the_layout_hook&quot;.</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | The main layout modifier arguments:</span><span>
</span><span id="line-170"></span><span class="hs-comment">--</span><span>
</span><span id="line-171"></span><span class="hs-comment">-- @subLayout advanceInnerLayouts innerLayout outerLayout@</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="hs-comment">--  [@advanceInnerLayouts@] When a new group at index @n@ in the outer layout</span><span>
</span><span id="line-174"></span><span class="hs-comment">--  is created (even with one element), the @innerLayout@ is used as the</span><span>
</span><span id="line-175"></span><span class="hs-comment">--  layout within that group after being advanced with @advanceInnerLayouts !!</span><span>
</span><span id="line-176"></span><span class="hs-comment">--  n@ 'NextLayout' messages. If there is no corresponding element in the</span><span>
</span><span id="line-177"></span><span class="hs-comment">--  @advanceInnerLayouts@ list, then @innerLayout@ is not given any 'NextLayout'</span><span>
</span><span id="line-178"></span><span class="hs-comment">--  messages.</span><span>
</span><span id="line-179"></span><span class="hs-comment">--</span><span>
</span><span id="line-180"></span><span class="hs-comment">--  [@innerLayout@] The single layout given to be run as a sublayout.</span><span>
</span><span id="line-181"></span><span class="hs-comment">--</span><span>
</span><span id="line-182"></span><span class="hs-comment">--  [@outerLayout@] The layout that determines the rectangles given to each</span><span>
</span><span id="line-183"></span><span class="hs-comment">--  group.</span><span>
</span><span id="line-184"></span><span class="hs-comment">--</span><span>
</span><span id="line-185"></span><span class="hs-comment">--  Ex. The second group is 'Tall', the third is 'XMonad.Layout.CircleEx.circle',</span><span>
</span><span id="line-186"></span><span class="hs-comment">--  all others are tabbed with:</span><span>
</span><span id="line-187"></span><span class="hs-comment">--</span><span>
</span><span id="line-188"></span><span class="hs-comment">--  &gt; myLayout = addTabs shrinkText def</span><span>
</span><span id="line-189"></span><span class="hs-comment">--  &gt;          $ subLayout [0,1,2] (Simplest ||| Tall 1 0.2 0.5 ||| circle)</span><span>
</span><span id="line-190"></span><span class="hs-comment">--  &gt;          $ Tall 1 0.2 0.5 ||| Full</span><span>
</span><span id="line-191"></span><span id="local-6989586621679494590"><span id="local-6989586621679494591"><span id="local-6989586621679494592"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#subLayout"><span class="hs-identifier hs-type">subLayout</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494592"><span class="hs-identifier hs-type">subl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494591"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494590"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494591"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-type">ModifiedLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494592"><span class="hs-identifier hs-type">subl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679494590"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494591"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-192"></span><span id="subLayout"><span class="annot"><span class="annottext">subLayout :: forall (subl :: * -&gt; *) a (l :: * -&gt; *).
[Int] -&gt; subl a -&gt; l a -&gt; ModifiedLayout (Sublayout subl) l a
</span><a href="XMonad.Layout.SubLayouts.html#subLayout"><span class="hs-identifier hs-var hs-var">subLayout</span></a></span></span><span> </span><span id="local-6989586621679494192"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679494192"><span class="hs-identifier hs-var">nextLayout</span></a></span></span><span> </span><span id="local-6989586621679494191"><span class="annot"><span class="annottext">subl a
</span><a href="#local-6989586621679494191"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) (l :: * -&gt; *) a.
m a -&gt; l a -&gt; ModifiedLayout m l a
</span><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-var">ModifiedLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Invisible [] (SomeMessage, a)
-&gt; ([Int], l a) -&gt; [(l a, Stack a)] -&gt; Sublayout l a
</span><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679494192"><span class="hs-identifier hs-var">nextLayout</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">subl a
</span><a href="#local-6989586621679494191"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-comment">-- | @subTabbed@ is a use of 'subLayout' with 'addTabs' to show decorations.</span><span>
</span><span id="line-195"></span><span id="local-6989586621679494574"><span id="local-6989586621679494576"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#subTabbed"><span class="hs-identifier hs-type">subTabbed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679494576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#LayoutModifier"><span class="hs-identifier hs-type">LayoutModifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.Simplest.html#Simplest"><span class="hs-identifier hs-type">Simplest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679494576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679494574"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494576"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><a href="#local-6989586621679494574"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494576"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-type">ModifiedLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.Decoration.html#Decoration"><span class="hs-identifier hs-type">Decoration</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.Tabbed.html#TabbedDecoration"><span class="hs-identifier hs-type">TabbedDecoration</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.Decoration.html#DefaultShrinker"><span class="hs-identifier hs-type">DefaultShrinker</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                          </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#ModifiedLayout"><span class="hs-identifier hs-type">ModifiedLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span> </span><span class="annot"><a href="XMonad.Layout.Simplest.html#Simplest"><span class="hs-identifier hs-type">Simplest</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679494574"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679494576"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-198"></span><span id="subTabbed"><span class="annot"><span class="annottext">subTabbed :: forall a (l :: * -&gt; *).
(Eq a, LayoutModifier (Sublayout Simplest) a, LayoutClass l a) =&gt;
l a
-&gt; ModifiedLayout
     (Decoration TabbedDecoration DefaultShrinker)
     (ModifiedLayout (Sublayout Simplest) l)
     a
</span><a href="XMonad.Layout.SubLayouts.html#subTabbed"><span class="hs-identifier hs-var hs-var">subTabbed</span></a></span></span><span>  </span><span id="local-6989586621679494174"><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679494174"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a (l :: * -&gt; *) s.
(Eq a, LayoutClass l a, Shrinker s) =&gt;
s
-&gt; Theme
-&gt; l a
-&gt; ModifiedLayout (Decoration TabbedDecoration s) l a
</span><a href="XMonad.Layout.Tabbed.html#addTabs"><span class="hs-identifier hs-var">addTabs</span></a></span><span> </span><span class="annot"><span class="annottext">DefaultShrinker
</span><a href="XMonad.Layout.Decoration.html#shrinkText"><span class="hs-identifier hs-var">shrinkText</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">X.def</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (subl :: * -&gt; *) a (l :: * -&gt; *).
[Int] -&gt; subl a -&gt; l a -&gt; ModifiedLayout (Sublayout subl) l a
</span><a href="XMonad.Layout.SubLayouts.html#subLayout"><span class="hs-identifier hs-var">subLayout</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. Simplest a
</span><a href="XMonad.Layout.Simplest.html#Simplest"><span class="hs-identifier hs-var">Simplest</span></a></span><span> </span><span class="annot"><span class="annottext">l a
</span><a href="#local-6989586621679494174"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | @defaultSublMap@ is an attempt to create a set of keybindings like the</span><span>
</span><span id="line-201"></span><span class="hs-comment">-- defaults ones but to be used as a 'submap' for sending messages to the</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- sublayout.</span><span>
</span><span id="line-203"></span><span id="local-6989586621679494554"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#defaultSublMap"><span class="hs-identifier hs-type">defaultSublMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span> </span><span class="annot"><a href="#local-6989586621679494554"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KeyMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">KeySym</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-204"></span><span id="defaultSublMap"><span class="annot"><span class="annottext">defaultSublMap :: forall (l :: * -&gt; *). XConfig l -&gt; Map (KeyMask, Window) (X ())
</span><a href="XMonad.Layout.SubLayouts.html#defaultSublMap"><span class="hs-identifier hs-var hs-var">defaultSublMap</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">XConfig</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">modMask :: forall (l :: * -&gt; *). XConfig l -&gt; KeyMask
</span><span class="hs-identifier hs-var">modMask</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679494150"><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span>
</span><span id="line-205"></span><span>         </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_space</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-var">toSubl</span></a></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">NextLayout</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_j</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var">onGroup</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_k</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var">onGroup</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_h</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-var">toSubl</span></a></span><span> </span><span class="annot"><span class="annottext">Resize
</span><span class="hs-identifier hs-var">Shrink</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-209"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_l</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-var">toSubl</span></a></span><span> </span><span class="annot"><span class="annottext">Resize
</span><span class="hs-identifier hs-var">Expand</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Tab</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var">onGroup</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">.|.</span></span><span> </span><span class="annot"><span class="annottext">KeyMask
</span><span class="hs-identifier hs-var">shiftMask</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Tab</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var">onGroup</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusUp'</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_m</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var">onGroup</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><a href="#local-6989586621679494134"><span class="hs-identifier hs-var">focusMaster'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-213"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_comma</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-var">toSubl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IncMasterN
</span><span class="hs-identifier hs-var">IncMasterN</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-214"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_period</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-var">toSubl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; IncMasterN
</span><span class="hs-identifier hs-var">IncMasterN</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-215"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">KeyMask
</span><a href="#local-6989586621679494150"><span class="hs-identifier hs-var">modm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier hs-var">xK_Return</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var">onGroup</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><a href="#local-6989586621679494129"><span class="hs-identifier hs-var">swapMaster'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>         </span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-218"></span><span>         </span><span class="hs-comment">-- should these go into XMonad.StackSet?</span><span>
</span><span id="line-219"></span><span>         </span><span id="local-6989586621679494134"><span class="annot"><span class="annottext">focusMaster' :: Stack a -&gt; Stack a
</span><a href="#local-6989586621679494134"><span class="hs-identifier hs-var hs-var">focusMaster'</span></a></span></span><span> </span><span id="local-6989586621679494128"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679494128"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [a] -&gt; NonEmpty a
</span><a href="XMonad.Prelude.html#notEmpty"><span class="hs-identifier hs-var">notEmpty</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span id="local-6989586621679494124"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494124"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679494123"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494123"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679494128"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-220"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494124"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494123"><span class="hs-identifier hs-var">fs</span></a></span><span>
</span><span id="line-221"></span><span>         </span><span id="local-6989586621679494129"><span class="annot"><span class="annottext">swapMaster' :: Stack a -&gt; Stack a
</span><a href="#local-6989586621679494129"><span class="hs-identifier hs-var hs-var">swapMaster'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679494120"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494120"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679494119"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494119"><span class="hs-identifier hs-var">u</span></a></span></span><span> </span><span id="local-6989586621679494118"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494118"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679494120"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494119"><span class="hs-identifier hs-var">u</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679494118"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-keyword">data</span><span> </span><span id="Sublayout"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span></span><span> </span><span id="local-6989586621679494580"><span class="annot"><a href="#local-6989586621679494580"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679494582"><span class="annot"><a href="#local-6989586621679494582"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Sublayout"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="delayMess"><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Sublayout l a -&gt; Invisible [] (SomeMessage, a)
</span><a href="XMonad.Layout.SubLayouts.html#delayMess"><span class="hs-identifier hs-var hs-var">delayMess</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Invisible.html#Invisible"><span class="hs-identifier hs-type">Invisible</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span class="hs-special">,</span><span class="annot"><a href="#local-6989586621679494582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>                          </span><span class="hs-comment">-- ^ messages are handled when running the layout,</span><span>
</span><span id="line-226"></span><span>                          </span><span class="hs-comment">-- not in the handleMessage, I'm not sure that this</span><span>
</span><span id="line-227"></span><span>                          </span><span class="hs-comment">-- is necessary</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="def"><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a. Sublayout l a -&gt; ([Int], l a)
</span><a href="XMonad.Layout.SubLayouts.html#def"><span class="hs-identifier hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679494580"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- ^ how many NextLayout messages to send to newly</span><span>
</span><span id="line-229"></span><span>                          </span><span class="hs-comment">-- populated layouts. If there is no corresponding</span><span>
</span><span id="line-230"></span><span>                          </span><span class="hs-comment">-- index, then don't send any.</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="subls"><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a. Sublayout l a -&gt; [(l a, Stack a)]
</span><a href="XMonad.Layout.SubLayouts.html#subls"><span class="hs-identifier hs-var hs-var">subls</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494580"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494582"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-232"></span><span>                          </span><span class="hs-comment">-- ^ The sublayouts and the stacks they manage</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679494084"><span id="local-6989586621679494107"><span id="local-6989586621679494110"><span id="local-6989586621679494112"><span class="annot"><span class="annottext">ReadPrec [Sublayout l a]
ReadPrec (Sublayout l a)
ReadS [Sublayout l a]
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
ReadPrec [Sublayout l a]
forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
ReadPrec (Sublayout l a)
forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
Int -&gt; ReadS (Sublayout l a)
forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
ReadS [Sublayout l a]
readListPrec :: ReadPrec [Sublayout l a]
$creadListPrec :: forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
ReadPrec [Sublayout l a]
readPrec :: ReadPrec (Sublayout l a)
$creadPrec :: forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
ReadPrec (Sublayout l a)
readList :: ReadS [Sublayout l a]
$creadList :: forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
ReadS [Sublayout l a]
readsPrec :: Int -&gt; ReadS (Sublayout l a)
$creadsPrec :: forall (l :: * -&gt; *) a.
(Read a, Read (l a)) =&gt;
Int -&gt; ReadS (Sublayout l a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span id="local-6989586621679494058"><span id="local-6989586621679494060"><span id="local-6989586621679494073"><span class="annot"><span class="annottext">Int -&gt; Sublayout l a -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (l :: * -&gt; *) a.
(Show a, Show (l a)) =&gt;
Int -&gt; Sublayout l a -&gt; ShowS
forall (l :: * -&gt; *) a.
(Show a, Show (l a)) =&gt;
[Sublayout l a] -&gt; ShowS
forall (l :: * -&gt; *) a.
(Show a, Show (l a)) =&gt;
Sublayout l a -&gt; String
showList :: [Sublayout l a] -&gt; ShowS
$cshowList :: forall (l :: * -&gt; *) a.
(Show a, Show (l a)) =&gt;
[Sublayout l a] -&gt; ShowS
show :: Sublayout l a -&gt; String
$cshow :: forall (l :: * -&gt; *) a.
(Show a, Show (l a)) =&gt;
Sublayout l a -&gt; String
showsPrec :: Int -&gt; Sublayout l a -&gt; ShowS
$cshowsPrec :: forall (l :: * -&gt; *) a.
(Show a, Show (l a)) =&gt;
Int -&gt; Sublayout l a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- | Groups assumes this invariant:</span><span>
</span><span id="line-237"></span><span class="hs-comment">--     M.keys gs == map W.focus (M.elems gs)  (ignoring order)</span><span>
</span><span id="line-238"></span><span class="hs-comment">--     All windows in the workspace are in the Map</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- The keys are visible windows, the rest are hidden.</span><span>
</span><span id="line-241"></span><span class="hs-comment">--</span><span>
</span><span id="line-242"></span><span class="hs-comment">-- This representation probably simplifies the internals of the modifier.</span><span>
</span><span id="line-243"></span><span class="hs-keyword">type</span><span> </span><span id="Groups"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-var">Groups</span></a></span></span><span> </span><span id="local-6989586621679494052"><span class="annot"><a href="#local-6989586621679494052"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679494052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Stack of stacks, a simple representation of groups for purposes of focus.</span><span>
</span><span id="line-246"></span><span class="hs-keyword">type</span><span> </span><span id="GroupStack"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupStack"><span class="hs-identifier hs-var">GroupStack</span></a></span></span><span> </span><span id="local-6989586621679494051"><span class="annot"><a href="#local-6989586621679494051"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494051"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | GroupMsg take window parameters to determine which group the action should</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- be applied to</span><span>
</span><span id="line-250"></span><span class="hs-keyword">data</span><span> </span><span id="GroupMsg"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupMsg"><span class="hs-identifier hs-var">GroupMsg</span></a></span></span><span> </span><span id="local-6989586621679494506"><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="UnMerge"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#UnMerge"><span class="hs-identifier hs-var">UnMerge</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ free the focused window from its tab stack</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UnMergeAll"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#UnMergeAll"><span class="hs-identifier hs-var">UnMergeAll</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-253"></span><span>                </span><span class="hs-comment">-- ^ separate the focused group into singleton groups</span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Merge"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- ^ merge the first group into the second group</span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="MergeAll"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#MergeAll"><span class="hs-identifier hs-var">MergeAll</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-256"></span><span>                </span><span class="hs-comment">-- ^ make one large group, keeping the parameter focused</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Migrate"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Migrate"><span class="hs-identifier hs-var">Migrate</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-258"></span><span>                </span><span class="hs-comment">-- ^ used to the window named in the first argument to the</span><span>
</span><span id="line-259"></span><span>                </span><span class="hs-comment">-- second argument's group, this may be replaced by a</span><span>
</span><span id="line-260"></span><span>                </span><span class="hs-comment">-- combination of 'UnMerge' and 'Merge'</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="WithGroup"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#WithGroup"><span class="hs-identifier hs-var">WithGroup</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="SubMessage"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#SubMessage"><span class="hs-identifier hs-var">SubMessage</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span>  </span><span class="annot"><a href="#local-6989586621679494506"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-263"></span><span>                </span><span class="hs-comment">-- ^ the sublayout with the given window will get the message</span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span class="hs-comment">-- | merge the window that would be focused by the function when applied to the</span><span>
</span><span id="line-266"></span><span class="hs-comment">-- W.Stack of all windows, with the current group removed. The given window</span><span>
</span><span id="line-267"></span><span class="hs-comment">-- should be focused by a sublayout. Example usage: @withFocused (sendMessage .</span><span>
</span><span id="line-268"></span><span class="hs-comment">-- mergeDir W.focusDown')@</span><span>
</span><span id="line-269"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#mergeDir"><span class="hs-identifier hs-type">mergeDir</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupMsg"><span class="hs-identifier hs-type">GroupMsg</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-270"></span><span id="mergeDir"><span class="annot"><span class="annottext">mergeDir :: (Stack Window -&gt; Stack Window) -&gt; Window -&gt; GroupMsg Window
</span><a href="XMonad.Layout.SubLayouts.html#mergeDir"><span class="hs-identifier hs-var hs-var">mergeDir</span></a></span></span><span> </span><span id="local-6989586621679494043"><span class="annot"><span class="annottext">Stack Window -&gt; Stack Window
</span><a href="#local-6989586621679494043"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (Stack a -&gt; X (Stack a)) -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#WithGroup"><span class="hs-identifier hs-var">WithGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window -&gt; X (Stack Window)
</span><a href="#local-6989586621679494042"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-271"></span><span> </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679494042"><span class="annot"><span class="annottext">g :: Stack Window -&gt; X (Stack Window)
</span><a href="#local-6989586621679494042"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span id="local-6989586621679494034"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679494034"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-272"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679494030"><span class="annot"><span class="annottext">onlyOthers :: Stack Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679494030"><span class="hs-identifier hs-var hs-var">onlyOthers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679494034"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; Maybe a -&gt; (a -&gt; m ()) -&gt; m ()
</span><span class="hs-operator hs-var">`whenJust`</span></span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679494034"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stack Window -&gt; Stack Window
</span><a href="#local-6989586621679494043"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679494030"><span class="hs-identifier hs-var">onlyOthers</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>          </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var">currentStack</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679494034"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-keyword">newtype</span><span> </span><span id="Broadcast"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Broadcast"><span class="hs-identifier hs-var">Broadcast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Broadcast"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Broadcast"><span class="hs-identifier hs-var">Broadcast</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SomeMessage</span></span><span> </span><span class="hs-comment">-- ^ send a message to all sublayouts</span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Broadcast"><span class="hs-identifier hs-type">Broadcast</span></a></span><span>
</span><span id="line-281"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679494593"><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679494593"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupMsg"><span class="hs-identifier hs-type">GroupMsg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494593"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | @pullGroup@, @pushGroup@ allow you to merge windows or groups inheriting</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- the position of the current window (pull) or the other window (push).</span><span>
</span><span id="line-285"></span><span class="hs-comment">--</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- @pushWindow@ and @pullWindow@ move individual windows between groups. They</span><span>
</span><span id="line-287"></span><span class="hs-comment">-- are less effective at preserving window positions.</span><span>
</span><span id="line-288"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pullGroup"><span class="hs-identifier hs-type">pullGroup</span></a></span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pushGroup"><span class="hs-identifier hs-type">pushGroup</span></a></span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pullWindow"><span class="hs-identifier hs-type">pullWindow</span></a></span><span class="hs-special">,</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#pushWindow"><span class="hs-identifier hs-type">pushWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction2D"><span class="hs-identifier hs-type">Direction2D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.WindowNavigation.html#Navigate"><span class="hs-identifier hs-type">Navigate</span></a></span><span>
</span><span id="line-289"></span><span id="pullGroup"><span class="annot"><span class="annottext">pullGroup :: Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#pullGroup"><span class="hs-identifier hs-var hs-var">pullGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; X ()) -&gt; Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#mergeNav"><span class="hs-identifier hs-var">mergeNav</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679494011"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494011"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679494010"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494010"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494011"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494010"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span id="pushGroup"><span class="annot"><span class="annottext">pushGroup :: Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#pushGroup"><span class="hs-identifier hs-var hs-var">pushGroup</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; X ()) -&gt; Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#mergeNav"><span class="hs-identifier hs-var">mergeNav</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679494009"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494009"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679494008"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494008"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#Merge"><span class="hs-identifier hs-var">Merge</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494008"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494009"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span id="pullWindow"><span class="annot"><span class="annottext">pullWindow :: Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#pullWindow"><span class="hs-identifier hs-var hs-var">pullWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; X ()) -&gt; Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#mergeNav"><span class="hs-identifier hs-var">mergeNav</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679494007"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494007"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679494006"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494006"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#Migrate"><span class="hs-identifier hs-var">Migrate</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494007"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494006"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span id="pushWindow"><span class="annot"><span class="annottext">pushWindow :: Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#pushWindow"><span class="hs-identifier hs-var hs-var">pushWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Window -&gt; X ()) -&gt; Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#mergeNav"><span class="hs-identifier hs-var">mergeNav</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679494005"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494005"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span id="local-6989586621679494004"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494004"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#Migrate"><span class="hs-identifier hs-var">Migrate</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494004"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679494005"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#mergeNav"><span class="hs-identifier hs-type">mergeNav</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Util.Types.html#Direction2D"><span class="hs-identifier hs-type">Direction2D</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.WindowNavigation.html#Navigate"><span class="hs-identifier hs-type">Navigate</span></a></span><span>
</span><span id="line-295"></span><span id="mergeNav"><span class="annot"><span class="annottext">mergeNav :: (Window -&gt; Window -&gt; X ()) -&gt; Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.SubLayouts.html#mergeNav"><span class="hs-identifier hs-var hs-var">mergeNav</span></a></span></span><span> </span><span id="local-6989586621679494003"><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X ()
</span><a href="#local-6989586621679494003"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; Direction2D -&gt; Navigate
</span><a href="XMonad.Layout.WindowNavigation.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Window -&gt; X ()
</span><a href="#local-6989586621679494003"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Apply a function on the stack belonging to the currently focused group. It</span><span>
</span><span id="line-298"></span><span class="hs-comment">-- works for rearranging windows and for changing focus.</span><span>
</span><span id="line-299"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-type">onGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span id="onGroup"><span class="annot"><span class="annottext">onGroup :: (Stack Window -&gt; Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#onGroup"><span class="hs-identifier hs-var hs-var">onGroup</span></a></span></span><span> </span><span id="local-6989586621679494001"><span class="annot"><span class="annottext">Stack Window -&gt; Stack Window
</span><a href="#local-6989586621679494001"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (Stack a -&gt; X (Stack a)) -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#WithGroup"><span class="hs-identifier hs-var">WithGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Stack Window -&gt; Stack Window
</span><a href="#local-6989586621679494001"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span class="hs-comment">-- | Send a message to the currently focused sublayout.</span><span>
</span><span id="line-303"></span><span id="local-6989586621679494540"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-type">toSubl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Message</span></span><span> </span><span class="annot"><a href="#local-6989586621679494540"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-304"></span><span id="toSubl"><span class="annot"><span class="annottext">toSubl :: forall a. Message a =&gt; a -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#toSubl"><span class="hs-identifier hs-var hs-var">toSubl</span></a></span></span><span> </span><span id="local-6989586621679493997"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493997"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Window -&gt; X ()) -&gt; X ()
</span><span class="hs-identifier hs-var">withFocused</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessage</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. SomeMessage -&gt; a -&gt; GroupMsg a
</span><a href="XMonad.Layout.SubLayouts.html#SubMessage"><span class="hs-identifier hs-var">SubMessage</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493997"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679493971"><span id="local-6989586621679493973"><span id="local-6989586621679493975"><span id="local-6989586621679493977"><span id="local-6989586621679493979"><span id="local-6989586621679493982"><span id="local-6989586621679493984"><span id="local-6989586621679493987"><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679494477"><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.LayoutModifier.html#LayoutModifier"><span class="hs-identifier hs-type">LayoutModifier</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679493960"><span class="annot"><span class="annottext">modifyLayout :: forall (l :: * -&gt; *).
LayoutClass l Window =&gt;
Sublayout l Window
-&gt; Workspace String (l Window) Window
-&gt; Rectangle
-&gt; X ([(Window, Rectangle)], Maybe (l Window))
</span><a href="#local-6989586621679493960"><span class="hs-identifier hs-var hs-var hs-var hs-var">modifyLayout</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">subls :: forall (l :: * -&gt; *) a. Sublayout l a -&gt; [(l a, Stack a)]
</span><a href="XMonad.Layout.SubLayouts.html#subls"><span class="hs-identifier hs-var">subls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679493959"><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493959"><span class="hs-identifier hs-var">osls</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Workspace</span></span><span> </span><span id="local-6989586621679493957"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679493957"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679493956"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493956"><span class="hs-identifier hs-var">la</span></a></span></span><span> </span><span id="local-6989586621679493955"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493955"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679493954"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493954"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493951"><span class="annot"><span class="annottext">gs' :: Groups Window
</span><a href="#local-6989586621679493951"><span class="hs-identifier hs-var hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Maybe (Stack a) -&gt; Groups a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#updateGroup"><span class="hs-identifier hs-var">updateGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493955"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a a1. Ord a =&gt; [(a1, Stack a)] -&gt; Map a (Stack a)
</span><a href="XMonad.Layout.SubLayouts.html#toGroups"><span class="hs-identifier hs-var">toGroups</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493959"><span class="hs-identifier hs-var">osls</span></a></span><span>
</span><span id="line-309"></span><span>                </span><span id="local-6989586621679493945"><span class="annot"><span class="annottext">st' :: Maybe (Stack Window)
</span><a href="#local-6989586621679493945"><span class="hs-identifier hs-var hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493951"><span class="hs-identifier hs-var">gs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493955"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">Groups Window -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#updateWs"><span class="hs-identifier hs-var">updateWs</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493951"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span id="local-6989586621679493941"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493941"><span class="hs-identifier hs-var">oldStack</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var">currentStack</span></a></span><span>
</span><span id="line-312"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#setStack"><span class="hs-identifier hs-var">setStack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493945"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679493957"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493956"><span class="hs-identifier hs-var">la</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493945"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493954"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#setStack"><span class="hs-identifier hs-var">setStack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493941"><span class="hs-identifier hs-var">oldStack</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="hs-comment">-- FIXME: merge back reordering, deletions?</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span>    </span><span id="local-6989586621679493922"><span class="annot"><span class="annottext">redoLayout :: Sublayout l Window
-&gt; Rectangle
-&gt; Maybe (Stack Window)
-&gt; [(Window, Rectangle)]
-&gt; X ([(Window, Rectangle)], Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493922"><span class="hs-identifier hs-var hs-var hs-var hs-var">redoLayout</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">delayMess :: forall (l :: * -&gt; *) a.
Sublayout l a -&gt; Invisible [] (SomeMessage, a)
</span><a href="XMonad.Layout.SubLayouts.html#delayMess"><span class="hs-identifier hs-var">delayMess</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621679493921"><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493921"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">def :: forall (l :: * -&gt; *) a. Sublayout l a -&gt; ([Int], l a)
</span><a href="XMonad.Layout.SubLayouts.html#def"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679493920"><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493920"><span class="hs-identifier hs-var">defl</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">subls :: forall (l :: * -&gt; *) a. Sublayout l a -&gt; [(l a, Stack a)]
</span><a href="XMonad.Layout.SubLayouts.html#subls"><span class="hs-identifier hs-var">subls</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679493919"><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493919"><span class="hs-identifier hs-var">osls</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span id="local-6989586621679493918"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493918"><span class="hs-identifier hs-var">_r</span></a></span></span><span> </span><span id="local-6989586621679493917"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493917"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679493916"><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679493916"><span class="hs-identifier hs-var">arrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493913"><span class="annot"><span class="annottext">gs' :: Groups Window
</span><a href="#local-6989586621679493913"><span class="hs-identifier hs-var hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Maybe (Stack a) -&gt; Groups a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#updateGroup"><span class="hs-identifier hs-var">updateGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493917"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a a1. Ord a =&gt; [(a1, Stack a)] -&gt; Map a (Stack a)
</span><a href="XMonad.Layout.SubLayouts.html#toGroups"><span class="hs-identifier hs-var">toGroups</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493919"><span class="hs-identifier hs-var">osls</span></a></span><span>
</span><span id="line-318"></span><span>        </span><span id="local-6989586621679493912"><span class="annot"><span class="annottext">[(Bool, (l Window, Stack Window))]
</span><a href="#local-6989586621679493912"><span class="hs-identifier hs-var">sls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a k b.
(LayoutClass layout a, Ord k) =&gt;
([Int], layout a)
-&gt; Maybe (Stack k)
-&gt; Groups k
-&gt; [(layout a, b)]
-&gt; X [(Bool, (layout a, Stack k))]
</span><a href="XMonad.Layout.SubLayouts.html#fromGroups"><span class="hs-identifier hs-var">fromGroups</span></a></span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493920"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493917"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493913"><span class="hs-identifier hs-var">gs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493919"><span class="hs-identifier hs-var">osls</span></a></span><span>
</span><span id="line-319"></span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679493910"><span class="hs-identifier hs-type">newL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-321"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rectangle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>            </span><span id="local-6989586621679493910"><span class="annot"><span class="annottext">newL :: LayoutClass l Window =&gt;
Rectangle
-&gt; String
-&gt; l Window
-&gt; Bool
-&gt; Maybe (Stack Window)
-&gt; X ([(Window, Rectangle)], l Window)
</span><a href="#local-6989586621679493910"><span class="hs-identifier hs-var hs-var">newL</span></a></span></span><span> </span><span id="local-6989586621679493893"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493893"><span class="hs-identifier hs-var">rect</span></a></span></span><span> </span><span id="local-6989586621679493892"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679493892"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679493891"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493891"><span class="hs-identifier hs-var">ol</span></a></span></span><span> </span><span id="local-6989586621679493890"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679493890"><span class="hs-identifier hs-var">isNew</span></a></span></span><span> </span><span id="local-6989586621679493889"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493889"><span class="hs-identifier hs-var">sst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>                </span><span id="local-6989586621679493888"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493888"><span class="hs-identifier hs-var">orgStack</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var">currentStack</span></a></span><span>
</span><span id="line-324"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493883"><span class="annot"><span class="annottext">handle :: layout a -&gt; (SomeMessage, b) -&gt; X (layout a)
</span><a href="#local-6989586621679493883"><span class="hs-identifier hs-var hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679493882"><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493882"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679493881"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493881"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679493890"><span class="hs-identifier hs-var">isNew</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493882"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493882"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493881"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-326"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493882"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-327"></span><span>                    </span><span id="local-6989586621679493874"><span class="annot"><span class="annottext">kms :: [(SomeMessage, Window)]
</span><a href="#local-6989586621679493874"><span class="hs-identifier hs-var hs-var">kms</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [k]
</span><span class="hs-identifier hs-var">M.keys</span></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493913"><span class="hs-identifier hs-var">gs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493921"><span class="hs-identifier hs-var">ms</span></a></span><span>
</span><span id="line-328"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#setStack"><span class="hs-identifier hs-var">setStack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493889"><span class="hs-identifier hs-var">sst</span></a></span><span>
</span><span id="line-329"></span><span>                </span><span id="local-6989586621679493873"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493873"><span class="hs-identifier hs-var">nl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">forall {layout :: * -&gt; *} {a} {b}.
LayoutClass layout a =&gt;
layout a -&gt; (SomeMessage, b) -&gt; X (layout a)
</span><a href="#local-6989586621679493883"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493891"><span class="hs-identifier hs-var">ol</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493889"><span class="hs-identifier hs-var">sst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493874"><span class="hs-identifier hs-var">kms</span></a></span><span>
</span><span id="line-330"></span><span>                </span><span id="local-6989586621679493870"><span class="annot"><span class="annottext">([(Window, Rectangle)], Maybe (l Window))
</span><a href="#local-6989586621679493870"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
Workspace String (layout a) a
-&gt; Rectangle -&gt; X ([(a, Rectangle)], Maybe (layout a))
</span><span class="hs-identifier hs-var">runLayout</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.Workspace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679493892"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493873"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493889"><span class="hs-identifier hs-var">sst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493893"><span class="hs-identifier hs-var">rect</span></a></span><span>
</span><span id="line-331"></span><span>                </span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#setStack"><span class="hs-identifier hs-var">setStack</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493888"><span class="hs-identifier hs-var">orgStack</span></a></span><span> </span><span class="hs-comment">-- FIXME: merge back reordering, deletions?</span><span>
</span><span id="line-332"></span><span>                </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493873"><span class="hs-identifier hs-var">nl</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><span class="hs-operator hs-var">`second`</span></span><span> </span><span class="annot"><span class="annottext">([(Window, Rectangle)], Maybe (l Window))
</span><a href="#local-6989586621679493870"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679493865"><span class="annot"><span class="annottext">[X ([(Window, Rectangle)], l Window)]
</span><a href="#local-6989586621679493865"><span class="hs-identifier hs-var">urls</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679493864"><span class="annot"><span class="annottext">[Maybe (Stack Window)]
</span><a href="#local-6989586621679493864"><span class="hs-identifier hs-var">ssts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. [(a, b)] -&gt; ([a], [b])
</span><span class="hs-identifier hs-var">unzip</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LayoutClass l Window =&gt;
Rectangle
-&gt; String
-&gt; l Window
-&gt; Bool
-&gt; Maybe (Stack Window)
-&gt; X ([(Window, Rectangle)], l Window)
</span><a href="#local-6989586621679493910"><span class="hs-identifier hs-var">newL</span></a></span><span> </span><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493862"><span class="hs-identifier hs-var">gr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679493861"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493860"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679493859"><span class="hs-identifier hs-var">isNew</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493858"><span class="hs-identifier hs-var">sst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493858"><span class="hs-identifier hs-var">sst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679493859"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679493859"><span class="hs-identifier hs-var">isNew</span></a></span></span><span class="hs-special">,</span><span class="hs-special">(</span><span id="local-6989586621679493860"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493860"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679493857"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493857"><span class="hs-identifier hs-var">_st</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Bool, (l Window, Stack Window))]
</span><a href="#local-6989586621679493912"><span class="hs-identifier hs-var">sls</span></a></span><span>
</span><span id="line-336"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679493861"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679493861"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-337"></span><span>                    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679493855"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493855"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679493862"><span class="annot"><span class="annottext">Rectangle
</span><a href="#local-6989586621679493862"><span class="hs-identifier hs-var">gr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><a href="#local-6989586621679493916"><span class="hs-identifier hs-var">arrs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493858"><span class="annot"><span class="annottext">sst :: Maybe (Stack Window)
</span><a href="#local-6989586621679493858"><span class="hs-identifier hs-var hs-var">sst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493855"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493913"><span class="hs-identifier hs-var">gs'</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span>        </span><span id="local-6989586621679493852"><span class="annot"><span class="annottext">[([(Window, Rectangle)], l Window)]
</span><a href="#local-6989586621679493852"><span class="hs-identifier hs-var">arrs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">[X ([(Window, Rectangle)], l Window)]
</span><a href="#local-6989586621679493865"><span class="hs-identifier hs-var">urls</span></a></span><span>
</span><span id="line-340"></span><span>        </span><span id="local-6989586621679493850"><span class="annot"><span class="annottext">Maybe (Sublayout l Window)
</span><a href="#local-6989586621679493850"><span class="hs-identifier hs-var">sls'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Invisible [] (SomeMessage, a)
-&gt; ([Int], l a) -&gt; [(l a, Stack a)] -&gt; Sublayout l a
</span><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493920"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a k b.
(LayoutClass layout a, Ord k) =&gt;
([Int], layout a)
-&gt; Maybe (Stack k)
-&gt; Groups k
-&gt; [(layout a, b)]
-&gt; X [(Bool, (layout a, Stack k))]
</span><a href="XMonad.Layout.SubLayouts.html#fromGroups"><span class="hs-identifier hs-var">fromGroups</span></a></span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493920"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493917"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493913"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-341"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493849"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493848"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[(Window, Rectangle)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679493849"><span class="annot"><span class="annottext">l Window
</span><a href="#local-6989586621679493849"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[([(Window, Rectangle)], l Window)]
</span><a href="#local-6989586621679493852"><span class="hs-identifier hs-var">arrs'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679493848"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493848"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Maybe (Stack Window)]
</span><a href="#local-6989586621679493864"><span class="hs-identifier hs-var">ssts</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[([(Window, Rectangle)], l Window)]
</span><a href="#local-6989586621679493852"><span class="hs-identifier hs-var">arrs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe (Sublayout l Window)
</span><a href="#local-6989586621679493850"><span class="hs-identifier hs-var">sls'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span>    </span><span id="local-6989586621679493784"><span class="annot"><span class="annottext">handleMess :: Sublayout l Window -&gt; SomeMessage -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493784"><span class="hs-identifier hs-var hs-var hs-var hs-var">handleMess</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621679493783"><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493783"><span class="hs-identifier hs-var">ms</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679493782"><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493782"><span class="hs-identifier hs-var">defl</span></a></span></span><span> </span><span id="local-6989586621679493781"><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493781"><span class="hs-identifier hs-var">sls</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679493780"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span></span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#SubMessage"><span class="hs-identifier hs-type">SubMessage</span></a></span><span> </span><span id="local-6989586621679493779"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493779"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679493778"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493778"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Invisible [] (SomeMessage, a)
-&gt; ([Int], l a) -&gt; [(l a, Stack a)] -&gt; Sublayout l a
</span><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493779"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493778"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493783"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493782"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493781"><span class="hs-identifier hs-var">sls</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Broadcast"><span class="hs-identifier hs-type">Broadcast</span></a></span><span> </span><span id="local-6989586621679493776"><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493776"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-349"></span><span>            </span><span id="local-6989586621679493775"><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493775"><span class="hs-identifier hs-var">ms'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493776"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var">currentStack</span></a></span><span>
</span><span id="line-350"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493775"><span class="hs-identifier hs-var">ms'</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-351"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Invisible [] (SomeMessage, a)
-&gt; ([Int], l a) -&gt; [(l a, Stack a)] -&gt; Sublayout l a
</span><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493775"><span class="hs-identifier hs-var">ms'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493783"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493782"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493781"><span class="hs-identifier hs-var">sls</span></a></span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">UpdateBoring
</span><a href="XMonad.Layout.BoringWindows.html#UpdateBoring"><span class="hs-identifier hs-var">B.UpdateBoring</span></a></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-354"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493771"><span class="annot"><span class="annottext">bs :: [Window]
</span><a href="#local-6989586621679493771"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><a href="XMonad.Layout.SubLayouts.html#unfocused"><span class="hs-identifier hs-var">unfocused</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-355"></span><span>            </span><span id="local-6989586621679493767"><span class="annot"><span class="annottext">Workspace String (Layout Window) Window
</span><a href="#local-6989586621679493767"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>            </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">forall a.
Message a =&gt;
a -&gt; Workspace String (Layout Window) Window -&gt; X ()
</span><span class="hs-identifier hs-var">sendMessageWithNoRefresh</span></span><span> </span><span class="annot"><span class="annottext">Workspace String (Layout Window) Window
</span><a href="#local-6989586621679493767"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [Window] -&gt; BoringMessage
</span><a href="XMonad.Layout.BoringWindows.html#Replace"><span class="hs-identifier hs-var">B.Replace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sublayouts&quot;</span></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493771"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-357"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#WithGroup"><span class="hs-identifier hs-type">WithGroup</span></a></span><span> </span><span id="local-6989586621679493759"><span class="annot"><span class="annottext">Stack Window -&gt; X (Stack Window)
</span><a href="#local-6989586621679493759"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679493758"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493758"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679493757"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493757"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493758"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-361"></span><span>            </span><span id="local-6989586621679493756"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493756"><span class="hs-identifier hs-var">g'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Stack Window -&gt; X (Stack Window)
</span><a href="#local-6989586621679493759"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493757"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-362"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493753"><span class="annot"><span class="annottext">gs' :: Groups Window
</span><a href="#local-6989586621679493753"><span class="hs-identifier hs-var hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493756"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493756"><span class="hs-identifier hs-var">g'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493757"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-363"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493753"><span class="hs-identifier hs-var">gs'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#updateWs"><span class="hs-identifier hs-var">updateWs</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493753"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-364"></span><span>            </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493758"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493756"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall s a i l sd.
(Eq s, Eq a, Eq i) =&gt;
a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.focusWindow</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493756"><span class="hs-identifier hs-var">g'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#MergeAll"><span class="hs-identifier hs-type">MergeAll</span></a></span><span> </span><span id="local-6989586621679493746"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493746"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-368"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493740"><span class="annot"><span class="annottext">gs' :: Maybe (Groups Window)
</span><a href="#local-6989586621679493740"><span class="hs-identifier hs-var hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493746"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>                    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; Stack a -&gt; Maybe (Stack a)
</span><a href="XMonad.Layout.SubLayouts.html#focusWindow%27"><span class="hs-identifier hs-var">focusWindow'</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493746"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.differentiate</span></span><span>
</span><span id="line-370"></span><span>                    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-371"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493735"><span class="hs-identifier hs-var">fgs</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Groups Window)
</span><a href="#local-6989586621679493740"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#UnMergeAll"><span class="hs-identifier hs-type">UnMergeAll</span></a></span><span> </span><span id="local-6989586621679493734"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493734"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-374"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493732"><span class="annot"><span class="annottext">ws :: [Window]
</span><a href="#local-6989586621679493732"><span class="hs-identifier hs-var hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-375"></span><span>                </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493734"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span>
</span><span id="line-376"></span><span>                </span><span id="local-6989586621679493731"><span class="annot"><span class="annottext">mkSingleton :: a -&gt; Map a (Stack a)
</span><a href="#local-6989586621679493731"><span class="hs-identifier hs-var hs-var">mkSingleton</span></a></span></span><span> </span><span id="local-6989586621679493730"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493730"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.singleton</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493730"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493730"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493735"><span class="hs-identifier hs-var">fgs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) k a.
(Foldable f, Ord k) =&gt;
f (Map k a) -&gt; Map k a
</span><span class="hs-identifier hs-var">M.unions</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall {a}. a -&gt; Map a (Stack a)
</span><a href="#local-6989586621679493731"><span class="hs-identifier hs-var">mkSingleton</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493732"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-378"></span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Merge"><span class="hs-identifier hs-type">Merge</span></a></span><span> </span><span id="local-6989586621679493728"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493728"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679493727"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493727"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679493726"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493726"><span class="hs-identifier hs-var">xb</span></a></span></span><span> </span><span id="local-6989586621679493725"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493725"><span class="hs-identifier hs-var">xn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679493724"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493728"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679493723"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493723"><span class="hs-identifier hs-var">yst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679493724"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493727"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493722"><span class="annot"><span class="annottext">zs :: Stack Window
</span><a href="#local-6989586621679493722"><span class="hs-identifier hs-var hs-var">zs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493728"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493726"><span class="hs-identifier hs-var">xb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493725"><span class="hs-identifier hs-var">xn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493723"><span class="hs-identifier hs-var">yst</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493735"><span class="hs-identifier hs-var">fgs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493728"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493722"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493723"><span class="hs-identifier hs-var">yst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#UnMerge"><span class="hs-identifier hs-type">UnMerge</span></a></span><span> </span><span id="local-6989586621679493721"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493721"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-386"></span><span>            </span><span class="annot"><span class="annottext">Groups Window -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493735"><span class="hs-identifier hs-var">fgs</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span>
</span><span id="line-387"></span><span>                    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b k. (a -&gt; Maybe b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">M.mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493721"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-comment">-- XXX sometimes this migrates an incorrect window, why?</span><span>
</span><span id="line-390"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Migrate"><span class="hs-identifier hs-type">Migrate</span></a></span><span> </span><span id="local-6989586621679493718"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493718"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679493717"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493717"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679493716"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493716"><span class="hs-identifier hs-var">xst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679493724"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493718"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679493715"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493715"><span class="hs-identifier hs-var">yf</span></a></span></span><span> </span><span id="local-6989586621679493714"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493714"><span class="hs-identifier hs-var">yu</span></a></span></span><span> </span><span id="local-6989586621679493713"><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493713"><span class="hs-identifier hs-var">yd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679493724"><span class="hs-identifier hs-var">findGroup</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493717"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493712"><span class="annot"><span class="annottext">zs :: Stack Window
</span><a href="#local-6989586621679493712"><span class="hs-identifier hs-var hs-var">zs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493715"><span class="hs-identifier hs-var">yf</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493714"><span class="hs-identifier hs-var">yu</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Window]
</span><a href="#local-6989586621679493713"><span class="hs-identifier hs-var">yd</span></a></span><span>
</span><span id="line-394"></span><span>                </span><span id="local-6989586621679493709"><span class="annot"><span class="annottext">nxsAdd :: Groups Window -&gt; Groups Window
</span><a href="#local-6989586621679493709"><span class="hs-identifier hs-var hs-var">nxsAdd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679493708"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493708"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493708"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493708"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493718"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493716"><span class="hs-identifier hs-var">xst</span></a></span><span>
</span><span id="line-395"></span><span>            </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493735"><span class="hs-identifier hs-var">fgs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; Groups Window
</span><a href="#local-6989586621679493709"><span class="hs-identifier hs-var">nxsAdd</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.insert</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493718"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493712"><span class="hs-identifier hs-var">zs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.delete</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493715"><span class="hs-identifier hs-var">yf</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-396"></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><span class="hs-identifier hs-var">join</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">LayoutMessages -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493706"><span class="hs-identifier hs-var">catchLayoutMess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall m. Message m =&gt; SomeMessage -&gt; Maybe m
</span><span class="hs-identifier hs-var">fromMessage</span></span><span> </span><span class="annot"><span class="annottext">SomeMessage
</span><a href="#local-6989586621679493780"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>     </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679493768"><span class="annot"><span class="annottext">gs :: Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a a1. Ord a =&gt; [(a1, Stack a)] -&gt; Map a (Stack a)
</span><a href="XMonad.Layout.SubLayouts.html#toGroups"><span class="hs-identifier hs-var">toGroups</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493781"><span class="hs-identifier hs-var">sls</span></a></span><span>
</span><span id="line-400"></span><span>           </span><span id="local-6989586621679493735"><span class="annot"><span class="annottext">fgs :: Groups Window -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493735"><span class="hs-identifier hs-var hs-var">fgs</span></a></span></span><span> </span><span id="local-6989586621679493700"><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493700"><span class="hs-identifier hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-401"></span><span>                </span><span id="local-6989586621679493699"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493699"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var">currentStack</span></a></span><span>
</span><span id="line-402"></span><span>                </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Invisible [] (SomeMessage, a)
-&gt; ([Int], l a) -&gt; [(l a, Stack a)] -&gt; Sublayout l a
</span><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493783"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493782"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a k b.
(LayoutClass layout a, Ord k) =&gt;
([Int], layout a)
-&gt; Maybe (Stack k)
-&gt; Groups k
-&gt; [(layout a, b)]
-&gt; X [(Bool, (layout a, Stack k))]
</span><a href="XMonad.Layout.SubLayouts.html#fromGroups"><span class="hs-identifier hs-var">fromGroups</span></a></span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493782"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493699"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493700"><span class="hs-identifier hs-var">gs'</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493781"><span class="hs-identifier hs-var">sls</span></a></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>           </span><span id="local-6989586621679493724"><span class="annot"><span class="annottext">findGroup :: Window -&gt; Maybe (Stack Window)
</span><a href="#local-6989586621679493724"><span class="hs-identifier hs-var hs-var">findGroup</span></a></span></span><span> </span><span id="local-6989586621679493693"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493693"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadPlus m =&gt; m a -&gt; m a -&gt; m a
</span><span class="hs-identifier hs-var">mplus</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493693"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span>
</span><span id="line-405"></span><span>                    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a k. (a -&gt; Bool) -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">M.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679493693"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493768"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span>           </span><span class="annot"><a href="#local-6989586621679493706"><span class="hs-identifier hs-type">catchLayoutMess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutMessages</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-type">Sublayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494477"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>           </span><span id="local-6989586621679493706"><span class="annot"><span class="annottext">catchLayoutMess :: LayoutMessages -&gt; X (Maybe (Sublayout l Window))
</span><a href="#local-6989586621679493706"><span class="hs-identifier hs-var hs-var">catchLayoutMess</span></a></span></span><span> </span><span id="local-6989586621679493689"><span class="annot"><span class="annottext">LayoutMessages
</span><a href="#local-6989586621679493689"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-409"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493686"><span class="annot"><span class="annottext">m' :: LayoutMessages
</span><a href="#local-6989586621679493686"><span class="hs-identifier hs-var hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LayoutMessages
</span><a href="#local-6989586621679493689"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`asTypeOf`</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LayoutMessages</span></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>            </span><span id="local-6989586621679493683"><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493683"><span class="hs-identifier hs-var">ms'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">LayoutMessages
</span><a href="#local-6989586621679493686"><span class="hs-identifier hs-var">m'</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span>
</span><span id="line-411"></span><span>                    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var">currentStack</span></a></span><span>
</span><span id="line-412"></span><span>            </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493683"><span class="hs-identifier hs-var">ms'</span></a></span><span>
</span><span id="line-413"></span><span>                        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (l :: * -&gt; *) a.
Invisible [] (SomeMessage, a)
-&gt; ([Int], l a) -&gt; [(l a, Stack a)] -&gt; Sublayout l a
</span><a href="XMonad.Layout.SubLayouts.html#Sublayout"><span class="hs-identifier hs-var">Sublayout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. m a -&gt; Invisible m a
</span><a href="XMonad.Util.Invisible.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493683"><span class="hs-identifier hs-var">ms'</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[(SomeMessage, Window)]
</span><a href="#local-6989586621679493783"><span class="hs-identifier hs-var">ms</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([Int], l Window)
</span><a href="#local-6989586621679493782"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">[(l Window, Stack Window)]
</span><a href="#local-6989586621679493781"><span class="hs-identifier hs-var">sls</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-type">currentStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span id="currentStack"><span class="annot"><span class="annottext">currentStack :: X (Maybe (Stack Window))
</span><a href="XMonad.Layout.SubLayouts.html#currentStack"><span class="hs-identifier hs-var hs-var">currentStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | update Group to follow changes in the workspace</span><span>
</span><span id="line-419"></span><span id="local-6989586621679494474"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#updateGroup"><span class="hs-identifier hs-type">updateGroup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494474"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494474"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494474"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494474"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-420"></span><span id="updateGroup"><span class="annot"><span class="annottext">updateGroup :: forall a. Ord a =&gt; Maybe (Stack a) -&gt; Groups a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#updateGroup"><span class="hs-identifier hs-var hs-var">updateGroup</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Groups a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-421"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#updateGroup"><span class="hs-identifier hs-var">updateGroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679493676"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493676"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679493675"><span class="annot"><span class="annottext">Groups a
</span><a href="#local-6989586621679493675"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; GroupStack a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#fromGroupStack"><span class="hs-identifier hs-var">fromGroupStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Groups a -&gt; Stack a -&gt; GroupStack a
</span><a href="XMonad.Layout.SubLayouts.html#toGroupStack"><span class="hs-identifier hs-var">toGroupStack</span></a></span><span> </span><span class="annot"><span class="annottext">Groups a
</span><a href="#local-6989586621679493675"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493676"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- | rearrange the windowset to put the groups of tabs next to each other, so</span><span>
</span><span id="line-424"></span><span class="hs-comment">-- that the stack of tabs stays put.</span><span>
</span><span id="line-425"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#updateWs"><span class="hs-identifier hs-type">updateWs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span id="updateWs"><span class="annot"><span class="annottext">updateWs :: Groups Window -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#updateWs"><span class="hs-identifier hs-var hs-var">updateWs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; Maybe WindowSet) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#windowsMaybe"><span class="hs-identifier hs-var">windowsMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Groups Window -&gt; WindowSet -&gt; Maybe WindowSet
</span><a href="XMonad.Layout.SubLayouts.html#updateWs%27"><span class="hs-identifier hs-var">updateWs'</span></a></span><span>
</span><span id="line-427"></span><span>
</span><span id="line-428"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#updateWs%27"><span class="hs-identifier hs-type">updateWs'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span>
</span><span id="line-429"></span><span id="updateWs%27"><span class="annot"><span class="annottext">updateWs' :: Groups Window -&gt; WindowSet -&gt; Maybe WindowSet
</span><a href="XMonad.Layout.SubLayouts.html#updateWs%27"><span class="hs-identifier hs-var hs-var">updateWs'</span></a></span></span><span> </span><span id="local-6989586621679493670"><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493670"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679493669"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493669"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679493668"><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493668"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493669"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493666"><span class="annot"><span class="annottext">w' :: Stack Window
</span><a href="#local-6989586621679493666"><span class="hs-identifier hs-var hs-var">w'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. GroupStack a -&gt; Stack a
</span><a href="XMonad.Layout.SubLayouts.html#flattenGroupStack"><span class="hs-identifier hs-var">flattenGroupStack</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; Groups a -&gt; Stack a -&gt; GroupStack a
</span><a href="XMonad.Layout.SubLayouts.html#toGroupStack"><span class="hs-identifier hs-var">toGroupStack</span></a></span><span> </span><span class="annot"><span class="annottext">Groups Window
</span><a href="#local-6989586621679493670"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493668"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493668"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493666"><span class="hs-identifier hs-var">w'</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a i l s sd.
(Stack a -&gt; Stack a) -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.modify'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Stack Window
</span><a href="#local-6989586621679493666"><span class="hs-identifier hs-var">w'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493669"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | Flatten a stack of stacks.</span><span>
</span><span id="line-436"></span><span id="local-6989586621679494328"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#flattenGroupStack"><span class="hs-identifier hs-type">flattenGroupStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupStack"><span class="hs-identifier hs-type">GroupStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494328"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494328"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-437"></span><span id="flattenGroupStack"><span class="annot"><span class="annottext">flattenGroupStack :: forall a. GroupStack a -&gt; Stack a
</span><a href="XMonad.Layout.SubLayouts.html#flattenGroupStack"><span class="hs-identifier hs-var hs-var">flattenGroupStack</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679493662"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493662"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679493661"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493661"><span class="hs-identifier hs-var">lf</span></a></span></span><span> </span><span id="local-6989586621679493660"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493660"><span class="hs-identifier hs-var">rf</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679493659"><span class="annot"><span class="annottext">[Stack a]
</span><a href="#local-6989586621679493659"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679493658"><span class="annot"><span class="annottext">[Stack a]
</span><a href="#local-6989586621679493658"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493656"><span class="annot"><span class="annottext">l :: [a]
</span><a href="#local-6989586621679493656"><span class="hs-identifier hs-var hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493661"><span class="hs-identifier hs-var">lf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Stack a]
</span><a href="#local-6989586621679493659"><span class="hs-identifier hs-var">ls</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679493654"><span class="annot"><span class="annottext">r :: [a]
</span><a href="#local-6989586621679493654"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493660"><span class="hs-identifier hs-var">rf</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">[Stack a]
</span><a href="#local-6989586621679493658"><span class="hs-identifier hs-var">rs</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493662"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493656"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493654"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="hs-comment">-- | Extract Groups from a stack of stacks.</span><span>
</span><span id="line-443"></span><span id="local-6989586621679494331"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#fromGroupStack"><span class="hs-identifier hs-type">fromGroupStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494331"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupStack"><span class="hs-identifier hs-type">GroupStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494331"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494331"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-444"></span><span id="fromGroupStack"><span class="annot"><span class="annottext">fromGroupStack :: forall a. Ord a =&gt; GroupStack a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#fromGroupStack"><span class="hs-identifier hs-var hs-var">fromGroupStack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="hs-comment">-- | Arrange a stack of windows into a stack of stacks, according to (possibly</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- outdated) Groups.</span><span>
</span><span id="line-448"></span><span class="hs-comment">--</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- Assumes that the groups are disjoint and there are no duplicates in the</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- stack; will result in additional duplicates otherwise. This is a reasonable</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- assumption&#8212;the rest of xmonad will mishave too&#8212;but it isn't checked</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- anywhere and there had been bugs breaking this assumption in the past.</span><span>
</span><span id="line-453"></span><span id="local-6989586621679494329"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#toGroupStack"><span class="hs-identifier hs-type">toGroupStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494329"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494329"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#GroupStack"><span class="hs-identifier hs-type">GroupStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494329"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-454"></span><span id="toGroupStack"><span class="annot"><span class="annottext">toGroupStack :: forall a. Ord a =&gt; Groups a -&gt; Stack a -&gt; GroupStack a
</span><a href="XMonad.Layout.SubLayouts.html#toGroupStack"><span class="hs-identifier hs-var hs-var">toGroupStack</span></a></span></span><span> </span><span id="local-6989586621679493645"><span class="annot"><span class="annottext">Groups a
</span><a href="#local-6989586621679493645"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679493644"><span class="annot"><span class="annottext">st :: Stack a
</span><a href="#local-6989586621679493644"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span id="local-6989586621679493643"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493643"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679493642"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493642"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span id="local-6989586621679493641"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493641"><span class="hs-identifier hs-var">rs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493639"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493643"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493639"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493642"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493639"><span class="hs-identifier hs-var">lu</span></a></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493641"><span class="hs-identifier hs-var">rs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-457"></span><span>    </span><span id="local-6989586621679493636"><span class="annot"><span class="annottext">wset :: Set a
</span><a href="#local-6989586621679493636"><span class="hs-identifier hs-var hs-var">wset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493644"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621679493633"><span class="annot"><span class="annottext">dead :: Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493633"><span class="hs-identifier hs-var hs-var">dead</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679493636"><span class="hs-identifier hs-var">wset</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- drop dead windows or entire groups</span><span>
</span><span id="line-459"></span><span>    </span><span id="local-6989586621679493626"><span class="annot"><span class="annottext">refocus :: Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493626"><span class="hs-identifier hs-var hs-var">refocus</span></a></span></span><span> </span><span id="local-6989586621679493625"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493625"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493643"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493625"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-comment">-- sync focus/order of current group</span><span>
</span><span id="line-460"></span><span>                                       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493625"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493644"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-461"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493625"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621679493622"><span class="annot"><span class="annottext">gs' :: Groups a
</span><a href="#local-6989586621679493622"><span class="hs-identifier hs-var hs-var">gs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a.
Ord a =&gt;
(Stack a -&gt; Maybe (Stack a)) -&gt; Groups a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#mapGroups"><span class="hs-identifier hs-var">mapGroups</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493626"><span class="hs-identifier hs-var">refocus</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493633"><span class="hs-identifier hs-var">dead</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Groups a
</span><a href="#local-6989586621679493645"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-463"></span><span>    </span><span id="local-6989586621679493617"><span class="annot"><span class="annottext">gset :: Set a
</span><a href="#local-6989586621679493617"><span class="hs-identifier hs-var hs-var">gset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">S.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Groups a
</span><a href="#local-6989586621679493622"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-464"></span><span>    </span><span class="hs-comment">-- after refocus, f is either the focused window of some group, or not in</span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-comment">-- gs' at all, so `lu f` is never Nothing</span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621679493639"><span class="annot"><span class="annottext">lu :: a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493639"><span class="hs-identifier hs-var hs-var">lu</span></a></span></span><span> </span><span id="local-6989586621679493614"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493614"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493614"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><span class="hs-operator hs-var">`S.member`</span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679493617"><span class="hs-identifier hs-var">gset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493614"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-operator hs-var">`M.lookup`</span></span><span> </span><span class="annot"><span class="annottext">Groups a
</span><a href="#local-6989586621679493622"><span class="hs-identifier hs-var">gs'</span></a></span><span>
</span><span id="line-467"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493614"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- singleton groups for new wins</span><span>
</span><span id="line-468"></span><span>
</span><span id="line-469"></span><span id="local-6989586621679494309"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#mapGroups"><span class="hs-identifier hs-type">mapGroups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494309"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494309"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494309"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494309"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-470"></span><span id="mapGroups"><span class="annot"><span class="annottext">mapGroups :: forall a.
Ord a =&gt;
(Stack a -&gt; Maybe (Stack a)) -&gt; Groups a -&gt; Groups a
</span><a href="XMonad.Layout.SubLayouts.html#mapGroups"><span class="hs-identifier hs-var hs-var">mapGroups</span></a></span></span><span> </span><span id="local-6989586621679493610"><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493610"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679493610"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span class="hs-comment">-- | focusWindow'. focus an element of a stack, is Nothing if that element is</span><span>
</span><span id="line-473"></span><span class="hs-comment">-- absent. See also 'W.focusWindow'</span><span>
</span><span id="line-474"></span><span id="local-6989586621679494368"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#focusWindow%27"><span class="hs-identifier hs-type">focusWindow'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679494368"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494368"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494368"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494368"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-475"></span><span id="focusWindow%27"><span class="annot"><span class="annottext">focusWindow' :: forall a. Eq a =&gt; a -&gt; Stack a -&gt; Maybe (Stack a)
</span><a href="XMonad.Layout.SubLayouts.html#focusWindow%27"><span class="hs-identifier hs-var hs-var">focusWindow'</span></a></span></span><span> </span><span id="local-6989586621679493602"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493602"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679493601"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493601"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493602"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493601"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">until</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493602"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; Stack a
</span><span class="hs-identifier hs-var">W.focusDown'</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493601"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-comment">-- update only when Just</span><span>
</span><span id="line-480"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#windowsMaybe"><span class="hs-identifier hs-type">windowsMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span id="windowsMaybe"><span class="annot"><span class="annottext">windowsMaybe :: (WindowSet -&gt; Maybe WindowSet) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#windowsMaybe"><span class="hs-identifier hs-var hs-var">windowsMaybe</span></a></span></span><span> </span><span id="local-6989586621679493599"><span class="annot"><span class="annottext">WindowSet -&gt; Maybe WindowSet
</span><a href="#local-6989586621679493599"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-482"></span><span>    </span><span id="local-6989586621679493598"><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493598"><span class="hs-identifier hs-var">xst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-483"></span><span>    </span><span id="local-6989586621679493596"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493596"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493593"><span class="annot"><span class="annottext">up :: WindowSet -&gt; m ()
</span><a href="#local-6989586621679493593"><span class="hs-identifier hs-var hs-var">up</span></a></span></span><span> </span><span id="local-6989586621679493592"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493592"><span class="hs-identifier hs-var">fws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493598"><span class="hs-identifier hs-var">xst</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">windowset :: WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493592"><span class="hs-identifier hs-var">fws</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *}. MonadState XState m =&gt; WindowSet -&gt; m ()
</span><a href="#local-6989586621679493593"><span class="hs-identifier hs-var">up</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; Maybe WindowSet
</span><a href="#local-6989586621679493599"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679493596"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span id="local-6989586621679493590"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#unfocused"><span class="hs-identifier hs-type">unfocused</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679493590"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679493590"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-488"></span><span id="unfocused"><span class="annot"><span class="annottext">unfocused :: forall a. Stack a -&gt; [a]
</span><a href="XMonad.Layout.SubLayouts.html#unfocused"><span class="hs-identifier hs-var hs-var">unfocused</span></a></span></span><span> </span><span id="local-6989586621679493589"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493589"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.up</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493589"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">W.down</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679493589"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span id="local-6989586621679494472"><span id="local-6989586621679494473"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#toGroups"><span class="hs-identifier hs-type">toGroups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494472"><span class="hs-identifier hs-type">a1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621679494473"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494473"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-491"></span><span id="toGroups"><span class="annot"><span class="annottext">toGroups :: forall a a1. Ord a =&gt; [(a1, Stack a)] -&gt; Map a (Stack a)
</span><a href="XMonad.Layout.SubLayouts.html#toGroups"><span class="hs-identifier hs-var hs-var">toGroups</span></a></span></span><span> </span><span id="local-6989586621679493581"><span class="annot"><span class="annottext">[(a1, Stack a)]
</span><a href="#local-6989586621679493581"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">M.fromList</span></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span> </span><span class="annot"><span class="annottext">forall (a :: * -&gt; * -&gt; *) b c c'.
Arrow a =&gt;
a b c -&gt; a b c' -&gt; a b (c, c')
</span><span class="hs-operator hs-var">&amp;&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nubBy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">on</span></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; a
</span><span class="hs-identifier hs-var">W.focus</span></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>                    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">[(a1, Stack a)]
</span><a href="#local-6989586621679493581"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-493"></span><span>
</span><span id="line-494"></span><span class="hs-comment">-- | restore the default layout for each group. It needs the X monad to switch</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- the default layout to a specific one (handleMessage NextLayout)</span><span>
</span><span id="line-496"></span><span id="local-6989586621679494456"><span id="local-6989586621679494457"><span id="local-6989586621679494458"><span id="local-6989586621679494459"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#fromGroups"><span class="hs-identifier hs-type">fromGroups</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">LayoutClass</span></span><span> </span><span class="annot"><a href="#local-6989586621679494459"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494458"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494457"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-497"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679494459"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494458"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494457"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494457"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-500"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494459"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494458"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679494456"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-501"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494459"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494458"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494457"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-502"></span><span id="fromGroups"><span class="annot"><span class="annottext">fromGroups :: forall (layout :: * -&gt; *) a k b.
(LayoutClass layout a, Ord k) =&gt;
([Int], layout a)
-&gt; Maybe (Stack k)
-&gt; Groups k
-&gt; [(layout a, b)]
-&gt; X [(Bool, (layout a, Stack k))]
</span><a href="XMonad.Layout.SubLayouts.html#fromGroups"><span class="hs-identifier hs-var hs-var">fromGroups</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679493569"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679493569"><span class="hs-identifier hs-var">skips</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679493568"><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493568"><span class="hs-identifier hs-var">defl</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679493567"><span class="annot"><span class="annottext">Maybe (Stack k)
</span><a href="#local-6989586621679493567"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679493566"><span class="annot"><span class="annottext">Groups k
</span><a href="#local-6989586621679493566"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679493565"><span class="annot"><span class="annottext">[(layout a, b)]
</span><a href="#local-6989586621679493565"><span class="hs-identifier hs-var">sls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>    </span><span id="local-6989586621679493564"><span class="annot"><span class="annottext">[layout a]
</span><a href="#local-6989586621679493564"><span class="hs-identifier hs-var">defls</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {a}. Monad m =&gt; (a -&gt; m a) -&gt; a -&gt; [m a]
</span><a href="#local-6989586621679493562"><span class="hs-identifier hs-var">iterateM</span></a></span><span> </span><span class="annot"><span class="annottext">forall {layout :: * -&gt; *} {a}.
LayoutClass layout a =&gt;
layout a -&gt; X (layout a)
</span><a href="#local-6989586621679493561"><span class="hs-identifier hs-var">nextL</span></a></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493568"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">!!</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679493569"><span class="hs-identifier hs-var">skips</span></a></span><span>
</span><span id="line-504"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall k a.
Ord k =&gt;
a
-&gt; [a]
-&gt; Maybe (Stack k)
-&gt; Groups k
-&gt; [a]
-&gt; [(Bool, (a, Stack k))]
</span><a href="XMonad.Layout.SubLayouts.html#fromGroups%27"><span class="hs-identifier hs-var">fromGroups'</span></a></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493568"><span class="hs-identifier hs-var">defl</span></a></span><span> </span><span class="annot"><span class="annottext">[layout a]
</span><a href="#local-6989586621679493564"><span class="hs-identifier hs-var">defls</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack k)
</span><a href="#local-6989586621679493567"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Groups k
</span><a href="#local-6989586621679493566"><span class="hs-identifier hs-var">gs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">[(layout a, b)]
</span><a href="#local-6989586621679493565"><span class="hs-identifier hs-var">sls</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>        </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679493561"><span class="annot"><span class="annottext">nextL :: layout a -&gt; X (layout a)
</span><a href="#local-6989586621679493561"><span class="hs-identifier hs-var hs-var">nextL</span></a></span></span><span> </span><span id="local-6989586621679493554"><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493554"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493554"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall (layout :: * -&gt; *) a.
LayoutClass layout a =&gt;
layout a -&gt; SomeMessage -&gt; X (Maybe (layout a))
</span><span class="hs-identifier hs-var">handleMessage</span></span><span> </span><span class="annot"><span class="annottext">layout a
</span><a href="#local-6989586621679493554"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Message a =&gt; a -&gt; SomeMessage
</span><span class="hs-identifier hs-var">SomeMessage</span></span><span> </span><span class="annot"><span class="annottext">ChangeLayout
</span><span class="hs-identifier hs-var">NextLayout</span></span><span class="hs-special">)</span><span>
</span><span id="line-506"></span><span>              </span><span id="local-6989586621679493562"><span class="annot"><span class="annottext">iterateM :: (a -&gt; m a) -&gt; a -&gt; [m a]
</span><a href="#local-6989586621679493562"><span class="hs-identifier hs-var hs-var">iterateM</span></a></span></span><span> </span><span id="local-6989586621679493550"><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679493550"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; a) -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">iterate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
</span><a href="#local-6989586621679493550"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span id="local-6989586621679494278"><span id="local-6989586621679494279"><span class="annot"><a href="XMonad.Layout.SubLayouts.html#fromGroups%27"><span class="hs-identifier hs-type">fromGroups'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679494279"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679494278"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679494278"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494279"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#Groups"><span class="hs-identifier hs-type">Groups</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679494279"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679494278"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-509"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679494278"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><a href="#local-6989586621679494279"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-510"></span><span id="fromGroups%27"><span class="annot"><span class="annottext">fromGroups' :: forall k a.
Ord k =&gt;
a
-&gt; [a]
-&gt; Maybe (Stack k)
-&gt; Groups k
-&gt; [a]
-&gt; [(Bool, (a, Stack k))]
</span><a href="XMonad.Layout.SubLayouts.html#fromGroups%27"><span class="hs-identifier hs-var hs-var">fromGroups'</span></a></span></span><span> </span><span id="local-6989586621679493542"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493542"><span class="hs-identifier hs-var">defl</span></a></span></span><span> </span><span id="local-6989586621679493541"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493541"><span class="hs-identifier hs-var">defls</span></a></span></span><span> </span><span id="local-6989586621679493540"><span class="annot"><span class="annottext">Maybe (Stack k)
</span><a href="#local-6989586621679493540"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679493539"><span class="annot"><span class="annottext">Groups k
</span><a href="#local-6989586621679493539"><span class="hs-identifier hs-var">gs</span></a></span></span><span> </span><span id="local-6989586621679493538"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493538"><span class="hs-identifier hs-var">sls</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-511"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679493537"><span class="hs-identifier hs-var">isNew</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">forall {a} {b}. (a, b) -&gt; (Maybe a, Maybe b) -&gt; (a, b)
</span><a href="#local-6989586621679493536"><span class="hs-identifier hs-var">fromMaybe2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493535"><span class="hs-identifier hs-var">dl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall {a}. a -&gt; Stack a
</span><a href="#local-6989586621679493534"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679493533"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679493532"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">M.lookup</span></span><span> </span><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679493533"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Groups k
</span><a href="#local-6989586621679493539"><span class="hs-identifier hs-var">gs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-512"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679493532"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679493532"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493538"><span class="hs-identifier hs-var">sls</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679493537"><span class="annot"><span class="annottext">isNew :: Bool
</span><a href="#local-6989586621679493537"><span class="hs-identifier hs-var hs-var">isNew</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679493532"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-513"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679493535"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493535"><span class="hs-identifier hs-var">dl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679493541"><span class="hs-identifier hs-var">defls</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a]
</span><span class="hs-identifier hs-var">repeat</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493542"><span class="hs-identifier hs-var">defl</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679493533"><span class="annot"><span class="annottext">k
</span><a href="#local-6989586621679493533"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe (Stack a) -&gt; [a]
</span><span class="hs-identifier hs-var">W.integrate'</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. (a -&gt; Bool) -&gt; Stack a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">W.filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[k]
</span><a href="#local-6989586621679493529"><span class="hs-identifier hs-var">unfocs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack k)
</span><a href="#local-6989586621679493540"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679493529"><span class="annot"><span class="annottext">unfocs :: [k]
</span><a href="#local-6989586621679493529"><span class="hs-identifier hs-var hs-var">unfocs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Stack a -&gt; [a]
</span><a href="XMonad.Layout.SubLayouts.html#unfocused"><span class="hs-identifier hs-var">unfocused</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">forall k a. Map k a -&gt; [a]
</span><span class="hs-identifier hs-var">M.elems</span></span><span> </span><span class="annot"><span class="annottext">Groups k
</span><a href="#local-6989586621679493539"><span class="hs-identifier hs-var">gs</span></a></span><span>
</span><span id="line-516"></span><span>          </span><span id="local-6989586621679493534"><span class="annot"><span class="annottext">single :: a -&gt; Stack a
</span><a href="#local-6989586621679493534"><span class="hs-identifier hs-var hs-var">single</span></a></span></span><span> </span><span id="local-6989586621679493527"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493527"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a] -&gt; Stack a
</span><span class="hs-identifier hs-var">W.Stack</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493527"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-517"></span><span>          </span><span id="local-6989586621679493536"><span class="annot"><span class="annottext">fromMaybe2 :: (a, b) -&gt; (Maybe a, Maybe b) -&gt; (a, b)
</span><a href="#local-6989586621679493536"><span class="hs-identifier hs-var hs-var">fromMaybe2</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679493526"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493526"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679493525"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679493525"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679493524"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679493524"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span id="local-6989586621679493523"><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679493523"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679493526"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679493524"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679493525"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679493523"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span>
</span><span id="line-520"></span><span class="hs-comment">-- this would be much cleaner with some kind of data-accessor</span><span>
</span><span id="line-521"></span><span class="annot"><a href="XMonad.Layout.SubLayouts.html#setStack"><span class="hs-identifier hs-type">setStack</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.Stack</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span id="setStack"><span class="annot"><span class="annottext">setStack :: Maybe (Stack Window) -&gt; X ()
</span><a href="XMonad.Layout.SubLayouts.html#setStack"><span class="hs-identifier hs-var hs-var">setStack</span></a></span></span><span> </span><span id="local-6989586621679493522"><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493522"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679493520"><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493520"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493520"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">windowset :: WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493520"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">current :: Screen String (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493520"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">workspace :: Workspace String (Layout Window) Window
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">W.workspace</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">W.current</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">XState -&gt; WindowSet
</span><span class="hs-identifier hs-var">windowset</span></span><span> </span><span class="annot"><span class="annottext">XState
</span><a href="#local-6989586621679493520"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stack :: Maybe (Stack Window)
</span><span class="hs-identifier hs-var">W.stack</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack Window)
</span><a href="#local-6989586621679493522"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-525"></span></pre></body></html>