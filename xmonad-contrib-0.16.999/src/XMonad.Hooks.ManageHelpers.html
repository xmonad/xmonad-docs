<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-2"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Module       : XMonad.Hooks.ManageHelpers</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Description  : Helper functions to be used in manageHook.</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- Copyright    : (c) Lukas Mai</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- License      : BSD</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Maintainer   : Lukas Mai &lt;l.mai@web.de&gt;</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Stability    : unstable</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Portability  : unportable</span><span>
</span><span id="line-12"></span><span class="hs-comment">--</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- This module provides helper functions to be used in @manageHook@. Here's</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- how you might use this:</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- &gt; import XMonad.Hooks.ManageHelpers</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- &gt; main =</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- &gt;     xmonad def{</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- &gt;         ...</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- &gt;         manageHook = composeOne [</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- &gt;             isKDETrayWindow -?&gt; doIgnore,</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- &gt;             transience,</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- &gt;             isFullscreen -?&gt; doFullFloat,</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- &gt;             resource =? &quot;stalonetray&quot; -?&gt; doIgnore</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- &gt;         ],</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- &gt;         ...</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &gt;     }</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Hooks.ManageHelpers</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Side"><span class="hs-identifier">Side</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#composeOne"><span class="hs-identifier">composeOne</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E"><span class="hs-operator">(-?&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#%2F%3D%3F"><span class="hs-operator">(/=?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#%3C%3D%3D%3F"><span class="hs-operator">(&lt;==?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#%3C%2F%3D%3F"><span class="hs-operator">(&lt;/=?)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#--%3E%3E"><span class="hs-operator">(--&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E%3E"><span class="hs-operator">(-?&gt;&gt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#currentWs"><span class="hs-identifier">currentWs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#windowTag"><span class="hs-identifier">windowTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier">isInProperty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isKDETrayWindow"><span class="hs-identifier">isKDETrayWindow</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isFullscreen"><span class="hs-identifier">isFullscreen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isDialog"><span class="hs-identifier">isDialog</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#pid"><span class="hs-identifier">pid</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#transientTo"><span class="hs-identifier">transientTo</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#maybeToDefinite"><span class="hs-identifier">maybeToDefinite</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#MaybeManageHook"><span class="hs-identifier">MaybeManageHook</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#transience"><span class="hs-identifier">transience</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#transience%27"><span class="hs-identifier">transience'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#clientLeader"><span class="hs-identifier">clientLeader</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#sameBy"><span class="hs-identifier">sameBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame"><span class="hs-identifier">shiftToSame</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame%27"><span class="hs-identifier">shiftToSame'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier">doRectFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFullFloat"><span class="hs-identifier">doFullFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doCenterFloat"><span class="hs-identifier">doCenterFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doSideFloat"><span class="hs-identifier">doSideFloat</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFloatAt"><span class="hs-identifier">doFloatAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFloatDep"><span class="hs-identifier">doFloatDep</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-55"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doHideIgnore"><span class="hs-identifier">doHideIgnore</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-56"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doSink"><span class="hs-identifier">doSink</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doLower"><span class="hs-identifier">doLower</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRaise"><span class="hs-identifier">doRaise</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFocus"><span class="hs-identifier">doFocus</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier">Match</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">W</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.WindowProperties.html"><span class="hs-identifier">XMonad.Util.WindowProperties</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.WindowProperties.html#getProp32s"><span class="hs-identifier">getProp32s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ProcessID</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">-- | Denotes a side of a screen. @S@ stands for South, @NE@ for Northeast</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- etc. @C@ stands for Center.</span><span>
</span><span id="line-72"></span><span class="hs-keyword">data</span><span> </span><span id="Side"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Side"><span class="hs-identifier hs-var">Side</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SC"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#SC"><span class="hs-identifier hs-var">SC</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NC"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#NC"><span class="hs-identifier hs-var">NC</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="CE"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#CE"><span class="hs-identifier hs-var">CE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="CW"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#CW"><span class="hs-identifier hs-var">CW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SE"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#SE"><span class="hs-identifier hs-var">SE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="SW"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#SW"><span class="hs-identifier hs-var">SW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NE"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#NE"><span class="hs-identifier hs-var">NE</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NW"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#NW"><span class="hs-identifier hs-var">NW</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="C"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#C"><span class="hs-identifier hs-var">C</span></a></span></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679394958"><span id="local-6989586621679394960"><span id="local-6989586621679394962"><span id="local-6989586621679394964"><span class="annot"><span class="annottext">ReadPrec [Side]
ReadPrec Side
Int -&gt; ReadS Side
ReadS [Side]
(Int -&gt; ReadS Side)
-&gt; ReadS [Side] -&gt; ReadPrec Side -&gt; ReadPrec [Side] -&gt; Read Side
forall a.
(Int -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [Side]
$creadListPrec :: ReadPrec [Side]
readPrec :: ReadPrec Side
$creadPrec :: ReadPrec Side
readList :: ReadS [Side]
$creadList :: ReadS [Side]
readsPrec :: Int -&gt; ReadS Side
$creadsPrec :: Int -&gt; ReadS Side
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679394951"><span id="local-6989586621679394953"><span id="local-6989586621679394955"><span class="annot"><span class="annottext">Int -&gt; Side -&gt; ShowS
[Side] -&gt; ShowS
Side -&gt; String
(Int -&gt; Side -&gt; ShowS)
-&gt; (Side -&gt; String) -&gt; ([Side] -&gt; ShowS) -&gt; Show Side
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Side] -&gt; ShowS
$cshowList :: [Side] -&gt; ShowS
show :: Side -&gt; String
$cshow :: Side -&gt; String
showsPrec :: Int -&gt; Side -&gt; ShowS
$cshowsPrec :: Int -&gt; Side -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679394946"><span id="local-6989586621679394948"><span class="annot"><span class="annottext">Side -&gt; Side -&gt; Bool
(Side -&gt; Side -&gt; Bool) -&gt; (Side -&gt; Side -&gt; Bool) -&gt; Eq Side
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Side -&gt; Side -&gt; Bool
$c/= :: Side -&gt; Side -&gt; Bool
== :: Side -&gt; Side -&gt; Bool
$c== :: Side -&gt; Side -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | A ManageHook that may or may not have been executed; the outcome is embedded in the Maybe</span><span>
</span><span id="line-76"></span><span class="hs-keyword">type</span><span> </span><span id="MaybeManageHook"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#MaybeManageHook"><span class="hs-identifier hs-var">MaybeManageHook</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Endo</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | A grouping type, which can hold the outcome of a predicate Query.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- This is analogous to group types in regular expressions.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- TODO: create a better API for aggregating multiple Matches logically</span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span> </span><span id="Match"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-var">Match</span></a></span></span><span> </span><span id="local-6989586621679395133"><span class="annot"><a href="#local-6989586621679395133"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Match"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-var">Match</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="annot"><a href="#local-6989586621679395133"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | An alternative 'ManageHook' composer. Unlike 'composeAll' it stops as soon as</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- a candidate returns a 'Just' value, effectively running only the first match</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- (whereas 'composeAll' continues and executes all matching rules).</span><span>
</span><span id="line-85"></span><span id="local-6989586621679394942"><span id="local-6989586621679394943"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#composeOne"><span class="hs-identifier hs-type">composeOne</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679394943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679394942"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679394942"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679394943"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394942"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394943"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-86"></span><span id="composeOne"><span class="annot"><span class="annottext">composeOne :: [m (Maybe a)] -&gt; m a
</span><a href="XMonad.Hooks.ManageHelpers.html#composeOne"><span class="hs-identifier hs-var hs-var">composeOne</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(m (Maybe a) -&gt; m a -&gt; m a) -&gt; m a -&gt; [m (Maybe a)] -&gt; m a
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="annot"><span class="annottext">m (Maybe a) -&gt; m a -&gt; m a
forall (m :: * -&gt; *) b. Monad m =&gt; m (Maybe b) -&gt; m b -&gt; m b
</span><a href="#local-6989586621679394940"><span class="hs-identifier hs-var">try</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>    </span><span id="local-6989586621679394940"><span class="annot"><span class="annottext">try :: m (Maybe b) -&gt; m b -&gt; m b
</span><a href="#local-6989586621679394940"><span class="hs-identifier hs-var hs-var">try</span></a></span></span><span> </span><span id="local-6989586621679394939"><span class="annot"><span class="annottext">m (Maybe b)
</span><a href="#local-6989586621679394939"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="local-6989586621679394938"><span class="annot"><span class="annottext">m b
</span><a href="#local-6989586621679394938"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-89"></span><span>        </span><span id="local-6989586621679394937"><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679394937"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Maybe b)
</span><a href="#local-6989586621679394939"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="annottext">m b -&gt; (b -&gt; m b) -&gt; Maybe b -&gt; m b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">m b
</span><a href="#local-6989586621679394938"><span class="hs-identifier hs-var">z</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe b
</span><a href="#local-6989586621679394937"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E"><span class="hs-operator hs-type">-?&gt;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#--%3E%3E"><span class="hs-operator hs-type">--&gt;&gt;</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E%3E"><span class="hs-operator hs-type">-?&gt;&gt;</span></a></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">-- | q \/=? x. if the result of q equals x, return False</span><span>
</span><span id="line-95"></span><span id="local-6989586621679394934"><span id="local-6989586621679394935"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#%2F%3D%3F"><span class="hs-operator hs-type">(/=?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679394935"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679394934"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394934"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394935"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394935"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394934"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span><span>
</span><span id="line-96"></span><span id="local-6989586621679394933"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394933"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="%2F%3D%3F"><span class="annot"><span class="annottext">/=? :: m a -&gt; a -&gt; m Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#%2F%3D%3F"><span class="hs-operator hs-var hs-var">/=?</span></a></span></span><span> </span><span id="local-6989586621679394932"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394932"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; m a -&gt; m Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394932"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394933"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | q &lt;==? x. if the result of q equals x, return True grouped with q</span><span>
</span><span id="line-99"></span><span id="local-6989586621679394929"><span id="local-6989586621679394930"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#%3C%3D%3D%3F"><span class="hs-operator hs-type">(&lt;==?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679394930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679394929"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394929"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394930"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394929"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394930"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679394928"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394928"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="%3C%3D%3D%3F"><span class="annot"><span class="annottext">&lt;==? :: m a -&gt; a -&gt; m (Match a)
</span><a href="XMonad.Hooks.ManageHelpers.html#%3C%3D%3D%3F"><span class="hs-operator hs-var hs-var">&lt;==?</span></a></span></span><span> </span><span id="local-6989586621679394927"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394927"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Match a) -&gt; m a -&gt; m (Match a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Match a
forall a. Eq a =&gt; a -&gt; a -&gt; Match a
</span><a href="#local-6989586621679394926"><span class="hs-operator hs-var">`eq`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394927"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394928"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span id="local-6989586621679394926"><span class="annot"><span class="annottext">eq :: a -&gt; a -&gt; Match a
</span><a href="#local-6989586621679394926"><span class="hs-identifier hs-var hs-var">eq</span></a></span></span><span> </span><span id="local-6989586621679394925"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394925"><span class="hs-identifier hs-var">q'</span></a></span></span><span> </span><span id="local-6989586621679394924"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394924"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Match a
forall a. Bool -&gt; a -&gt; Match a
</span><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394925"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394924"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394925"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-103"></span><span>
</span><span id="line-104"></span><span class="hs-comment">-- | q &lt;\/=? x. if the result of q notequals x, return True grouped with q</span><span>
</span><span id="line-105"></span><span id="local-6989586621679395074"><span id="local-6989586621679395075"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#%3C%2F%3D%3F"><span class="hs-operator hs-type">(&lt;/=?)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679395075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679395074"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679395075"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395075"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395074"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679395075"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-106"></span><span id="local-6989586621679394923"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394923"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span id="%3C%2F%3D%3F"><span class="annot"><span class="annottext">&lt;/=? :: m a -&gt; a -&gt; m (Match a)
</span><a href="XMonad.Hooks.ManageHelpers.html#%3C%2F%3D%3F"><span class="hs-operator hs-var hs-var">&lt;/=?</span></a></span></span><span> </span><span id="local-6989586621679394922"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394922"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Match a) -&gt; m a -&gt; m (Match a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Match a
forall a. Eq a =&gt; a -&gt; a -&gt; Match a
</span><a href="#local-6989586621679394921"><span class="hs-operator hs-var">`neq`</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394922"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394923"><span class="hs-identifier hs-var">q</span></a></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-108"></span><span>    </span><span id="local-6989586621679394921"><span class="annot"><span class="annottext">neq :: a -&gt; a -&gt; Match a
</span><a href="#local-6989586621679394921"><span class="hs-identifier hs-var hs-var">neq</span></a></span></span><span> </span><span id="local-6989586621679394920"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394920"><span class="hs-identifier hs-var">q'</span></a></span></span><span> </span><span id="local-6989586621679394919"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394919"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; a -&gt; Match a
forall a. Bool -&gt; a -&gt; Match a
</span><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394920"><span class="hs-identifier hs-var">q'</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394919"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394920"><span class="hs-identifier hs-var">q'</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | A helper operator for use in 'composeOne'. It takes a condition and an action;</span><span>
</span><span id="line-111"></span><span class="hs-comment">-- if the condition fails, it returns 'Nothing' from the 'Query' so 'composeOne' will</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- go on and try the next rule.</span><span>
</span><span id="line-113"></span><span id="local-6989586621679394917"><span id="local-6989586621679394918"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E"><span class="hs-operator hs-type">(-?&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679394918"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679394918"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394918"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394918"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394917"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394918"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679394917"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-114"></span><span id="local-6989586621679394916"><span class="annot"><span class="annottext">m Bool
</span><a href="#local-6989586621679394916"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="-%3F%3E"><span class="annot"><span class="annottext">-?&gt; :: m Bool -&gt; m a -&gt; m (Maybe a)
</span><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E"><span class="hs-operator hs-var hs-var">-?&gt;</span></a></span></span><span> </span><span id="local-6989586621679394915"><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394915"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-115"></span><span>    </span><span id="local-6989586621679394914"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679394914"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Bool
</span><a href="#local-6989586621679394916"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679394914"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Maybe a) -&gt; m a -&gt; m (Maybe a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">m a
</span><a href="#local-6989586621679394915"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; m (Maybe a)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-117"></span><span>
</span><span id="line-118"></span><span class="hs-comment">-- | A helper operator for use in 'composeAll'. It takes a condition and a function taking a grouped datum to action.  If 'p' is true, it executes the resulting action.</span><span>
</span><span id="line-119"></span><span id="local-6989586621679394911"><span id="local-6989586621679394912"><span id="local-6989586621679394913"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#--%3E%3E"><span class="hs-operator hs-type">(--&gt;&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679394913"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679394912"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394911"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679394911"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394913"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679394912"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679394913"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-120"></span><span id="local-6989586621679394910"><span class="annot"><span class="annottext">m (Match a)
</span><a href="#local-6989586621679394910"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="--%3E%3E"><span class="annot"><span class="annottext">--&gt;&gt; :: m (Match a) -&gt; (a -&gt; m b) -&gt; m b
</span><a href="XMonad.Hooks.ManageHelpers.html#--%3E%3E"><span class="hs-operator hs-var hs-var">--&gt;&gt;</span></a></span></span><span> </span><span id="local-6989586621679394909"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679394909"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679394908"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679394908"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679394907"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394907"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Match a)
</span><a href="#local-6989586621679394910"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679394908"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679394909"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394907"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">b -&gt; m b
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">b
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | A helper operator for use in 'composeOne'.  It takes a condition and a function taking a groupdatum to action.  If 'p' is true, it executes the resulting action.  If it fails, it returns 'Nothing' from the 'Query' so 'composeOne' will go on and try the next rule.</span><span>
</span><span id="line-125"></span><span id="local-6989586621679395070"><span id="local-6989586621679395071"><span id="local-6989586621679395072"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E%3E"><span class="hs-operator hs-type">(-?&gt;&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679395072"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679395072"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395072"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679395071"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679395071"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395072"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679395070"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395072"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679395070"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-126"></span><span id="local-6989586621679394906"><span class="annot"><span class="annottext">m (Match a)
</span><a href="#local-6989586621679394906"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="-%3F%3E%3E"><span class="annot"><span class="annottext">-?&gt;&gt; :: m (Match a) -&gt; (a -&gt; m b) -&gt; m (Maybe b)
</span><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E%3E"><span class="hs-operator hs-var hs-var">-?&gt;&gt;</span></a></span></span><span> </span><span id="local-6989586621679394905"><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679394905"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621679394904"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679394904"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679394903"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394903"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (Match a)
</span><a href="#local-6989586621679394906"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679394904"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(b -&gt; Maybe b) -&gt; m b -&gt; m (Maybe b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span>  </span><span class="annot"><span class="annottext">b -&gt; Maybe b
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; m b
</span><a href="#local-6989586621679394905"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679394903"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe b -&gt; m (Maybe b)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe b
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Return the current workspace</span><span>
</span><span id="line-131"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#currentWs"><span class="hs-identifier hs-type">currentWs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span>
</span><span id="line-132"></span><span id="currentWs"><span class="annot"><span class="annottext">currentWs :: Query String
</span><a href="XMonad.Hooks.ManageHelpers.html#currentWs"><span class="hs-identifier hs-var hs-var">currentWs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X String -&gt; Query String
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(WindowSet -&gt; X String) -&gt; X String
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X String) -&gt; X String)
-&gt; (WindowSet -&gt; X String) -&gt; X String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; X String
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; X String)
-&gt; (WindowSet -&gt; String) -&gt; WindowSet -&gt; X String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WindowSet -&gt; String
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">W.currentTag</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Return the workspace tag of a window, if already managed</span><span>
</span><span id="line-135"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#windowTag"><span class="hs-identifier hs-type">windowTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">WorkspaceId</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span id="windowTag"><span class="annot"><span class="annottext">windowTag :: Query (Maybe String)
</span><a href="XMonad.Hooks.ManageHelpers.html#windowTag"><span class="hs-identifier hs-var hs-var">windowTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Maybe String)) -&gt; Query (Maybe String)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394896"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394896"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X (Maybe String) -&gt; Query (Maybe String)
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X (Maybe String) -&gt; Query (Maybe String))
-&gt; X (Maybe String) -&gt; Query (Maybe String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X (Maybe String)) -&gt; X (Maybe String)
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X (Maybe String)) -&gt; X (Maybe String))
-&gt; (WindowSet -&gt; X (Maybe String)) -&gt; X (Maybe String)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; X (Maybe String)
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; X (Maybe String))
-&gt; (WindowSet -&gt; Maybe String) -&gt; WindowSet -&gt; X (Maybe String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; WindowSet -&gt; Maybe String
forall a i l s sd. Eq a =&gt; a -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">W.findTag</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394896"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | A predicate to check whether a window is a KDE system tray icon.</span><span>
</span><span id="line-139"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isKDETrayWindow"><span class="hs-identifier hs-type">isKDETrayWindow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-140"></span><span id="isKDETrayWindow"><span class="annot"><span class="annottext">isKDETrayWindow :: Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isKDETrayWindow"><span class="hs-identifier hs-var hs-var">isKDETrayWindow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window -&gt; (Window -&gt; Query Bool) -&gt; Query Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394894"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394894"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; Query Bool
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X Bool -&gt; Query Bool) -&gt; X Bool -&gt; Query Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679394893"><span class="annot"><span class="annottext">Maybe [CLong]
</span><a href="#local-6989586621679394893"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X (Maybe [CLong])
</span><a href="XMonad.Util.WindowProperties.html#getProp32s"><span class="hs-identifier hs-var">getProp32s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_KDE_NET_WM_SYSTEM_TRAY_WINDOW_FOR&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394894"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; X Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; X Bool) -&gt; Bool -&gt; X Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [CLong]
</span><a href="#local-6989586621679394893"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CLong
</span><span class="hs-identifier">_</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><span class="annottext">Maybe [CLong]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Helper to check if a window property contains certain value.</span><span>
</span><span id="line-147"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier hs-type">isInProperty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-148"></span><span id="isInProperty"><span class="annot"><span class="annottext">isInProperty :: String -&gt; String -&gt; Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier hs-var hs-var">isInProperty</span></a></span></span><span> </span><span id="local-6989586621679394892"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679394892"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679394891"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679394891"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window -&gt; (Window -&gt; Query Bool) -&gt; Query Bool
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394890"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394890"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; Query Bool
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X Bool -&gt; Query Bool) -&gt; X Bool -&gt; Query Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679394889"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394889"><span class="hs-identifier hs-var">va</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; X Window
</span><span class="hs-identifier hs-var">getAtom</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679394891"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679394887"><span class="annot"><span class="annottext">Maybe [CLong]
</span><a href="#local-6989586621679394887"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X (Maybe [CLong])
</span><a href="XMonad.Util.WindowProperties.html#getProp32s"><span class="hs-identifier hs-var">getProp32s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679394892"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394890"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; X Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; X Bool) -&gt; Bool -&gt; X Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe [CLong]
</span><a href="#local-6989586621679394887"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-152"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679394886"><span class="annot"><span class="annottext">[CLong]
</span><a href="#local-6989586621679394886"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; CLong
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394889"><span class="hs-identifier hs-var">va</span></a></span><span> </span><span class="annot"><span class="annottext">CLong -&gt; [CLong] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[CLong]
</span><a href="#local-6989586621679394886"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">Maybe [CLong]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">-- | A predicate to check whether a window wants to fill the whole screen.</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- See also 'doFullFloat'.</span><span>
</span><span id="line-157"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isFullscreen"><span class="hs-identifier hs-type">isFullscreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-158"></span><span id="isFullscreen"><span class="annot"><span class="annottext">isFullscreen :: Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isFullscreen"><span class="hs-identifier hs-var hs-var">isFullscreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier hs-var">isInProperty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_STATE&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_STATE_FULLSCREEN&quot;</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | A predicate to check whether a window is a dialog.</span><span>
</span><span id="line-161"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#isDialog"><span class="hs-identifier hs-type">isDialog</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-162"></span><span id="isDialog"><span class="annot"><span class="annottext">isDialog :: Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isDialog"><span class="hs-identifier hs-var hs-var">isDialog</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Query Bool
</span><a href="XMonad.Hooks.ManageHelpers.html#isInProperty"><span class="hs-identifier hs-var">isInProperty</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_WINDOW_TYPE&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_WINDOW_TYPE_DIALOG&quot;</span></span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | This function returns 'Just' the @_NET_WM_PID@ property for a</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- particular window if set, 'Nothing' otherwise.</span><span>
</span><span id="line-166"></span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span class="hs-comment">-- See &lt;https://specifications.freedesktop.org/wm-spec/wm-spec-1.5.html#idm45623487788432&gt;.</span><span>
</span><span id="line-168"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#pid"><span class="hs-identifier hs-type">pid</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProcessID</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span id="pid"><span class="annot"><span class="annottext">pid :: Query (Maybe ProcessID)
</span><a href="XMonad.Hooks.ManageHelpers.html#pid"><span class="hs-identifier hs-var hs-var">pid</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Maybe ProcessID)) -&gt; Query (Maybe ProcessID)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394884"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394884"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X (Maybe ProcessID) -&gt; Query (Maybe ProcessID)
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X (Maybe ProcessID) -&gt; Query (Maybe ProcessID))
-&gt; X (Maybe ProcessID) -&gt; Query (Maybe ProcessID)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X (Maybe [CLong])
</span><a href="XMonad.Util.WindowProperties.html#getProp32s"><span class="hs-identifier hs-var">getProp32s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;_NET_WM_PID&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394884"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">X (Maybe [CLong])
-&gt; (Maybe [CLong] -&gt; Maybe ProcessID) -&gt; X (Maybe ProcessID)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-170"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679394882"><span class="annot"><span class="annottext">CLong
</span><a href="#local-6989586621679394882"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ProcessID -&gt; Maybe ProcessID
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLong -&gt; ProcessID
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">CLong
</span><a href="#local-6989586621679394882"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">Maybe [CLong]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ProcessID
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | A predicate to check whether a window is Transient.</span><span>
</span><span id="line-174"></span><span class="hs-comment">-- It holds the result which might be the window it is transient to</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- or it might be 'Nothing'.</span><span>
</span><span id="line-176"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#transientTo"><span class="hs-identifier hs-type">transientTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span id="transientTo"><span class="annot"><span class="annottext">transientTo :: Query (Maybe Window)
</span><a href="XMonad.Hooks.ManageHelpers.html#transientTo"><span class="hs-identifier hs-var hs-var">transientTo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-178"></span><span>    </span><span id="local-6989586621679394881"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394881"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679394880"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679394880"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">X Display -&gt; Query Display
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X Display -&gt; Query Display)
-&gt; ((XConf -&gt; Display) -&gt; X Display)
-&gt; (XConf -&gt; Display)
-&gt; Query Display
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(XConf -&gt; Display) -&gt; X Display
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XConf -&gt; Display
</span><span class="hs-identifier hs-var hs-var">display</span></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="annottext">IO (Maybe Window) -&gt; Query (Maybe Window)
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">liftIO</span></span><span> </span><span class="annot"><span class="annottext">(IO (Maybe Window) -&gt; Query (Maybe Window))
-&gt; IO (Maybe Window) -&gt; Query (Maybe Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO (Maybe Window)
</span><span class="hs-identifier hs-var">getTransientForHint</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679394880"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394881"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | A convenience 'MaybeManageHook' that will check to see if a window</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- is transient, and then move it to its parent.</span><span>
</span><span id="line-184"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#transience"><span class="hs-identifier hs-type">transience</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#MaybeManageHook"><span class="hs-identifier hs-type">MaybeManageHook</span></a></span><span>
</span><span id="line-185"></span><span id="transience"><span class="annot"><span class="annottext">transience :: MaybeManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#transience"><span class="hs-identifier hs-var hs-var">transience</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (Maybe Window)
</span><a href="XMonad.Hooks.ManageHelpers.html#transientTo"><span class="hs-identifier hs-var">transientTo</span></a></span><span> </span><span class="annot"><span class="annottext">Query (Maybe Window)
-&gt; Maybe Window -&gt; Query (Match (Maybe Window))
forall a (m :: * -&gt; *).
(Eq a, Functor m) =&gt;
m a -&gt; a -&gt; m (Match a)
</span><a href="XMonad.Hooks.ManageHelpers.html#%3C%2F%3D%3F"><span class="hs-operator hs-var">&lt;/=?</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Query (Match (Maybe Window))
-&gt; (Maybe Window -&gt; Query (Endo WindowSet)) -&gt; MaybeManageHook
forall (m :: * -&gt; *) a b.
(Functor m, Monad m) =&gt;
m (Match a) -&gt; (a -&gt; m b) -&gt; m (Maybe b)
</span><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E%3E"><span class="hs-operator hs-var">-?&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Query (Endo WindowSet)
-&gt; (Window -&gt; Query (Endo WindowSet))
-&gt; Maybe Window
-&gt; Query (Endo WindowSet)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Query (Endo WindowSet)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">idHook</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doShiftTo"><span class="hs-identifier hs-var">doShiftTo</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-comment">-- | 'transience' set to a 'ManageHook'</span><span>
</span><span id="line-188"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#transience%27"><span class="hs-identifier hs-type">transience'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-189"></span><span id="transience%27"><span class="annot"><span class="annottext">transience' :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#transience%27"><span class="hs-identifier hs-var hs-var">transience'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeManageHook -&gt; Query (Endo WindowSet)
forall a (m :: * -&gt; *). (Monoid a, Functor m) =&gt; m (Maybe a) -&gt; m a
</span><a href="XMonad.Hooks.ManageHelpers.html#maybeToDefinite"><span class="hs-identifier hs-var">maybeToDefinite</span></a></span><span> </span><span class="annot"><span class="annottext">MaybeManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#transience"><span class="hs-identifier hs-var">transience</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | This function returns 'Just' the @WM_CLIENT_LEADER@ property for a</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- particular window if set, 'Nothing' otherwise. Note that, generally,</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- the window ID returned from this property (by firefox, for example)</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- corresponds to an unmapped or unmanaged dummy window. For this to be</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- useful in most cases, it should be used together with 'sameBy'.</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- See &lt;https://tronche.com/gui/x/icccm/sec-5.html&gt;.</span><span>
</span><span id="line-198"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#clientLeader"><span class="hs-identifier hs-type">clientLeader</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span id="clientLeader"><span class="annot"><span class="annottext">clientLeader :: Query (Maybe Window)
</span><a href="XMonad.Hooks.ManageHelpers.html#clientLeader"><span class="hs-identifier hs-var hs-var">clientLeader</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Maybe Window)) -&gt; Query (Maybe Window)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394872"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394872"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X (Maybe Window) -&gt; Query (Maybe Window)
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X (Maybe Window) -&gt; Query (Maybe Window))
-&gt; X (Maybe Window) -&gt; Query (Maybe Window)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Window -&gt; X (Maybe [CLong])
</span><a href="XMonad.Util.WindowProperties.html#getProp32s"><span class="hs-identifier hs-var">getProp32s</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;WM_CLIENT_LEADER&quot;</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394872"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">X (Maybe [CLong])
-&gt; (Maybe [CLong] -&gt; Maybe Window) -&gt; X (Maybe Window)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-200"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621679394871"><span class="annot"><span class="annottext">CLong
</span><a href="#local-6989586621679394871"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Window -&gt; Maybe Window
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CLong -&gt; Window
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">CLong
</span><a href="#local-6989586621679394871"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="annottext">Maybe [CLong]
</span><span class="hs-identifier">_</span></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Window
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- | For a given window, 'sameBy' returns all windows that have a matching</span><span>
</span><span id="line-204"></span><span class="hs-comment">-- property (e.g. those obtained from Queries of 'clientLeader' and 'pid').</span><span>
</span><span id="line-205"></span><span id="local-6989586621679395054"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#sameBy"><span class="hs-identifier hs-type">sameBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679395054"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679395054"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span class="hs-special">]</span></span><span>
</span><span id="line-206"></span><span id="sameBy"><span class="annot"><span class="annottext">sameBy :: Query (Maybe prop) -&gt; Query [Window]
</span><a href="XMonad.Hooks.ManageHelpers.html#sameBy"><span class="hs-identifier hs-var hs-var">sameBy</span></a></span></span><span> </span><span id="local-6989586621679394870"><span class="annot"><span class="annottext">Query (Maybe prop)
</span><a href="#local-6989586621679394870"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop)
</span><a href="#local-6989586621679394870"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop)
-&gt; (Maybe prop -&gt; Query [Window]) -&gt; Query [Window]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Maybe prop
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Query [Window]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679394869"><span class="annot"><span class="annottext">Maybe prop
</span><a href="#local-6989586621679394869"><span class="hs-identifier hs-var">propVal</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window -&gt; (Window -&gt; Query [Window]) -&gt; Query [Window]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394868"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394868"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X [Window] -&gt; Query [Window]
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X [Window] -&gt; Query [Window])
-&gt; ((WindowSet -&gt; X [Window]) -&gt; X [Window])
-&gt; (WindowSet -&gt; X [Window])
-&gt; Query [Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; X [Window]) -&gt; X [Window]
forall a. (WindowSet -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withWindowSet</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; X [Window]) -&gt; Query [Window])
-&gt; (WindowSet -&gt; X [Window]) -&gt; Query [Window]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394867"><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679394867"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>        </span><span class="annot"><span class="annottext">(Window -&gt; X Bool) -&gt; [Window] -&gt; X [Window]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
(a -&gt; m Bool) -&gt; [a] -&gt; m [a]
</span><span class="hs-identifier hs-var">filterM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Maybe prop -&gt; Bool) -&gt; X (Maybe prop) -&gt; X Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe prop
</span><a href="#local-6989586621679394869"><span class="hs-identifier hs-var">propVal</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe prop -&gt; Maybe prop -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X (Maybe prop) -&gt; X Bool)
-&gt; (Window -&gt; X (Maybe prop)) -&gt; Window -&gt; X Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop) -&gt; Window -&gt; X (Maybe prop)
forall a. Query a -&gt; Window -&gt; X a
</span><span class="hs-identifier hs-var">runQuery</span></span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop)
</span><a href="#local-6989586621679394870"><span class="hs-identifier hs-var">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WindowSet -&gt; [Window]
forall a i l s sd. Eq a =&gt; StackSet i l a s sd -&gt; [a]
</span><span class="hs-identifier hs-var">W.allWindows</span></span><span> </span><span class="annot"><span class="annottext">WindowSet
</span><a href="#local-6989586621679394867"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; [Window] -&gt; [Window]
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">\\</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394868"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | 'MaybeManageHook' that moves the window to the same workspace as the</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- first other window that has the same value of a given 'Query'. Useful</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- Queries for this include 'clientLeader' and 'pid'.</span><span>
</span><span id="line-214"></span><span id="local-6989586621679395051"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame"><span class="hs-identifier hs-type">shiftToSame</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679395051"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679395051"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#MaybeManageHook"><span class="hs-identifier hs-type">MaybeManageHook</span></a></span></span><span>
</span><span id="line-215"></span><span id="shiftToSame"><span class="annot"><span class="annottext">shiftToSame :: Query (Maybe prop) -&gt; MaybeManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame"><span class="hs-identifier hs-var hs-var">shiftToSame</span></a></span></span><span> </span><span id="local-6989586621679394862"><span class="annot"><span class="annottext">Query (Maybe prop)
</span><a href="#local-6989586621679394862"><span class="hs-identifier hs-var">prop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop) -&gt; Query [Window]
forall prop. Eq prop =&gt; Query (Maybe prop) -&gt; Query [Window]
</span><a href="XMonad.Hooks.ManageHelpers.html#sameBy"><span class="hs-identifier hs-var">sameBy</span></a></span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop)
</span><a href="#local-6989586621679394862"><span class="hs-identifier hs-var">prop</span></a></span><span> </span><span class="annot"><span class="annottext">Query [Window] -&gt; [Window] -&gt; Query (Match [Window])
forall a (m :: * -&gt; *).
(Eq a, Functor m) =&gt;
m a -&gt; a -&gt; m (Match a)
</span><a href="XMonad.Hooks.ManageHelpers.html#%3C%2F%3D%3F"><span class="hs-operator hs-var">&lt;/=?</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Query (Match [Window])
-&gt; ([Window] -&gt; Query (Endo WindowSet)) -&gt; MaybeManageHook
forall (m :: * -&gt; *) a b.
(Functor m, Monad m) =&gt;
m (Match a) -&gt; (a -&gt; m b) -&gt; m (Maybe b)
</span><a href="XMonad.Hooks.ManageHelpers.html#-%3F%3E%3E"><span class="hs-operator hs-var">-?&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Query (Endo WindowSet)
-&gt; (Window -&gt; Query (Endo WindowSet))
-&gt; Maybe Window
-&gt; Query (Endo WindowSet)
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Query (Endo WindowSet)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">idHook</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doShiftTo"><span class="hs-identifier hs-var">doShiftTo</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Window -&gt; Query (Endo WindowSet))
-&gt; ([Window] -&gt; Maybe Window) -&gt; [Window] -&gt; Query (Endo WindowSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Window] -&gt; Maybe Window
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span class="hs-comment">-- | 'shiftToSame' set to a 'ManageHook'</span><span>
</span><span id="line-218"></span><span id="local-6989586621679394860"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame%27"><span class="hs-identifier hs-type">shiftToSame'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679394860"><span class="hs-identifier hs-type">prop</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Query</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679394860"><span class="hs-identifier hs-type">prop</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span></span><span>
</span><span id="line-219"></span><span id="shiftToSame%27"><span class="annot"><span class="annottext">shiftToSame' :: Query (Maybe prop) -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame%27"><span class="hs-identifier hs-var hs-var">shiftToSame'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeManageHook -&gt; Query (Endo WindowSet)
forall a (m :: * -&gt; *). (Monoid a, Functor m) =&gt; m (Maybe a) -&gt; m a
</span><a href="XMonad.Hooks.ManageHelpers.html#maybeToDefinite"><span class="hs-identifier hs-var">maybeToDefinite</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeManageHook -&gt; Query (Endo WindowSet))
-&gt; (Query (Maybe prop) -&gt; MaybeManageHook)
-&gt; Query (Maybe prop)
-&gt; Query (Endo WindowSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Query (Maybe prop) -&gt; MaybeManageHook
forall prop. Eq prop =&gt; Query (Maybe prop) -&gt; MaybeManageHook
</span><a href="XMonad.Hooks.ManageHelpers.html#shiftToSame"><span class="hs-identifier hs-var">shiftToSame</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | converts 'MaybeManageHook's to 'ManageHook's</span><span>
</span><span id="line-222"></span><span id="local-6989586621679395068"><span id="local-6989586621679395069"><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#maybeToDefinite"><span class="hs-identifier hs-type">maybeToDefinite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679395069"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679395068"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679395069"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679395068"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679395069"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-223"></span><span id="maybeToDefinite"><span class="annot"><span class="annottext">maybeToDefinite :: m (Maybe a) -&gt; m a
</span><a href="XMonad.Hooks.ManageHelpers.html#maybeToDefinite"><span class="hs-identifier hs-var hs-var">maybeToDefinite</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; a) -&gt; m (Maybe a) -&gt; m a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe a -&gt; a
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">a
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-comment">-- | Move the window to the same workspace as another window.</span><span>
</span><span id="line-226"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doShiftTo"><span class="hs-identifier hs-type">doShiftTo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Window</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-227"></span><span id="doShiftTo"><span class="annot"><span class="annottext">doShiftTo :: Window -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doShiftTo"><span class="hs-identifier hs-var hs-var">doShiftTo</span></a></span></span><span> </span><span id="local-6989586621679394858"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394858"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet)
forall s. (s -&gt; s) -&gt; Query (Endo s)
</span><span class="hs-identifier hs-var">doF</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet))
-&gt; (Window -&gt; WindowSet -&gt; WindowSet)
-&gt; Window
-&gt; Query (Endo WindowSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; WindowSet -&gt; WindowSet
forall s i l sd.
(Eq s, Eq i) =&gt;
Window -&gt; StackSet i l Window s sd -&gt; StackSet i l Window s sd
</span><a href="#local-6989586621679394856"><span class="hs-identifier hs-var">shiftTo</span></a></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Query (Endo WindowSet))
-&gt; Query Window -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679394856"><span class="annot"><span class="annottext">shiftTo :: Window -&gt; StackSet i l Window s sd -&gt; StackSet i l Window s sd
</span><a href="#local-6989586621679394856"><span class="hs-identifier hs-var hs-var">shiftTo</span></a></span></span><span> </span><span id="local-6989586621679394854"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394854"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679394853"><span class="annot"><span class="annottext">StackSet i l Window s sd
</span><a href="#local-6989586621679394853"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StackSet i l Window s sd
-&gt; (i -&gt; StackSet i l Window s sd)
-&gt; Maybe i
-&gt; StackSet i l Window s sd
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">StackSet i l Window s sd
</span><a href="#local-6989586621679394853"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679394852"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679394852"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i -&gt; Window -&gt; StackSet i l Window s sd -&gt; StackSet i l Window s sd
forall a s i l sd.
(Ord a, Eq s, Eq i) =&gt;
i -&gt; a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.shiftWin</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679394852"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394854"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">StackSet i l Window s sd
</span><a href="#local-6989586621679394853"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; StackSet i l Window s sd -&gt; Maybe i
forall a i l s sd. Eq a =&gt; a -&gt; StackSet i l a s sd -&gt; Maybe i
</span><span class="hs-identifier hs-var">W.findTag</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394858"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">StackSet i l Window s sd
</span><a href="#local-6989586621679394853"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | Floats the new window in the given rectangle.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier hs-type">doRectFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span>  </span><span class="hs-comment">-- ^ The rectangle to float the window in. 0 to 1; x, y, w, h.</span><span>
</span><span id="line-232"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-233"></span><span id="doRectFloat"><span class="annot"><span class="annottext">doRectFloat :: RationalRect -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier hs-var hs-var">doRectFloat</span></a></span></span><span> </span><span id="local-6989586621679394850"><span class="annot"><span class="annottext">RationalRect
</span><a href="#local-6989586621679394850"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Endo WindowSet)) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394849"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394849"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet)
forall s. (s -&gt; s) -&gt; Query (Endo s)
</span><span class="hs-identifier hs-var">doF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; RationalRect -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
Ord a =&gt;
a -&gt; RationalRect -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.float</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394849"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">RationalRect
</span><a href="#local-6989586621679394850"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-comment">-- | Floats the window and makes it use the whole screen. Equivalent to</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- @'doRectFloat' $ 'W.RationalRect' 0 0 1 1@.</span><span>
</span><span id="line-237"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFullFloat"><span class="hs-identifier hs-type">doFullFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-238"></span><span id="doFullFloat"><span class="annot"><span class="annottext">doFullFloat :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doFullFloat"><span class="hs-identifier hs-var hs-var">doFullFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doRectFloat"><span class="hs-identifier hs-var">doRectFloat</span></a></span><span> </span><span class="annot"><span class="annottext">(RationalRect -&gt; Query (Endo WindowSet))
-&gt; RationalRect -&gt; Query (Endo WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational -&gt; Rational -&gt; RationalRect
</span><span class="hs-identifier hs-var">W.RationalRect</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | Floats a new window using a rectangle computed as a function of</span><span>
</span><span id="line-241"></span><span class="hs-comment">--   the rectangle that it would have used by default.</span><span>
</span><span id="line-242"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFloatDep"><span class="hs-identifier hs-type">doFloatDep</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-243"></span><span id="doFloatDep"><span class="annot"><span class="annottext">doFloatDep :: (RationalRect -&gt; RationalRect) -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doFloatDep"><span class="hs-identifier hs-var hs-var">doFloatDep</span></a></span></span><span> </span><span id="local-6989586621679394846"><span class="annot"><span class="annottext">RationalRect -&gt; RationalRect
</span><a href="#local-6989586621679394846"><span class="hs-identifier hs-var">move</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Endo WindowSet)) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394845"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394845"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet)
forall s. (s -&gt; s) -&gt; Query (Endo s)
</span><span class="hs-identifier hs-var">doF</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet))
-&gt; ((ScreenId, RationalRect) -&gt; WindowSet -&gt; WindowSet)
-&gt; (ScreenId, RationalRect)
-&gt; Query (Endo WindowSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; RationalRect -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
Ord a =&gt;
a -&gt; RationalRect -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.float</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394845"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">(RationalRect -&gt; WindowSet -&gt; WindowSet)
-&gt; ((ScreenId, RationalRect) -&gt; RationalRect)
-&gt; (ScreenId, RationalRect)
-&gt; WindowSet
-&gt; WindowSet
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; RationalRect
</span><a href="#local-6989586621679394846"><span class="hs-identifier hs-var">move</span></a></span><span> </span><span class="annot"><span class="annottext">(RationalRect -&gt; RationalRect)
-&gt; ((ScreenId, RationalRect) -&gt; RationalRect)
-&gt; (ScreenId, RationalRect)
-&gt; RationalRect
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(ScreenId, RationalRect) -&gt; RationalRect
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((ScreenId, RationalRect) -&gt; Query (Endo WindowSet))
-&gt; Query (ScreenId, RationalRect) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">X (ScreenId, RationalRect) -&gt; Query (ScreenId, RationalRect)
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X (ScreenId, RationalRect)
</span><span class="hs-identifier hs-var">floatLocation</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394845"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-comment">-- | Floats a new window with its original size, and its top left</span><span>
</span><span id="line-246"></span><span class="hs-comment">--   corner at a specific point on the screen (both coordinates should</span><span>
</span><span id="line-247"></span><span class="hs-comment">--   be in the range 0 to 1).</span><span>
</span><span id="line-248"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFloatAt"><span class="hs-identifier hs-type">doFloatAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rational</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-249"></span><span id="doFloatAt"><span class="annot"><span class="annottext">doFloatAt :: Rational -&gt; Rational -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doFloatAt"><span class="hs-identifier hs-var hs-var">doFloatAt</span></a></span></span><span> </span><span id="local-6989586621679394843"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394843"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679394842"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394842"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RationalRect -&gt; RationalRect) -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doFloatDep"><span class="hs-identifier hs-var">doFloatDep</span></a></span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; RationalRect
</span><a href="#local-6989586621679394841"><span class="hs-identifier hs-var">move</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-251"></span><span>    </span><span id="local-6989586621679394841"><span class="annot"><span class="annottext">move :: RationalRect -&gt; RationalRect
</span><a href="#local-6989586621679394841"><span class="hs-identifier hs-var hs-var">move</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679394840"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394840"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679394839"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394839"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational -&gt; Rational -&gt; RationalRect
</span><span class="hs-identifier hs-var">W.RationalRect</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394843"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394842"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394840"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394839"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- | Floats a new window with its original size on the specified side of a</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- screen</span><span>
</span><span id="line-255"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doSideFloat"><span class="hs-identifier hs-type">doSideFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#Side"><span class="hs-identifier hs-type">Side</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-256"></span><span id="doSideFloat"><span class="annot"><span class="annottext">doSideFloat :: Side -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doSideFloat"><span class="hs-identifier hs-var hs-var">doSideFloat</span></a></span></span><span> </span><span id="local-6989586621679394838"><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679394838"><span class="hs-identifier hs-var">side</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(RationalRect -&gt; RationalRect) -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doFloatDep"><span class="hs-identifier hs-var">doFloatDep</span></a></span><span> </span><span class="annot"><span class="annottext">RationalRect -&gt; RationalRect
</span><a href="#local-6989586621679394837"><span class="hs-identifier hs-var">move</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621679394837"><span class="annot"><span class="annottext">move :: RationalRect -&gt; RationalRect
</span><a href="#local-6989586621679394837"><span class="hs-identifier hs-var hs-var">move</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">W.RationalRect</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679394836"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394836"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span id="local-6989586621679394835"><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394835"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational -&gt; Rational -&gt; RationalRect
</span><span class="hs-identifier hs-var">W.RationalRect</span></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394834"><span class="hs-identifier hs-var">cx</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394833"><span class="hs-identifier hs-var">cy</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394836"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394835"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679394834"><span class="annot"><span class="annottext">cx :: Rational
</span><a href="#local-6989586621679394834"><span class="hs-identifier hs-var hs-var">cx</span></a></span></span><span>
</span><span id="line-260"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679394838"><span class="hs-identifier hs-var">side</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; [Side] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#SC"><span class="hs-identifier hs-var">SC</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#NC"><span class="hs-identifier hs-var">NC</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394836"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-261"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679394838"><span class="hs-identifier hs-var">side</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; [Side] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#SW"><span class="hs-identifier hs-var">SW</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#CW"><span class="hs-identifier hs-var">CW</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#NW"><span class="hs-identifier hs-var">NW</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-262"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">{- side `elem` [SE,CE,NE] -}</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394836"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-263"></span><span>            </span><span id="local-6989586621679394833"><span class="annot"><span class="annottext">cy :: Rational
</span><a href="#local-6989586621679394833"><span class="hs-identifier hs-var hs-var">cy</span></a></span></span><span>
</span><span id="line-264"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679394838"><span class="hs-identifier hs-var">side</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; [Side] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#CE"><span class="hs-identifier hs-var">CE</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#C"><span class="hs-identifier hs-var">C</span></a></span><span> </span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#CW"><span class="hs-identifier hs-var">CW</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394835"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">)</span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">2</span></span><span>
</span><span id="line-265"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="#local-6989586621679394838"><span class="hs-identifier hs-var">side</span></a></span><span> </span><span class="annot"><span class="annottext">Side -&gt; [Side] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#NE"><span class="hs-identifier hs-var">NE</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#NC"><span class="hs-identifier hs-var">NC</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#NW"><span class="hs-identifier hs-var">NW</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">0</span></span><span>
</span><span id="line-266"></span><span>              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">{- side `elem` [SE,SC,SW] -}</span><span> </span><span class="annot"><span class="annottext">Rational
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Rational -&gt; Rational -&gt; Rational
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">Rational
</span><a href="#local-6989586621679394835"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | Floats a new window with its original size, but centered.</span><span>
</span><span id="line-269"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doCenterFloat"><span class="hs-identifier hs-type">doCenterFloat</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-270"></span><span id="doCenterFloat"><span class="annot"><span class="annottext">doCenterFloat :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doCenterFloat"><span class="hs-identifier hs-var hs-var">doCenterFloat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Side -&gt; Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doSideFloat"><span class="hs-identifier hs-var">doSideFloat</span></a></span><span> </span><span class="annot"><span class="annottext">Side
</span><a href="XMonad.Hooks.ManageHelpers.html#C"><span class="hs-identifier hs-var">C</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Hides window and ignores it.</span><span>
</span><span id="line-273"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doHideIgnore"><span class="hs-identifier hs-type">doHideIgnore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-274"></span><span id="doHideIgnore"><span class="annot"><span class="annottext">doHideIgnore :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doHideIgnore"><span class="hs-identifier hs-var hs-var">doHideIgnore</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Endo WindowSet)) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394831"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394831"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X () -&gt; Query ()
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; X ()
</span><span class="hs-identifier hs-var">hide</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394831"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Query () -&gt; Query (Endo WindowSet) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet)
forall s. (s -&gt; s) -&gt; Query (Endo s)
</span><span class="hs-identifier hs-var">doF</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Window -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
Ord a =&gt;
a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.delete</span></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394831"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Sinks a window</span><span>
</span><span id="line-277"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doSink"><span class="hs-identifier hs-type">doSink</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-278"></span><span id="doSink"><span class="annot"><span class="annottext">doSink :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doSink"><span class="hs-identifier hs-var hs-var">doSink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet)
forall s. (s -&gt; s) -&gt; Query (Endo s)
</span><span class="hs-identifier hs-var">doF</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet))
-&gt; (Window -&gt; WindowSet -&gt; WindowSet)
-&gt; Window
-&gt; Query (Endo WindowSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; WindowSet -&gt; WindowSet
forall a i l s sd.
Ord a =&gt;
a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.sink</span></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Query (Endo WindowSet))
-&gt; Query Window -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- | Lower an unmanaged window. Useful together with 'doIgnore' to lower</span><span>
</span><span id="line-281"></span><span class="hs-comment">-- special windows that for some reason don't do it themselves.</span><span>
</span><span id="line-282"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doLower"><span class="hs-identifier hs-type">doLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-283"></span><span id="doLower"><span class="annot"><span class="annottext">doLower :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doLower"><span class="hs-identifier hs-var hs-var">doLower</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Endo WindowSet)) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394827"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394827"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X (Endo WindowSet) -&gt; Query (Endo WindowSet)
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X (Endo WindowSet) -&gt; Query (Endo WindowSet))
-&gt; X (Endo WindowSet) -&gt; Query (Endo WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Display -&gt; X (Endo WindowSet)) -&gt; X (Endo WindowSet)
forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">((Display -&gt; X (Endo WindowSet)) -&gt; X (Endo WindowSet))
-&gt; (Display -&gt; X (Endo WindowSet)) -&gt; X (Endo WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394825"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679394825"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; X ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">lowerWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679394825"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394827"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X () -&gt; X (Endo WindowSet) -&gt; X (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">X (Endo WindowSet)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | Raise an unmanaged window. Useful together with 'doIgnore' to raise</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- special windows that for some reason don't do it themselves.</span><span>
</span><span id="line-287"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doRaise"><span class="hs-identifier hs-type">doRaise</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-288"></span><span id="doRaise"><span class="annot"><span class="annottext">doRaise :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doRaise"><span class="hs-identifier hs-var hs-var">doRaise</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span> </span><span class="annot"><span class="annottext">Query Window
-&gt; (Window -&gt; Query (Endo WindowSet)) -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394822"><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394822"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">X (Endo WindowSet) -&gt; Query (Endo WindowSet)
forall a. X a -&gt; Query a
</span><span class="hs-identifier hs-var">liftX</span></span><span> </span><span class="annot"><span class="annottext">(X (Endo WindowSet) -&gt; Query (Endo WindowSet))
-&gt; X (Endo WindowSet) -&gt; Query (Endo WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Display -&gt; X (Endo WindowSet)) -&gt; X (Endo WindowSet)
forall a. (Display -&gt; X a) -&gt; X a
</span><span class="hs-identifier hs-var">withDisplay</span></span><span> </span><span class="annot"><span class="annottext">((Display -&gt; X (Endo WindowSet)) -&gt; X (Endo WindowSet))
-&gt; (Display -&gt; X (Endo WindowSet)) -&gt; X (Endo WindowSet)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679394821"><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679394821"><span class="hs-identifier hs-var">dpy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; X ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Display -&gt; Window -&gt; IO ()
</span><span class="hs-identifier hs-var">raiseWindow</span></span><span> </span><span class="annot"><span class="annottext">Display
</span><a href="#local-6989586621679394821"><span class="hs-identifier hs-var">dpy</span></a></span><span> </span><span class="annot"><span class="annottext">Window
</span><a href="#local-6989586621679394822"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X () -&gt; X (Endo WindowSet) -&gt; X (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">X (Endo WindowSet)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-comment">-- | Focus a window (useful in 'XMonad.Hooks.EwmhDesktops.setActivateHook').</span><span>
</span><span id="line-291"></span><span class="annot"><a href="XMonad.Hooks.ManageHelpers.html#doFocus"><span class="hs-identifier hs-type">doFocus</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ManageHook</span></span><span>
</span><span id="line-292"></span><span id="doFocus"><span class="annot"><span class="annottext">doFocus :: Query (Endo WindowSet)
</span><a href="XMonad.Hooks.ManageHelpers.html#doFocus"><span class="hs-identifier hs-var hs-var">doFocus</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet)
forall s. (s -&gt; s) -&gt; Query (Endo s)
</span><span class="hs-identifier hs-var">doF</span></span><span> </span><span class="annot"><span class="annottext">((WindowSet -&gt; WindowSet) -&gt; Query (Endo WindowSet))
-&gt; (Window -&gt; WindowSet -&gt; WindowSet)
-&gt; Window
-&gt; Query (Endo WindowSet)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Window -&gt; WindowSet -&gt; WindowSet
forall s a i l sd.
(Eq s, Eq a, Eq i) =&gt;
a -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">W.focusWindow</span></span><span> </span><span class="annot"><span class="annottext">(Window -&gt; Query (Endo WindowSet))
-&gt; Query Window -&gt; Query (Endo WindowSet)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Query Window
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-293"></span></pre></body></html>