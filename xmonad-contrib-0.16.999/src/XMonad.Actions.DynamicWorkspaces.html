<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Module      :  XMonad.Actions.DynamicWorkspaces</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Description :  Provides bindings to add and delete workspaces.</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- Copyright   :  (c) David Roundy &lt;droundy@darcs.net&gt;</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- Maintainer  :  none</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Stability   :  unstable</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Portability :  unportable</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Provides bindings to add and delete workspaces.</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Actions.DynamicWorkspaces</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>                                         </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-18"></span><span>                                         </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-19"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspace"><span class="hs-identifier">addWorkspace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspacePrompt"><span class="hs-identifier">addWorkspacePrompt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspace"><span class="hs-identifier">appendWorkspace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspacePrompt"><span class="hs-identifier">appendWorkspacePrompt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspaceAt"><span class="hs-identifier">addWorkspaceAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace"><span class="hs-identifier">removeWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspaceByTag"><span class="hs-identifier">removeWorkspaceByTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspace"><span class="hs-identifier">removeEmptyWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceByTag"><span class="hs-identifier">removeEmptyWorkspaceByTag</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfter"><span class="hs-identifier">removeEmptyWorkspaceAfter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfterExcept"><span class="hs-identifier">removeEmptyWorkspaceAfterExcept</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier">addHiddenWorkspace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspaceAt"><span class="hs-identifier">addHiddenWorkspaceAt</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#withWorkspace"><span class="hs-identifier">withWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#selectWorkspace"><span class="hs-identifier">selectWorkspace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspace"><span class="hs-identifier">renameWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspaceByName"><span class="hs-identifier">renameWorkspaceByName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#toNthWorkspace"><span class="hs-identifier">toNthWorkspace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#withNthWorkspace"><span class="hs-identifier">withNthWorkspace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#setWorkspaceIndex"><span class="hs-identifier">setWorkspaceIndex</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#withWorkspaceIndex"><span class="hs-identifier">withWorkspaceIndex</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>                                         </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceIndex"><span class="hs-identifier">WorkspaceIndex</span></a></span><span>
</span><span id="line-35"></span><span>                                       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nub</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">workspaces</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad.StackSet</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">filter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">delete</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prompt.Workspace.html"><span class="hs-identifier">XMonad.Prompt.Workspace</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="XMonad.Prompt.Workspace.html#Wor"><span class="hs-identifier">Wor</span></a></span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.Workspace.html#Wor"><span class="hs-identifier">Wor</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.Workspace.html#workspacePrompt"><span class="hs-identifier">workspacePrompt</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prompt.html"><span class="hs-identifier">XMonad.Prompt</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier">XPConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier">mkXPrompt</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.WorkspaceCompare.html"><span class="hs-identifier">XMonad.Util.WorkspaceCompare</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="XMonad.Util.WorkspaceCompare.html#getSortByIndex"><span class="hs-identifier">getSortByIndex</span></a></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.Strict</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="XMonad.Util.ExtensibleState.html"><span class="hs-identifier">XMonad.Util.ExtensibleState</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">XS</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- $usage</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- You can use this module with the following in your @~\/.xmonad\/xmonad.hs@ file:</span><span>
</span><span id="line-48"></span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- &gt; import XMonad.Actions.DynamicWorkspaces</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- &gt; import XMonad.Actions.CopyWindow(copy)</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- Then add keybindings like the following:</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- &gt;   , ((modm .|. shiftMask, xK_BackSpace), removeWorkspace)</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- &gt;   , ((modm .|. shiftMask, xK_v      ), selectWorkspace def)</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- &gt;   , ((modm, xK_m                    ), withWorkspace def (windows . W.shift))</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- &gt;   , ((modm .|. shiftMask, xK_m      ), withWorkspace def (windows . copy))</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- &gt;   , ((modm .|. shiftMask, xK_r      ), renameWorkspace def)</span><span>
</span><span id="line-59"></span><span class="hs-comment">--</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- &gt; -- mod-[1..9]       %! Switch to workspace N in the list of workspaces</span><span>
</span><span id="line-61"></span><span class="hs-comment">-- &gt; -- mod-shift-[1..9] %! Move client to workspace N in the list of workspaces</span><span>
</span><span id="line-62"></span><span class="hs-comment">-- &gt;    ++</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- &gt;    zip (zip (repeat (modm)) [xK_1..xK_9]) (map (withNthWorkspace W.greedyView) [0..])</span><span>
</span><span id="line-64"></span><span class="hs-comment">-- &gt;    ++</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- &gt;    zip (zip (repeat (modm .|. shiftMask)) [xK_1..xK_9]) (map (withNthWorkspace W.shift) [0..])</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- Alternatively, you can associate indexes (which don't depend of the</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- workspace list order) to workspaces by using following keybindings:</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- &gt; -- mod-[1..9]         %! Switch to workspace of index N</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- &gt; -- mod-control-[1..9] %! Set index N to the current workspace</span><span>
</span><span id="line-72"></span><span class="hs-comment">-- &gt;    ++</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- &gt;    zip (zip (repeat (modm)) [xK_1..xK_9]) (map (withWorkspaceIndex W.greedyView) [1..])</span><span>
</span><span id="line-74"></span><span class="hs-comment">-- &gt;    ++</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- &gt;    zip (zip (repeat (modm .|. controlMask)) [xK_1..xK_9]) (map (setWorkspaceIndex) [1..])</span><span>
</span><span id="line-76"></span><span class="hs-comment">--</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- For detailed instructions on editing your key bindings, see</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- &quot;XMonad.Doc.Extending#Editing_key_bindings&quot;. See also the documentation for</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- &quot;XMonad.Actions.CopyWindow&quot;, 'windows', 'shift', and 'XPConfig'.</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">type</span><span> </span><span id="WorkspaceTag"><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceTag"><span class="hs-identifier hs-var">WorkspaceTag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | The workspace index is mapped to a workspace tag by the user and</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- can be updated.</span><span>
</span><span id="line-84"></span><span class="hs-keyword">type</span><span> </span><span id="WorkspaceIndex"><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceIndex"><span class="hs-identifier hs-var">WorkspaceIndex</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Internal dynamic project state that stores a mapping between</span><span>
</span><span id="line-87"></span><span class="hs-comment">--   workspace indexes and workspace tags.</span><span>
</span><span id="line-88"></span><span class="hs-keyword">newtype</span><span> </span><span id="DynamicWorkspaceState"><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#DynamicWorkspaceState"><span class="hs-identifier hs-var">DynamicWorkspaceState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DynamicWorkspaceState"><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#DynamicWorkspaceState"><span class="hs-identifier hs-var">DynamicWorkspaceState</span></a></span></span><span> </span><span class="hs-special">{</span><span id="workspaceIndexMap"><span class="annot"><span class="annottext">DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag
</span><a href="XMonad.Actions.DynamicWorkspaces.html#workspaceIndexMap"><span class="hs-identifier hs-var hs-var">workspaceIndexMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.Map</span></span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceIndex"><span class="hs-identifier hs-type">WorkspaceIndex</span></a></span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceTag"><span class="hs-identifier hs-type">WorkspaceTag</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403330"><span id="local-6989586621679403332"><span id="local-6989586621679403334"><span id="local-6989586621679403336"><span class="annot"><span class="annottext">ReadPrec [DynamicWorkspaceState]
ReadPrec DynamicWorkspaceState
WorkspaceIndex -&gt; ReadS DynamicWorkspaceState
ReadS [DynamicWorkspaceState]
(WorkspaceIndex -&gt; ReadS DynamicWorkspaceState)
-&gt; ReadS [DynamicWorkspaceState]
-&gt; ReadPrec DynamicWorkspaceState
-&gt; ReadPrec [DynamicWorkspaceState]
-&gt; Read DynamicWorkspaceState
forall a.
(WorkspaceIndex -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
readListPrec :: ReadPrec [DynamicWorkspaceState]
$creadListPrec :: ReadPrec [DynamicWorkspaceState]
readPrec :: ReadPrec DynamicWorkspaceState
$creadPrec :: ReadPrec DynamicWorkspaceState
readList :: ReadS [DynamicWorkspaceState]
$creadList :: ReadS [DynamicWorkspaceState]
readsPrec :: WorkspaceIndex -&gt; ReadS DynamicWorkspaceState
$creadsPrec :: WorkspaceIndex -&gt; ReadS DynamicWorkspaceState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679403323"><span id="local-6989586621679403325"><span id="local-6989586621679403327"><span class="annot"><span class="annottext">WorkspaceIndex -&gt; DynamicWorkspaceState -&gt; ShowS
[DynamicWorkspaceState] -&gt; ShowS
DynamicWorkspaceState -&gt; WorkspaceTag
(WorkspaceIndex -&gt; DynamicWorkspaceState -&gt; ShowS)
-&gt; (DynamicWorkspaceState -&gt; WorkspaceTag)
-&gt; ([DynamicWorkspaceState] -&gt; ShowS)
-&gt; Show DynamicWorkspaceState
forall a.
(WorkspaceIndex -&gt; a -&gt; ShowS)
-&gt; (a -&gt; WorkspaceTag) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DynamicWorkspaceState] -&gt; ShowS
$cshowList :: [DynamicWorkspaceState] -&gt; ShowS
show :: DynamicWorkspaceState -&gt; WorkspaceTag
$cshow :: DynamicWorkspaceState -&gt; WorkspaceTag
showsPrec :: WorkspaceIndex -&gt; DynamicWorkspaceState -&gt; ShowS
$cshowsPrec :: WorkspaceIndex -&gt; DynamicWorkspaceState -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExtensionClass</span></span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#DynamicWorkspaceState"><span class="hs-identifier hs-type">DynamicWorkspaceState</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-92"></span><span>  </span><span id="local-6989586621679403317"><span class="annot"><span class="annottext">initialValue :: DynamicWorkspaceState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">initialValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceIndex WorkspaceTag -&gt; DynamicWorkspaceState
</span><a href="XMonad.Actions.DynamicWorkspaces.html#DynamicWorkspaceState"><span class="hs-identifier hs-var">DynamicWorkspaceState</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceIndex WorkspaceTag
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679403314"><span class="annot"><span class="annottext">extensionType :: DynamicWorkspaceState -&gt; StateExtension
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">extensionType</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DynamicWorkspaceState -&gt; StateExtension
forall a. (Read a, Show a, ExtensionClass a) =&gt; a -&gt; StateExtension
</span><span class="hs-identifier hs-var">PersistentExtension</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | Set the index of the current workspace.</span><span>
</span><span id="line-96"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#setWorkspaceIndex"><span class="hs-identifier hs-type">setWorkspaceIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceIndex"><span class="hs-identifier hs-type">WorkspaceIndex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span id="setWorkspaceIndex"><span class="annot"><span class="annottext">setWorkspaceIndex :: WorkspaceIndex -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#setWorkspaceIndex"><span class="hs-identifier hs-var hs-var">setWorkspaceIndex</span></a></span></span><span> </span><span id="local-6989586621679403311"><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403311"><span class="hs-identifier hs-var">widx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>  </span><span id="local-6989586621679403310"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403310"><span class="hs-identifier hs-var">wtag</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WorkspaceTag) -&gt; X WorkspaceTag
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; WorkspaceTag
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">currentTag</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; WorkspaceTag)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; WorkspaceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>  </span><span id="local-6989586621679403305"><span class="annot"><span class="annottext">Map WorkspaceIndex WorkspaceTag
</span><a href="#local-6989586621679403305"><span class="hs-identifier hs-var">wmap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag)
-&gt; X (Map WorkspaceIndex WorkspaceTag)
forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag
</span><a href="XMonad.Actions.DynamicWorkspaces.html#workspaceIndexMap"><span class="hs-identifier hs-var hs-var">workspaceIndexMap</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="annottext">(DynamicWorkspaceState -&gt; DynamicWorkspaceState) -&gt; X ()
forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">((DynamicWorkspaceState -&gt; DynamicWorkspaceState) -&gt; X ())
-&gt; (DynamicWorkspaceState -&gt; DynamicWorkspaceState) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679403302"><span class="annot"><span class="annottext">DynamicWorkspaceState
</span><a href="#local-6989586621679403302"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynamicWorkspaceState
</span><a href="#local-6989586621679403302"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">workspaceIndexMap :: Map WorkspaceIndex WorkspaceTag
</span><a href="XMonad.Actions.DynamicWorkspaces.html#workspaceIndexMap"><span class="hs-identifier hs-var">workspaceIndexMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
-&gt; WorkspaceTag
-&gt; Map WorkspaceIndex WorkspaceTag
-&gt; Map WorkspaceIndex WorkspaceTag
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403311"><span class="hs-identifier hs-var">widx</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403310"><span class="hs-identifier hs-var">wtag</span></a></span><span> </span><span class="annot"><span class="annottext">Map WorkspaceIndex WorkspaceTag
</span><a href="#local-6989586621679403305"><span class="hs-identifier hs-var">wmap</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#withWorkspaceIndex"><span class="hs-identifier hs-type">withWorkspaceIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceIndex"><span class="hs-identifier hs-type">WorkspaceIndex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span id="withWorkspaceIndex"><span class="annot"><span class="annottext">withWorkspaceIndex :: (WorkspaceTag
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; WorkspaceIndex -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#withWorkspaceIndex"><span class="hs-identifier hs-var hs-var">withWorkspaceIndex</span></a></span></span><span> </span><span id="local-6989586621679403299"><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403299"><span class="hs-identifier hs-var">job</span></a></span></span><span> </span><span id="local-6989586621679403298"><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403298"><span class="hs-identifier hs-var">widx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-104"></span><span>  </span><span id="local-6989586621679403297"><span class="annot"><span class="annottext">Maybe WorkspaceTag
</span><a href="#local-6989586621679403297"><span class="hs-identifier hs-var">wtag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex -&gt; X (Maybe WorkspaceTag)
</span><a href="#local-6989586621679403296"><span class="hs-identifier hs-var">ilookup</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403298"><span class="hs-identifier hs-var">widx</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="annottext">X () -&gt; (WorkspaceTag -&gt; X ()) -&gt; Maybe WorkspaceTag -&gt; X ()
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet
    WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (WorkspaceTag
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; WorkspaceTag
-&gt; X ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403299"><span class="hs-identifier hs-var">job</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe WorkspaceTag
</span><a href="#local-6989586621679403297"><span class="hs-identifier hs-var">wtag</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><a href="#local-6989586621679403296"><span class="hs-identifier hs-type">ilookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceIndex"><span class="hs-identifier hs-type">WorkspaceIndex</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#WorkspaceTag"><span class="hs-identifier hs-type">WorkspaceTag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>      </span><span id="local-6989586621679403296"><span class="annot"><span class="annottext">ilookup :: WorkspaceIndex -&gt; X (Maybe WorkspaceTag)
</span><a href="#local-6989586621679403296"><span class="hs-identifier hs-var hs-var">ilookup</span></a></span></span><span> </span><span id="local-6989586621679403293"><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403293"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
-&gt; Map WorkspaceIndex WorkspaceTag -&gt; Maybe WorkspaceTag
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403293"><span class="hs-identifier hs-var">idx</span></a></span><span> </span><span class="annot"><span class="annottext">(Map WorkspaceIndex WorkspaceTag -&gt; Maybe WorkspaceTag)
-&gt; X (Map WorkspaceIndex WorkspaceTag) -&gt; X (Maybe WorkspaceTag)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag)
-&gt; X (Map WorkspaceIndex WorkspaceTag)
forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag
</span><a href="XMonad.Actions.DynamicWorkspaces.html#workspaceIndexMap"><span class="hs-identifier hs-var hs-var">workspaceIndexMap</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#mkCompl"><span class="hs-identifier hs-type">mkCompl</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span>
</span><span id="line-112"></span><span id="mkCompl"><span class="annot"><span class="annottext">mkCompl :: [WorkspaceTag] -&gt; WorkspaceTag -&gt; IO [WorkspaceTag]
</span><a href="XMonad.Actions.DynamicWorkspaces.html#mkCompl"><span class="hs-identifier hs-var hs-var">mkCompl</span></a></span></span><span> </span><span id="local-6989586621679403289"><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403289"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679403288"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403288"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag] -&gt; IO [WorkspaceTag]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([WorkspaceTag] -&gt; IO [WorkspaceTag])
-&gt; [WorkspaceTag] -&gt; IO [WorkspaceTag]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(WorkspaceTag -&gt; Bool) -&gt; [WorkspaceTag] -&gt; [WorkspaceTag]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679403287"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403287"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex -&gt; ShowS
forall a. WorkspaceIndex -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceIndex
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; WorkspaceIndex
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403288"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403287"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403288"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403289"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#withWorkspace"><span class="hs-identifier hs-type">withWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span id="withWorkspace"><span class="annot"><span class="annottext">withWorkspace :: XPConfig -&gt; (WorkspaceTag -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#withWorkspace"><span class="hs-identifier hs-var hs-var">withWorkspace</span></a></span></span><span> </span><span id="local-6989586621679403284"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403284"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span id="local-6989586621679403283"><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403283"><span class="hs-identifier hs-var">job</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679403282"><span class="annot"><span class="annottext">[Workspace WorkspaceTag (Layout Window) Window]
</span><a href="#local-6989586621679403282"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; X [Workspace WorkspaceTag (Layout Window) Window]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">workspaces</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>                         </span><span id="local-6989586621679403280"><span class="annot"><span class="annottext">WorkspaceSort
</span><a href="#local-6989586621679403280"><span class="hs-identifier hs-var">sort</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceSort
</span><a href="XMonad.Util.WorkspaceCompare.html#getSortByIndex"><span class="hs-identifier hs-var">getSortByIndex</span></a></span><span>
</span><span id="line-117"></span><span>                         </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679403279"><span class="annot"><span class="annottext">ts :: [WorkspaceTag]
</span><a href="#local-6989586621679403279"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag)
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
-&gt; [WorkspaceTag]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">([Workspace WorkspaceTag (Layout Window) Window] -&gt; [WorkspaceTag])
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
-&gt; [WorkspaceTag]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceSort
</span><a href="#local-6989586621679403280"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceTag (Layout Window) Window]
</span><a href="#local-6989586621679403282"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-118"></span><span>                             </span><span id="local-6989586621679403277"><span class="annot"><span class="annottext">job' :: WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403277"><span class="hs-identifier hs-var hs-var">job'</span></a></span></span><span> </span><span id="local-6989586621679403276"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403276"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403276"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; [WorkspaceTag] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`elem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403279"><span class="hs-identifier hs-var">ts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403283"><span class="hs-identifier hs-var">job</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403276"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-119"></span><span>                                    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier hs-var">addHiddenWorkspace</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403276"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">X () -&gt; X () -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403283"><span class="hs-identifier hs-var">job</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403276"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-120"></span><span>                         </span><span class="annot"><span class="annottext">Wor
-&gt; XPConfig
-&gt; (WorkspaceTag -&gt; IO [WorkspaceTag])
-&gt; (WorkspaceTag -&gt; X ())
-&gt; X ()
forall p.
XPrompt p =&gt;
p
-&gt; XPConfig
-&gt; (WorkspaceTag -&gt; IO [WorkspaceTag])
-&gt; (WorkspaceTag -&gt; X ())
-&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag -&gt; Wor
</span><a href="XMonad.Prompt.Workspace.html#Wor"><span class="hs-identifier hs-var">Wor</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403284"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WorkspaceTag] -&gt; WorkspaceTag -&gt; IO [WorkspaceTag]
</span><a href="XMonad.Actions.DynamicWorkspaces.html#mkCompl"><span class="hs-identifier hs-var">mkCompl</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403279"><span class="hs-identifier hs-var">ts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403277"><span class="hs-identifier hs-var">job'</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspace"><span class="hs-identifier hs-type">renameWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span id="renameWorkspace"><span class="annot"><span class="annottext">renameWorkspace :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspace"><span class="hs-identifier hs-var hs-var">renameWorkspace</span></a></span></span><span> </span><span id="local-6989586621679403274"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403274"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; (WorkspaceTag -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.Workspace.html#workspacePrompt"><span class="hs-identifier hs-var">workspacePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403274"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspaceByName"><span class="hs-identifier hs-var">renameWorkspaceByName</span></a></span><span>
</span><span id="line-124"></span><span>
</span><span id="line-125"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspaceByName"><span class="hs-identifier hs-type">renameWorkspaceByName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span id="renameWorkspaceByName"><span class="annot"><span class="annottext">renameWorkspaceByName :: WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#renameWorkspaceByName"><span class="hs-identifier hs-var hs-var">renameWorkspaceByName</span></a></span></span><span> </span><span id="local-6989586621679403273"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403273"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679403272"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403272"><span class="hs-identifier hs-var">old</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WorkspaceTag) -&gt; X WorkspaceTag
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; WorkspaceTag
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">currentTag</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; WorkspaceTag)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; WorkspaceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>                             </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet
    WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679403271"><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403271"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679403270"><span class="annot"><span class="annottext">sett :: Workspace i l a -&gt; Workspace WorkspaceTag l a
</span><a href="#local-6989586621679403270"><span class="hs-identifier hs-var hs-var">sett</span></a></span></span><span> </span><span id="local-6989586621679403269"><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403269"><span class="hs-identifier hs-var">wk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403269"><span class="hs-identifier hs-var">wk</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">tag :: WorkspaceTag
</span><span class="hs-identifier hs-var">tag</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403273"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-128"></span><span>                                                 </span><span id="local-6989586621679403268"><span class="annot"><span class="annottext">setscr :: Screen i l a sid sd -&gt; Screen WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403268"><span class="hs-identifier hs-var hs-var">setscr</span></a></span></span><span> </span><span id="local-6989586621679403267"><span class="annot"><span class="annottext">Screen i l a sid sd
</span><a href="#local-6989586621679403267"><span class="hs-identifier hs-var">scr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen i l a sid sd
</span><a href="#local-6989586621679403267"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">workspace :: Workspace WorkspaceTag l a
</span><span class="hs-identifier hs-var">workspace</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Workspace i l a -&gt; Workspace WorkspaceTag l a
forall i l a. Workspace i l a -&gt; Workspace WorkspaceTag l a
</span><a href="#local-6989586621679403270"><span class="hs-identifier hs-var">sett</span></a></span><span> </span><span class="annot"><span class="annottext">(Workspace i l a -&gt; Workspace WorkspaceTag l a)
-&gt; Workspace i l a -&gt; Workspace WorkspaceTag l a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Screen i l a sid sd -&gt; Workspace i l a
forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var hs-var">workspace</span></span><span> </span><span class="annot"><span class="annottext">Screen i l a sid sd
</span><a href="#local-6989586621679403267"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-129"></span><span>                                                 </span><span id="local-6989586621679403265"><span class="annot"><span class="annottext">sets :: StackSet WorkspaceTag l a sid sd
-&gt; StackSet WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403265"><span class="hs-identifier hs-var hs-var">sets</span></a></span></span><span> </span><span id="local-6989586621679403264"><span class="annot"><span class="annottext">StackSet WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403264"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403264"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">current :: Screen WorkspaceTag l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen WorkspaceTag l a sid sd -&gt; Screen WorkspaceTag l a sid sd
forall i l a sid sd.
Screen i l a sid sd -&gt; Screen WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403268"><span class="hs-identifier hs-var">setscr</span></a></span><span> </span><span class="annot"><span class="annottext">(Screen WorkspaceTag l a sid sd -&gt; Screen WorkspaceTag l a sid sd)
-&gt; Screen WorkspaceTag l a sid sd -&gt; Screen WorkspaceTag l a sid sd
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag l a sid sd -&gt; Screen WorkspaceTag l a sid sd
forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var hs-var">current</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403264"><span class="hs-identifier hs-var">q</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-130"></span><span>                                             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall l a sid sd.
StackSet WorkspaceTag l a sid sd
-&gt; StackSet WorkspaceTag l a sid sd
</span><a href="#local-6989586621679403265"><span class="hs-identifier hs-var">sets</span></a></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall i a l sid sd.
(Eq i, Eq a) =&gt;
i -&gt; StackSet i l a sid sd -&gt; StackSet i l a sid sd
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace%27"><span class="hs-identifier hs-var">removeWorkspace'</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403273"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403271"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-131"></span><span>                             </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceTag -&gt; X ()
forall (m :: * -&gt; *).
XLike m =&gt;
WorkspaceTag -&gt; WorkspaceTag -&gt; m ()
</span><a href="#local-6989586621679403261"><span class="hs-identifier hs-var">updateIndexMap</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403272"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403273"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679403261"><span class="annot"><span class="annottext">updateIndexMap :: WorkspaceTag -&gt; WorkspaceTag -&gt; m ()
</span><a href="#local-6989586621679403261"><span class="hs-identifier hs-var hs-var">updateIndexMap</span></a></span></span><span> </span><span id="local-6989586621679403260"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403260"><span class="hs-identifier hs-var">oldIM</span></a></span></span><span> </span><span id="local-6989586621679403259"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403259"><span class="hs-identifier hs-var">newIM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-133"></span><span>          </span><span id="local-6989586621679403258"><span class="annot"><span class="annottext">Map WorkspaceIndex WorkspaceTag
</span><a href="#local-6989586621679403258"><span class="hs-identifier hs-var">wmap</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag)
-&gt; m (Map WorkspaceIndex WorkspaceTag)
forall a (m :: * -&gt; *) b.
(ExtensionClass a, XLike m) =&gt;
(a -&gt; b) -&gt; m b
</span><a href="XMonad.Util.ExtensibleState.html#gets"><span class="hs-identifier hs-var">XS.gets</span></a></span><span> </span><span class="annot"><span class="annottext">DynamicWorkspaceState -&gt; Map WorkspaceIndex WorkspaceTag
</span><a href="XMonad.Actions.DynamicWorkspaces.html#workspaceIndexMap"><span class="hs-identifier hs-var hs-var">workspaceIndexMap</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="annot"><span class="annottext">(DynamicWorkspaceState -&gt; DynamicWorkspaceState) -&gt; m ()
forall a (m :: * -&gt; *).
(ExtensionClass a, XLike m) =&gt;
(a -&gt; a) -&gt; m ()
</span><a href="XMonad.Util.ExtensibleState.html#modify"><span class="hs-identifier hs-var">XS.modify</span></a></span><span> </span><span class="annot"><span class="annottext">((DynamicWorkspaceState -&gt; DynamicWorkspaceState) -&gt; m ())
-&gt; (DynamicWorkspaceState -&gt; DynamicWorkspaceState) -&gt; m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679403257"><span class="annot"><span class="annottext">DynamicWorkspaceState
</span><a href="#local-6989586621679403257"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DynamicWorkspaceState
</span><a href="#local-6989586621679403257"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">workspaceIndexMap :: Map WorkspaceIndex WorkspaceTag
</span><a href="XMonad.Actions.DynamicWorkspaces.html#workspaceIndexMap"><span class="hs-identifier hs-var">workspaceIndexMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
-&gt; Map WorkspaceIndex WorkspaceTag
-&gt; Map WorkspaceIndex WorkspaceTag
forall a b k. (a -&gt; b) -&gt; Map k a -&gt; Map k b
</span><span class="hs-identifier hs-var">Map.map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679403255"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403255"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403255"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403260"><span class="hs-identifier hs-var">oldIM</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403259"><span class="hs-identifier hs-var">newIM</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403255"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map WorkspaceIndex WorkspaceTag
</span><a href="#local-6989586621679403258"><span class="hs-identifier hs-var">wmap</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#toNthWorkspace"><span class="hs-identifier hs-type">toNthWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span id="toNthWorkspace"><span class="annot"><span class="annottext">toNthWorkspace :: (WorkspaceTag -&gt; X ()) -&gt; WorkspaceIndex -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#toNthWorkspace"><span class="hs-identifier hs-var hs-var">toNthWorkspace</span></a></span></span><span> </span><span id="local-6989586621679403254"><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403254"><span class="hs-identifier hs-var">job</span></a></span></span><span> </span><span id="local-6989586621679403253"><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403253"><span class="hs-identifier hs-var">wnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679403252"><span class="annot"><span class="annottext">WorkspaceSort
</span><a href="#local-6989586621679403252"><span class="hs-identifier hs-var">sort</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceSort
</span><a href="XMonad.Util.WorkspaceCompare.html#getSortByIndex"><span class="hs-identifier hs-var">getSortByIndex</span></a></span><span>
</span><span id="line-138"></span><span>                             </span><span id="local-6989586621679403251"><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403251"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; [WorkspaceTag]) -&gt; X [WorkspaceTag]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag)
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
-&gt; [WorkspaceTag]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">([Workspace WorkspaceTag (Layout Window) Window] -&gt; [WorkspaceTag])
-&gt; (XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; XState
-&gt; [WorkspaceTag]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceSort
</span><a href="#local-6989586621679403252"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceSort
-&gt; (XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; XState
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">workspaces</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>                             </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex -&gt; [WorkspaceTag] -&gt; [WorkspaceTag]
forall a. WorkspaceIndex -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403253"><span class="hs-identifier hs-var">wnum</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403251"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-140"></span><span>                               </span><span class="hs-special">(</span><span id="local-6989586621679403249"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403249"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="#local-6989586621679403254"><span class="hs-identifier hs-var">job</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403249"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-141"></span><span>                               </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#withNthWorkspace"><span class="hs-identifier hs-type">withNthWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">WindowSet</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span id="withNthWorkspace"><span class="annot"><span class="annottext">withNthWorkspace :: (WorkspaceTag
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; WorkspaceIndex -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#withNthWorkspace"><span class="hs-identifier hs-var hs-var">withNthWorkspace</span></a></span></span><span> </span><span id="local-6989586621679403248"><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403248"><span class="hs-identifier hs-var">job</span></a></span></span><span> </span><span id="local-6989586621679403247"><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403247"><span class="hs-identifier hs-var">wnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679403246"><span class="annot"><span class="annottext">WorkspaceSort
</span><a href="#local-6989586621679403246"><span class="hs-identifier hs-var">sort</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">X WorkspaceSort
</span><a href="XMonad.Util.WorkspaceCompare.html#getSortByIndex"><span class="hs-identifier hs-var">getSortByIndex</span></a></span><span>
</span><span id="line-145"></span><span>                               </span><span id="local-6989586621679403245"><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403245"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; [WorkspaceTag]) -&gt; X [WorkspaceTag]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag)
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
-&gt; [WorkspaceTag]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">([Workspace WorkspaceTag (Layout Window) Window] -&gt; [WorkspaceTag])
-&gt; (XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; XState
-&gt; [WorkspaceTag]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceSort
</span><a href="#local-6989586621679403246"><span class="hs-identifier hs-var">sort</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceSort
-&gt; (XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; XState
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">workspaces</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                               </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex -&gt; [WorkspaceTag] -&gt; [WorkspaceTag]
forall a. WorkspaceIndex -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceIndex
</span><a href="#local-6989586621679403247"><span class="hs-identifier hs-var">wnum</span></a></span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403245"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-147"></span><span>                                 </span><span class="hs-special">(</span><span id="local-6989586621679403244"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403244"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet
    WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403248"><span class="hs-identifier hs-var">job</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403244"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-148"></span><span>                                 </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#selectWorkspace"><span class="hs-identifier hs-type">selectWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span id="selectWorkspace"><span class="annot"><span class="annottext">selectWorkspace :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#selectWorkspace"><span class="hs-identifier hs-var hs-var">selectWorkspace</span></a></span></span><span> </span><span id="local-6989586621679403243"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403243"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; (WorkspaceTag -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.Workspace.html#workspacePrompt"><span class="hs-identifier hs-var">workspacePrompt</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403243"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="annot"><span class="annottext">((WorkspaceTag -&gt; X ()) -&gt; X ()) -&gt; (WorkspaceTag -&gt; X ()) -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679403242"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403242"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-152"></span><span>                       </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679403241"><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403241"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X (StackSet
        WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-153"></span><span>                          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; Bool
forall i l a s sd. Eq i =&gt; i -&gt; StackSet i l a s sd -&gt; Bool
</span><span class="hs-identifier hs-var">tagMember</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403242"><span class="hs-identifier hs-var">w</span></a></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403241"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-154"></span><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet
    WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">greedyView</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403242"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-155"></span><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspace"><span class="hs-identifier hs-var">addWorkspace</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403242"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Add a new workspace with the given name, or do nothing if a</span><span>
</span><span id="line-158"></span><span class="hs-comment">--   workspace with the given name already exists; then switch to the</span><span>
</span><span id="line-159"></span><span class="hs-comment">--   newly created workspace.</span><span>
</span><span id="line-160"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspace"><span class="hs-identifier hs-type">addWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span id="addWorkspace"><span class="annot"><span class="annottext">addWorkspace :: WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspace"><span class="hs-identifier hs-var hs-var">addWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspaceAt"><span class="hs-identifier hs-var">addWorkspaceAt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Same as addWorkspace, but adds the workspace to the end of the list of workspaces</span><span>
</span><span id="line-164"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspace"><span class="hs-identifier hs-type">appendWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span id="appendWorkspace"><span class="annot"><span class="annottext">appendWorkspace :: WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspace"><span class="hs-identifier hs-var hs-var">appendWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspaceAt"><span class="hs-identifier hs-var">addWorkspaceAt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">([Workspace WorkspaceTag (Layout Window) Window] -&gt; WorkspaceSort)
-&gt; [Workspace WorkspaceTag (Layout Window) Window] -&gt; WorkspaceSort
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceTag (Layout Window) Window] -&gt; WorkspaceSort
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">(++)</span></span><span> </span><span class="annot"><span class="annottext">([Workspace WorkspaceTag (Layout Window) Window] -&gt; WorkspaceSort)
-&gt; (Workspace WorkspaceTag (Layout Window) Window
    -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; Workspace WorkspaceTag (Layout Window) Window
-&gt; WorkspaceSort
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-comment">-- | Adds a new workspace with the given name to the current list of workspaces.</span><span>
</span><span id="line-168"></span><span class="hs-comment">--   This function allows the user to pass a function that inserts an element</span><span>
</span><span id="line-169"></span><span class="hs-comment">--   into a list at an arbitrary spot.</span><span>
</span><span id="line-170"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspaceAt"><span class="hs-identifier hs-type">addWorkspaceAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span id="addWorkspaceAt"><span class="annot"><span class="annottext">addWorkspaceAt :: (Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspaceAt"><span class="hs-identifier hs-var hs-var">addWorkspaceAt</span></a></span></span><span> </span><span id="local-6989586621679403236"><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort
</span><a href="#local-6989586621679403236"><span class="hs-identifier hs-var">add</span></a></span></span><span> </span><span id="local-6989586621679403235"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403235"><span class="hs-identifier hs-var">newtag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspaceAt"><span class="hs-identifier hs-var">addHiddenWorkspaceAt</span></a></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort
</span><a href="#local-6989586621679403236"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403235"><span class="hs-identifier hs-var">newtag</span></a></span><span> </span><span class="annot"><span class="annottext">X () -&gt; X () -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">greedyView</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403235"><span class="hs-identifier hs-var">newtag</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Prompt for the name of a new workspace, add it if it does not</span><span>
</span><span id="line-174"></span><span class="hs-comment">--   already exist, and switch to it.</span><span>
</span><span id="line-175"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspacePrompt"><span class="hs-identifier hs-type">addWorkspacePrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span id="addWorkspacePrompt"><span class="annot"><span class="annottext">addWorkspacePrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspacePrompt"><span class="hs-identifier hs-var hs-var">addWorkspacePrompt</span></a></span></span><span> </span><span id="local-6989586621679403234"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403234"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wor
-&gt; XPConfig
-&gt; (WorkspaceTag -&gt; IO [WorkspaceTag])
-&gt; (WorkspaceTag -&gt; X ())
-&gt; X ()
forall p.
XPrompt p =&gt;
p
-&gt; XPConfig
-&gt; (WorkspaceTag -&gt; IO [WorkspaceTag])
-&gt; (WorkspaceTag -&gt; X ())
-&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag -&gt; Wor
</span><a href="XMonad.Prompt.Workspace.html#Wor"><span class="hs-identifier hs-var">Wor</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><span class="hs-string">&quot;New workspace name: &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403234"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO [WorkspaceTag] -&gt; WorkspaceTag -&gt; IO [WorkspaceTag]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WorkspaceTag] -&gt; IO [WorkspaceTag]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addWorkspace"><span class="hs-identifier hs-var">addWorkspace</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- | Prompt for the name of a new workspace, appending it to the end of the list of workspaces</span><span>
</span><span id="line-179"></span><span class="hs-comment">--   if it does not already exist, and switch to it.</span><span>
</span><span id="line-180"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspacePrompt"><span class="hs-identifier hs-type">appendWorkspacePrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span id="appendWorkspacePrompt"><span class="annot"><span class="annottext">appendWorkspacePrompt :: XPConfig -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspacePrompt"><span class="hs-identifier hs-var hs-var">appendWorkspacePrompt</span></a></span></span><span> </span><span id="local-6989586621679403232"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403232"><span class="hs-identifier hs-var">conf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Wor
-&gt; XPConfig
-&gt; (WorkspaceTag -&gt; IO [WorkspaceTag])
-&gt; (WorkspaceTag -&gt; X ())
-&gt; X ()
forall p.
XPrompt p =&gt;
p
-&gt; XPConfig
-&gt; (WorkspaceTag -&gt; IO [WorkspaceTag])
-&gt; (WorkspaceTag -&gt; X ())
-&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag -&gt; Wor
</span><a href="XMonad.Prompt.Workspace.html#Wor"><span class="hs-identifier hs-var">Wor</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><span class="hs-string">&quot;New workspace name: &quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679403232"><span class="hs-identifier hs-var">conf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO [WorkspaceTag] -&gt; WorkspaceTag -&gt; IO [WorkspaceTag]
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[WorkspaceTag] -&gt; IO [WorkspaceTag]
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#appendWorkspace"><span class="hs-identifier hs-var">appendWorkspace</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Add a new hidden workspace with the given name, or do nothing if</span><span>
</span><span id="line-184"></span><span class="hs-comment">--   a workspace with the given name already exists. Takes a function to insert</span><span>
</span><span id="line-185"></span><span class="hs-comment">--   the workspace at an arbitrary spot in the list.</span><span>
</span><span id="line-186"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspaceAt"><span class="hs-identifier hs-type">addHiddenWorkspaceAt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">WindowSpace</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span id="addHiddenWorkspaceAt"><span class="annot"><span class="annottext">addHiddenWorkspaceAt :: (Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspaceAt"><span class="hs-identifier hs-var hs-var">addHiddenWorkspaceAt</span></a></span></span><span> </span><span id="local-6989586621679403231"><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort
</span><a href="#local-6989586621679403231"><span class="hs-identifier hs-var">add</span></a></span></span><span> </span><span id="local-6989586621679403230"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403230"><span class="hs-identifier hs-var">newtag</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(XState -&gt; Bool) -&gt; X Bool
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (XState -&gt; Bool) -&gt; XState -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; Bool
forall i l a s sd. Eq i =&gt; i -&gt; StackSet i l a s sd -&gt; Bool
</span><span class="hs-identifier hs-var">tagMember</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403230"><span class="hs-identifier hs-var">newtag</span></a></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; Bool)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621679403227"><span class="annot"><span class="annottext">Layout Window
</span><a href="#local-6989586621679403227"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XConf -&gt; Layout Window) -&gt; X (Layout Window)
forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">asks</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">XConfig Layout -&gt; Layout Window
forall (l :: * -&gt; *). XConfig l -&gt; l Window
</span><span class="hs-identifier hs-var hs-var">layoutHook</span></span><span> </span><span class="annot"><span class="annottext">(XConfig Layout -&gt; Layout Window)
-&gt; (XConf -&gt; XConfig Layout) -&gt; XConf -&gt; Layout Window
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XConf -&gt; XConfig Layout
</span><span class="hs-identifier hs-var hs-var">config</span></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag
-&gt; Layout Window
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall i l a sid sd.
(Workspace i l a -&gt; [Workspace i l a] -&gt; [Workspace i l a])
-&gt; i -&gt; l -&gt; StackSet i l a sid sd -&gt; StackSet i l a sid sd
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace%27"><span class="hs-identifier hs-var">addHiddenWorkspace'</span></a></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort
</span><a href="#local-6989586621679403231"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403230"><span class="hs-identifier hs-var">newtag</span></a></span><span> </span><span class="annot"><span class="annottext">Layout Window
</span><a href="#local-6989586621679403227"><span class="hs-identifier hs-var">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Add a new hidden workspace with the given name, or do nothing if</span><span>
</span><span id="line-193"></span><span class="hs-comment">--   a workspace with the given name already exists.</span><span>
</span><span id="line-194"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier hs-type">addHiddenWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span id="addHiddenWorkspace"><span class="annot"><span class="annottext">addHiddenWorkspace :: WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace"><span class="hs-identifier hs-var hs-var">addHiddenWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceSort)
-&gt; WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspaceAt"><span class="hs-identifier hs-var">addHiddenWorkspaceAt</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">-- | Remove the current workspace if it contains no windows.</span><span>
</span><span id="line-198"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspace"><span class="hs-identifier hs-type">removeEmptyWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span id="removeEmptyWorkspace"><span class="annot"><span class="annottext">removeEmptyWorkspace :: X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspace"><span class="hs-identifier hs-var hs-var">removeEmptyWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WorkspaceTag) -&gt; X WorkspaceTag
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; WorkspaceTag
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">currentTag</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; WorkspaceTag)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; WorkspaceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X WorkspaceTag -&gt; (WorkspaceTag -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceByTag"><span class="hs-identifier hs-var">removeEmptyWorkspaceByTag</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-comment">-- | Remove the current workspace.</span><span>
</span><span id="line-202"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace"><span class="hs-identifier hs-type">removeWorkspace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span id="removeWorkspace"><span class="annot"><span class="annottext">removeWorkspace :: X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace"><span class="hs-identifier hs-var hs-var">removeWorkspace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WorkspaceTag) -&gt; X WorkspaceTag
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; WorkspaceTag
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">currentTag</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; WorkspaceTag)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; WorkspaceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">X WorkspaceTag -&gt; (WorkspaceTag -&gt; X ()) -&gt; X ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspaceByTag"><span class="hs-identifier hs-var">removeWorkspaceByTag</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Remove workspace with specific tag if it contains no windows.</span><span>
</span><span id="line-206"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceByTag"><span class="hs-identifier hs-type">removeEmptyWorkspaceByTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span id="removeEmptyWorkspaceByTag"><span class="annot"><span class="annottext">removeEmptyWorkspaceByTag :: WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceByTag"><span class="hs-identifier hs-var hs-var">removeEmptyWorkspaceByTag</span></a></span></span><span> </span><span id="local-6989586621679403222"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403222"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">X Bool -&gt; X () -&gt; X ()
</span><span class="hs-identifier hs-var">whenX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X Bool
</span><a href="XMonad.Actions.DynamicWorkspaces.html#isEmpty"><span class="hs-identifier hs-var">isEmpty</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403222"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspaceByTag"><span class="hs-identifier hs-var">removeWorkspaceByTag</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403222"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="hs-comment">-- | Remove workspace with specific tag.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspaceByTag"><span class="hs-identifier hs-type">removeWorkspaceByTag</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span id="removeWorkspaceByTag"><span class="annot"><span class="annottext">removeWorkspaceByTag :: WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspaceByTag"><span class="hs-identifier hs-var hs-var">removeWorkspaceByTag</span></a></span></span><span> </span><span id="local-6989586621679403220"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403220"><span class="hs-identifier hs-var">torem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621679403219"><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403219"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X (StackSet
        WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><a href="#local-6989586621679403219"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">current :: forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Screen</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">workspace :: forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">workspace</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679403216"><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
</span><a href="#local-6989586621679403216"><span class="hs-identifier hs-var">cur</span></a></span></span><span> </span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hidden :: forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403214"><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
</span><a href="#local-6989586621679403214"><span class="hs-identifier hs-var">w</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[Workspace WorkspaceTag (Layout Window) Window]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-215"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403220"><span class="hs-identifier hs-var">torem</span></a></span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
</span><a href="#local-6989586621679403216"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet
    WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall s i l a sd.
(Eq s, Eq i) =&gt;
i -&gt; StackSet i l a s sd -&gt; StackSet i l a s sd
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">(WorkspaceTag
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
</span><a href="#local-6989586621679403214"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-216"></span><span>                </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
</span><span class="hs-identifier hs-var">windows</span></span><span> </span><span class="annot"><span class="annottext">((StackSet
    WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
  -&gt; StackSet
       WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
 -&gt; X ())
-&gt; (StackSet
      WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
forall i a l sid sd.
(Eq i, Eq a) =&gt;
i -&gt; StackSet i l a sid sd -&gt; StackSet i l a sid sd
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace%27"><span class="hs-identifier hs-var">removeWorkspace'</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403220"><span class="hs-identifier hs-var">torem</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; X ()
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Remove the current workspace after an operation if it is empty and hidden.</span><span>
</span><span id="line-220"></span><span class="hs-comment">--   Can be used to remove a workspace if it is empty when leaving it. The</span><span>
</span><span id="line-221"></span><span class="hs-comment">--   operation may only change workspace once, otherwise the workspace will not</span><span>
</span><span id="line-222"></span><span class="hs-comment">--   be removed.</span><span>
</span><span id="line-223"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfter"><span class="hs-identifier hs-type">removeEmptyWorkspaceAfter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span id="removeEmptyWorkspaceAfter"><span class="annot"><span class="annottext">removeEmptyWorkspaceAfter :: X () -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfter"><span class="hs-identifier hs-var hs-var">removeEmptyWorkspaceAfter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag] -&gt; X () -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfterExcept"><span class="hs-identifier hs-var">removeEmptyWorkspaceAfterExcept</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="hs-comment">-- | Like 'removeEmptyWorkspaceAfter' but use a list of sticky workspaces,</span><span>
</span><span id="line-227"></span><span class="hs-comment">--   whose entries will never be removed.</span><span>
</span><span id="line-228"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfterExcept"><span class="hs-identifier hs-type">removeEmptyWorkspaceAfterExcept</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span id="removeEmptyWorkspaceAfterExcept"><span class="annot"><span class="annottext">removeEmptyWorkspaceAfterExcept :: [WorkspaceTag] -&gt; X () -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceAfterExcept"><span class="hs-identifier hs-var hs-var">removeEmptyWorkspaceAfterExcept</span></a></span></span><span> </span><span id="local-6989586621679403212"><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403212"><span class="hs-identifier hs-var">sticky</span></a></span></span><span> </span><span id="local-6989586621679403211"><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679403211"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>    </span><span id="local-6989586621679403210"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403210"><span class="hs-identifier hs-var">before</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WorkspaceTag) -&gt; X WorkspaceTag
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; WorkspaceTag
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">currentTag</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; WorkspaceTag)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; WorkspaceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">X ()
</span><a href="#local-6989586621679403211"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621679403209"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403209"><span class="hs-identifier hs-var">after</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; WorkspaceTag) -&gt; X WorkspaceTag
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; WorkspaceTag
forall i l a s sd. StackSet i l a s sd -&gt; i
</span><span class="hs-identifier hs-var">currentTag</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; WorkspaceTag)
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; WorkspaceTag
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; X () -&gt; X ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403210"><span class="hs-identifier hs-var">before</span></a></span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403209"><span class="hs-identifier hs-var">after</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403210"><span class="hs-identifier hs-var">before</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; [WorkspaceTag] -&gt; Bool
forall (t :: * -&gt; *) a. (Foldable t, Eq a) =&gt; a -&gt; t a -&gt; Bool
</span><span class="hs-operator hs-var">`notElem`</span></span><span> </span><span class="annot"><span class="annottext">[WorkspaceTag]
</span><a href="#local-6989586621679403212"><span class="hs-identifier hs-var">sticky</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(X () -&gt; X ()) -&gt; X () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; X ()
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeEmptyWorkspaceByTag"><span class="hs-identifier hs-var">removeEmptyWorkspaceByTag</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403210"><span class="hs-identifier hs-var">before</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#isEmpty"><span class="hs-identifier hs-type">isEmpty</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-236"></span><span id="isEmpty"><span class="annot"><span class="annottext">isEmpty :: WorkspaceTag -&gt; X Bool
</span><a href="XMonad.Actions.DynamicWorkspaces.html#isEmpty"><span class="hs-identifier hs-var hs-var">isEmpty</span></a></span></span><span> </span><span id="local-6989586621679403205"><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403205"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span id="local-6989586621679403204"><span class="annot"><span class="annottext">[Workspace WorkspaceTag (Layout Window) Window]
</span><a href="#local-6989586621679403204"><span class="hs-identifier hs-var">wsl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; X [Workspace WorkspaceTag (Layout Window) Window]
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">((XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
 -&gt; X [Workspace WorkspaceTag (Layout Window) Window])
-&gt; (XState -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; X [Workspace WorkspaceTag (Layout Window) Window]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">workspaces</span></span><span> </span><span class="annot"><span class="annottext">(StackSet WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
 -&gt; [Workspace WorkspaceTag (Layout Window) Window])
-&gt; (XState
    -&gt; StackSet
         WorkspaceTag (Layout Window) Window ScreenId ScreenDetail)
-&gt; XState
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">XState
-&gt; StackSet
     WorkspaceTag (Layout Window) Window ScreenId ScreenDetail
</span><span class="hs-identifier hs-var hs-var">windowset</span></span><span>
</span><span id="line-237"></span><span>               </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679403203"><span class="annot"><span class="annottext">mws :: Maybe (Workspace WorkspaceTag (Layout Window) Window)
</span><a href="#local-6989586621679403203"><span class="hs-identifier hs-var hs-var">mws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace WorkspaceTag (Layout Window) Window -&gt; Bool)
-&gt; [Workspace WorkspaceTag (Layout Window) Window]
-&gt; Maybe (Workspace WorkspaceTag (Layout Window) Window)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679403202"><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
</span><a href="#local-6989586621679403202"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window -&gt; WorkspaceTag
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
</span><a href="#local-6989586621679403202"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag -&gt; WorkspaceTag -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">WorkspaceTag
</span><a href="#local-6989586621679403205"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Workspace WorkspaceTag (Layout Window) Window]
</span><a href="#local-6989586621679403204"><span class="hs-identifier hs-var">wsl</span></a></span><span>
</span><span id="line-238"></span><span>               </span><span class="annot"><span class="annottext">Bool -&gt; X Bool
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; X Bool) -&gt; Bool -&gt; X Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Bool
-&gt; (Workspace WorkspaceTag (Layout Window) Window -&gt; Bool)
-&gt; Maybe (Workspace WorkspaceTag (Layout Window) Window)
-&gt; Bool
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Stack Window) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Stack Window) -&gt; Bool)
-&gt; (Workspace WorkspaceTag (Layout Window) Window
    -&gt; Maybe (Stack Window))
-&gt; Workspace WorkspaceTag (Layout Window) Window
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Workspace WorkspaceTag (Layout Window) Window
-&gt; Maybe (Stack Window)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">stack</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Workspace WorkspaceTag (Layout Window) Window)
</span><a href="#local-6989586621679403203"><span class="hs-identifier hs-var">mws</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span id="local-6989586621679403404"><span id="local-6989586621679403405"><span id="local-6989586621679403406"><span id="local-6989586621679403407"><span id="local-6989586621679403408"><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace%27"><span class="hs-identifier hs-type">addHiddenWorkspace'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Workspace</span></span><span> </span><span class="annot"><a href="#local-6989586621679403408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403407"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403406"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Workspace</span></span><span> </span><span class="annot"><a href="#local-6989586621679403408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403407"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403406"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Workspace</span></span><span> </span><span class="annot"><a href="#local-6989586621679403408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403407"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403406"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403407"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679403408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403407"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403406"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403405"><span class="hs-identifier hs-type">sid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403404"><span class="hs-identifier hs-type">sd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679403408"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403407"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403406"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403405"><span class="hs-identifier hs-type">sid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403404"><span class="hs-identifier hs-type">sd</span></a></span></span></span></span></span></span><span>
</span><span id="line-241"></span><span id="addHiddenWorkspace%27"><span class="annot"><span class="annottext">addHiddenWorkspace' :: (Workspace i l a -&gt; [Workspace i l a] -&gt; [Workspace i l a])
-&gt; i -&gt; l -&gt; StackSet i l a sid sd -&gt; StackSet i l a sid sd
</span><a href="XMonad.Actions.DynamicWorkspaces.html#addHiddenWorkspace%27"><span class="hs-identifier hs-var hs-var">addHiddenWorkspace'</span></a></span></span><span> </span><span id="local-6989586621679403200"><span class="annot"><span class="annottext">Workspace i l a -&gt; [Workspace i l a] -&gt; [Workspace i l a]
</span><a href="#local-6989586621679403200"><span class="hs-identifier hs-var">add</span></a></span></span><span> </span><span id="local-6989586621679403199"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679403199"><span class="hs-identifier hs-var">newtag</span></a></span></span><span> </span><span id="local-6989586621679403198"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679403198"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679403197"><span class="annot"><span class="annottext">s :: StackSet i l a sid sd
</span><a href="#local-6989586621679403197"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hidden :: forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679403196"><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403196"><span class="hs-identifier hs-var">ws</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StackSet i l a sid sd
</span><a href="#local-6989586621679403197"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">hidden :: [Workspace i l a]
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Workspace i l a -&gt; [Workspace i l a] -&gt; [Workspace i l a]
</span><a href="#local-6989586621679403200"><span class="hs-identifier hs-var">add</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
forall i l a. i -&gt; l -&gt; Maybe (Stack a) -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">Workspace</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679403199"><span class="hs-identifier hs-var">newtag</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679403198"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403196"><span class="hs-identifier hs-var">ws</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="hs-comment">-- | Remove the hidden workspace with the given tag from the StackSet, if</span><span>
</span><span id="line-244"></span><span class="hs-comment">--   it exists. All the windows in that workspace are moved to the current</span><span>
</span><span id="line-245"></span><span class="hs-comment">--   workspace.</span><span>
</span><span id="line-246"></span><span id="local-6989586621679403437"><span id="local-6989586621679403438"><span id="local-6989586621679403439"><span id="local-6989586621679403440"><span id="local-6989586621679403441"><span class="annot"><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace%27"><span class="hs-identifier hs-type">removeWorkspace'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679403441"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679403440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679403441"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679403441"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403439"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">sid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403437"><span class="hs-identifier hs-type">sd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679403441"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403439"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403438"><span class="hs-identifier hs-type">sid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679403437"><span class="hs-identifier hs-type">sd</span></a></span></span></span></span></span></span><span>
</span><span id="line-247"></span><span id="removeWorkspace%27"><span class="annot"><span class="annottext">removeWorkspace' :: i -&gt; StackSet i l a sid sd -&gt; StackSet i l a sid sd
</span><a href="XMonad.Actions.DynamicWorkspaces.html#removeWorkspace%27"><span class="hs-identifier hs-var hs-var">removeWorkspace'</span></a></span></span><span> </span><span id="local-6989586621679403194"><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679403194"><span class="hs-identifier hs-var">torem</span></a></span></span><span> </span><span id="local-6989586621679403193"><span class="annot"><span class="annottext">s :: StackSet i l a sid sd
</span><a href="#local-6989586621679403193"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">StackSet</span></span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">current :: forall i l a sid sd. StackSet i l a sid sd -&gt; Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679403192"><span class="annot"><span class="annottext">scr :: Screen i l a sid sd
</span><a href="#local-6989586621679403192"><span class="hs-identifier hs-var">scr</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Screen</span></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">workspace :: forall i l a sid sd. Screen i l a sid sd -&gt; Workspace i l a
</span><span class="hs-identifier hs-var">workspace</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679403191"><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403191"><span class="hs-identifier hs-var">wc</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-248"></span><span>                                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hidden :: forall i l a s sd. StackSet i l a s sd -&gt; [Workspace i l a]
</span><span class="hs-identifier hs-var">hidden</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679403190"><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403190"><span class="hs-identifier hs-var">hs</span></a></span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403189"><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403189"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679403188"><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403188"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Workspace i l a -&gt; Bool)
-&gt; [Workspace i l a] -&gt; ([Workspace i l a], [Workspace i l a])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><span class="hs-identifier hs-var">break</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">i -&gt; i -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">i
</span><a href="#local-6989586621679403194"><span class="hs-identifier hs-var">torem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(i -&gt; Bool) -&gt; (Workspace i l a -&gt; i) -&gt; Workspace i l a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Workspace i l a -&gt; i
forall i l a. Workspace i l a -&gt; i
</span><span class="hs-identifier hs-var hs-var">tag</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403190"><span class="hs-identifier hs-var">hs</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">[Workspace i l a] -&gt; [Workspace i l a] -&gt; StackSet i l a sid sd
</span><a href="#local-6989586621679403186"><span class="hs-identifier hs-var">removeWorkspace''</span></a></span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403189"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403188"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-251"></span><span>   </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679403185"><span class="annot"><span class="annottext">meld :: Maybe (Stack a) -&gt; Maybe (Stack a) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679403185"><span class="hs-identifier hs-var hs-var">meld</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-252"></span><span>         </span><span class="annot"><a href="#local-6989586621679403185"><span class="hs-identifier hs-var">meld</span></a></span><span> </span><span id="local-6989586621679403184"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679403184"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679403184"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-253"></span><span>         </span><span class="annot"><a href="#local-6989586621679403185"><span class="hs-identifier hs-var">meld</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span id="local-6989586621679403183"><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679403183"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a)
</span><a href="#local-6989586621679403183"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-254"></span><span>         </span><span class="annot"><a href="#local-6989586621679403185"><span class="hs-identifier hs-var">meld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403182"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679403182"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679403181"><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679403181"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe (Stack a)
forall a. [a] -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var">differentiate</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Maybe (Stack a)) -&gt; ([a] -&gt; [a]) -&gt; [a] -&gt; Maybe (Stack a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a]
forall a. Eq a =&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nub</span></span><span> </span><span class="annot"><span class="annottext">([a] -&gt; Maybe (Stack a)) -&gt; [a] -&gt; Maybe (Stack a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679403182"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [a] -&gt; [a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Stack a -&gt; [a]
forall a. Stack a -&gt; [a]
</span><span class="hs-identifier hs-var">integrate</span></span><span> </span><span class="annot"><span class="annottext">Stack a
</span><a href="#local-6989586621679403181"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-255"></span><span>         </span><span id="local-6989586621679403186"><span class="annot"><span class="annottext">removeWorkspace'' :: [Workspace i l a] -&gt; [Workspace i l a] -&gt; StackSet i l a sid sd
</span><a href="#local-6989586621679403186"><span class="hs-identifier hs-var hs-var">removeWorkspace''</span></a></span></span><span> </span><span id="local-6989586621679403178"><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403178"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679403177"><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403177"><span class="hs-identifier hs-var">y</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679403176"><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403176"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StackSet i l a sid sd
</span><a href="#local-6989586621679403193"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">current :: Screen i l a sid sd
</span><span class="hs-identifier hs-var">current</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Screen i l a sid sd
</span><a href="#local-6989586621679403192"><span class="hs-identifier hs-var">scr</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">workspace :: Workspace i l a
</span><span class="hs-identifier hs-var">workspace</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403191"><span class="hs-identifier hs-var">wc</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stack :: Maybe (Stack a)
</span><span class="hs-identifier hs-var">stack</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Stack a) -&gt; Maybe (Stack a) -&gt; Maybe (Stack a)
forall a.
Eq a =&gt;
Maybe (Stack a) -&gt; Maybe (Stack a) -&gt; Maybe (Stack a)
</span><a href="#local-6989586621679403185"><span class="hs-identifier hs-var">meld</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Workspace i l a -&gt; Maybe (Stack a)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403177"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Workspace i l a -&gt; Maybe (Stack a)
forall i l a. Workspace i l a -&gt; Maybe (Stack a)
</span><span class="hs-identifier hs-var hs-var">stack</span></span><span> </span><span class="annot"><span class="annottext">Workspace i l a
</span><a href="#local-6989586621679403191"><span class="hs-identifier hs-var">wc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-256"></span><span>                                         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">hidden :: [Workspace i l a]
</span><span class="hs-identifier hs-var">hidden</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403178"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">[Workspace i l a] -&gt; [Workspace i l a] -&gt; [Workspace i l a]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><a href="#local-6989586621679403176"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-257"></span><span>         </span><span class="annot"><a href="#local-6989586621679403186"><span class="hs-identifier hs-var">removeWorkspace''</span></a></span><span> </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><span class="hs-identifier">_</span></span><span>  </span><span class="annot"><span class="annottext">[Workspace i l a]
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StackSet i l a sid sd
</span><a href="#local-6989586621679403193"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-258"></span></pre></body></html>