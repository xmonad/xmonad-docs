<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_KfH1wYeFlmDBRaGHefP8fs"><span id="%24con2tag_Cyhd1ya0S664dz4Gw31HPr"></span></span><span class="hs-pragma">{-# LANGUAGE CPP                 #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs        #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase          #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE StrictData          #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Module      :  XMonad.Prompt.OrgMode</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- Description :  A prompt for interacting with org-mode.</span><span>
</span><span id="line-11"></span><span class="hs-comment">-- Copyright   :  (c) 2021  slotThe &lt;soliditsallgood@mailbox.org&gt;</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- License     :  BSD3-style (see LICENSE)</span><span>
</span><span id="line-13"></span><span class="hs-comment">--</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- Maintainer  :  slotThe &lt;soliditsallgood@mailbox.org&gt;</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- Portability :  unknown</span><span>
</span><span id="line-17"></span><span class="hs-comment">--</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- A prompt for interacting with &lt;https:\/\/orgmode.org\/ org-mode&gt;.</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- This can be seen as an org-specific version of</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- &quot;XMonad.Prompt.AppendFile&quot;, allowing for more interesting</span><span>
</span><span id="line-21"></span><span class="hs-comment">-- interactions with that particular file type.</span><span>
</span><span id="line-22"></span><span class="hs-comment">--</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- It can be used to quickly save TODOs, NOTEs, and the like with</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- the additional capability to schedule/deadline a task, or use</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- the system's clipboard (really: the primary selection) as the</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- contents of the note.</span><span>
</span><span id="line-27"></span><span class="hs-comment">--</span><span>
</span><span id="line-28"></span><span class="hs-comment">--------------------------------------------------------------------</span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">XMonad.Prompt.OrgMode</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Usage</span></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- $usage</span></span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Prompts</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#orgPrompt"><span class="hs-identifier">orgPrompt</span></a></span><span class="hs-special">,</span><span>              </span><span class="hs-comment">-- :: XPConfig -&gt; String -&gt; FilePath -&gt; X ()</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#orgPromptPrimary"><span class="hs-identifier">orgPromptPrimary</span></a></span><span class="hs-special">,</span><span>       </span><span class="hs-comment">-- :: XPConfig -&gt; String -&gt; FilePath -&gt; X ()</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#ClipboardSupport"><span class="hs-identifier">ClipboardSupport</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier">OrgMode</span></a></span><span class="hs-special">,</span><span>                </span><span class="hs-comment">-- abstract</span><span class="hs-cpp">

#ifdef TESTING
</span><span>    </span><span class="hs-identifier">pInput</span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-identifier">Note</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-identifier">Date</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-identifier">Time</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-identifier">TimeOfDay</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-identifier">DayOfWeek</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span class="hs-cpp">
#endif
</span><span>
</span><span id="line-50"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prelude.html"><span class="hs-identifier">XMonad.Prelude</span></a></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">XMonad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">X</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">io</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Prompt.html"><span class="hs-identifier">XMonad.Prompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier">XPConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier">XPrompt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier">showXPrompt</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier">mkXPrompt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="XMonad.Util.XSelection.html"><span class="hs-identifier">XMonad.Util.XSelection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Util.XSelection.html#getSelection"><span class="hs-identifier">getSelection</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Day</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ModifiedJulianDay</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NominalDiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">utctDay</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">addUTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">defaultTimeLocale</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">formatTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromGregorian</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCurrentTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">iso8601DateFormat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">nominalDay</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toGregorian</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">getHomeDirectory</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IOMode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AppendMode</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hPutStrLn</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ReadP</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">munch</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">munch1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readP_to_S</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">skipSpaces</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">string</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;++)</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-comment">{- $usage

You can use this module by importing it, along with &quot;XMonad.Prompt&quot;, in
your @xmonad.hs@

&gt; import XMonad.Prompt
&gt; import XMonad.Prompt.OrgMode (orgPrompt)

and adding an appropriate keybinding.  For example, using syntax from
&quot;XMonad.Util.EZConfig&quot;:

&gt; , (&quot;M-C-o&quot;, orgPrompt def &quot;TODO&quot; &quot;/home/me/org/todos.org&quot;)

This would create notes of the form @* TODO /my-message/@ in the
specified file.

You can also enter a relative path; in that case the file path will be
prepended with @$HOME@ or an equivalent directory.  I.e. instead of the
above you can write

&gt; , (&quot;M-C-o&quot;, orgPrompt def &quot;TODO&quot; &quot;org/todos.org&quot;)
&gt;                -- also possible: &quot;~/org/todos.org&quot;

There is also some scheduling and deadline functionality present.  This
may be initiated by entering @+s@ or @+d@&#8212;separated by at least one
whitespace character on either side&#8212;into the prompt, respectively.
Then, one may enter a date and (optionally) a time of day.  Any of the
following are valid dates, where brackets indicate optionality:

  - tod[ay]
  - tom[orrow]
  - /any weekday/
  - /any date of the form DD [MM] [YYYY]/

In the last case, the missing month and year will be filled out with the
current month and year.

For weekdays, we also disambiguate as early as possible; a simple @w@
will suffice to mean Wednesday, but @s@ will not be enough to say
Sunday.  You can, however, also write the full word without any
troubles.  Weekdays always schedule into the future; e.g., if today is
Monday and you schedule something for Monday, you will actually schedule
it for the /next/ Monday (the one in seven days).

The time is specified in the @HH:MM@ format.  The minutes may be
omitted, in which case we assume a full hour is specified.

A few examples are probably in order.  Suppose we have bound the key
above, pressed it, and are now confronted with a prompt:

  - @hello +s today@ would create a TODO note with the header @hello@
    and would schedule that for today's date.

  - @hello +s today 12@ schedules the note for today at 12:00.

  - @hello +s today 12:30@ schedules it for today at 12:30.

  - @hello +d today 12:30@ works just like above, but creates a
    deadline.

  - @hello +s thu@ would schedule the note for next thursday.

  - @hello +s 11@ would schedule it for the 11th of this month and this
    year.

  - @hello +s 11 jan 2013@ would schedule the note for the 11th of
    January 2013.

Note that, due to ambiguity concerns, years below @25@ result in
undefined parsing behaviour.  Otherwise, what should @message +s 11 jan
13@ resolve to&#8212;the 11th of january at 13:00 or the 11th of january in
the year 13?

There's also the possibility to take what's currently in the primary
selection and paste that as the content of the created note.  This is
especially useful when you want to quickly save a URL for later and
return to whatever you were doing before.  See the 'orgPromptPrimary'
prompt for that.

-}</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">{- TODO

  - XMonad.Util.XSelection.getSelection is really, really horrible.  The
    plan would be to rewrite this in a way so it uses xmonad's
    connection to the X server.

  - Add option to explicitly use the system clipboard instead of the
    primary selection.

-}</span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Prompt</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-keyword">data</span><span> </span><span id="OrgMode"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-var">OrgMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OrgMode"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-var">OrgMode</span></a></span></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="clpSupport"><span class="annot"><span class="annottext">OrgMode -&gt; ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#clpSupport"><span class="hs-identifier hs-var hs-var">clpSupport</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#ClipboardSupport"><span class="hs-identifier hs-type">ClipboardSupport</span></a></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="todoHeader"><span class="annot"><span class="annottext">OrgMode -&gt; String
</span><a href="XMonad.Prompt.OrgMode.html#todoHeader"><span class="hs-identifier hs-var hs-var">todoHeader</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>    </span><span class="hs-comment">-- ^ Will display like @* todoHeader @</span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="orgFile"><span class="annot"><span class="annottext">OrgMode -&gt; String
</span><a href="XMonad.Prompt.OrgMode.html#orgFile"><span class="hs-identifier hs-var hs-var">orgFile</span></a></span></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="hs-comment">-- | Whether we should use a clipboard and which one to use.</span><span>
</span><span id="line-165"></span><span class="hs-keyword">data</span><span> </span><span id="ClipboardSupport"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#ClipboardSupport"><span class="hs-identifier hs-var">ClipboardSupport</span></a></span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="PrimarySelection"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#PrimarySelection"><span class="hs-identifier hs-var">PrimarySelection</span></a></span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NoClpSupport"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#NoClpSupport"><span class="hs-identifier hs-var">NoClpSupport</span></a></span></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-comment">-- | How one should display the clipboard string.</span><span>
</span><span id="line-170"></span><span class="hs-keyword">data</span><span> </span><span id="Clp"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Clp"><span class="hs-identifier hs-var">Clp</span></a></span></span><span>
</span><span id="line-171"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Header"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Header"><span class="hs-identifier hs-var">Header</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ In the header as a link: @* [[clp][message]]@</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Body"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Body"><span class="hs-identifier hs-var">Body</span></a></span></span><span>   </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ In the body as additional text: @* message \n clp@</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391385"><span id="local-6989586621679391387"><span id="local-6989586621679391389"><span id="local-6989586621679391391"><span id="local-6989586621679391393"><span class="annot"><a href="XMonad.Prompt.html#XPrompt"><span class="hs-identifier hs-type">XPrompt</span></a></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-type">OrgMode</span></a></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-175"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.html#showXPrompt"><span class="hs-identifier hs-type">showXPrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-type">OrgMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679391383"><span class="annot"><span class="annottext">showXPrompt :: OrgMode -&gt; String
</span><a href="#local-6989586621679391383"><span class="hs-identifier hs-var hs-var hs-var hs-var">showXPrompt</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-type">OrgMode</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679391382"><span class="annot"><span class="annottext">String
todoHeader :: String
todoHeader :: OrgMode -&gt; String
</span><a href="#local-6989586621679391382"><span class="hs-identifier hs-var hs-var">todoHeader</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391381"><span class="annot"><span class="annottext">String
orgFile :: String
orgFile :: OrgMode -&gt; String
</span><a href="#local-6989586621679391381"><span class="hs-identifier hs-var hs-var">orgFile</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391380"><span class="annot"><span class="annottext">ClipboardSupport
clpSupport :: ClipboardSupport
clpSupport :: OrgMode -&gt; ClipboardSupport
</span><a href="#local-6989586621679391380"><span class="hs-identifier hs-var hs-var">clpSupport</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Add &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391382"><span class="hs-identifier hs-var">todoHeader</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391379"><span class="hs-identifier hs-var">clp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; to &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391381"><span class="hs-identifier hs-var">orgFile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621679391379"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391379"><span class="hs-identifier hs-var">clp</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="#local-6989586621679391380"><span class="hs-identifier hs-var">clpSupport</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#NoClpSupport"><span class="hs-identifier hs-var">NoClpSupport</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-181"></span><span>      </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#PrimarySelection"><span class="hs-identifier hs-var">PrimarySelection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; + PS&quot;</span></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="hs-comment">-- | Prompt for interacting with @org-mode@.</span><span>
</span><span id="line-184"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#orgPrompt"><span class="hs-identifier hs-type">orgPrompt</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span>  </span><span class="hs-comment">-- ^ Prompt configuration</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>    </span><span class="hs-comment">-- ^ What kind of note to create; will be displayed after</span><span>
</span><span id="line-187"></span><span>               </span><span class="hs-comment">--   a single @*@</span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>  </span><span class="hs-comment">-- ^ Path to @.org@ file, e.g. @home\/me\/todos.org@</span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span id="orgPrompt"><span class="annot"><span class="annottext">orgPrompt :: XPConfig -&gt; String -&gt; String -&gt; X ()
</span><a href="XMonad.Prompt.OrgMode.html#orgPrompt"><span class="hs-identifier hs-var hs-var">orgPrompt</span></a></span></span><span> </span><span id="local-6989586621679391378"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679391378"><span class="hs-identifier hs-var">xpc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; OrgMode -&gt; X ()
</span><a href="XMonad.Prompt.OrgMode.html#mkOrgPrompt"><span class="hs-identifier hs-var">mkOrgPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679391378"><span class="hs-identifier hs-var">xpc</span></a></span><span> </span><span class="annot"><span class="annottext">(OrgMode -&gt; X ())
-&gt; (String -&gt; String -&gt; OrgMode) -&gt; String -&gt; String -&gt; X ()
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d -&gt; a) -&gt; c -&gt; d -&gt; b
</span><a href="XMonad.Prelude.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">ClipboardSupport -&gt; String -&gt; String -&gt; OrgMode
</span><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-var">OrgMode</span></a></span><span> </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#NoClpSupport"><span class="hs-identifier hs-var">NoClpSupport</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | Like 'orgPrompt', but additionally make use of the primary</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- selection.  If it is a URL, then use an org-style link</span><span>
</span><span id="line-194"></span><span class="hs-comment">-- @[[primary-selection][entered message]]@ as the heading.  Otherwise,</span><span>
</span><span id="line-195"></span><span class="hs-comment">-- use the primary selection as the content of the note.</span><span>
</span><span id="line-196"></span><span class="hs-comment">--</span><span>
</span><span id="line-197"></span><span class="hs-comment">-- The prompt will display a little @+ PS@ in the window</span><span>
</span><span id="line-198"></span><span class="hs-comment">-- after the type of note.</span><span>
</span><span id="line-199"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#orgPromptPrimary"><span class="hs-identifier hs-type">orgPromptPrimary</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span id="orgPromptPrimary"><span class="annot"><span class="annottext">orgPromptPrimary :: XPConfig -&gt; String -&gt; String -&gt; X ()
</span><a href="XMonad.Prompt.OrgMode.html#orgPromptPrimary"><span class="hs-identifier hs-var hs-var">orgPromptPrimary</span></a></span></span><span> </span><span id="local-6989586621679391375"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679391375"><span class="hs-identifier hs-var">xpc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">XPConfig -&gt; OrgMode -&gt; X ()
</span><a href="XMonad.Prompt.OrgMode.html#mkOrgPrompt"><span class="hs-identifier hs-var">mkOrgPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679391375"><span class="hs-identifier hs-var">xpc</span></a></span><span> </span><span class="annot"><span class="annottext">(OrgMode -&gt; X ())
-&gt; (String -&gt; String -&gt; OrgMode) -&gt; String -&gt; String -&gt; X ()
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d -&gt; a) -&gt; c -&gt; d -&gt; b
</span><a href="XMonad.Prelude.html#.%3A"><span class="hs-operator hs-var">.:</span></a></span><span> </span><span class="annot"><span class="annottext">ClipboardSupport -&gt; String -&gt; String -&gt; OrgMode
</span><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-var">OrgMode</span></a></span><span> </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#PrimarySelection"><span class="hs-identifier hs-var">PrimarySelection</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | Create the actual prompt.</span><span>
</span><span id="line-203"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#mkOrgPrompt"><span class="hs-identifier hs-type">mkOrgPrompt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.html#XPConfig"><span class="hs-identifier hs-type">XPConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-type">OrgMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span id="mkOrgPrompt"><span class="annot"><span class="annottext">mkOrgPrompt :: XPConfig -&gt; OrgMode -&gt; X ()
</span><a href="XMonad.Prompt.OrgMode.html#mkOrgPrompt"><span class="hs-identifier hs-var hs-var">mkOrgPrompt</span></a></span></span><span> </span><span id="local-6989586621679391374"><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679391374"><span class="hs-identifier hs-var">xpc</span></a></span></span><span> </span><span id="local-6989586621679391373"><span class="annot"><span class="annottext">oc :: OrgMode
</span><a href="#local-6989586621679391373"><span class="hs-identifier hs-var">oc</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#OrgMode"><span class="hs-identifier hs-type">OrgMode</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679391372"><span class="annot"><span class="annottext">String
todoHeader :: String
todoHeader :: OrgMode -&gt; String
</span><a href="#local-6989586621679391372"><span class="hs-identifier hs-var hs-var">todoHeader</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391371"><span class="annot"><span class="annottext">String
orgFile :: String
orgFile :: OrgMode -&gt; String
</span><a href="#local-6989586621679391371"><span class="hs-identifier hs-var hs-var">orgFile</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391370"><span class="annot"><span class="annottext">ClipboardSupport
clpSupport :: ClipboardSupport
clpSupport :: OrgMode -&gt; ClipboardSupport
</span><a href="#local-6989586621679391370"><span class="hs-identifier hs-var hs-var">clpSupport</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">OrgMode -&gt; XPConfig -&gt; ComplFunction -&gt; (String -&gt; X ()) -&gt; X ()
forall p.
XPrompt p =&gt;
p -&gt; XPConfig -&gt; ComplFunction -&gt; (String -&gt; X ()) -&gt; X ()
</span><a href="XMonad.Prompt.html#mkXPrompt"><span class="hs-identifier hs-var">mkXPrompt</span></a></span><span> </span><span class="annot"><span class="annottext">OrgMode
</span><a href="#local-6989586621679391373"><span class="hs-identifier hs-var">oc</span></a></span><span> </span><span class="annot"><span class="annottext">XPConfig
</span><a href="#local-6989586621679391374"><span class="hs-identifier hs-var">xpc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IO [String] -&gt; ComplFunction
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; IO [String]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; X ()
</span><a href="#local-6989586621679391368"><span class="hs-identifier hs-var">appendNote</span></a></span><span>
</span><span id="line-206"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- | Parse the user input, create an @org-mode@ note out of that and</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-comment">-- try to append it to the given file.</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="#local-6989586621679391368"><span class="hs-identifier hs-type">appendNote</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">X</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679391368"><span class="annot"><span class="annottext">appendNote :: String -&gt; X ()
</span><a href="#local-6989586621679391368"><span class="hs-identifier hs-var hs-var">appendNote</span></a></span></span><span> </span><span id="local-6989586621679391367"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391367"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; X ()
forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><span class="hs-identifier hs-var">io</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; X ()) -&gt; IO () -&gt; X ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-211"></span><span>    </span><span id="local-6989586621679391366"><span class="annot"><span class="annottext">Clp
</span><a href="#local-6989586621679391366"><span class="hs-identifier hs-var">clpStr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="#local-6989586621679391370"><span class="hs-identifier hs-var">clpSupport</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-212"></span><span>      </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#NoClpSupport"><span class="hs-identifier hs-var">NoClpSupport</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Clp -&gt; IO Clp
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Clp -&gt; IO Clp) -&gt; Clp -&gt; IO Clp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Clp
</span><a href="XMonad.Prompt.OrgMode.html#Body"><span class="hs-identifier hs-var">Body</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-213"></span><span>      </span><span class="annot"><span class="annottext">ClipboardSupport
</span><a href="XMonad.Prompt.OrgMode.html#PrimarySelection"><span class="hs-identifier hs-var">PrimarySelection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>        </span><span id="local-6989586621679391365"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391365"><span class="hs-identifier hs-var">sel</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO String
forall (m :: * -&gt; *). MonadIO m =&gt; m String
</span><a href="XMonad.Util.XSelection.html#getSelection"><span class="hs-identifier hs-var">getSelection</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">Clp -&gt; IO Clp
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Clp -&gt; IO Clp) -&gt; Clp -&gt; IO Clp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">if</span><span>   </span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; [String] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391365"><span class="hs-identifier hs-var">sel</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;http://&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;https://&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-216"></span><span>               </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Clp
</span><a href="XMonad.Prompt.OrgMode.html#Header"><span class="hs-identifier hs-var">Header</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391365"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-217"></span><span>               </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; Clp
</span><a href="XMonad.Prompt.OrgMode.html#Body"><span class="hs-identifier hs-var">Body</span></a></span><span>   </span><span class="annot"><span class="annottext">(String -&gt; Clp) -&gt; String -&gt; Clp
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391365"><span class="hs-identifier hs-var">sel</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- Expand path if applicable</span><span>
</span><span id="line-220"></span><span>    </span><span id="local-6989586621679391362"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391362"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391371"><span class="hs-identifier hs-var">orgFile</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span>       </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391371"><span class="hs-identifier hs-var">orgFile</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'~'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getHomeDirectory</span></span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; String) -&gt; IO String
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391371"><span class="hs-identifier hs-var">orgFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO String
</span><span class="hs-identifier hs-var">getHomeDirectory</span></span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (String -&gt; String) -&gt; IO String
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'/'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391371"><span class="hs-identifier hs-var">orgFile</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IOMode -&gt; (Handle -&gt; IO ()) -&gt; IO ()
forall r. String -&gt; IOMode -&gt; (Handle -&gt; IO r) -&gt; IO r
</span><span class="hs-identifier hs-var">withFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391362"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><span class="hs-identifier hs-var">AppendMode</span></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO ()) -&gt; IO ())
-&gt; (String -&gt; Handle -&gt; IO ()) -&gt; String -&gt; IO ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Handle -&gt; String -&gt; IO ()) -&gt; String -&gt; Handle -&gt; IO ()
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStrLn</span></span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; (String -&gt; IO String) -&gt; String -&gt; IO ()
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">IO String -&gt; (Note -&gt; IO String) -&gt; Maybe Note -&gt; IO String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Clp -&gt; String -&gt; Note -&gt; IO String
</span><a href="XMonad.Prompt.OrgMode.html#ppNote"><span class="hs-identifier hs-var">ppNote</span></a></span><span> </span><span class="annot"><span class="annottext">Clp
</span><a href="#local-6989586621679391366"><span class="hs-identifier hs-var">clpStr</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391372"><span class="hs-identifier hs-var">todoHeader</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe Note -&gt; IO String)
-&gt; (String -&gt; Maybe Note) -&gt; String -&gt; IO String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe Note
</span><a href="XMonad.Prompt.OrgMode.html#pInput"><span class="hs-identifier hs-var">pInput</span></a></span><span>
</span><span id="line-227"></span><span>        </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391367"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Time</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span class="hs-comment">-- | A 'Time' is a 'Date' with the possibility of having a specified</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- @HH:MM@ time.</span><span>
</span><span id="line-234"></span><span class="hs-keyword">data</span><span> </span><span id="Time"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-var">Time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Time"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-var">Time</span></a></span></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="date"><span class="annot"><span class="annottext">Time -&gt; Date
</span><a href="XMonad.Prompt.OrgMode.html#date"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="tod"><span class="annot"><span class="annottext">Time -&gt; Maybe TimeOfDay
</span><a href="XMonad.Prompt.OrgMode.html#tod"><span class="hs-identifier hs-var hs-var">tod</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-type">TimeOfDay</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391347"><span id="local-6989586621679391349"><span class="annot"><span class="annottext">Time -&gt; Time -&gt; Bool
(Time -&gt; Time -&gt; Bool) -&gt; (Time -&gt; Time -&gt; Bool) -&gt; Eq Time
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Time -&gt; Time -&gt; Bool
$c/= :: Time -&gt; Time -&gt; Bool
== :: Time -&gt; Time -&gt; Bool
$c== :: Time -&gt; Time -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391340"><span id="local-6989586621679391342"><span id="local-6989586621679391344"><span class="annot"><span class="annottext">Int -&gt; Time -&gt; String -&gt; String
[Time] -&gt; String -&gt; String
Time -&gt; String
(Int -&gt; Time -&gt; String -&gt; String)
-&gt; (Time -&gt; String) -&gt; ([Time] -&gt; String -&gt; String) -&gt; Show Time
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Time] -&gt; String -&gt; String
$cshowList :: [Time] -&gt; String -&gt; String
show :: Time -&gt; String
$cshow :: Time -&gt; String
showsPrec :: Int -&gt; Time -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Time -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | The time in HH:MM.</span><span>
</span><span id="line-241"></span><span class="hs-keyword">data</span><span> </span><span id="TimeOfDay"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-var">TimeOfDay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TimeOfDay"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-var">TimeOfDay</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391334"><span id="local-6989586621679391336"><span class="annot"><span class="annottext">TimeOfDay -&gt; TimeOfDay -&gt; Bool
(TimeOfDay -&gt; TimeOfDay -&gt; Bool)
-&gt; (TimeOfDay -&gt; TimeOfDay -&gt; Bool) -&gt; Eq TimeOfDay
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TimeOfDay -&gt; TimeOfDay -&gt; Bool
$c/= :: TimeOfDay -&gt; TimeOfDay -&gt; Bool
== :: TimeOfDay -&gt; TimeOfDay -&gt; Bool
$c== :: TimeOfDay -&gt; TimeOfDay -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391329"><span id="local-6989586621679391332"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-type">TimeOfDay</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-type">TimeOfDay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679391327"><span class="annot"><span class="annottext">show :: TimeOfDay -&gt; String
</span><a href="#local-6989586621679391327"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-type">TimeOfDay</span></a></span><span> </span><span id="local-6989586621679391326"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391326"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679391325"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391325"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391326"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391325"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-247"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="#local-6989586621679391324"><span class="hs-identifier hs-type">pad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-249"></span><span>    </span><span id="local-6989586621679391324"><span class="annot"><span class="annottext">pad :: Int -&gt; String
</span><a href="#local-6989586621679391324"><span class="hs-identifier hs-var hs-var">pad</span></a></span></span><span> </span><span id="local-6989586621679391323"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391323"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391323"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;0&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391323"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-250"></span><span>
</span><span id="line-251"></span><span class="hs-comment">-- | Type for specifying exactly which day one wants.</span><span>
</span><span id="line-252"></span><span class="hs-keyword">data</span><span> </span><span id="Date"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Date"><span class="hs-identifier hs-var">Date</span></a></span></span><span>
</span><span id="line-253"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Today"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Today"><span class="hs-identifier hs-var">Today</span></a></span></span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Tomorrow"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Tomorrow"><span class="hs-identifier hs-var">Tomorrow</span></a></span></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Next"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Next"><span class="hs-identifier hs-var">Next</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-comment">-- ^ This will __always__ show the next 'DayOfWeek' (e.g. calling</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- 'Next Monday' on a Monday will result in getting the menu for the</span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-comment">-- following Monday)</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Date"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Date"><span class="hs-identifier hs-var">Date</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- ^ Manual date entry in the format DD [MM] [YYYY]</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391314"><span id="local-6989586621679391316"><span class="annot"><span class="annottext">Date -&gt; Date -&gt; Bool
(Date -&gt; Date -&gt; Bool) -&gt; (Date -&gt; Date -&gt; Bool) -&gt; Eq Date
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Date -&gt; Date -&gt; Bool
$c/= :: Date -&gt; Date -&gt; Bool
== :: Date -&gt; Date -&gt; Bool
$c== :: Date -&gt; Date -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391299"><span id="local-6989586621679391301"><span id="local-6989586621679391303"><span id="local-6989586621679391305"><span id="local-6989586621679391307"><span id="local-6989586621679391309"><span id="local-6989586621679391311"><span class="annot"><span class="annottext">Eq Date
Eq Date
-&gt; (Date -&gt; Date -&gt; Ordering)
-&gt; (Date -&gt; Date -&gt; Bool)
-&gt; (Date -&gt; Date -&gt; Bool)
-&gt; (Date -&gt; Date -&gt; Bool)
-&gt; (Date -&gt; Date -&gt; Bool)
-&gt; (Date -&gt; Date -&gt; Date)
-&gt; (Date -&gt; Date -&gt; Date)
-&gt; Ord Date
Date -&gt; Date -&gt; Bool
Date -&gt; Date -&gt; Ordering
Date -&gt; Date -&gt; Date
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Date -&gt; Date -&gt; Date
$cmin :: Date -&gt; Date -&gt; Date
max :: Date -&gt; Date -&gt; Date
$cmax :: Date -&gt; Date -&gt; Date
&gt;= :: Date -&gt; Date -&gt; Bool
$c&gt;= :: Date -&gt; Date -&gt; Bool
&gt; :: Date -&gt; Date -&gt; Bool
$c&gt; :: Date -&gt; Date -&gt; Bool
&lt;= :: Date -&gt; Date -&gt; Bool
$c&lt;= :: Date -&gt; Date -&gt; Bool
&lt; :: Date -&gt; Date -&gt; Bool
$c&lt; :: Date -&gt; Date -&gt; Bool
compare :: Date -&gt; Date -&gt; Ordering
$ccompare :: Date -&gt; Date -&gt; Ordering
$cp1Ord :: Eq Date
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391292"><span id="local-6989586621679391294"><span id="local-6989586621679391296"><span class="annot"><span class="annottext">Int -&gt; Date -&gt; String -&gt; String
[Date] -&gt; String -&gt; String
Date -&gt; String
(Int -&gt; Date -&gt; String -&gt; String)
-&gt; (Date -&gt; String) -&gt; ([Date] -&gt; String -&gt; String) -&gt; Show Date
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Date] -&gt; String -&gt; String
$cshowList :: [Date] -&gt; String -&gt; String
show :: Date -&gt; String
$cshow :: Date -&gt; String
showsPrec :: Int -&gt; Date -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Date -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#toOrgFmt"><span class="hs-identifier hs-type">toOrgFmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-type">TimeOfDay</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-264"></span><span id="toOrgFmt"><span class="annot"><span class="annottext">toOrgFmt :: Maybe TimeOfDay -&gt; Day -&gt; String
</span><a href="XMonad.Prompt.OrgMode.html#toOrgFmt"><span class="hs-identifier hs-var hs-var">toOrgFmt</span></a></span></span><span> </span><span id="local-6989586621679391290"><span class="annot"><span class="annottext">Maybe TimeOfDay
</span><a href="#local-6989586621679391290"><span class="hs-identifier hs-var">tod</span></a></span></span><span> </span><span id="local-6989586621679391289"><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679391289"><span class="hs-identifier hs-var">day</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391288"><span class="hs-identifier hs-var">isoDay</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#dayOfWeek"><span class="hs-identifier hs-var">dayOfWeek</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679391289"><span class="hs-identifier hs-var">day</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391285"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span class="hs-special">]</span><span>
</span><span id="line-266"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679391285"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391285"><span class="hs-identifier hs-var">time</span></a></span></span><span>   </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (TimeOfDay -&gt; String) -&gt; Maybe TimeOfDay -&gt; String
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (TimeOfDay -&gt; String) -&gt; TimeOfDay -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TimeOfDay -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe TimeOfDay
</span><a href="#local-6989586621679391290"><span class="hs-identifier hs-var">tod</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span id="local-6989586621679391288"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391288"><span class="hs-identifier hs-var">isoDay</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TimeLocale -&gt; String -&gt; Day -&gt; String
forall t. FormatTime t =&gt; TimeLocale -&gt; String -&gt; t -&gt; String
</span><span class="hs-identifier hs-var">formatTime</span></span><span> </span><span class="annot"><span class="annottext">TimeLocale
</span><span class="hs-identifier hs-var">defaultTimeLocale</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; String
</span><span class="hs-identifier hs-var">iso8601DateFormat</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679391289"><span class="hs-identifier hs-var">day</span></a></span><span>
</span><span id="line-269"></span><span>
</span><span id="line-270"></span><span class="hs-comment">-- | Pretty print a 'Date' and an optional time to reflect the actual</span><span>
</span><span id="line-271"></span><span class="hs-comment">-- date.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#ppDate"><span class="hs-identifier hs-type">ppDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-273"></span><span id="ppDate"><span class="annot"><span class="annottext">ppDate :: Time -&gt; IO String
</span><a href="XMonad.Prompt.OrgMode.html#ppDate"><span class="hs-identifier hs-var hs-var">ppDate</span></a></span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span class="hs-special">{</span><span> </span><span id="local-6989586621679391283"><span class="annot"><span class="annottext">Date
date :: Date
date :: Time -&gt; Date
</span><a href="#local-6989586621679391283"><span class="hs-identifier hs-var hs-var">date</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391282"><span class="annot"><span class="annottext">Maybe TimeOfDay
tod :: Maybe TimeOfDay
tod :: Time -&gt; Maybe TimeOfDay
</span><a href="#local-6989586621679391282"><span class="hs-identifier hs-var hs-var">tod</span></a></span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679391281"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679391281"><span class="hs-identifier hs-var">curTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679391280"><span class="annot"><span class="annottext">curDay :: Day
</span><a href="#local-6989586621679391280"><span class="hs-identifier hs-var hs-var">curDay</span></a></span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><span class="hs-identifier hs-var hs-var">utctDay</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679391281"><span class="hs-identifier hs-var">curTime</span></a></span><span>
</span><span id="line-276"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679391279"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391279"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391278"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391278"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Day -&gt; (Integer, Int, Int)
</span><span class="hs-identifier hs-var">toGregorian</span></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679391280"><span class="hs-identifier hs-var">curDay</span></a></span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621679391277"><span class="annot"><span class="annottext">diffToDay :: DayOfWeek -&gt; NominalDiffTime
</span><a href="#local-6989586621679391277"><span class="hs-identifier hs-var hs-var">diffToDay</span></a></span></span><span> </span><span id="local-6989586621679391276"><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391276"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DayOfWeek -&gt; DayOfWeek -&gt; NominalDiffTime
</span><a href="#local-6989586621679391275"><span class="hs-identifier hs-var">diffBetween</span></a></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391276"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Day -&gt; DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#dayOfWeek"><span class="hs-identifier hs-var">dayOfWeek</span></a></span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679391280"><span class="hs-identifier hs-var">curDay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; (Day -&gt; String) -&gt; Day -&gt; IO String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Maybe TimeOfDay -&gt; Day -&gt; String
</span><a href="XMonad.Prompt.OrgMode.html#toOrgFmt"><span class="hs-identifier hs-var">toOrgFmt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe TimeOfDay
</span><a href="#local-6989586621679391282"><span class="hs-identifier hs-var">tod</span></a></span><span> </span><span class="annot"><span class="annottext">(Day -&gt; IO String) -&gt; Day -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Date
</span><a href="#local-6989586621679391283"><span class="hs-identifier hs-var">date</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><span class="annottext">Date
</span><a href="XMonad.Prompt.OrgMode.html#Today"><span class="hs-identifier hs-var">Today</span></a></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Day
</span><a href="#local-6989586621679391280"><span class="hs-identifier hs-var">curDay</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">Date
</span><a href="XMonad.Prompt.OrgMode.html#Tomorrow"><span class="hs-identifier hs-var">Tomorrow</span></a></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><span class="hs-identifier hs-var hs-var">utctDay</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Day) -&gt; UTCTime -&gt; Day
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="#local-6989586621679391274"><span class="hs-identifier hs-var">addDays</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679391281"><span class="hs-identifier hs-var">curTime</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Next"><span class="hs-identifier hs-type">Next</span></a></span><span> </span><span id="local-6989586621679391273"><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391273"><span class="hs-identifier hs-var">wday</span></a></span></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; Day
</span><span class="hs-identifier hs-var hs-var">utctDay</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; Day) -&gt; UTCTime -&gt; Day
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="#local-6989586621679391274"><span class="hs-identifier hs-var">addDays</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DayOfWeek -&gt; NominalDiffTime
</span><a href="#local-6989586621679391277"><span class="hs-identifier hs-var">diffToDay</span></a></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391273"><span class="hs-identifier hs-var">wday</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679391281"><span class="hs-identifier hs-var">curTime</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391272"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391272"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391271"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679391271"><span class="hs-identifier hs-var">mbM</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391270"><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679391270"><span class="hs-identifier hs-var">mbY</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int -&gt; Int -&gt; Day
</span><span class="hs-identifier hs-var">fromGregorian</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer -&gt; Integer
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391279"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
</span><a href="#local-6989586621679391270"><span class="hs-identifier hs-var">mbY</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Maybe Int -&gt; Int
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391278"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679391271"><span class="hs-identifier hs-var">mbM</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391272"><span class="hs-identifier hs-var">d</span></a></span><span>
</span><span id="line-284"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-comment">-- | Add a specified number of days to a 'UTCTime'.</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679391274"><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><a href="#local-6989586621679391274"><span class="hs-identifier hs-var">addDays</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; UTCTime -&gt; UTCTime)
-&gt; (NominalDiffTime -&gt; NominalDiffTime)
-&gt; NominalDiffTime
-&gt; UTCTime
-&gt; UTCTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-identifier hs-var">nominalDay</span></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-comment">-- | Evil enum hackery.</span><span>
</span><span id="line-290"></span><span>  </span><span class="annot"><a href="#local-6989586621679391275"><span class="hs-identifier hs-type">diffBetween</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679391275"><span class="annot"><span class="annottext">diffBetween :: DayOfWeek -&gt; DayOfWeek -&gt; NominalDiffTime
</span><a href="#local-6989586621679391275"><span class="hs-identifier hs-var hs-var">diffBetween</span></a></span></span><span> </span><span id="local-6989586621679391267"><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391267"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679391266"><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391266"><span class="hs-identifier hs-var">cur</span></a></span></span><span>  </span><span class="hs-comment">-- we want to jump to @d@</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391267"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">DayOfWeek -&gt; DayOfWeek -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391266"><span class="hs-identifier hs-var">cur</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">7</span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; NominalDiffTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; NominalDiffTime) -&gt; (Int -&gt; Int) -&gt; Int -&gt; NominalDiffTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int
forall a. Num a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">abs</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; NominalDiffTime) -&gt; Int -&gt; NominalDiffTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DayOfWeek -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391267"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek -&gt; Int
forall a. Enum a =&gt; a -&gt; Int
</span><span class="hs-identifier hs-var">fromEnum</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="#local-6989586621679391266"><span class="hs-identifier hs-var">cur</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">`mod`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">-- Old GHC versions don't have a @time@ library new enough to have</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- this, so replicate it here for the moment.</span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#dayOfWeek"><span class="hs-identifier hs-type">dayOfWeek</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Day</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span>
</span><span id="line-299"></span><span id="dayOfWeek"><span class="annot"><span class="annottext">dayOfWeek :: Day -&gt; DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#dayOfWeek"><span class="hs-identifier hs-var hs-var">dayOfWeek</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ModifiedJulianDay</span></span><span> </span><span id="local-6989586621679391262"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391262"><span class="hs-identifier hs-var">d</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; DayOfWeek
forall a. Enum a =&gt; Int -&gt; a
</span><span class="hs-identifier hs-var">toEnum</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; DayOfWeek) -&gt; Int -&gt; DayOfWeek
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Int
forall a. Num a =&gt; Integer -&gt; a
</span><span class="hs-identifier hs-var">fromInteger</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Int) -&gt; Integer -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391262"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">3</span></span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="hs-keyword">data</span><span> </span><span id="DayOfWeek"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-var">DayOfWeek</span></a></span></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Monday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Monday"><span class="hs-identifier hs-var">Monday</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Tuesday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Tuesday"><span class="hs-identifier hs-var">Tuesday</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Wednesday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Wednesday"><span class="hs-identifier hs-var">Wednesday</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Thursday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Thursday"><span class="hs-identifier hs-var">Thursday</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Friday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Friday"><span class="hs-identifier hs-var">Friday</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Saturday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Saturday"><span class="hs-identifier hs-var">Saturday</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Sunday"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Sunday"><span class="hs-identifier hs-var">Sunday</span></a></span></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391249"><span id="local-6989586621679391251"><span class="annot"><span class="annottext">DayOfWeek -&gt; DayOfWeek -&gt; Bool
(DayOfWeek -&gt; DayOfWeek -&gt; Bool)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; Bool) -&gt; Eq DayOfWeek
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
$c/= :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
== :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
$c== :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391234"><span id="local-6989586621679391236"><span id="local-6989586621679391238"><span id="local-6989586621679391240"><span id="local-6989586621679391242"><span id="local-6989586621679391244"><span id="local-6989586621679391246"><span class="annot"><span class="annottext">Eq DayOfWeek
Eq DayOfWeek
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; Ordering)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; Bool)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; Bool)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; Bool)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; Bool)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek)
-&gt; (DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek)
-&gt; Ord DayOfWeek
DayOfWeek -&gt; DayOfWeek -&gt; Bool
DayOfWeek -&gt; DayOfWeek -&gt; Ordering
DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek
$cmin :: DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek
max :: DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek
$cmax :: DayOfWeek -&gt; DayOfWeek -&gt; DayOfWeek
&gt;= :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
$c&gt;= :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
&gt; :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
$c&gt; :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
&lt;= :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
$c&lt;= :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
&lt; :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
$c&lt; :: DayOfWeek -&gt; DayOfWeek -&gt; Bool
compare :: DayOfWeek -&gt; DayOfWeek -&gt; Ordering
$ccompare :: DayOfWeek -&gt; DayOfWeek -&gt; Ordering
$cp1Ord :: Eq DayOfWeek
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391228"><span id="local-6989586621679391230"><span id="local-6989586621679391232"><span class="annot"><span class="annottext">Int -&gt; DayOfWeek -&gt; String -&gt; String
[DayOfWeek] -&gt; String -&gt; String
DayOfWeek -&gt; String
(Int -&gt; DayOfWeek -&gt; String -&gt; String)
-&gt; (DayOfWeek -&gt; String)
-&gt; ([DayOfWeek] -&gt; String -&gt; String)
-&gt; Show DayOfWeek
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [DayOfWeek] -&gt; String -&gt; String
$cshowList :: [DayOfWeek] -&gt; String -&gt; String
show :: DayOfWeek -&gt; String
$cshow :: DayOfWeek -&gt; String
showsPrec :: Int -&gt; DayOfWeek -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; DayOfWeek -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | \&quot;Circular\&quot;, so for example @[Tuesday ..]@ gives an endless</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- sequence.  Also: 'fromEnum' gives [1 .. 7] for [Monday .. Sunday],</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- and 'toEnum' performs mod 7 to give a cycle of days.</span><span>
</span><span id="line-308"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679391214"><span id="local-6989586621679391216"><span id="local-6989586621679391218"><span id="local-6989586621679391220"><span id="local-6989586621679391224"><span id="local-6989586621679391226"><span class="annot"><span class="hs-identifier hs-type">Enum</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">toEnum</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679391212"><span class="annot"><span class="annottext">toEnum :: Int -&gt; DayOfWeek
</span><a href="#local-6989586621679391212"><span class="hs-identifier hs-var hs-var hs-var hs-var">toEnum</span></a></span></span><span> </span><span id="local-6989586621679391211"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391211"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Integral a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">mod</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679391211"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Sunday"><span class="hs-identifier hs-var">Sunday</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Monday"><span class="hs-identifier hs-var">Monday</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Tuesday"><span class="hs-identifier hs-var">Tuesday</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Wednesday"><span class="hs-identifier hs-var">Wednesday</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Thursday"><span class="hs-identifier hs-var">Thursday</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Friday"><span class="hs-identifier hs-var">Friday</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Saturday"><span class="hs-identifier hs-var">Saturday</span></a></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">fromEnum</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679391210"><span class="annot"><span class="annottext">fromEnum :: DayOfWeek -&gt; Int
</span><a href="#local-6989586621679391210"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromEnum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Monday"><span class="hs-identifier hs-var">Monday</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Tuesday"><span class="hs-identifier hs-var">Tuesday</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Wednesday"><span class="hs-identifier hs-var">Wednesday</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Thursday"><span class="hs-identifier hs-var">Thursday</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Friday"><span class="hs-identifier hs-var">Friday</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span>
</span><span id="line-326"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Saturday"><span class="hs-identifier hs-var">Saturday</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Sunday"><span class="hs-identifier hs-var">Sunday</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-330"></span><span class="hs-comment">-- Note</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | An @org-mode@ style note.</span><span>
</span><span id="line-333"></span><span class="hs-keyword">data</span><span> </span><span id="Note"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Note"><span class="hs-identifier hs-var">Note</span></a></span></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Scheduled"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Scheduled"><span class="hs-identifier hs-var">Scheduled</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Deadline"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Deadline"><span class="hs-identifier hs-var">Deadline</span></a></span></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NormalMsg"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#NormalMsg"><span class="hs-identifier hs-var">NormalMsg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679391203"><span id="local-6989586621679391205"><span class="annot"><span class="annottext">Note -&gt; Note -&gt; Bool
(Note -&gt; Note -&gt; Bool) -&gt; (Note -&gt; Note -&gt; Bool) -&gt; Eq Note
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Note -&gt; Note -&gt; Bool
$c/= :: Note -&gt; Note -&gt; Bool
== :: Note -&gt; Note -&gt; Bool
$c== :: Note -&gt; Note -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679391197"><span id="local-6989586621679391199"><span id="local-6989586621679391201"><span class="annot"><span class="annottext">Int -&gt; Note -&gt; String -&gt; String
[Note] -&gt; String -&gt; String
Note -&gt; String
(Int -&gt; Note -&gt; String -&gt; String)
-&gt; (Note -&gt; String) -&gt; ([Note] -&gt; String -&gt; String) -&gt; Show Note
forall a.
(Int -&gt; a -&gt; String -&gt; String)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; String -&gt; String) -&gt; Show a
showList :: [Note] -&gt; String -&gt; String
$cshowList :: [Note] -&gt; String -&gt; String
show :: Note -&gt; String
$cshow :: Note -&gt; String
showsPrec :: Int -&gt; Note -&gt; String -&gt; String
$cshowsPrec :: Int -&gt; Note -&gt; String -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="hs-comment">-- | Pretty print a given 'Note'.</span><span>
</span><span id="line-340"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#ppNote"><span class="hs-identifier hs-type">ppNote</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Clp"><span class="hs-identifier hs-type">Clp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Note"><span class="hs-identifier hs-type">Note</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-341"></span><span id="ppNote"><span class="annot"><span class="annottext">ppNote :: Clp -&gt; String -&gt; Note -&gt; IO String
</span><a href="XMonad.Prompt.OrgMode.html#ppNote"><span class="hs-identifier hs-var hs-var">ppNote</span></a></span></span><span> </span><span id="local-6989586621679391196"><span class="annot"><span class="annottext">Clp
</span><a href="#local-6989586621679391196"><span class="hs-identifier hs-var">clp</span></a></span></span><span> </span><span id="local-6989586621679391195"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391195"><span class="hs-identifier hs-var">todo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-342"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Scheduled"><span class="hs-identifier hs-type">Scheduled</span></a></span><span> </span><span id="local-6989586621679391194"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391194"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679391193"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679391193"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe Time -&gt; IO String
</span><a href="#local-6989586621679391192"><span class="hs-identifier hs-var">mkLine</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391194"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SCHEDULED: &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; Maybe Time
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679391193"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Deadline"><span class="hs-identifier hs-type">Deadline</span></a></span><span>  </span><span id="local-6989586621679391191"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391191"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679391190"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679391190"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe Time -&gt; IO String
</span><a href="#local-6989586621679391192"><span class="hs-identifier hs-var">mkLine</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391191"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;DEADLINE: &quot;</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Time -&gt; Maybe Time
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679391190"><span class="hs-identifier hs-var">time</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>  </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#NormalMsg"><span class="hs-identifier hs-type">NormalMsg</span></a></span><span> </span><span id="local-6989586621679391189"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391189"><span class="hs-identifier hs-var">str</span></a></span></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Maybe Time -&gt; IO String
</span><a href="#local-6989586621679391192"><span class="hs-identifier hs-var">mkLine</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391189"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>            </span><span class="annot"><span class="annottext">Maybe Time
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-345"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><a href="#local-6989586621679391192"><span class="hs-identifier hs-type">mkLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-type">Time</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-347"></span><span>  </span><span id="local-6989586621679391192"><span class="annot"><span class="annottext">mkLine :: String -&gt; String -&gt; Maybe Time -&gt; IO String
</span><a href="#local-6989586621679391192"><span class="hs-identifier hs-var hs-var">mkLine</span></a></span></span><span> </span><span id="local-6989586621679391188"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391188"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span id="local-6989586621679391187"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391187"><span class="hs-identifier hs-var">sched</span></a></span></span><span> </span><span id="local-6989586621679391186"><span class="annot"><span class="annottext">Maybe Time
</span><a href="#local-6989586621679391186"><span class="hs-identifier hs-var">time</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-348"></span><span>    </span><span id="local-6989586621679391185"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391185"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Time
</span><a href="#local-6989586621679391186"><span class="hs-identifier hs-var">time</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-349"></span><span>      </span><span class="annot"><span class="annottext">Maybe Time
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-350"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679391184"><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679391184"><span class="hs-identifier hs-var">ti</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391187"><span class="hs-identifier hs-var">sched</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; IO String -&gt; IO String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Time -&gt; IO String
</span><a href="XMonad.Prompt.OrgMode.html#ppDate"><span class="hs-identifier hs-var">ppDate</span></a></span><span> </span><span class="annot"><span class="annottext">Time
</span><a href="#local-6989586621679391184"><span class="hs-identifier hs-var">ti</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; String -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Clp
</span><a href="#local-6989586621679391196"><span class="hs-identifier hs-var">clp</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-352"></span><span>      </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Body"><span class="hs-identifier hs-type">Body</span></a></span><span>   </span><span id="local-6989586621679391182"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391182"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;* &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391195"><span class="hs-identifier hs-var">todo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391188"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391185"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391182"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-353"></span><span>      </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Header"><span class="hs-identifier hs-type">Header</span></a></span><span> </span><span id="local-6989586621679391181"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391181"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
forall a. Monoid a =&gt; [a] -&gt; a
</span><span class="hs-identifier hs-var">mconcat</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;* &quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391195"><span class="hs-identifier hs-var">todo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; [[&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391181"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;][&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391188"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;]]&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391185"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-354"></span><span>
</span><span id="line-355"></span><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- Parsing</span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-comment">-- | Parse the given string into a 'Note'.</span><span>
</span><span id="line-359"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#pInput"><span class="hs-identifier hs-type">pInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Note"><span class="hs-identifier hs-type">Note</span></a></span><span>
</span><span id="line-360"></span><span id="pInput"><span class="annot"><span class="annottext">pInput :: String -&gt; Maybe Note
</span><a href="XMonad.Prompt.OrgMode.html#pInput"><span class="hs-identifier hs-var hs-var">pInput</span></a></span></span><span> </span><span id="local-6989586621679391180"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391180"><span class="hs-identifier hs-var">inp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Note, String) -&gt; Note) -&gt; Maybe (Note, String) -&gt; Maybe Note
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Note, String) -&gt; Note
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Note, String) -&gt; Maybe Note)
-&gt; ([ReadP Note] -&gt; Maybe (Note, String))
-&gt; [ReadP Note]
-&gt; Maybe Note
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[(Note, String)] -&gt; Maybe (Note, String)
forall a. [a] -&gt; Maybe a
</span><span class="hs-identifier hs-var">listToMaybe</span></span><span> </span><span class="annot"><span class="annottext">([(Note, String)] -&gt; Maybe (Note, String))
-&gt; ([ReadP Note] -&gt; [(Note, String)])
-&gt; [ReadP Note]
-&gt; Maybe (Note, String)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP Note -&gt; ReadS Note
forall a. ReadP a -&gt; ReadS a
</span><span class="hs-operator hs-var">`readP_to_S`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391180"><span class="hs-identifier hs-var">inp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ReadP Note -&gt; [(Note, String)])
-&gt; ([ReadP Note] -&gt; ReadP Note) -&gt; [ReadP Note] -&gt; [(Note, String)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[ReadP Note] -&gt; ReadP Note
forall a. [ReadP a] -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-var">lchoice</span></a></span><span> </span><span class="annot"><span class="annottext">([ReadP Note] -&gt; Maybe Note) -&gt; [ReadP Note] -&gt; Maybe Note
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; Time -&gt; Note
</span><a href="XMonad.Prompt.OrgMode.html#Scheduled"><span class="hs-identifier hs-var">Scheduled</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Time -&gt; Note) -&gt; ReadP String -&gt; ReadP (Time -&gt; Note)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><a href="#local-6989586621679391177"><span class="hs-identifier hs-var">getLast</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+s&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Time -&gt; Note) -&gt; ReadP Time -&gt; ReadP Note
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Date -&gt; Maybe TimeOfDay -&gt; Time
</span><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-var">Time</span></a></span><span> </span><span class="annot"><span class="annottext">(Date -&gt; Maybe TimeOfDay -&gt; Time)
-&gt; ReadP Date -&gt; ReadP (Maybe TimeOfDay -&gt; Time)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Date
</span><a href="XMonad.Prompt.OrgMode.html#pDate"><span class="hs-identifier hs-var">pDate</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP (Maybe TimeOfDay -&gt; Time)
-&gt; ReadP (Maybe TimeOfDay) -&gt; ReadP Time
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Maybe TimeOfDay)
</span><a href="XMonad.Prompt.OrgMode.html#pTimeOfDay"><span class="hs-identifier hs-var">pTimeOfDay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Time -&gt; Note
</span><a href="XMonad.Prompt.OrgMode.html#Deadline"><span class="hs-identifier hs-var">Deadline</span></a></span><span>  </span><span class="annot"><span class="annottext">(String -&gt; Time -&gt; Note) -&gt; ReadP String -&gt; ReadP (Time -&gt; Note)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><a href="#local-6989586621679391177"><span class="hs-identifier hs-var">getLast</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;+d&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Time -&gt; Note) -&gt; ReadP Time -&gt; ReadP Note
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Date -&gt; Maybe TimeOfDay -&gt; Time
</span><a href="XMonad.Prompt.OrgMode.html#Time"><span class="hs-identifier hs-var">Time</span></a></span><span> </span><span class="annot"><span class="annottext">(Date -&gt; Maybe TimeOfDay -&gt; Time)
-&gt; ReadP Date -&gt; ReadP (Maybe TimeOfDay -&gt; Time)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Date
</span><a href="XMonad.Prompt.OrgMode.html#pDate"><span class="hs-identifier hs-var">pDate</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP (Maybe TimeOfDay -&gt; Time)
-&gt; ReadP (Maybe TimeOfDay) -&gt; ReadP Time
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Maybe TimeOfDay)
</span><a href="XMonad.Prompt.OrgMode.html#pTimeOfDay"><span class="hs-identifier hs-var">pTimeOfDay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Note
</span><a href="XMonad.Prompt.OrgMode.html#NormalMsg"><span class="hs-identifier hs-var">NormalMsg</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Note) -&gt; ReadP String -&gt; ReadP Note
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP String
</span><span class="hs-identifier hs-var">munch1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Char -&gt; Bool
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-365"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><a href="#local-6989586621679391177"><span class="hs-identifier hs-type">getLast</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-367"></span><span>  </span><span id="local-6989586621679391177"><span class="annot"><span class="annottext">getLast :: String -&gt; ReadP String
</span><a href="#local-6989586621679391177"><span class="hs-identifier hs-var hs-var">getLast</span></a></span></span><span> </span><span id="local-6989586621679391174"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391174"><span class="hs-identifier hs-var">ptn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-368"></span><span>              </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; String -&gt; String
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">dropWhile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>    </span><span class="hs-comment">-- trim whitespace at the end</span><span>
</span><span id="line-369"></span><span>              </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391174"><span class="hs-identifier hs-var">ptn</span></a></span><span class="hs-special">)</span><span>     </span><span class="hs-comment">-- drop only the last pattern</span><span>
</span><span id="line-370"></span><span>              </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">String -&gt; String
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span>
</span><span id="line-371"></span><span>              </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; ([String] -&gt; String) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span>  </span><span class="annot"><span class="annottext">[String] -&gt; String
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span>
</span><span id="line-372"></span><span>             </span><span class="annot"><span class="annottext">([String] -&gt; String) -&gt; ReadP [String] -&gt; ReadP String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP String -&gt; ReadP String -&gt; ReadP [String]
forall a sep. ReadP a -&gt; ReadP sep -&gt; ReadP [a]
</span><a href="XMonad.Prompt.OrgMode.html#endBy1"><span class="hs-identifier hs-var">endBy1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><a href="#local-6989586621679391168"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ReadP String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391174"><span class="hs-identifier hs-var">ptn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><a href="#local-6989586621679391168"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-375"></span><span>    </span><span id="local-6989586621679391168"><span class="annot"><span class="annottext">go :: String -&gt; ReadP String
</span><a href="#local-6989586621679391168"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679391167"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391167"><span class="hs-identifier hs-var">consumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679391166"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391166"><span class="hs-identifier hs-var">str</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP String
</span><span class="hs-identifier hs-var">munch</span></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Char
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391174"><span class="hs-identifier hs-var">ptn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>      </span><span id="local-6989586621679391163"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391163"><span class="hs-identifier hs-var">word</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP String
</span><span class="hs-identifier hs-var">munch1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>      </span><span class="annot"><span class="annottext">(String -&gt; ReadP String)
-&gt; (String -&gt; ReadP String) -&gt; Bool -&gt; String -&gt; ReadP String
forall a. a -&gt; a -&gt; Bool -&gt; a
</span><span class="hs-identifier hs-var">bool</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><a href="#local-6989586621679391168"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391163"><span class="hs-identifier hs-var">word</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391174"><span class="hs-identifier hs-var">ptn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(String -&gt; ReadP String) -&gt; String -&gt; ReadP String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391167"><span class="hs-identifier hs-var">consumed</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391166"><span class="hs-identifier hs-var">str</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391163"><span class="hs-identifier hs-var">word</span></a></span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span class="hs-comment">-- | Try to parse a 'Time'.</span><span>
</span><span id="line-381"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#pTimeOfDay"><span class="hs-identifier hs-type">pTimeOfDay</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-type">TimeOfDay</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span id="pTimeOfDay"><span class="annot"><span class="annottext">pTimeOfDay :: ReadP (Maybe TimeOfDay)
</span><a href="XMonad.Prompt.OrgMode.html#pTimeOfDay"><span class="hs-identifier hs-var hs-var">pTimeOfDay</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ReadP (Maybe TimeOfDay)] -&gt; ReadP (Maybe TimeOfDay)
forall a. [ReadP a] -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-var">lchoice</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">TimeOfDay -&gt; Maybe TimeOfDay
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TimeOfDay -&gt; Maybe TimeOfDay)
-&gt; ReadP TimeOfDay -&gt; ReadP (Maybe TimeOfDay)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; TimeOfDay
</span><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-var">TimeOfDay</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; TimeOfDay) -&gt; ReadP Int -&gt; ReadP (Int -&gt; TimeOfDay)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Int
forall a. (Read a, Integral a) =&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-var">pInt</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP (Int -&gt; TimeOfDay)
-&gt; ReadP String -&gt; ReadP (Int -&gt; TimeOfDay)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Int -&gt; TimeOfDay) -&gt; ReadP Int -&gt; ReadP TimeOfDay
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Int
forall a. (Read a, Integral a) =&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-var">pInt</span></a></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- HH:MM</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TimeOfDay -&gt; Maybe TimeOfDay
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(TimeOfDay -&gt; Maybe TimeOfDay)
-&gt; ReadP TimeOfDay -&gt; ReadP (Maybe TimeOfDay)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; TimeOfDay
</span><a href="XMonad.Prompt.OrgMode.html#TimeOfDay"><span class="hs-identifier hs-var">TimeOfDay</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; TimeOfDay) -&gt; ReadP Int -&gt; ReadP (Int -&gt; TimeOfDay)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Int
forall a. (Read a, Integral a) =&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-var">pInt</span></a></span><span>               </span><span class="annot"><span class="annottext">ReadP (Int -&gt; TimeOfDay) -&gt; ReadP Int -&gt; ReadP TimeOfDay
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ReadP Int
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- HH</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe TimeOfDay -&gt; ReadP (Maybe TimeOfDay)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe TimeOfDay
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Parse a 'Date'.</span><span>
</span><span id="line-389"></span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#pDate"><span class="hs-identifier hs-type">pDate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#Date"><span class="hs-identifier hs-type">Date</span></a></span><span>
</span><span id="line-390"></span><span id="pDate"><span class="annot"><span class="annottext">pDate :: ReadP Date
</span><a href="XMonad.Prompt.OrgMode.html#pDate"><span class="hs-identifier hs-var hs-var">pDate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">skipSpaces</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP Date -&gt; ReadP Date
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ReadP Date] -&gt; ReadP Date
forall a. [ReadP a] -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-var">lchoice</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Date -&gt; ReadP Date
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tod&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ay&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Date
</span><a href="XMonad.Prompt.OrgMode.html#Today"><span class="hs-identifier hs-var">Today</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Date -&gt; ReadP Date
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tom&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;orrow&quot;</span></span><span> </span><span class="annot"><span class="annottext">Date
</span><a href="XMonad.Prompt.OrgMode.html#Tomorrow"><span class="hs-identifier hs-var">Tomorrow</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">DayOfWeek -&gt; Date
</span><a href="XMonad.Prompt.OrgMode.html#Next"><span class="hs-identifier hs-var">Next</span></a></span><span>     </span><span class="annot"><span class="annottext">(DayOfWeek -&gt; Date) -&gt; ReadP DayOfWeek -&gt; ReadP Date
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP DayOfWeek
</span><a href="#local-6989586621679391158"><span class="hs-identifier hs-var">pNext</span></a></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(Int, Maybe Int, Maybe Integer) -&gt; Date
</span><a href="XMonad.Prompt.OrgMode.html#Date"><span class="hs-identifier hs-var">Date</span></a></span><span>     </span><span class="annot"><span class="annottext">((Int, Maybe Int, Maybe Integer) -&gt; Date)
-&gt; ReadP (Int, Maybe Int, Maybe Integer) -&gt; ReadP Date
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Int, Maybe Int, Maybe Integer)
</span><a href="#local-6989586621679391157"><span class="hs-identifier hs-var">pDate1</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP (Int, Maybe Int, Maybe Integer)
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-operator hs-var">&lt;++</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Int, Maybe Int, Maybe Integer)
</span><a href="#local-6989586621679391156"><span class="hs-identifier hs-var">pDate2</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP (Int, Maybe Int, Maybe Integer)
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-operator hs-var">&lt;++</span></span><span> </span><span class="annot"><span class="annottext">ReadP (Int, Maybe Int, Maybe Integer)
</span><a href="#local-6989586621679391155"><span class="hs-identifier hs-var">pDate3</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">ReadP Date -&gt; ReadP () -&gt; ReadP Date
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">skipSpaces</span></span><span>  </span><span class="hs-comment">-- cleanup</span><span>
</span><span id="line-396"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>  </span><span id="local-6989586621679391158"><span class="annot"><span class="annottext">ReadP DayOfWeek
</span><a href="#local-6989586621679391158"><span class="hs-identifier hs-var">pNext</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="XMonad.Prompt.OrgMode.html#DayOfWeek"><span class="hs-identifier hs-type">DayOfWeek</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ReadP DayOfWeek] -&gt; ReadP DayOfWeek
forall a. [ReadP a] -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-var">lchoice</span></a></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;m&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;onday&quot;</span></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Monday"><span class="hs-identifier hs-var">Monday</span></a></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;tu&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;esday&quot;</span></span><span>  </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Tuesday"><span class="hs-identifier hs-var">Tuesday</span></a></span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;w&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ednesday&quot;</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Wednesday"><span class="hs-identifier hs-var">Wednesday</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;th&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ursday&quot;</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Thursday"><span class="hs-identifier hs-var">Thursday</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;riday&quot;</span></span><span>    </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Friday"><span class="hs-identifier hs-var">Friday</span></a></span><span>   </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;sa&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;turday&quot;</span></span><span> </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Saturday"><span class="hs-identifier hs-var">Saturday</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; DayOfWeek -&gt; ReadP DayOfWeek
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;su&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nday&quot;</span></span><span>     </span><span class="annot"><span class="annottext">DayOfWeek
</span><a href="XMonad.Prompt.OrgMode.html#Sunday"><span class="hs-identifier hs-var">Sunday</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-comment">-- XXX: This is really horrible, but I can't see a way to not have</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-comment">-- exponential blowup with ReadP otherwise.</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><a href="#local-6989586621679391157"><span class="hs-identifier hs-type">pDate1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679391156"><span class="hs-identifier hs-type">pDate2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679391155"><span class="hs-identifier hs-type">pDate3</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679391157"><span class="annot"><span class="annottext">pDate1 :: ReadP (Int, Maybe Int, Maybe Integer)
</span><a href="#local-6989586621679391157"><span class="hs-identifier hs-var hs-var">pDate1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ReadP Int -&gt; ReadP (Maybe Int))
-&gt; (ReadP Integer -&gt; ReadP (Maybe Integer))
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
forall (f :: * -&gt; *).
(ReadP Int -&gt; ReadP (f Int))
-&gt; (ReadP Integer -&gt; ReadP (f Integer))
-&gt; ReadP (Int, f Int, f Integer)
</span><a href="#local-6989586621679391154"><span class="hs-identifier hs-var">pDate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; ReadP Int -&gt; ReadP (Maybe Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Integer -&gt; Maybe Integer)
-&gt; ReadP Integer -&gt; ReadP (Maybe Integer)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Maybe Integer
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679391156"><span class="annot"><span class="annottext">pDate2 :: ReadP (Int, Maybe Int, Maybe Integer)
</span><a href="#local-6989586621679391156"><span class="hs-identifier hs-var hs-var">pDate2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ReadP Int -&gt; ReadP (Maybe Int))
-&gt; (ReadP Integer -&gt; ReadP (Maybe Integer))
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
forall (f :: * -&gt; *).
(ReadP Int -&gt; ReadP (f Int))
-&gt; (ReadP Integer -&gt; ReadP (f Integer))
-&gt; ReadP (Int, f Int, f Integer)
</span><a href="#local-6989586621679391154"><span class="hs-identifier hs-var">pDate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Maybe Int) -&gt; ReadP Int -&gt; ReadP (Maybe Int)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Maybe Int
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span class="hs-special">)</span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP (Maybe Integer) -&gt; ReadP Integer -&gt; ReadP (Maybe Integer)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Integer -&gt; ReadP (Maybe Integer)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679391155"><span class="annot"><span class="annottext">pDate3 :: ReadP (Int, Maybe Int, Maybe Integer)
</span><a href="#local-6989586621679391155"><span class="hs-identifier hs-var hs-var">pDate3</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ReadP Int -&gt; ReadP (Maybe Int))
-&gt; (ReadP Integer -&gt; ReadP (Maybe Integer))
-&gt; ReadP (Int, Maybe Int, Maybe Integer)
forall (f :: * -&gt; *).
(ReadP Int -&gt; ReadP (f Int))
-&gt; (ReadP Integer -&gt; ReadP (f Integer))
-&gt; ReadP (Int, f Int, f Integer)
</span><a href="#local-6989586621679391154"><span class="hs-identifier hs-var">pDate'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP (Maybe Int) -&gt; ReadP Int -&gt; ReadP (Maybe Int)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int -&gt; ReadP (Maybe Int)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP (Maybe Integer) -&gt; ReadP Integer -&gt; ReadP (Maybe Integer)
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Integer -&gt; ReadP (Maybe Integer)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe Integer
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>  </span><span id="local-6989586621679391458"><span class="annot"><a href="#local-6989586621679391154"><span class="hs-identifier hs-type">pDate'</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679391458"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>    </span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679391458"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679391458"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679391458"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-414"></span><span>  </span><span id="local-6989586621679391154"><span class="annot"><span class="annottext">pDate' :: (ReadP Int -&gt; ReadP (f Int))
-&gt; (ReadP Integer -&gt; ReadP (f Integer))
-&gt; ReadP (Int, f Int, f Integer)
</span><a href="#local-6989586621679391154"><span class="hs-identifier hs-var hs-var">pDate'</span></a></span></span><span> </span><span id="local-6989586621679391153"><span class="annot"><span class="annottext">ReadP Int -&gt; ReadP (f Int)
</span><a href="#local-6989586621679391153"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679391152"><span class="annot"><span class="annottext">ReadP Integer -&gt; ReadP (f Integer)
</span><a href="#local-6989586621679391152"><span class="hs-identifier hs-var">p'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; f Int -&gt; f Integer -&gt; (Int, f Int, f Integer))
-&gt; ReadP Int
-&gt; ReadP (f Int -&gt; f Integer -&gt; (Int, f Int, f Integer))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Int
forall a. (Read a, Integral a) =&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-var">pInt</span></a></span><span>
</span><span id="line-416"></span><span>         </span><span class="annot"><span class="annottext">ReadP (f Int -&gt; f Integer -&gt; (Int, f Int, f Integer))
-&gt; ReadP (f Int) -&gt; ReadP (f Integer -&gt; (Int, f Int, f Integer))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Int -&gt; ReadP (f Int)
</span><a href="#local-6989586621679391153"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">skipSpaces</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP Int -&gt; ReadP Int
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ReadP Int] -&gt; ReadP Int
forall a. [ReadP a] -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-var">lchoice</span></a></span><span>
</span><span id="line-417"></span><span>               </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ja&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;nuary&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;f&quot;</span></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ebruary&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-418"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mar&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ch&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ap&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ril&quot;</span></span><span>     </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span>
</span><span id="line-419"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;may&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>         </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;jun&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;e&quot;</span></span><span>       </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">6</span></span><span>
</span><span id="line-420"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;jul&quot;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;y&quot;</span></span><span>        </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">7</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;au&quot;</span></span><span>  </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;gust&quot;</span></span><span>    </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span>
</span><span id="line-421"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;s&quot;</span></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;eptember&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;o&quot;</span></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ctober&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">10</span></span><span>
</span><span id="line-422"></span><span>               </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;n&quot;</span></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ovember&quot;</span></span><span>  </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">11</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Int -&gt; ReadP Int
forall a. String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var">pString</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;d&quot;</span></span><span>   </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ecember&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">12</span></span><span>
</span><span id="line-423"></span><span>               </span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>         </span><span class="annot"><span class="annottext">ReadP (f Integer -&gt; (Int, f Int, f Integer))
-&gt; ReadP (f Integer) -&gt; ReadP (Int, f Int, f Integer)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Integer -&gt; ReadP (f Integer)
</span><a href="#local-6989586621679391152"><span class="hs-identifier hs-var">p'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP ()
</span><span class="hs-identifier hs-var">skipSpaces</span></span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; ReadP Integer -&gt; ReadP Integer
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><span class="hs-operator hs-var">*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP Integer
forall a. (Read a, Integral a) =&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-var">pInt</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP Integer -&gt; (Integer -&gt; ReadP Integer) -&gt; ReadP Integer
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679391151"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391151"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; ReadP ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391151"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">25</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ReadP () -&gt; Integer -&gt; ReadP Integer
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; b -&gt; f b
</span><span class="hs-operator hs-var">$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679391151"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>
</span><span id="line-426"></span><span class="hs-comment">-- | Parse a @start@ and see whether the rest of the word (separated by</span><span>
</span><span id="line-427"></span><span class="hs-comment">-- spaces) fits the @leftover@.</span><span>
</span><span id="line-428"></span><span id="local-6989586621679391460"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-type">pString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679391460"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391460"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-429"></span><span id="pString"><span class="annot"><span class="annottext">pString :: String -&gt; String -&gt; a -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pString"><span class="hs-identifier hs-var hs-var">pString</span></a></span></span><span> </span><span id="local-6989586621679391149"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391149"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span id="local-6989586621679391148"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391148"><span class="hs-identifier hs-var">leftover</span></a></span></span><span> </span><span id="local-6989586621679391147"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679391147"><span class="hs-identifier hs-var">ret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><span class="annottext">ReadP String -&gt; ReadP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP String -&gt; ReadP ()) -&gt; ReadP String -&gt; ReadP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391149"><span class="hs-identifier hs-var">start</span></a></span><span>
</span><span id="line-431"></span><span>  </span><span id="local-6989586621679391145"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391145"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP String
</span><span class="hs-identifier hs-var">munch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; ReadP ()
forall (f :: * -&gt; *). Alternative f =&gt; Bool -&gt; f ()
</span><span class="hs-identifier hs-var">guard</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391145"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-operator hs-var">`isPrefixOf`</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679391148"><span class="hs-identifier hs-var">leftover</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>  </span><span class="annot"><span class="annottext">a -&gt; ReadP a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679391147"><span class="hs-identifier hs-var">ret</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span class="hs-comment">-- | Parse a number.</span><span>
</span><span id="line-436"></span><span id="local-6989586621679391465"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-type">pInt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Read</span></span><span> </span><span class="annot"><a href="#local-6989586621679391465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integral</span></span><span> </span><span class="annot"><a href="#local-6989586621679391465"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391465"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-437"></span><span id="pInt"><span class="annot"><span class="annottext">pInt :: ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#pInt"><span class="hs-identifier hs-var hs-var">pInt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. Read a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">read</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; a) -&gt; ReadP String -&gt; ReadP a
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP String
</span><span class="hs-identifier hs-var">munch1</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | Like 'choice', but with '(&lt;++)' instead of '(+++)', stopping</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- parsing when the left-most parser succeeds.</span><span>
</span><span id="line-441"></span><span id="local-6989586621679391478"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-type">lchoice</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391478"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391478"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-442"></span><span id="lchoice"><span class="annot"><span class="annottext">lchoice :: [ReadP a] -&gt; ReadP a
</span><a href="XMonad.Prompt.OrgMode.html#lchoice"><span class="hs-identifier hs-var hs-var">lchoice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ReadP a -&gt; ReadP a -&gt; ReadP a) -&gt; ReadP a -&gt; [ReadP a] -&gt; ReadP a
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">ReadP a -&gt; ReadP a -&gt; ReadP a
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-operator hs-var">(&lt;++)</span></span><span> </span><span class="annot"><span class="annottext">ReadP a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a
</span><span class="hs-identifier hs-var">empty</span></span><span>
</span><span id="line-443"></span><span>
</span><span id="line-444"></span><span class="hs-comment">-- | Like 'Text.ParserCombinators.ReadP.endBy1', but only return the</span><span>
</span><span id="line-445"></span><span class="hs-comment">-- parse where @parser@ had the highest number of applications.</span><span>
</span><span id="line-446"></span><span id="local-6989586621679391468"><span id="local-6989586621679391469"><span class="annot"><a href="XMonad.Prompt.OrgMode.html#endBy1"><span class="hs-identifier hs-type">endBy1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391469"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391468"><span class="hs-identifier hs-type">sep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679391469"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-447"></span><span id="endBy1"><span class="annot"><span class="annottext">endBy1 :: ReadP a -&gt; ReadP sep -&gt; ReadP [a]
</span><a href="XMonad.Prompt.OrgMode.html#endBy1"><span class="hs-identifier hs-var hs-var">endBy1</span></a></span></span><span> </span><span id="local-6989586621679391140"><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679391140"><span class="hs-identifier hs-var">parser</span></a></span></span><span> </span><span id="local-6989586621679391139"><span class="annot"><span class="annottext">ReadP sep
</span><a href="#local-6989586621679391139"><span class="hs-identifier hs-var">sep</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP a -&gt; ReadP [a]
forall a. ReadP a -&gt; ReadP [a]
</span><a href="#local-6989586621679391138"><span class="hs-identifier hs-var">many1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679391140"><span class="hs-identifier hs-var">parser</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP a -&gt; ReadP sep -&gt; ReadP a
forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;*</span></span><span> </span><span class="annot"><span class="annottext">ReadP sep
</span><a href="#local-6989586621679391139"><span class="hs-identifier hs-var">sep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-comment">-- | Like 'Text.ParserCombinators.ReadP.many1', but use '(&lt;++)'</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-comment">-- instead of '(+++)'.</span><span>
</span><span id="line-451"></span><span>  </span><span id="local-6989586621679391434"><span class="annot"><a href="#local-6989586621679391138"><span class="hs-identifier hs-type">many1</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="annot"><a href="#local-6989586621679391434"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679391434"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-452"></span><span>  </span><span id="local-6989586621679391138"><span class="annot"><span class="annottext">many1 :: ReadP a -&gt; ReadP [a]
</span><a href="#local-6989586621679391138"><span class="hs-identifier hs-var hs-var">many1</span></a></span></span><span> </span><span id="local-6989586621679391137"><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679391137"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [a] -&gt; [a]) -&gt; ReadP a -&gt; ReadP ([a] -&gt; [a])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679391137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP ([a] -&gt; [a]) -&gt; ReadP [a] -&gt; ReadP [a]
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReadP a -&gt; ReadP [a]
forall a. ReadP a -&gt; ReadP [a]
</span><a href="#local-6989586621679391138"><span class="hs-identifier hs-var">many1</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP a
</span><a href="#local-6989586621679391137"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">ReadP [a] -&gt; ReadP [a] -&gt; ReadP [a]
forall a. ReadP a -&gt; ReadP a -&gt; ReadP a
</span><span class="hs-operator hs-var">&lt;++</span></span><span> </span><span class="annot"><span class="annottext">[a] -&gt; ReadP [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-453"></span></pre></body></html>